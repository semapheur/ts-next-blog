---
title: 'Lagrangian mechanics'
subject: 'physics/classical mechanics'
showToc: true
references:
  - book_benacquista_romano_2018
  - book_deriglazov_2010
  - book_dewar_2022
---

# Euler-Lagrange equations

In Lagrangian mechanics the dynamics of a system with kinetic energy $T$ and potential energy $V$ are determined by the Euler-Lagrange (EL) equations

$$
	\frac{\d}{\d t} \left( \frac{\partial L}{\partial \dot{q}_i} \right) - \frac{\partial L}{\partial q_i} = 0
$$

where $q_i$ are generalized coordinates representing the degrees of freedom of the system and $L(\mathbf{q}, \dot{\mathbf{q}}) = T - V$ is the Lagrangian function.

The EL-equations reproduce Newton's equations of motion for a particle subject to a potential $V(\mathbf{r})$. Its Langrangian function is

$$
	L(\mathbf{r}, \dot{\mathbf{r}}) = \frac{1}{2}m|\dot{\mathbf{r}}|^2 - V(\mathbf{r})
$$

Evaluating the EL-equations yields Newton's equations

$$
\begin{gather*}
	\frac{1}{2}m \frac{\d}{\d t} \left( \dot{\nabla} |\dot{\mathbf{r}}|^2 \right)  + \nabla V(\mathbf{r}) = \mathbf{0} \\
	m\frac{\d}{\d t} \dot{\mathbf{r}} + \nabla V(\mathbf{r}) = \mathbf{0} \\
	m\ddot{\mathbf{r}} = -\nabla V(\mathbf{r}) \equiv \mathbf{F}
\end{gather*}
$$

## Spherical coordinates

The position of a particle expressed in spherical coordinates is

$$
	x = r\sin\theta\cos \, ,\quad y = r\sin\theta\sin\phi \, ,\quad z = r\cos\theta
$$

An infinitisimal displacement is given by

$$
	\d\mathbf{s} = \d r \, \hat{\mathbf{r}} + r\, \d\theta \, \hat{\boldsymbol{\theta}} + r\sin\theta\;\d\phi \, \hat{\boldsymbol{\phi}}
$$

giving the squared infinitisimal distance

$$
	\d s^2 = \d r^2 + r^2\d\theta^2 + r^2
$$

The squared velocity is

$$
	v^2 = \frac{\d s^2}{\d t} \dot{r}^2 + r^2\dot{\theta}^2 + r^2\sin^2(\theta)\dot{\phi}^2
$$

The Lagrangian is

$$
	L = \frac{1}{2}m\left( \frac{\d s^2}{\d t} \dot{r}^2 + r^2\dot{\theta}^2 + r^2\sin^2(\theta)\dot{\phi}^2 \right) - V(r, \theta, \phi)
$$

The EL equations yield

$$
\begin{gather*}
	m\ddot{r} - mr\left(\dot{\theta}^2 + \sin^2(\theta)\dot{\phi}^2 \right) + \frac{\partial V}{\partial r} = 0 \\
	m\frac{\d}{\d t}\left( r^2\dot{\theta} \right) - mr^2\dot{\phi}^2 \sin\theta\cos\theta + \frac{\partial V}{\partial \theta} = 0 \\
	m\frac{\d}{\d t}\left(r^2\sin^2(\theta)\dot{\phi} \right) + \frac{\partial V}{\partial \phi} = 0
\end{gather*}
$$

# Configuration space

Lagrangian mechanics describe motion in a configuration space spanned by the generalized coordinates, $q(t)$, which completely describe the positions of all particles in a mechanical system. The motion of the system can be represented by a trajectory in configuration space, and the generalized velocities $\dot{q}_i$ represent the tangent to this trajectory.

## Holonomic constraints

Holonomic constraints are relations between the position variables (and possibly time) of the following form

$$
	f_\alpha(\mathbf{q}, t) = 0 \quad \alpha = 1, \dots , 3N-n
$$

Such constraints reduces degrees of freedom of system. A system with $d_f$ degrees of freedom and $k$ holonomic constraints requires $n = d_f - k$ independent generalized coordinates.

Holonomic constraints represents constraint forces. They can be included in the Lagrangian as follows

$$
	L' = L\left(\mathbf{q}, \dot{\mathbf{q}}\right) + \lambda_\alpha f_\alpha (\mathbf{q}, t)
$$

where $\lambda_\alpha$ are called Lagrange multipliers. The EL equations give

$$
	\frac{\partial L'}{\partial \lambda_\alpha} = f_\alpha (\mathbf{q}, t) = 0
$$

The EL-equations for the generalized coordinates become

$$
	\frac{\d}{\d t}\left( \frac{\partial L}{\partial \dot{q}_i} \right) - \frac{\partial L}{\partial q_i} = \lambda_\alpha \frac{\partial f_\alpha}{\partial q_i}
$$

## Virtual displacement

The concept of virtual displacements refers to a change in a system configuration as a result of any arbitrary infinitessimal instananeous change of the positions $\delta\mathbf{r}_i$, that is consistent with the forces and constraints imposed on the system at the instant $t$. The word "virtual" implies there is no change in time, i.e. $\delta t$, as opposed to the actual displacement $\d \mathbf{r}_i$ occuring during a time interval $\d t$.

# Hamilton's principle (principle of least action)

The path taken by a system of particles is the one which minimizes the action functional

$$
	S[\mathbf{q}] = \int_{t_0}^{t_1} L\left(\mathbf{q}, \dot{\mathbf{q}}, t \right) \d t
$$

Solving for $\delta S = 0$ results in the EL-equations.

# Lagrange's equations from D'Alembert's principle

Virtual work is the work done along a virtual displacement for any force. D'Alemebert's principle asserts the virtual work of a dynamic system subject to applied (non-constrained) forces $\mathbf{F}^A$ and constraint forces $\mathbf{F}^C$ is zero

$$
	\delta W = \sum_{i=1}^n \left( \mathbf{F}^A_i + \mathbf{F}^C_i - \dot{\mathbf{p}} \right) \cdot \delta\mathbf{r}_i = 0
$$

Since the constraint forces act perpendicular to the motion of each particle in the system to maintain the constraints, the virtual work reduces to

$$
	\delta W = \sum_{i=1}^n \left( \mathbf{F}^A_i - \dot{\mathbf{p}} \right) \cdot \delta\mathbf{r}_i = 0
$$

For a system of $n$ particles, let the position of each particle be a function of generalized coordinates $\mathbf{r}_i(\mathbf{q}, t)$. The velocity of each particle becomes

$$
	\mathbf{v}_i \equiv \mathbf{\dot{r}}_i = \sum_{j=1}^n \frac{\partial \mathbf{r}_i}{\partial q_j} \dot{q}_j + \frac{\partial \mathbf{r}_i}{\partial t}
$$

giving $\frac{\partial \mathbf{v_i}}{\partial \dot{q}_j} = \frac{\partial \mathbf{r_i}}{\partial q_j}$

The virtual displacements (infinitisemal variations) are given by

$$
	\delta \mathbf{r}_i = \sum_{j=1}^n \frac{\partial \mathbf{r}_i}{\partial q_j} \delta q_j
$$

The above transformations can be used to express d'Alembert's principle of virtual work in generalized coordinates. The first term becomes

$$
	\sum_{i}^n \mathbf{F}^A_i \cdot \delta \mathbf{r}_i = \sum_i^n \sum_j^n \mathbf{F}^A_i \cdot \frac{\partial \mathbf{r}_i}{\partial q_j} \delta q_j = \sum_j^n Q_j \delta q_j
$$

where $Q_j$ are components of the generalized force defined as $Q_j \equiv \mathbf{F}^A_i \cdot \frac{\partial \mathbf{r}_i}{\partial q_j}$

The second term of D'Alembert's principle becomes

$$
\begin{align*}
	\sum_i^n \mathbf{\dot{p}} \cdot \delta\mathbf{r}_i =& \sum_i^n m_i \mathbf{\ddot{r}}_i \cdot \delta\mathbf{r}_i \\
	=& \sum_j^n\left( \sum_i^n m_i \mathbf{\ddot{r}}_i \cdot \frac{\partial \mathbf{r}_i}{\partial q_j} \right) \delta q_j \\
	=& \sum_j^n\sum_i^n \left[ \frac{\d}{\d t} \left( m_i \mathbf{\dot{r}_i} \cdot \frac{\partial \mathbf{r}_i}{\partial q_j} \right) - m_i \mathbf{\dot{r}}_i \cdot \frac{\d}{\d t} \left( \frac{\partial \mathbf{r}_i}{\partial q_j} \right) \right] \delta q_j \\
	=& \sum_j^n\sum_i^n \left[ \frac{\d}{\d t} \left( m_i \mathbf{v_i} \cdot \frac{\partial \mathbf{v}_i}{\partial \dot{q}_j} \right) - m_i \mathbf{v}_i \cdot \left( \frac{\partial \mathbf{v}_i}{\partial q_j} \right) \right] \delta q_j \\
	=& \sum_j^n \left\{ \frac{\d}{\d t} \left[ \frac{\partial}{\partial \dot{q}_j} \left( \sum_i^n \frac{1}{2} m_i v_i^2 \right) \right] - \frac{\partial}{\partial q_j} \left( \sum_i^n \frac{1}{2} m_i v_i^2 \right) \right\} \delta q_j
\end{align*}
$$

recognizing the system kinetic energy $T \equiv \sum_i^n \frac{1}{2}m_i v_i^2$.

Combining the two transformed terms of D'Alemberts principle yields

$$
\begin{align*}
	\delta Q =& \sum_i^n \left( \mathbf{F}^A_i - \mathbf{\dot{p}}_i \right) \cdot \delta \mathbf{r}_i \\
	=& \sum_j^n \left[ \frac{\d}{\d t} \left( \frac{\partial T}{\partial \dot{q}_j} \right) - \frac{\partial T}{\partial q_j} - Q_j \right] \delta q_j = 0
\end{align*}
$$

resulting in Lagrange's equations of motion

$$
	Q_j = \frac{\d}{\d t} \left( \frac{\partial T}{\partial \dot{q}_j} \right) - \frac{\partial T}{\partial q_j}
$$

Assuming the system is conservative, the generalized forced can be expressed as

$$
\begin{gather*}
	\mathbf{F}_i = -\nabla V_i (\mathbf{r}_i) \\
	Q_j = \sum_i^n \mathbf{F}_i \frac{\partial \mathbf{r}_i}{\partial q_j} = \sum_i^n -\nabla V_i (\mathbf{r}_i) \frac{\partial \mathbf{r}_i}{\partial q_j} \overbrace{=}^{\mathrm{chain rule}} -\frac{\partial V}{\partial q_j}
\end{gather*}
$$

Further assuming the potential $V$ is independent of generalized velocity, i.e. $\frac{\partial V}{\partial \dot{q}_j} = 0$, we obtain the Euler-Lagrange equation

$$
\begin{gather*}
	\frac{\d}{\d t} \left( \frac{\partial (T - V)}{\partial \dot{q}_j} \right) - \frac{\partial (T - V)}{\partial q_j} = 0 \\
	\frac{\d}{\d t} \left( \frac{\partial L}{\partial \dot{q}_j} \right) - \frac{\partial L}{\partial q_j} = 0
\end{gather*}
$$

where $L \equiv T - V$ is the Lagrange function.

# Invariance under change of Lagrangian

The EL equations are invariant under a change of Lagrangian of the form

$$
	L' = L(\mathbf{q}, \dot{\mathbf{q}}, t) + \frac{\d}{\d t}f(\mathbf{q}, t) = L(\mathbf{q}, \dot{\mathbf{q}}, t) + \sum_i \frac{\partial f}{\partial q_i}\dot{q}_i + \frac{\partial f}{\partial t}
$$

Writing $L' = L + \Delta L$, the EL equations for $L'$ become

$$
\begin{align*}
	0 =& \frac{\d}{\d t}\frac{\partial L'}{\partial q_i} - \frac{\partial L'}{\partial q_i} \\
	=& \frac{\d}{\d t}\frac{\partial L}{\partial q_i} - \frac{\partial L}{\partial q_i} + \frac{\d}{\d t}\frac{\Delta \partial L}{\partial q_i} - \frac{\Delta \partial L}{\partial q_i}
\end{align*}
$$

The EL equtions are invariant if and only if

$$
	\frac{\d}{\d t}\frac{\Delta \partial L}{\partial q_i} - \frac{\Delta \partial L}{\partial q_i} = 0
$$

Because $f$ is independent of $\dot{\mathbf{q}}$ we have

$$
\begin{align*}
	\frac{\partial \Delta L}{\partial \dot{q_i}} =& \frac{\partial}{\partial \dot{q_i}} \left(\sum_j \frac{\partial f}{\partial q_j}\dot{q}_j + \frac{\partial f}{\partial q_i} \right) \\
	=& \sum_j \frac{\partial f}{\partial q_j}\frac{\partial q_j}{\partial q_i} \\
	=& \frac{\partial f}{\partial q_i}
\end{align*}
$$

From this it follows that

$$
\begin{align*}
	\frac{\d}{\d t}\frac{\partial \Delta L}{\partial \dot{q}_i} =& \frac{\d}{\d t}\frac{\partial f}{\partial q_i} \\
	=& \sum_i \frac{\partial^2 f}{\partial q_i \partial q_j}\dot{q}_j + \frac{\partial^2 f}{\partial t \partial q_i}
\end{align*}
$$

On the other hand

$$
\begin{align*}
	\frac{\partial \Delta L}{\partial q_i} =& \frac{\partial}{\partial q_i} \left(\sum_j \frac{\partial f}{\partial q_j}\partial \dot{q}_j + \frac{\partial f}{\partial t} \right) \\
	=& \sum_i \frac{\partial^2 f}{\partial q_i \partial q_j}\dot{q}_j + \frac{\partial^2 f}{\partial t \partial q_i} \\
	=& \frac{\d}{\d t}\frac{\partial \Delta L}{\partial \dot{q}_i}
\end{align*}
$$

# Conservation statements

## Generalized momenta

Each generalized coordinate $q_i$ has a corresponding generalized momentum given by

$$
\begin{gather*}
	p_i \equiv \frac{\partial L}{\partial \dot{q_i}} \\
	\dot{p_i} \equiv \frac{\partial L}{\partial q_i}
\end{gather*}
$$

Whenever the Lagrangian of a mechanical system does not explicitly depend on a generalized coordinate (called a cyclic coordinate),

$$
	\dot{p_i} \equiv \frac{\partial L}{\partial q_i} = 0
$$

the corresponding generalized momentum is conserved.

The generalized momenta can represent either a component of the linear-momentum vector or a component of the angular-momentum vector.

The Lagrangian of a free particle in cylindrical coordinates is

$$
	L = \frac{1}{2}m\left(\dot{r}^2 + r^2\dot{\phi}^2 + \dot{z}^2 \right)
$$

The generalized momenta are

$$
\begin{align*}
	p_r =& \frac{\partial L}{\partial \dot{r}} = m\dot{r} \\
	p_\phi =& \frac{\partial L}{\partial \dot{\phi}} = mr^2\dot{\phi} \\
	p_z =& \frac{\partial L}{\partial \dot{z}} = m\dot{z}
\end{align*}
$$

Both $p_r$ and $p_z$ represent components of a linear-momentum vector, while $p_\phi$ represents the component of an angular-momentum vector.

## Noether's theorem

Consider the one-parameter family of maps

$$
	q_i(t) \mapsto Q_i(s, t) \quad s \in \R
$$

such that $Q_i(0, t) = q_i(t)$. This transformation is called a continuous symmetry of the Lagrangian if

$$
	\frac{\partial}{\partial s} L\left[Q_i(s,t), \dot{Q}_i(s,t) \right] = 0
$$

Noether's theorem states that for each such symmetry there is a conserved quantity.

By the chain rule

$$
	\frac{\partial L}{\partial s} = \frac{\partial L}{\partial Q_i} \frac{\partial Q_i}{\partial s} + \frac{\partial L}{\partial \dot{Q}_i} \frac{\partial \dot{Q}_i}{\partial s}
$$

so that

$$
\begin{align*}
	0 = \left.\frac{\partial L}{\partial s}\right|_{s=0} =& \left.\frac{\partial L}{\partial q_i} \frac{\partial Q_i}{\partial s}\right|_{s=0} + \left.\frac{\partial L}{\partial \dot{Q}_i} \frac{\partial \dot{Q}_i}{\partial s}\right|_{s=0} \\
	=& \frac{\d}{\d t}\left(\frac{\partial L}{\partial q_i} \right)\left.\frac{\partial Q_i}{\partial s}\right|_{s=0} + \frac{\partial L}{\partial \dot{q}_i} \left.\frac{\partial \dot{Q}_i}{\partial s}\right|_{s=0} \\
	=& \frac{\d}{\d t} \left( \frac{\partial L}{\partial \dot{q}_i} \left.\frac{\partial \dot{Q}_i}{\partial s}\right|_{s=0} \frac{\d}{\d t} \right)
\end{align*}
$$

meaning that $\left.\sum \frac{\partial L}{\partial \dot{q}_i} \frac{\partial \dot{Q}_i}{\partial s}\right|_{s=0}$ is constant.

## Conservation of energy

The energy of a system is conserved whenever the Langrangian is time invariant, i.e. $\frac{\d L}{\d t} = 0$

$$
\begin{align*}
	\frac{\d L}{\d t} =& \sum_i \left(\frac{\partial L}{\partial q_i}\dot{q}_i + \frac{\partial L}{\partial \dot{q}_i}\ddot{q}_i \right) + \frac{\partial L}{\partial t} \\
	=& \sum_i \left( \dot{p}_i \dot{q}_i + p_i \ddot{q}_i \right) + \frac{\partial L}{\partial t} \\
	=& \frac{\d}{\d t} \left( \sum_i p_i \dot{q}_i \right) + \frac{\partial L}{\partial t}
\end{align*} \\
		\implies \frac{\d}{\d t} \left( \sum_i p_i \dot{q}_i  - L \right) = -\frac{\partial L}{\partial t}
$$

Whenever $L$ is time invariant, we have that

$$
	\frac{\d}{\d t} \left( \sum_i p_i \dot{q}_i  - L \right) \equiv \frac{\d}{\d t} h(\mathbf{q}, \dot{\mathbf{q}}) = 0
$$

where $h(q, \dot{q})$ represents the system's total mechanical energy.

# Motion of a rolling disk

Consider a disk of mass $m$ and radius $R$ rolling without slipping on a plane of length $\ell$ and inclination $\alpha$.

The disk's kinetic energy comprises components of translational and rotational motion

$$
	T = \frac{1}{2}m\dot{s}^2 + \frac{1}{2}I\dot{\theta}^2
$$

where $I = \frac{1}{2}mR^2$ is the disk's moment of inertia. The coordinates $s$ and $\theta$ are related by the no-slip condition, implying $s = R\theta$, so that $\dot{s} = R\dot{\theta}$ and the kinetic energy becomes

$$
	T = \frac{1}{2}m\left(R\dot{\theta} \right)^2 + \frac{1}{4}I\left(R\dot{\theta} \right)^2 = \frac{3}{4}m\left(R\dot{\theta} \right)^2
$$

With potential energy

$$
	V = mgz = mg(\ell - s)\sin\alpha = mg(\ell - R\theta)\sin\alpha
$$

the Lagrangian becomes

$$
	L\left(\theta, \dot{\theta} \right) = \frac{3}{4}m\left(R\dot{\theta} \right)^2 - mg(\ell - R\theta)\sin\alpha
$$

Computing the EL equation gives

$$
	\frac{\d}{\d t}\frac{\partial L}{\partial \dot{\theta}} - \frac{\partial L}{\partial \theta} = \frac{3}{2}mR\ddot{\theta} - mgR\sin\alpha = 0 \\
	\ddot{\theta} = \frac{2g\sin\alpha}{3R}
$$

Assuming the disk starts with zero angular velocity, the differential equation integrates to

$$
	\theta(t) = \frac{g\sin\alpha}{3R}t^2
$$

# Motion on a turntable

Consider a turntable that is rotating with uniform angular velocity $\Omega$. The original inertial frame is denoted $S'$, while $S$ is the rotating frame. In spherical coordinates $(r, \theta, \phi)$, the reference frames share the same radial distance, $r' = r$ and zenith angle $\theta' = \theta$, while the azimuth angles are related by $\phi' = \phi + \Omega t$.

The coordinate transform from $S$ to $S'$ is efficiently found using complex numbers

$$
	x + iy = r\sin\theta \left(\cos\phi + i\sin\phi \right) = r\sin\theta e^{i\phi} \\
$$

For $S'$ we have

$$
\begin{align*}
	x' + iy' =& r\sin\theta \left(\cos\phi' + i\sin\phi' \right) = r\sin\theta e^{i\phi'} \\
	=& r\sin\theta e^{i(\phi + \Omega t)} = e^{i\Omega t}r\sin\theta e^{i\phi} \\
	=& e^{i\Omega t}(x + iy)
\end{align*}
$$

Expanding out

$$
\begin{align*}
	x' + iy' =& x\left(\cos\Omega t + i\sin\Omega t\right) + iy\left(\cos\Omega t + i\sin\Omega t\right) \\
	=& (x\cos\Omega t - y\sin\Omega t) + i\left(y\cos\Omega t + x\sin\Omega t \right)
\end{align*}
$$

The coordinate transform is thus

$$
\begin{align*}
	x' =& x\cos\Omega t - y\sin\Omega t \\
	y' =& y\cos\Omega t + x\sin\Omega t \\
	z' =& z
\end{align*}
$$

Taking the time derivative gives the velocity relationship

$$
\begin{align*}
	\dot{x}' =& \dot{x}\cos\Omega t - \dot{y}\sin\Omega t - \Omega\left(x\sin \Omega t + y \cos\Omega t \right)\\
	\dot{y}' =& \dot{y}\cos\Omega t + \dot{x}\sin\Omega t - \Omega\left(y\sin\Omega t - x\cos\Omega t \right) \\
	\dot{z}' =& \dot{z}
\end{align*}
$$

The squared velocity is then

$$
\begin{align*}
	v'^2 =& \dot{x}'^2 + \dot{y}'^2 + \dot{z}'^2 \\
	=& \dot{x}^2 + \dot{y}^2 + \dot{z}^2 - 2\Omega\left(y\dot{x} - x\dot{y} \right) + \Omega^2\left(x^2 + y^2 \right)
\end{align*}
$$

The Lagrangian of a particle moving on the turntable is

$$
	L = \frac{1}{2}m\left(\dot{x}^2 + \dot{y}^2 + \dot{z}^2 \right) - m\Omega\left(y\dot{x} - x\dot{y} \right) + \frac{1}{2}m\Omega^2 \left(x^2 + y^2 \right) - V(x, y, z)
$$

The EL eqations results in the following equations of motion

$$
\begin{align*}
	m\ddot{x} =& -\frac{\partial V}{\partial x} + 2m\Omega\dot{y} + m\Omega^2 x \\
	m\ddot{y} =& -\frac{\partial V}{\partial y} - 2m\Omega\dot{x} + m\Omega^2 y \\
	m\ddot{z} =& -\frac{\partial V}{\partial z}
\end{align*}
$$

The equations can be expressed in vectorial form by introducing the angular-momentum vector $\boldsymbol{\Omega} = \Omega \hat{\mathbf{z}}$

$$
	m\ddot{\mathbf{r}} = \underbrace{-\nabla V}_{\mathbf{F}_\textrm{applied}} + \underbrace{2m\dot{\mathbf{r}} \times \boldsymbol{\Omega}}_{\mathbf{F}_\textrm{Coriolis}} + \underbrace{m\boldsymbol{\Omega} \times \left(\mathbf{r} \times \boldsymbol{\Omega} \right)}_{\mathbf{F}_\textrm{centrifugal}}
$$

## Spring-mass

Consider a particle attached to a linear spring free to rotate around the $z$ axis in the $xy$-plane. The particle is subjected to the potential

$$
	V = \frac{1}{2}m\omega^2 \left(x^2 + y^2 \right)
$$

where $\omega^2 \equiv \frac{k}{m}$. The equations of motion become

$$
\begin{align*}
	\ddot{x} = 2\Omega \dot{y} + \left(\Omega^2 - \omega^2 \right)x \\
	\ddot{y} = -2\Omega \dot{x} + \left(\Omega^2 - \omega^2 \right)y
\end{align*}
$$

The equations can be combined by introducing $\xi = x + iy$

$$
\begin{align*}
	\ddot{\xi} =& \ddot{x} + i\ddot{y} \\
	=& 2\Omega \left(\dot{y} - i\dot{x} \right) + \left( \Omega^2 - \omega^2 \right)(x + iy) \\
	=& -2i\Omega \left( \dot{x} + i\dot{y} \right) + \left( \Omega^2 - \omega^2 \right)(x + iy)
\end{align*}
$$

giving a second-order differential equation for $\xi$

$$
	\ddot{\xi} + 2i\Omega\dot{\xi} - \left( \Omega^2 - \omega^2 \right)\xi = 0
$$

with characteristic quadratic equation

$$
\begin{gather*}
	\lambda^2 + 2\Omega\lambda + \left( \Omega^2 - \omega^2 \right) = 0 \\
	\left(\lambda + \Omega + \omega \right) + \left(\lambda + \Omega - \omega \right) = 0
\end{gather*}
$$

The general solution for $\xi$ is

$$
\begin{align*}
	\xi =& C_1 e^{-i(\Omega + \omega)t} + C_2 e^{-i(\Omega - \omega)t} \\
	=& e^{-i\Omega t}\left(C_1 e^{-i\omega t} + C_2 e^{i\omega t} \right)
\end{align*}
$$

In the limit of no rotations, the equations of motion have the general solution

$$
\begin{align*}
	x_{\Omega=0}(t) =& a\cos(\omega t + \alpha) \\
	y_{\Omega=0}(t) =& b\cos(\omega t + \beta)
\end{align*}
$$

Thus

$$
	\xi(t) = e^{-i\Omega t}\left[ x_{\Omega=0}(t) + iy_{\Omega=0}(t) \right]
$$

Expanding out gives

$$
\begin{align*}
	x(t) =& a\cos(\omega t + \alpha)\cos\Omega t + b\cos(\omega t + \beta)\sin\Omega t \\
	y(t) =& b\cos(\omega t + \beta)\cos\Omega t - a\cos(\omega t + \alpha)\sin\Omega t
\end{align*}
$$

# Motion on earth (rotational frame)

Consider a point $P$ on the surface of the earth with radius $R$. In an inertial frame $S'$ with origin at earth's center, its position vector is

$$
	\mathbf{R} = R\sin\theta'\cos\phi'\hat{\mathbf{x}}' + R\sin\theta'\sin\phi'\hat{\mathbf{y}}' + R\cos\theta'\hat{\mathbf{z}}'
$$

Introducing a rotating reference frame with origin at $P$. The orientation of this frame is set by the directions of spherical basis $\left(\hat{\mathbf{r}}', \hat{\boldsymbol{\theta}}', \hat{\boldsymbol{\phi}}' \right)$ so that

$$
\begin{align*}
	\hat{\mathbf{x}} =& \hat{\boldsymbol{\theta}}' = \cos\theta'\cos\phi'\hat{\mathbf{x}}' + \cos\theta'\sin\phi'\hat{\mathbf{y}}' -\sin\theta' \hat{\mathbf{z}}' \\
	\hat{\mathbf{y}} =& \hat{\boldsymbol{\phi}}' = -\sin\phi'\hat{\mathbf{x}}' + \cos\phi'\hat{\mathbf{y}}'  \\
	\hat{\mathbf{z}} =& \hat{\mathbf{r}}' = \sin\theta'\cos\phi'\hat{\mathbf{x}}' + \sin\theta'\sin\phi'\hat{\mathbf{y}}' +\cos\theta' \hat{\mathbf{z}}'
\end{align*}
$$

The position of a particle at a point $Q$ relative to $P$ is

$$
\begin{align*}
	\mathbf{r} =& x\hat{\boldsymbol{\theta}}' + y\hat{\boldsymbol{\phi}}' + z\hat{\mathbf{r}}' \\
	=& \left(x\cos\theta'\cos\phi' - y\sin\phi' + z\sin\theta'\cos\phi' \right)\hat{\mathbf{x}}' \\
	& + \left(x\cos\theta'\sin\phi' + y\cos\phi' + z\sin\theta'\sin\phi' \right)\hat{\mathbf{y}}' \\
	& +\left(-x\sin\theta' + z\cos\theta' \right)\hat{\mathbf{z}}'
\end{align*}
$$

The position vector relative to the centre of the earth is

$$
\begin{align*}
	\mathbf{R} + \mathbf{r} =& \left[x\cos\theta'\cos\phi' - y\sin\phi' + (R + z)\sin\theta'\cos\phi' \right]\hat{\mathbf{x}}' \\
	& + \left[x\cos\theta'\sin\phi' + y\cos\phi' + (R + z)\sin\theta'\sin\phi' \right]\hat{\mathbf{y}}' \\
	& +\left[-x\sin\theta' + (R + z)\cos\theta' \right]\hat{\mathbf{z}}'
\end{align*}
$$

giving the transformation

$$
\begin{align*}
	x' =& x\cos\theta'\cos\phi' - y\sin\phi' + (R + z)\sin\theta'\cos\phi' \\
	y' =& x\cos\theta'\sin\phi' + y\cos\phi' + (R + z)\sin\theta'\sin\phi' \\
	z' =& -x\sin\theta' + (R + z)\cos\theta'
\end{align*}
$$

Introducing earth's rotation $\phi' = \Omega t$ and fixing the colatitude $\theta' = \alpha$, the transformation becomes

$$
\begin{align*}
	x' =& x\cos\alpha\cos\Omega t - y\sin\Omega t + (R + z)\sin\alpha\cos\Omega t \\
	y' =& x\cos\alpha\sin\Omega t + y\cos\Omega t + (R + z)\sin \alpha\sin\Omega t \\
	z' =& -x\sin\alpha + (R + z)\cos\alpha
\end{align*}
$$

## Dynamics

In the inertial frame, the velocity of a particle moving on earth is

$$
\begin{align*}
	\dot{x}' =& \dot{x}\cos\alpha\cos\Omega t - \dot{y}\sin\Omega t + \dot{z}\sin\alpha\cos\Omega t \\
	& -\Omega\left[x\cos\alpha\sin\Omega t + y\cos\Omega t + (R + z)\sin\alpha\sin\Omega t \right] \\
	\dot{y}' =& \dot{x}\cos\alpha\sin\Omega t - \dot{y}\cos\Omega t + \dot{z}\sin\alpha\cos\Omega t \\
	& -\Omega\left[x\cos\alpha\cos\Omega t + y\sin\Omega t + (R + z)\sin\alpha\cos\Omega t \right] \\
	\dot{z}' =& -\dot{x}\sin\alpha + \dot{z}\cos\alpha
\end{align*}
$$

The squared velocity is

$$
\begin{align*}
	v'^2 =& \dot{x}^2 + \dot{y}^2 + \dot{z}^2 + 2\Omega \left\{\left[(R + z)\dot{y} - y\dot{z} \right]\sin\alpha + \left[ x\dot{y} - y\dot{x} \right]\cos\alpha \right\} \\
	& +\Omega^2 \left\{\left[x\cos\alpha + (R + z)\sin\alpha \right]^2 + y^2 \right\}
\end{align*}
$$

The particle's potential energy is

$$
	V = mgz + U(x, y, z)
$$

where $U$ account for applied forces.

Applying the EL equations on the Langrangian $L = \frac{1}{2}mv'^2 - mgz - U(x, y, z)$ yields the equations of motion

$$
\begin{align*}
	m\ddot{x} =& -\frac{\partial U}{\partial x} + 2m\Omega\dot{y}\cos\alpha + m\Omega^2 \left[x\cos\alpha + (R + z)\sin\alpha \right]\cos\alpha \\
	m\ddot{y} =& -\frac{\partial U}{\partial y} - 2m\Omega\dot{y}\left(\dot{x}\cos\alpha + \dot{z}\sin\alpha \right) + m\Omega^2 y \\
	m\ddot{z} =& -mg -\frac{\partial U}{\partial z} + 2m\Omega\dot{y}\sin\alpha + m\Omega^2 \left[x\cos\alpha + (R + z)\sin\alpha \right]\sin\alpha
\end{align*}
$$

These equations can be expressed in vectorial form by introducing the angular-momentum vector $\boldsymbol{\Omega} = \Omega\hat{\mathbf{z}}'$. In the local rotating frame, the vector has components

$$
\begin{align*}
	\boldsymbol{\Omega} =& \boldsymbol{\Omega}\cdot\left(\hat{\mathbf{x}} + \hat{\mathbf{y}} + \hat{\mathbf{z}} \right) \\
	=& \Omega\left(\hat{\mathbf{z}}\cdot{\boldsymbol{\theta}'} + \hat{\mathbf{z}}\cdot{\boldsymbol{\phi}'} + \hat{\mathbf{z}}\cdot{\mathbf{r}'} \right) \\
	=& -\Omega\sin\alpha\hat{\mathbf{x}} + \Omega\cos\alpha\hat{\mathbf{z}}
\end{align*}
$$

The vectorial equation is

$$
	m\ddot{\mathbf{r}} = m\mathbf{g} + \underbrace{-\nabla U}_{\mathbf{F}_\textrm{applied}} + \underbrace{2m\dot{\mathbf{r}} \times \boldsymbol{\Omega}}_{\mathbf{F}_\textrm{Coriolis}} + \underbrace{m\boldsymbol{\Omega} \times \left[\left(\mathbf{R} + \mathbf{r}\right) \times \boldsymbol{\Omega} \right]}_{\mathbf{F}_\textrm{centrifugal}}
$$

## Particle released from rest

Consider a particle that is released from rest at a height $h$. Because the earth's rotation is quite slow, it is sufficient to only regard the first order in the angular velocity $\Omega$, neglecting the centrifugal term. At this level of accuracy the equations of motion reduce to

$$
\begin{align*}
	\ddot{x} =& 2\Omega\dot{y}\cos\alpha \\
	\ddot{y} =& -2\Omega(\dot{x}\cos\alpha + \dot{z}\sin\alpha) \\
	\ddot{z} =& -g + 2\Omega\dot{y}\sin\alpha
\end{align*}
$$

Assuming a solution of the form $\mathbf{r}(t) = \mathbf{r}_0(t) + \Omega\mathbf{r}_1(t) + O\left(\Omega^2 \right)$. Equating powers of $\Omega$ produces the set of equations

$$
\begin{gather*}
	\ddot{x}_0 = 0 \, ,\quad \ddot{y}_0 = 0 \, ,\quad \ddot{z}_0 = -g \\
	\ddot{x}_1 = 2\dot{y}_0\cos\alpha \, , \quad \ddot{y}_1 = -2\dot{x}_0\cos\alpha - 2\dot{z}_0\sin\alpha \, , \quad \ddot{z}_1 = 2\dot{y}_0\sin\alpha
\end{gather*}
$$

The solution is

$$
\begin{align*}
	x(t) =& 0 + O\left(\Omega^2 \right) \\
	y(t) =& \frac{1}{3}(g\Omega\sin\alpha)t^3 + O\left(\Omega^2 \right) \\
	z(t) =& h - \frac{1}{2}gt^2 + O\left(\Omega^2 \right)
\end{align*}
$$

Since the factor $g\Omega\sin\alpha > 0$ except at the poles, the particle drifts away in the eastward direction.

## Foucalt's pendulum

Foucalt's pendulum is a suspended spherical pendulum used to demonstrate earth's rotation (first display at the Observatoire de Paris in 1851). With constant length $l$, The position of the pendulum is

$$
\begin{align*}
	x =& l\sin\theta\cos\phi \\
	y =& l\sin\theta\sin\phi \\
	z =& h - l\cos\theta
\end{align*}
$$

The pendulum's velocity is

$$
\begin{align*}
	\dot{x} =& l\dot{\theta}\sin\theta\cos\phi + l\dot{\phi}\sin\theta\sin\theta \\
	\dot{y} =& l\dot{\theta}\sin\theta\sin\phi + l\dot{\phi}\sin\theta\cos\theta \\
	\dot{z} =& l\dot{\theta}\cos\theta
\end{align*}
$$

The squared velocity is

$$
	v^2 = l^2\dot{\theta}^2 + l^2 \dot{\phi}^2 \sin^2\theta
$$

The Lagrangian is (neglecting the centrifugal term) with respect to the inertial frame

$$
\begin{align*}
	L =& \frac{1}{2}ml^2\left(\dot{\theta}^2 + \phi^2 \sin^2 \theta \right) \\
	&+ m\Omega\left\{\left[(R + h) - l\cos\theta)\dot{y} - y\dot{z} \right]\sin\alpha + \left[x\dot{y} - y\dot{x} \right]\cos\alpha \right\} \\
	&- mg(h - l\cos\alpha)
\end{align*}
$$

The term $m\Omega(R + h)\dot{y}\sin\alpha$ can be discarded, because it is a total time derivative and will therefore not contribute to the equations of motion. The term $mgh$ is constant and can also be omitted

$$
\begin{align*}
	L =& \frac{1}{2}ml^2\left(\dot{\theta}^2 + \phi^2 \sin^2 \theta \right) \\
	&+ m\Omega \left\{- \left[\dot{y}\cos\theta + y\dot{z} \right]\sin\alpha + \left[x\dot{y} - y\dot{x} \right]\cos\alpha \right\} \\
	&+ mgl\cos\alpha
\end{align*}
$$

Transforming to spherical coordinates

$$
\begin{align*}
	L =& \frac{1}{2}ml^2\left(\dot{\theta}^2 + \phi^2 \sin^2 \theta \right) \\
	& -ml^2\Omega\sin\alpha \left(\dot{\theta}\sin\phi + \dot{\phi}\sin\theta\cos\theta\cos\phi \right) \\
	& +ml^2\Omega\dot{\phi}\cos\alpha\sin^2 \theta + ml^2\omega^2\cos\theta
\end{align*}
$$

where $\omega^2 = \frac{g}{l}$. The Lagrangian can be furter simplifed by assuming small amplitude of the pendulum's oscillations

$$
	\sin\theta \approx \theta \, ,\quad \cos\theta \approx 1 - \frac{1}{2}\theta^2
$$

Neglecting all terms of order $\theta^3$ and higher, we obtain

$$
\begin{align*}
	L =& ml^2 \left[\frac{1}{2}\left(\dot{\theta}^2 + \phi^2 \theta^2 \right) - \Omega\sin(\alpha) \left(\dot{\theta}\sin\phi + \dot{\phi}\theta\cos\phi \right) \right. \\
	&\left. + \Omega\dot{\phi}\cos(\alpha)\theta^2 + \omega^2\left(1 - \frac{1}{2}\theta^2 \right) \right]
\end{align*}
$$

Recognizing an omittable total time derivative term

$$
	\dot{\theta}\sin\phi + \dot{\phi}\theta\cos\phi = \frac{\d}{\d t}\left(\theta\sin\phi \right)
$$

Additionally, the constant $\omega^2$ can also be discarded leaving

$$
	L = ml^2 \left[\frac{1}{2}\left(\dot{\theta}^2 + \theta^2\dot{\phi}^2 \right) + \Omega\theta^2\dot{\phi}\cos\alpha - \frac{1}{2}\omega^2\theta^2 \right]
$$

The EL equations results in the following equation of motion

$$
	\ddot{\theta} + \omega^2\theta - \dot{\phi}\left( \dot{\phi} + 2\Omega\cos\alpha \right)\theta = 0
$$

Since the Lagrangian does not depend explicitly on $\phi$ implies that the generalized momentum

$$
	p_\phi = \theta^2\left(\dot{\phi} + \Omega\cos\alpha \right)
$$

is a constant of the motion. Solving for $\dot{\phi}$ gives

$$
	\dot{\phi} = -\Omega\cos\alpha + \frac{p_\phi}{\theta^2}
$$

Unless $p_\phi = 0$, $\dot{\phi}$ blows up as $\theta \to 0$, that is whenever the pendulum crosses the $z$ axis. Thus

$$
	\dot{\phi} = -\Omega\cos\alpha
$$

This represents the Foucalt effect. When the pendulum is located in the northern hemisphere, $\cos\alpha > 0$, meaning that the swing plane rotates clockwise. In the southern hemisphere, $\cos\alpha < 0$, and the swing plane rotates counterclockwise.
