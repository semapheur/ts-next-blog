---
title: 'Quantum Mechanics'
subject: 'Physics'
showToc: true
references:
  - book_auletta_etal_2009
  - book_griffiths_schroeter_2018
---

# Mathematical foundation

## Dirac notation (bra-ket)

Let $V$ be a Hilbert space over a field $\mathbb{F}$ with dual space $V^*$.
- A *ket* $\ket{v}\in V$ denotes a vector representing the state of a quantum system
- A *bra* $\bra{f}\in V^*$ denotes a linear form $f : V \to\mathbb{F}$ and is a covector to $\ket{f}$
- A *bra-ket* $\braket{f|v} = \bra{f}(\ket{v})$ denotes an inner product
- A *ket-bra* $\ket{v}\bra{f}$ denotes an outer product
- A *ket-ket* $\ket{v}\ket{w}$ denotes a tensor product $\ket{v}\otimes\ket{w}$

Bra-ket properties
- Conjugate symmetry: $\braket{\psi|\phi} = \braket{\phi|\psi}^*$
- Linearity in the second argument: $\braket{\psi | a_1\phi_1 + a_2 \phi_2} = a_1\braket{\psi|\phi_1} + a_2\braket{\psi|\phi_2}$
- Anti-linearity in the first argument: $\braket{a_1\psi_1 + a_2\psi_2 | \phi} = a_1^*\braket{\psi_1|\phi} + a_2^*\braket{\psi_2|\phi}$
- Positive definite: $\braket{\psi | \psi} \geq 0$ and $\braket{\psi|\psi} = 0 \iff \ket{\psi} = 0$
- Triangle inequality: $\sqrt{\braket{\psi + \phi | \psi + \phi}} \leq \sqrt{\braket{\psi|\psi}} + \sqrt{\braket{\phi|\phi}}$
- Schwarz inequality: $\left[\braket{\psi|\phi}\right]^2 \leq \left[\braket{\psi|\psi}\right] \left[\braket{\phi|\phi}\right]$
- Orthogonality: $\braket{\psi|\phi} = 0$ if and only if $\psi$ and $\phi$ are orthogonal
- Hermitian adjoint/conjugate: 
$$
\begin{align*}
  \ket{\psi}^\dagger &= \bra{\psi} \\
  \bra{\phi}^\dagger &= \ket{\phi}
\end{align*}
$$

## Basis

Let $V$ be an $n$-dimensional vector space with basis $\set{\ket{e_i}}_{i=1}^n$. Then any $\ket{\psi}\in V$ can be written as a linear combination

$$
  \ket{\psi} = \sum_{i=1}^n \psi_i \ket{e}_i
$$

If $V$ is an $n$-dimensional Hilbert space with orthonormal basis $\set{\ket{e_i}}_{i=1}^n$ then

$$
  \braket{e_i|e_j} = \delta_{ij}
$$

The inner product of $\ket{\psi}$ and $\bra{e_j}$ is

$$
  \braket{e_j|\psi} = \sum_{i=1}^n \psi_i \braket{e_j|e_i} = \sum_{i=1}^n \psi_i \delta_{ji} = \psi_j
$$

## Linear operators

A linear operator is a mapping between two vector spaces that is preserved under vector addition and scalar multiplication

- Additivity: 
  - $\hat{A}\left(\ket{\phi_1} + \ket{\phi_2} \right) = \hat{A} \ket{\phi_1} + \hat{A} \ket{\phi_2}$
    - $\left( \bra{\psi_1} + \bra{\psi_2} \right)\hat{A} = \bra{\psi_1}\hat{A} + \bra{\psi_2}\hat{A}$
- Scalar multiplication
  - $\hat{A} \ket{a\phi} = a\hat{A} \ket{\phi}$
  - $ \left( \bra{\psi} a \right) \hat{A} = a \bra{\psi} \hat{A}$

The outer product $\ket{\psi}\bra{\phi}$ is a linear operator.

Operator properties
- Anticommutative: $\hat{A}\hat{B} \neq \hat{B}\hat{A}$
- Associative: $\hat{A}\hat{B}\hat{C} = \hat{A}\left(\hat{B}\hat{C}\right) = (\hat{A}\hat{B})\hat{C}$
- Power property: $\left(\hat{A}\right)^n \left( \hat{A} \right)^m = \left(\hat{A}\right)^{n + m}$
- Inner product: $\braket{\psi|\hat{A}|\phi} = \braket{\psi|\phi'} \in \mathbb{C}$
- Expectation: $\langle\hat{A}\rangle = \frac{\braket{\psi | \hat{A} | \phi}}{\braket{\psi|\psi}}$

### Projection operator

An operator $\hat{P}:V\to V$ is a *projection operator* if $\hat{P}^2 = \hat{P}\hat{P} = \hat{P}$. The orthogonal complement of $\hat{P}$ is the projection operator $\hat{Q} = \hat{I} - \hat{P}$. 

If $V$ is an inner product space and $\hat{P}$ is Hermitian with respect to this inner product, $\hat{P}$ is called an orthogonal projection operator. If $\ket{v}\in V$ is a unit vector, i.e. $\braket{v|v} = 1$, the projection onto $\ket{v}$ is given by

$$
  \hat{P}_v = \ket{v}\bra{v}
$$

To see that this is a projection, we have

$$
  \hat{P}_v^2 = (\ket{v}\bra{v})(\ket{v}\bra{v}) = \ket{v}(\underbrace{\braket{v|v}}_{=1})\bra{v} = \ket{v}\bra{v} = \hat{P}_v
$$

Also $\hat{P}$ is Hermitian since

$$
  \hat{P}_v^\dagger = (\ket{v}\bra{v})^\dagger = \ket{v}\bra{v} = \hat{P}_v
$$

The projection of $\ket{u}\in V$ onto $\ket{v}$ becomes

$$
  \hat{P}_v \ket{u} = \ket{v}\braket{v|u} = \braket{v|u}\ket{v} = c \ket{v}
$$

The eigenvalues of $\hat{P}_v$ are found from

$$
\begin{align*}
  \hat{P}_v \ket{x} =& \lambda\ket{x} \\
  \ket{v}\underbrace{\braket{v|x}}_{=c\in\R} =& \lambda\ket{x} \\
  c\ket{v} =& \lambda\ket{x}
\end{align*}
$$

If $\ket{x} = \ket{v}$, then $\lambda = \braket{v|x} = \braket{v|v} = 1$. Otherwise, for $\ket{x}\neq\ket{v}$ we have $\lambda = \braket{v|x} = 0$.

In terms of $\hat{P}_v$, any $\ket{u}\in V$ can be decomposed as 

$$
\begin{align*}
  \ket{u} =& \hat{I}\ket{u} + \hat{P}_v \ket{v} - \hat{P}_v \\
  =& \hat{P}_v \ket{u} + (\hat{I} - \hat{P})\ket{u}
\end{align*}
$$

Since 

$$
  \hat{P}_v (\hat{P}_v \ket{u}) = \hat{P}_v^2 \ket{u} = \hat{P}_v \ket{u}
$$

then $\hat{P}_v \ket{u}$ is an eigenstate of $\hat{P}_v$ with eigenvalue $1$. Since

$$
  \hat{P}_v [(\hat{I} - \hat{P}_v)\ket{u}] = (\hat{P}_v - \underbrace{\hat{P}_v^2}_{=\hat{P}_v})\ket{u} = 0 
$$

then $(\hat{I} - \hat{P}_v)\ket{u}$ is an eigenstate of $\hat{P}_v$ with eigenvalue $0$.

If $W\subset$ is an $m$-dimensional subspace with orthonormal basis $\set{\ket{b}_i}_{i=1}^m$, the projection onto $W$ is given by

$$
  \hat{P}_W = \sum_{i=1}^m \ket{b_i}\bra{b_i}
$$

### Hermitian adjoint

The Hermitian adjoint of an operator $\hat{A}$ is defined as 

$$
  \braket{\varphi | \hat{A} \psi} = \braket{\hat{A}^\dagger \varphi | \psi}
$$

or alternatively 

$$
  \braket{\varphi | \hat{A} | \psi} = \braket{\psi | \hat{A}^\dagger | \varphi}^*
$$

Hermitian adjoint properties
- $\left(\hat{A}^\dagger \right)^\dagger = \hat{A}$
- $\left(\hat{A} + \hat{B}\right)^\dagger = \hat{A}^\dagger + \hat{B}^\dagger$
- $\left(\hat{A}\hat{B} \right)^\dagger = \hat{B}^\dagger\hat{A}^\dagger$
- $\left(\hat{A}\ket{\psi}\right)^\dagger = \langle\psi|\hat{A}^\dagger$
- $\left(\ket{\psi}\langle\phi|\right)^\dagger = \ket{\phi}\langle\psi|$
- $\langle a\hat{A}\psi| = a^* \langle\psi|\hat{A}^\dagger$
- $(\hat{A}\times\hat{B})^\dagger = -\hat{B}^\dagger \times\hat{A}^\dagger$

<details>
<summary>Proof</summary>

In terms of the Levi-Civita symbol, $\varepsilon_{ijk}$, we can write

$$
  (\hat{A}\times\mathbf{B})_i = \varepsilon_{ijk} A_j B_k
$$

Thus,

$$
  (\hat{A} \times \hat{B})^\dagger = (\varepsilon_{ijk} A_j B_k)^\dagger = \varepsilon_{ijk} (A_j B_k)^\dagger = \varepsilon_{ijk} B_k^\dagger A_j^\dagger = -\varepsilon_{ikj} B_k^\dagger A_j^\dagger = -(\hat{B}^\dagger \times\hat{A}^\dagger)_i
$$
</details>

An operator is Hermitian (self-adjoint) if it is its own Hermitian adjoint

$$
  \hat{A} = \hat{A}^\dagger
$$

An operator is anti-Hermitian if it is the negative of its own Hermitian adjoint

$$
  \hat{A} = -\hat{A}^\dagger
$$

An operator is unitary if its Hermitian adjoint equals its inverse

$$
  \hat{A}^\dagger = \hat{A}^{-1}
$$
    
### Eigenvalues

The eigenvalue of an operator $\hat{A}$ is a scalar $\lambda$ satisfying

$$
  \hat{A} \ket{\psi} = \lambda \ket{\psi}
$$

where $\ket{\psi}$ is an eigenvector of $\hat{A}$ corresponding to $\lambda$. The collection of all of eigenvalues is called the spectrum of the operator $\hat{A}$. An operator with distinct eigenvalues is said to have a non-degenerate specturm. If two or more eigenvalues coincide, the spectrum becomes degenerate.

For a Hermitian operator $\hat{A}$, the eigenvalue equation satisfies

$$
\begin{aligned}
    \braket{\psi_i | \hat{A} \psi_j} &= \braket{\hat{A} \psi_i | \psi_j} \\
    \lambda_i^* \braket{\psi_i | \psi_j} &= \lambda_i \braket{\psi_i | \psi_j}
\end{aligned}\\
  \implies \left( \lambda_j^* - \lambda_i \right) \braket{\psi_i | \psi_j} = 0
$$

If $i = j$, then $\lambda_i = \lambda_i^*$ so that the eigenvalue is real. If $i \neq j$, then $\braket{\psi_i | \psi_j} = 0$ which shows that the eigenvectors are orthogonal.

The eigenvectors of a Hermitian operator are complete, meaning that they form an orthogonal basis. Any wavefunction $\psi$ can therefore be expanded in terms of the eigenvalues of a given operator $\hat{A}$

$$
  \psi(\mathbf{x}) = \sum_i^\infty a_i \phi_i (\mathbf{x})
$$

for some complex coefficients $a_n$. If the eigenvectors are normalized, forming an orthonormal basis, these coefficients are given by

$$
  \braket{\phi_i | \psi} = \sum_j a_j \braket{\phi_i | \psi} = \sum_j a_j \delta_{ij} = a_i
$$

The norm of a state vector in discrete space is

$$
\begin{align*}
  \lVert \psi(\mathbf{x}) \rVert^2 =& \braket{ \psi | \psi } = \Braket{ \sum_i a_i \phi_i | \sum_j a_j \phi_j} \\
  =& \sum_{i,j} a_i^* a_j \braket{\phi_i | \phi_j} \\
  =& \sum_{i,j} a_i^* a_j \delta_{ij} = \sum_i \left| a_i \right|^2
\end{align*}
$$

### Commutator

The commutator of two operators $\hat{A}$ and $\hat{B}$ is written

$$
  [\hat{A}, \hat{B}] := \hat{A}\hat{B} - \hat{B}\hat{A}
$$

while the anticommutator is written 

$$
\{\hat{A}, \hat{B}\} := \hat{A}\hat{B} + \hat{B}\hat{A}
$$

Commutator properties
- Self-commution: $[\hat{A}, \hat{A}] = 0$
- Antisymmetry: $[\hat{A}, \hat{B}] = -[\hat{B}, \hat{A}]$
- Linearity: $[\hat{A}, \hat{B} + \hat{C}] = [\hat{A}, \hat{B}] + [\hat{A}, \hat{C}]$
- Hermitian conjugable: $[\hat{A}, \hat{B}]^\dagger = [\hat{A}^\dagger, \hat{B}^\dagger]$
- Distributivity:
$$
\begin{align*}
  [\hat{A}, \hat{B}\hat{C}] &= [\hat{A}, \hat{B} ]\hat{C} + \hat{B}[ \hat{A}, \hat{C}] \\
  [\hat{A}\hat{B}, \hat{C}] &= \hat{A}[\hat{B}, \hat{C}] + [ \hat{A}, \hat{C}]\hat{B}
\end{align*}
$$
- $[\hat{A}^2,\hat{B}] = \hat{A}[\hat{A},\hat{B}] + [\hat{A},\hat{B}]\hat{A}$
- Jacobi identity: $\left[\hat{A}, [\hat{B}, \hat{C}]\right] + \left[\hat{B}, [\hat{C}, \hat{A}]\right] + \left[\hat{C}, [\hat{A}, \hat{B}]\right] = 0$
- Operators commute with scalars
- If $\hat{A}$ and $\hat{B}$ Hermitian operators then
  * $[\hat{A}, \hat{B}]$ is anti-Hermitian
  * $\{\hat{A}, \hat{B}\}$ is Hermitian

The commutator gives an alternative expression for the dot product of two operators $\hat{A}$ and $\hat{B}$

$$
  \hat{A}\cdot\hat{B} = \hat{A}_i \hat{B}_i = (\hat{A}_i \hat{B}_i - \hat{B}_i \hat{A}_i) + \hat{B}_i \hat{A}_i = [\hat{A}_i, \hat{B}_i] + \hat{B}_i \hat{A}_i = [\hat{A}_i, \hat{B}_i] + \hat{B}\cdot\hat{A} 
$$

and likewise for their cross product

$$
  (\hat{A}\times\hat{B})_i = \varepsilon_{ijk} \hat{A}_j \hat{B}_k = \varepsilon_{ijk}[(\hat{A}_j \hat{B}_k - \hat{B}_k \hat{A}_j) + \hat{B}_k \hat{A}_j] = \varepsilon_{ijk}([\hat{A}_j, \hat{B}_k] + \hat{B}_k \hat{A}_j) = -\varepsilon_{ikj} \hat{B}_k \hat{A}_j + \varepsilon_{ijk} [\hat{A}_j, \hat{B}_k] = -(\hat{B} \times \hat{A})_i + \varepsilon_{ijk} [\hat{A}_j, \hat{B}_k]
$$
    
Two operators $\hat{A}$ and $\hat{B}$ are said to commute if $[ \hat{A}, \hat{B}] = 0$. Two commuting operators share the same eigenvectors. Suppose $\hat{A}$ and $\hat{B}$ commute with common eigenvectors

$$
  \hat{A}\phi_i (\mathbf{x}) = \lambda_i \phi_i (\mathbf{x}),\quad \hat{B}\phi_i (\mathbf{x}) = \mu_i \phi_i (\mathbf{x})
$$

then any function $\phi$ can be expanded in terms of these eigenstates $\psi = \sum_i a_i \phi_i$ giving

$$
  [\hat{A}, \hat{B}]\psi = \sum_i a_i [\hat{A}, \hat{B}]\phi_i = \sum_i a_i \left(\lambda_i \mu_i - \mu_i \lambda_i \right)\phi_i = 0 
$$

## Spectral theory

### Completeness relation

If $\hat{A}$ is a self-adjoint operator on a Hilbert space with spectrum $\sigma(\hat{A})$, there is a projection-valued measure $E(\lambda)$ such that

$$
  \hat{A} = \int_{\sigma(\hat{A})} \lambda\;\d E(\lambda)
$$

In particular, if $\hat{A}$ has both discrete and continuous spectra, i.e. $\sigma(\hat{A}) = \sigma_\text{d} (\hat{A}) \cup \sigma_\text{c} (\hat{A})$, where
- $\sigma_\text{d} (\hat{A}) = \Set{a_i}$ is the set of discrete eigenvalues with corresponding eigenvectors $\set{\ket{a_i}}$
- $\sigma_\text{c} (\hat{A})$ is the continuum of eigenvalues with corresponding eigenfunctions $\set{\ket{\lambda}}$

then the identity operator $\hat{I}$ can be decomposed as

$$
  \hat{I} = \sum_i \ket{a_i} \bra{a_i} + \int_{\sigma_{\text{c}}(\hat{A})} \ket{\lambda}\bra{\lambda}\;\d\lambda
$$

which is known as the completeness relation.

# Quantum formalism

## Postulates

1. **Description of system states:** The configuration space of a quantum system is a complex separable Hilbert space $\mathcal{H}$ and the possible states of this system are represented by state vectors $\ket{\psi}\in\mathcal{H}$ with unit norm, i.e. $\lVert\ket{\psi}\rVert = 1$.
2. *Description of system observables:* Each physical observable $A$ of a quantum system is associated with a Hermitian operator $\hat{A}$ acting on $\mathcal{H}$. Since $\hat{A}$ is Hermitian, its eigenvalues are real, and its eigenstates form a complete, orthonormal set that spans $H$, provided that $\hat{A}$ has a discrete spectrum. If $\hat{A}$ has a continuous spectrum, the eigenstates may form a generalized orthonormal basis, typically in terms of distrsibution functions. 
3. **Measurement of physical observables:** The possible measurable values of an observable $A$ are defined by the eigenvalues of its associated operator $\hat{A}$. When the quantum system is in state $\ket{\psi}\in\mathcal{H}$
    - The probability $P_n$ for measuring a particular eigenvalue $a_n$, corresponding to an eigenstate $n$ is $P_n = |\braket{n|\psi}|^2$.
    - The expected value of $A$ is $\langle A \rangle = \braket{\psi|\hat{A}|\psi}$
4. **Effect of measurement on the state:** An ideal measurement of an observable $A$ that yields the eigenvalue $a_n$, projects the quantum system from its initial state $\ket{\psi}$ to a final state
$$
  \ket{\psi'} = \frac{\hat{P}_n \ket{\psi}}{\sqrt{\psi|\hat{P}_n|\psi}}
$$
where $\hat{P}_n$ is the projection operator onto the eigenstate $\ket{n}$ corresponding to the eigenvalue $a_n$.

5. **Time evolution of a system:** In the Schrödinger picture, the time evolution of a state vector $\ket{\psi(t)}$ is governed by the Schrödinger equation
$$
  i\hbar\frac{\d}{\d t}\ket{\psi(t)} = \hat{H}\ket{\psi(t)}
$$
where $\hat{H}$ is the Hamiltonian of the quantum system.

    - The time evolution of a closed quantum system is described by a unitary transformation $\hat{U}$ acting on the initial state $\ket{\psi(t_0)}$
$$
  \ket{\psi(t)} = U(t,t_0)\ket{\psi (t_0)}
$$

### Time evolution pictures

| Evolution of | Schrödinger $(S)$ | Heisenberg $(H)$ | Interaction $(I)$ |
| --- | --- | --- | --- |
| State vector | $\ket{\psi_s (t)} = e^{-i\hat{H}_S t/\hbar} \ket{\psi_S (0)}$ | constant | $\ket{\psi_I (t)} = e^{i\hat{H}_{0;S} t/\hbar} \ket{\psi_S (t)}$ |
| Observable | constant | $\hat{O}_H = e^{i\hat{H}_S t/\hbar} \hat{O}_S e^{-i\hat{H}_S t/\hbar}$ | $\hat{O}_I = e^{i\hat{H}_{0;S} t/\hbar} \hat{O}_S e^{-i\hat{H}_{0;S} t/\hbar}$ |
| Density matrix | $\rho_S (t) = e^{i\hat{H}_S t/\hbar} \rho_S (0) e^{-i\hat{H}_S t/\hbar}$ | constant | $\rho_I (t) = e^{i\hat{H}_{0;S} t/\hbar} \rho_S (t) e^{-i\hat{H}_{0;S} t/\hbar}$ |

## Wave function

The state of a quantum particle is described by a complex-valued wavefunction $\psi(\mathbf{x}, t)$ in position space. The mod square of the wavefunction represents the probability density for the particle's position

$$
  P(\mathbf{x}, t) = |\psi(\mathbf{x}, t)|^2
$$

This is known as the Born rule. The probabilistic interpretation requires the wavefunction to be a square normalisable function

$$
  \int |\psi(\mathbf{x}, t)|^2 \;\d^3 x = \int \psi^* \psi \;\d^3x = 1
$$

The set of square normalisable functions forms the Hilbert space $\mathcal{H} \in L^2 (M)$, which is a vector space. This means that if $\psi_i (\mathbf{x},t)$ for $i\in I\subseteq\N$ are possible states of the system, then so is the linear combination

$$
  \psi (\mathbf{x}, t) = \sum_{i\in I} c_i \psi_i (\mathbf{x}, t) 
$$

which is known as the principle of superposition. The wavefunction $\psi(\mathbf{x},t)$ gives the components of the state space vector $\ket{\psi(t)}$, i.e.

$$
  \ket{\psi(t)} = \int_{\R^3} \psi(\mathbf{x},t)\ket{\mathbf{x}}\;\d^3 x
$$

Thus, the wave function can be written as an inner product of the state space vector $\ket{\psi(t)}$ with position eigenstates $\bra{\mathbf{x}}$, i.e.

$$
  \psi(\mathbf{x}, t) = \braket{\mathbf{x}|\psi(t)}
$$

In bra-ket notation the normalization integral takes the form

$$
\begin{align*}
  \int |\psi(\mathbf{x}, t)|^2 \;\d^3 x =& \int_{\R^3} \braket{\mathbf{x}|\psi}^* \braket{\mathbf{x}|\psi}\;\d^3 x \\
  =& \int_{\R^3} \braket{\psi|\mathbf{x}} \braket{\mathbf{x}|\psi}\;\d^3 x \\
  =& \braket{\psi|\psi} = \lVert \psi \rVert^2 = 1
\end{align*}
$$

This shows that the state space vector $\ket{\psi(t)}$ has unit norm.

## Schrödinger equation

The Schrödinger equation describes the time evolution of the wave function $\psi(\mathbf{x},t)$ by the differential equation

$$
  i\hbar \frac{\partial}{\partial t}\psi(\mathbf{x},t) = \hat{H}\psi(\mathbf{x},t)
$$

where $\hat{H}$ is the Hamiltonian operator of the system. In Cartesian coordinates, $\hat{H}$ is derived from the classical Hamiltonian $H(\mathbf{p},\mathbf{x},t)$ by the substitution

$$
  \mathbf{p} \to\hat{\mathbf{p}} = -i\hbar\nabla
$$

For a non-relativistic particle with mass $m$ subject to a potential $V(\mathbf{x},t)$, the Hamiltonian takes the form

$$
  \hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{x},t)
$$

In terms of state space vector $\ket{\psi(t)} = \int \psi(\mathbf{x},t)\ket{\mathbf{x}}\;\d^3 x$, the Schrödinger equation takes the form

$$
  i\hbar\frac{\d}{\d t}\ket{\psi(t)} = \hat{H}\ket{\psi(t)}
$$

Taking the Hermitian adjoint of the equation yields

$$
  -i\hbar\frac{\d}{\d t}\bra{\psi(t)} = \bra{\psi(t)}\hat{H}^\dagger 
$$

The Schrödinger equation preserves the Born rule if $\hat{H}$ is Hermitian. To prove this, note that probility is conserved, if the norm of $\ket{\psi}$ remains constant over time

$$
  \frac{\d}{\d t} \braket{\psi(t)|\psi(t)} = 0
$$

Applying the product rule to the left-hand side gives

$$
  \frac{\d}{\d t} \braket{\psi|\psi} = \frac{\d}{\d t}(\bra{\psi})\ket{\psi} + \ket{\psi} \frac{\d}{\d t}(\ket{\psi})
$$

Substituting the Schrödinger equation and its conjugate gives

$$
\begin{align*}
  \frac{\d}{\d t} \braket{\psi|\psi} =& \left(-\frac{i}{\hbar}\bra{\psi}\hat{H}^\dagger \right)\ket{\psi} + \bra{\psi}\left(\frac{i}{\hbar}\hat{H}\ket{\psi} \right) \\
  =& \frac{i}{\hbar}\left(\braket{\psi|\hat{H}|\psi} - \braket{\psi|\hat{H}^\dagger|\psi} \right) = 0
\end{align*}
$$

This expression vanishes if and only if $\braket{\psi|\hat{H}|\psi} = \braket{\psi|\hat{H}^\dagger|\psi}$. Since this must hold for any arbitrary state $\ket{\psi(t)}$, it follows that $\hat{H} = \hat{H}^\dagger$.

### Conservation of probability

The Schrödinger equation ensures that probability is conserved for a quantum system. The partial time derivative of the probability density is

$$
  \frac{\partial P}{\partial t}(\mathbf{x},t) = \frac{\partial}{\partial t}|\psi(\mathbf{x},t)|^2 = \psi^* \frac{\partial\psi}{\partial t} + \frac{\partial\psi^*}{\partial t}\psi
$$

Applying the Schrödinger equation with Hamiltonian $\hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{x})$ on the partial time derivatives gives

$$
\begin{align*}
  \frac{\partial P}{\partial t} &= -\psi^* \frac{i}{\hbar}\left( -\frac{\hbar^2}{2m}\nabla^2 + V \right)\psi + \psi^* \frac{i}\psi \left(-\frac{\hbar^2}{2m}\nabla^2 + V \right)\psi^* \\
  &= \frac{i\hbar}{2m}\left( \psi^* \nabla^2 \psi - \psi\nabla^2 \psi^* \right) + \frac{i}{\hbar}V\left(\psi\psi^* - \psi^*\psi \right) \\
  &= \frac{i\hbar}{2m}\nabla \cdot \left( \psi^* \nabla \psi - \psi\nabla \psi^* \right)
\end{align*}
$$

If we define the probability current

$$
  \mathbf{J} = -\frac{i\hbar}{2m} \left( \psi^* \nabla \psi - \psi\nabla \psi^* \right)
$$

we get the continuity equation

$$
  \frac{\partial P}{\partial t} + \nabla \cdot \mathbf{J} = 0
$$

To see that this gives a conservation law, consider a volume $V\subseteq\R^3$ enclosed by a surface $S$. The probability that the particle lies in this region is given by

$$
  P_V (t) = \int_V P(\mathbf{x},t)\;\d^3 x
$$

The continuity equation tells us that this probability changes as

$$
  \frac{\partial P_V}{\partial t} = - \int_V \nabla\cdot\mathbf{J}\;\d^3 x = - \int_S \mathbf{J}\cdot\d\mathbf{S}
$$

where the final step follows from the divergence theorem. This shows that a change in $P_V$ produces a flow of probability through $S$.

In the special case $V = \R^3$, then $P = \int_{\R^3} |\psi(\mathbf{x},t)|^2 \; \d^3 x = 1$. The change in probability is

$$
  \frac{\partial P}{\partial t} = - \int_{S_\infty^2} \mathbf{J}\cdot\d\mathbf{S}
$$

where $S_\infty^2$ is the asymptotic $2$-sphere at the infinity of $\R^3$. However, any normalized wavefunction vanishes asymptotically, i.e. $\psi \xrightarrow{|\mathbf{x}|\to\infty} 0$. Consequently, we have $\mathbf{J}\xrightarrow{|\mathbf{x}|\to\infty} 0$. Furthermore, we can check that $\mathbf{J}$ falls off quickly enough so that $\frac{\partial P}{\partial t} = 0$.

### Stationary states

If the Hamiltonian operator has a time-independent potential, the Schrödinger equation can be solved by separation of variables. Assuming a wavefunction of the form $\Psi(\mathbf{x},t) = \psi(\mathbf{x})\phi(t)$ with partial derivatives

$$
  \frac{\partial\Psi}{\partial t} = \psi \frac{\d\phi}{\d t}, \quad \nabla^2 \Psi = (\nabla^2 \psi) \phi
$$

the Schrödinger equation reads

$$
\begin{align}
  i\hbar \psi \frac{\d\phi}{\partial t} =& -\frac{\hbar^2}{2m} (\nabla^2 \psi)\phi + V\psi\phi \\
  i\hbar \frac{1}{\phi} \frac{\d\phi}{\d t} =& -\frac{\hbar^2}{2m} \frac{1}{\psi} \nabla^2 \psi + V
\end{align*}
$$

The equation holds if both sides equal a separation constant, which in this case corresponds with the systems total energy $E$. This results in the temporal equation

$$
  \frac{\d\phi}{\d t} = -\frac{iE}{\hbar} \phi
$$

and the spatial equation

$$
\begin{align*}
  -\frac{\hbar^2}{2m} \nabla^2 \psi + V\psi =& E\psi \\
  \hat{H}\psi =& E\psi 
\end{align*}
$$

which is called the time-independent Schrödinger equation. The temporal equation has general solution

$$
  \phi(t) = C e^{-iEt/\hbar}
$$

Absorbing the normalization constant $C$ into $\psi$, the wavefunction becomes

$$
  \Psi(\mathbf{x}, t) = \psi(\mathbf{x}) e^{-iEt/\hbar}
$$

Although $\Psi$ depends on $t$, the probability density

$$
  |\Psi(\mathbf{x},t)|^2 = \Psi^* \Psi = \psi^* e^{iEt/\hbar} \psi e^{-iEt/\hbar} = |\psi(x)|^2
$$

is time-independent. Taking the expectation value of $\hat{H}$, we get

$$
\begin{align*}
  \langle \hat{H} \rangle_\Psi =& \braket{\Psi|\hat{H}\Psi} = \int_{\R^3} (\psi e^{-iEt/\hbar})^* \underbrace{\hat{H}\psi}_{=E\psi} e^{-iEt/\hbar} \;\d^3 x \\
  =& E \int_{\R^3} \psi^* e^{iEt/\hbar} \psi e^{-iEt/\hbar} \; \d^3 x \\
  =& E \underbrace{\int_{\R^3} |\psi|^2 \;\d^3 x}_{=1} = E
\end{align*}
$$

Since

$$
  \hat{H}^2 \psi = \hat{H}(\hat{H}\psi) = \hat{H}(E\psi) = E(\hat{H}\psi) = E^2 \psi
$$

it follows that $\langle\hat{H}^2 \rangle = E^2$. Thus, the variance of $H$ is

$$
  \sigma_H^2 = \langle H^2 \rangle - \langle H \rangle^2 = E^2 - E^2 = 0
$$

showing that the total energy is a determinate state.

## Observables

In quantum mechanics, all observables are represented by Hermitian operators on the Hilbert space. The expectation (average measurement) of an observable $\hat{Q}(\mathbf{x}, \mathbf{p})$ in state $\Psi$ is given by the inner product

$$
  \langle Q \rangle_\Psi = \braket{\Psi|\hat{Q}|\Psi} = \int \Psi^* \hat{Q} \Psi \;\d\mathbf{x} 
$$

In order for the observable to represent a physical quantity, we require that the expectation is real, i.e. $\langle Q \rangle_\Psi = \langle Q \rangle_\Psi^*$. This holds if $\hat{Q}$ is Hermitian in which case

$$
  \underbrace{\braket{\Psi|\hat{Q}\Psi}}_{\langle Q \rangle} = \underbrace{\braket{\hat{Q}\Psi|\Psi}}_{\langle Q \rangle^*}
$$

The position operator $\hat{\mathbf{x}}$ can be shown to be Hermitian by noting that

$$
\begin{align*}
  \braket{\psi|\hat{\mathbf{x}}|\phi} =& \int_{\R^3} \psi^*(\mathbf{x}) \mathbf{x} \phi(\mathbf{x}) \;\d^3 x = \int_{\R^3} \phi(\mathbf{x}) \mathbf{x} \psi^*(\mathbf{x}) \;\d^3 x \\
  =& \left(\int_{\R^3} \phi^*(\mathbf{x}) \mathbf{x} \psi(\mathbf{x}) \;\d^3 x\right)^* = \braket{\phi|\hat{\mathbf{x}}|\psi}^*
\end{align*}
$$

Some common operators for a non-relativistic particle with mass $m$ are:

- Momentum operator
$$
  \hat{\mathbf{p}} = -i\hbar \nabla
$$
- Angular momentum operator
$$
  \hat{\mathbf{L}} = \hat{\mathbf{x}} \times \hat{\mathbf{p}} = -i\hbar \hat{\mathbf{x}} \times \nabla
$$
- Hamiltonian (energy operator)
$$
  \hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V\left(\hat{\mathbf{x}} \right)
$$

## Measurement

The possible measurements of an observable $\hat{Q}$ in a quantum system lies in its spectrum of eigenvalues. In terms of an orthonormal eigenbasis $\set{\phi_n}_{n\in\N}$, the eigenvalues of $\hat{Q}$ is given by

$$
  \hat{Q}\phi_n = \lambda_n \phi_n
$$

The wavefunction $\psi$ of quantum system can therefore be exanded in terms of the orthonormal eigenstates of $\hat{Q}$

$$
  \psi (\mathbf{x}) = \sum_n a_n \phi_n (\mathbf{x}) \quad \sum_n \left| a_n \right|^2 = 1
$$

Assuming that the spectrum is non-degenerate, the expectation value of $\hat{Q}$ is 

$$
  \left\langle \hat{Q} \right\rangle_\psi = \sum_{n\in\N} \left| a_n \right|^2 \lambda_n
$$

<details>
<summary>Details</summary>

Using the definition of expecation value $\left\langle \hat{Q} \right\rangle_\psi = \Braket{\psi | \hat{Q} \psi}$ and the fact that $\psi_n$ are orthornormal we find

$$
\begin{align*}
  \left\langle \hat{Q} \right\rangle_\psi = \Braket{\psi | \hat{Q} \psi} &= \Braket{\sum_i a_i \phi_i | \sum_h a_j \hat{Q} \phi_j} \\
  &= \sum_i \sum_j a_i^* a_j \lambda_j \braket{\phi_i | \phi_j} \\
  &= \sum_i \sum_j a_i^* a_j \lambda_j \delta_{ij} \\
  &= \sum_i \left| a_i \right|^2 \lambda_i
\end{align*}
$$
</details>

The probability that the measurement yields the eigenstate $\lambda_n$ is given by the Born rule

$$
  P(\lambda_n) = \left| a_n \right|^2
$$

After the measurement, the wavefunction discontinuously collapses into the eigenvector $\phi_n$ corresponding to the measured eigenstate $\lambda_n$

$$
  \phi(\mathbf{x}) \rightarrow \phi_n (\mathbf{x})
$$

When the spectrum is degenerate, the probability is given by

$$
  P(\lambda) = \sum_{n|\lambda_n = \lambda} \left| a_n \right|^2
$$

in which case, the wavefunction collapses to

$$
  \psi(\mathbf{x}) \rightarrow C \sum_{n|\lambda_n = \lambda} a_n \phi_n
$$

where $C$ is the appropriate normalization factor.

### Determinate states

An interesting case arises when an observable $Q$ is in a determinate state $\psi$ with measurement $\langle Q \rangle_\psi = q$. In this case the variance of $\hat{Q}$ in state $\psi$ is zero, i.e.

$$
  (\Delta_\psi Q)^2 =\left\langle (\hat{Q} - \langle \hat{Q} \rangle_\psi )^2 \right\rangle_\psi = \Braket{\psi|(\hat{Q} - q)^2 \psi} = \Braket{(\hat{Q} - q)\psi|(\hat{Q} - q)\psi} = 0
$$

where we have used the fact that $\hat{Q} - q$ is Hermitian from the assumed hermiticity of $\hat{Q}$. The vanishing variance implies that

$$
  \hat{Q}\psi = q\psi
$$

which is the eigenvalue equation for $\hat{Q}$ with eigenvalue $q$ and corresponding eigenfunction $\psi$. This shows that determinate states of $Q$ are eigenfunctions of $\hat{Q}$

## Heisenberg uncertainty principle

The uncertainty of an observable $\hat{Q}$ in a state $\psi$ is denoted $\Delta_\psi Q = \sigma_{Q}$ and is defined as the variance of the state's probability distribution:

$$
\begin{align*}
  (\Delta_\psi Q )^2 &= \left\langle (\hat{Q} - \langle \hat{Q} \rangle_\psi )^2 \right\rangle_\psi \\
  &= \left\langle \hat{Q}^2 - 2 \langle \hat{Q} \rangle_\psi \hat{Q} + \langle \hat{Q} \rangle_\psi^2 \right\rangle_\psi \\
  &= \langle \hat{Q}^2  \rangle_\psi - \langle \hat{Q} \rangle_\psi^2 \\
  &= \Braket{\psi | \hat{Q}^2 \psi} - \Braket{\psi | \hat{Q}\psi}^2
\end{align*}
$$

For two operators $\hat{A}$ and $\hat{B}$, Heisenberg's uncertainty principle states that

$$
  \sigma_A^2 \sigma_B^2 \geq \left(\frac{1}{2i} \langle [\hat{A}, \hat{B}] \rangle \right)^2
$$

<details>
<summary>Proof</summary>

For any observables $A$ and $B$ we have

$$
\begin{align*}
  \sigma_A^2 =& \Braket{(\hat{A} - \langle A \rangle)\psi | (\hat{A} - \langle A \rangle)\psi} =: \braket{f|f} \\
  \sigma_B^2 =& \Braket{(\hat{B} - \langle B \rangle)\psi | (\hat{B} - \langle B \rangle)\psi} =: \braket{g|g}
\end{align*}
$$

Invoking the Cauchy-Schwarz inequlity, we obtain

$$
  \sigma_A^2 \sigma_B^2 = \braket{f|f}\braket{g|g} \geq |\braket{f|g}|^2
$$

For any complex number $z\in\mathbb{C}$ we have

$$
  |z|^2 = \Re^2{z} + \Im^2 {z} \geq \Im^2{z} = \left(\frac{1}{2i} (z - z^*)\right)^2^
$$

Therefore, letting $z = \braket{f|g}$

$$
  \sigma_A^2 \sigma_B^2 \geq \left(\frac{1}{2i} [\braket{f|g} - \braket{g|f}] \right)^2
$$

From the hermiticity of $\hat{A} - \langle A \rangle$ we get

$$
\begin{align*}
  \braket{f|g} =& \Braket{(\hat{A} - \langle A \rangle)\psi | (\hat{B} - \langle B \rangle)\psi} \\
  =& \Braket{\psi|(\hat{A} - \langle A \rangle) (\hat{B} - \langle B \rangle B)\psi} \\
  =& \Braket{\psi | (\hat{A}\hat{B} - \hat{A}\langle B \rangle - \hat{B} \langle A \rangle + \langle B \rangle \langle B \rangle)\psi} \\
  =& \Braket{\psi | \hat{A}\hat{B}\psi} - \langle B \rangle \Braket{\psi|\hat{A}\psi} - \langle A \rangle \Braket{\psi|\hat{B}\psi} + \langle A \rangle \langle B \rangle \underbrace{\braket{\psi|\psi}}_{=1} \\
  =& \langle \hat{A}\hat{B}\rangle - \langle B \rangle \langle A \rangle - \langle A \rangle \langle B \rangle + \langle A \rangle \langle B \rangle \\
  =& \langle \hat{A}\hat{B}\rangle - \langle A \rangle \langle B \rangle
\end{align*}
$$

Similarly,

$$
  \braket{g|f} = \langle \hat{A}\hat{B} \rangle - \langle A \rangle \langle B \rangle
$$

so

$$
  \braket{f|g} - \braket{g|f} = \langle\hat{A}\hat{B}\rangle - \langle\hat{A}\hat{B}\rangle = \langle\hat{A}\hat{B} - \hat{A}\hat{B}\rangle = \langle[\hat{A},\hat{B}]\rangle
$$

Hence

$$
  \sigma_A^2 \sigma_B^2 \geq \left(\frac{1}{2i} \langle [\hat{A}, \hat{B}] \rangle \right)^2
$$
</details>

In particular, the Heisenberg uncertainty principle states that 

$$
  \Delta_\psi x \Delta_\psi p \geq \frac{\hbar}{2}
$$

The principle can be derived by consider the one-parameter family of states defined by

$$
  \psi_s (\mathbf{x}) = \left( \hat{p} - is\hat{x} \right)\psi(\mathbf{x}) \quad s \in \mathbf{R}
$$

with norm given by

$$
\begin{align*}
  0 \leq \Braket{\psi_s | \psi_s} &= \Braket{\left( \hat{p} - is\hat{x} \right)\psi | \left( \hat{p} - is\hat{x} \right)\psi} \\
  &= \Braket{\psi | \left( \hat{p} + is\hat{x} \right)\left( \hat{p} - is\hat{x} \right)\psi} \\
  &= \Braket{\psi | \left( \hat{p}^2 + is\left[\hat{x}, \hat{p} \right] s^2\hat{x}^2 \right)\psi} \\
  &= \Braket{\psi | \left( \hat{p}^2 - s\hbar + s^2\hat{x}^2 \right)\psi} \\
  &= \left(\Delta_\psi p \right)^2 - s\hbar + s^2\left(\Delta_\psi x \right)^2
\end{align*}
$$

where the commutation $\left[\hat{x}, \hat{p} \right] = i\hbar$ is used. To satisfy the inequality, the derived quadratic equation in $s$

$$
  \left(\Delta_\psi p \right)^2 - s\hbar + s^2\left(\Delta_\psi x \right)^2 \geq 0
$$

has either one or no roots. This is only true if the discriminant is non-positive, i.e.

$$
\begin{gather*}
  4\left(\Delta_\psi x \right)^2\left(\Delta_\psi p \right)^2 \geq \hbar^2 \\
  \Delta_\psi x \Delta_\psi p \geq \frac{\hbar}{2}
\end{gather*}
$$

which is the Heisenberg uncertainty principle.

## Time evolution operator

A time evolution operator $\hat{U}$ translates a state vector $\ket{\psi(t)}$ from time $t_a$ to $t_b$ by

$$
  \hat{U}(t_b,t_a)\ket{\psi(t_a)} = \ket{\psi(t_b)}
$$

If the Hamiltonian is time-independent, the time evolution operator is obtainable from the Schrödinger equation

$$
  i\hbar\frac{\partial}{\partial t_b}(\hat{U}(t_b,t_a)\ket{\psi(t_a)}) = \hat{H}\hat{U}(t_b,t_a)\ket{\psi(t_a)} 
$$

Since $\ket{\psi(t_a)}$ is indepedent of $t_b$, we can factor it out from the partial time derivative

$$
  i\hbar\frac{\partial\hat{U}(t_b,t_a)}{\partial t_b}\ket{\psi(t_a)} = \hat{H}\hat{U}(t_b,t_a)\ket{\psi(t_a)} 
$$

This equation must hold for any initial state $\ket{\psi(t_a)}$ giving a first-order differential equation for $\hat{U}(t_b,t_a)$

$$
  i\hbar\frac{\partial\hat{U}(t_b,t_a)}{\partial t_b} = \hat{H}\hat{U}(t_b,t_a)
$$

with solution

$$
  \hat{U}(t_b,t_a) = e^{i\hat{H}(t_a - t_b)/\hbar}
$$

Its inverse is obtained by interchanging the order of $t_a$ and $t_b$

$$
  \hat{U}^{-1}(t_b,t_a) = e^{-i\hat{H}(t_a - t_b)/\hbar}
$$

Since $\hat{H}$ is Hermitian, $\hat{U}$ is unitary because

$$
\begin{equation}
\begin{split}
  \hat{U}^\dagger (t_b,t_a) =& e^{i(t_b - t_a)\hat{H}^\dagger /\hbar} \\
  =& e^{i(t_b - t_a)\hat{H} /\hbar} \\
  =& \hat{U}^{-1}(t_b,t_a)
\end{split}\tag{\label{equation-6}}
\end{equation}
$$

If the Hamiltonian depends explicitly on time, the time evolution operator can be found iteratively. The time interval $[t_a, t_b]$ with $t_a < t_b$ is partitioned into $N + 1$ subintervals of length $\epsilon = (t_b - t_a)/(N + 1)$, such that $t_n = t_a + n\epsilon$ for $n=0,\dots,N+1$. Schrödinger's equation approximates the time evolution at each step $\epsilon$

$$
\begin{align*}
  \ket{\psi(t_a + \epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + \epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a)} \\
  \ket{\psi(t_a + 2\epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + 2\epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a + \epsilon)} \\
  \vdots& \\
  \ket{\psi(t_a + (N+1)\epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + (N+1)\epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a + N\epsilon)} 
\end{align*}
$$

Combining the equation, the time evolution operator is approximated as

$$
  \hat{U}(t_b, t_a) \approx \prod_{n=0}^{N} \left(\int_{t_n}^{t_{n+1}} \hat{H}(t'_{n+1})\;\d t'_{n+1} \right)
$$

Expanding the product and taking the limit $N\to\infty$ gives the series

$$
\begin{align*}
  \hat{U}(t_b, t_a) =& 1 - \frac{1}{\hbar} \int_{t_a}^{t_b} \d t'_1 \;\hat{H}(t'_1) \\
  &+ \left(\frac{-i}{\hbar}\right) \int_{t_a}^{t_b} \d t'_n \int_{t_a}^{t_n} \d t'_{n-1} \cdots \int_{t_a}^{t'_2} \d t'_1 \;\hat{H}(t'_n)\hat{H}(t'_{n-1})\cdots\hat{H}(t'_1)
\end{align*}
$$

known as the *Neumann-Liouville expansion* or *Dyson series*. Note that each integral has the time arguments in the Hamilton operators ordered causally since the operators are ordered descending in time. It is useful to introduce a time-ordering operator, which when applied to an arbitrary product of operators

$$
  \hat{O}_n (t_n) \cdots\hat{O}_1 (t_1)
$$

reorders the times successivelse, i.e.

$$
  \hat{T}(\hat{O}_n (t_n)c\dots\hat{O}_1 (t_1)) := \hat{O}_{i_n} (t_{i_n})\cdots\hat{O}_{i_1} (t_{i_1})
$$

where $t_{i_n},\dots,t_{i_1}$ are the times $t_n,\dots,t_1$ relabeled in the causal order, so that

$$
  t_{i_n} > t_{i_{n-1}} >\cdots> t_{i_1}
$$

With this operator, the Neumann-Liouville expansion can be written more compactly. Consider the third term of the series

$$
\begin{equation}
  \int_{t_a}^{t_b} \d t_2 \int_{t_a}^{t_2} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1) \tag{\label{equation-1}}
\end{equation}
$$

The integration covers the triangle above the diagonal in the square $t_1, t_2 \in [t_a, t_b]$ in the $(t_1, t_2)$ plane. Comparing this the with the remaining integral over the lower triangle

$$
\begin{equation}
  \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1) \tag{\label{equation-2}}
\end{equation}
$$

we see that the two expressions coincide except for the order of the operators. Applying the time-ordering operator to $\eqref{equation-2}$, gives

$$
  \hat{T} \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1)
$$

which is equal to $\eqref{equation-1}$ because $\eqref{equation-2}$ can be rewritten as

$$
\begin{equation}
  \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_1)\hat{H}(t_2) = \int_{t_a}^{t_b} \d t_1 \int_{t_a}^{t_1} \d t_2 \; \hat{H}(t_1)\hat{H}(t_2) \tag{\label{equation-3}}
\end{equation}
$$

where the order of integration is changed in the last step. Apart from the dummy integration variables $t_2 \leftrightarrow t_1$, the double integral $\eqref{equation-3}$ coincides with $\eqref{equation-1}$. Since the time arguments are properly ordered, the time-ordering operator can be applied to $\eqref{equation-1}$ to give

$$
  \frac{1}{2}\hat{T}\int_{t_a}^{t_b} \d t_2 \int_{t_a}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1) = \frac{1}{2}\hat{T}\left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^2
$$

Similarly, we may rewrite the $n$-th order term of the Neumann-Liouville expansion as

$$
\begin{align*}
  &\frac{1}{n!} \hat{T} \int_{t_a}^{t_b} \d t_n \int_{t_a}^{t_b} \d t_{n-1} \cdots \int_{t_a}^{t_b} \d t_1 \; \hat{H}(t_n)\hat{H}(t_{n-1})\cdots\hat{H}(t_1) \\
  =& \frac{1}{n!} \hat{T}\left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^n 
\end{align*}
$$

The time evolution operator $\hat{U}(t_b, t_a)$ has therefore the series expansion

$$
\begin{align*}
  \hat{U}(t_b, t_a) = \sum_{n=0}^\infty \frac{1}{n!}\left(\frac{-i}{\hbar}\right)^n \hat{T}\left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^n
\end{align*}
$$

which we recognize as the power series expansion of the exponential, giving

$$
\begin{equation}
  \hat{U}(t_b, t_a) = \hat{T}\exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t)\;\d t \right) \tag{\label{equation-5}}
\end{equation}
$$

Note that a small variation $\delta\hat{H}(t)$ of $\hat{H}(t)$ changes $\hat{U}(t_b, t_a)$ by

$$
\begin{align*}
  \delta\hat{U}(t_b, t_a) =& -\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{T}\exp\left(-\frac{i}{h} \int_{t'}^{t_b} \hat{H}(t)\; \d t \right) \delta\hat{H}(t') \hat{T}\exp\left(-\frac{i}{\hbar} \int_{t_a}^{t'} \hat{H}(t)\;\d t \right)\; \d t'\\
  =& -\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{U}(t_b, t') \delta\hat{H} (t') \hat{U}(t', t_a)\; \d t'
\end{align*}
$$

### Properties of the time evolution operator

#### Fundamental composition law

If two time translation are performed successively, the corresponding operators $\hat{U}$ are related by

$$
\begin{equation}
  \hat{U}(t_b, t_a) = \hat{U}(t_b, t')\hat{U}(t', t_a),\; t'\in(t_a, t_b) \tag{\label{equation-4}}
\end{equation}
$$

This composition law makes the operators $\hat{U}$ a representation of the Abelian group of time translations. For time-independent Hamiltonians the composition law $\eqref{equation-4}$ is trivial. In the general case with $\hat{U}(t_b, t_a)$ given by $\eqref{equation-5}$, the composition law follows from the additivity rule of the exponential

$$
\begin{align*}
  &\hat{T}\exp\left(-\frac{i}{\hbar} \int_{t'}^{t_b} \hat{H}(t)\;\d t \right)\hat{T} \exp\left(\int_{t_a}^{t'} \hat{H} (t) \;\d t \right) \\
  =& \hat{T}\left[\exp\left(-\frac{i}{\hbar} \int_{t'}^{t_b} \hat{H}(t)\;\d t \right) \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t'} \hat{H}(t)\;\d t \right) \right] \\
  =& \hat{T}\exp\left(-\frac{i}{\hbar} \left[ \int_{t'}^{t_b} \hat{H}(t)\;\d t + \int_{t_a}^{t'} \hat{H}(t)\;\d t \right]\right) \\
  =& \hat{T}\exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)
\end{align*}
$$

#### Unitarity

The inverse of the time evolution operator $\hat{U}(t_b, t_a)$ is obtained by interchanging the order of $t_a$ and $t_b$, which gives its anticasual form, i.e.

$$
  \hat{U}(t_b, t_a) = \hat{U}(t_a, t_b)^{-1}
$$

This implies that $\hat{U}$ is unitary. The unitarity was already established for time independent Hamiltonians in $\eqref{equation-6}$. In the general case, a direc solution of the Schrödinger equation shows that the operator $\hat{U}(t_b, t_a)$ for $t_b < t_a$ has a representation just like $\eqref{equation-5}$, except for a reversed time order of its argument, written as

$$
  \hat{U}(t_b, t_a) = \hat{\bar{T}} \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t) \;\d t \right)
$$

where $\hat{\bar{T}}$ denotes the time-antiordering operator, which satisfies

$$
  \left[\hat{T}\left(\hat{O}_1 (t_1)\cdots \hat{O}_n (t_n) \right) \right]^\dagger = \hat{\bar{T}} \left(\hat{O}_n^\dagger (t_n)\cdots \hat{O}_1^\dagger (t_1) \right)
$$

It follows that

$$
\begin{align*}
  \hat{U}^\dagger (t_b, t_a) =& \left[\hat{T} \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H} (t) \;\d t \right)\right]^\dagger \\
  =& \hat{\bar{T}} \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}^\dagger (t) \;\d t \right) \\
  =& \hat{T} \exp\left(-\frac{i}{\hbar} \int_{t_b}^{t_a} \hat{H} (t) \;\d t \right) \\
  =& \hat{U}(t_a, t_b) = \hat{U}^{-1} (t_b, t_a)
\end{align*}
$$

#### Time evolution for $\hat{U}(t_b, t_a)$

Since the time-evolution operator $\hat{U}(t_b, t_a)$ gives the relation between arbitrary wave functions at different times

$$
  \ket{\psi(t_b)} = \hat{U}(t_b, t_a) \ket{\psi(t_a)}
$$

the Schrödinger equation implies that the operator $\hat{U}(t_a, t_b)$ satisfies

$$
\begin{equation}
\begin{split}
  i\hbar\frac{\partial}{\partial t} \hat{U}(t, t_a) =& \hat{H}\hat{U}(t, t_a) \\
  i\hbar\frac{\partial}{\partial t} \hat{U}^{-1} (t, t_a) =& -\hat{U}(t, t_a)^{-1} \hat{H}
\end{split} \tag{\label{equation-8}}
\end{equation}
$$

with the initial condition $\hat{U}(t_a, t_a) = 1$.

## Propagator

The matrix elements of the time evolution operator in the localized basis states $\set{\ket{\mathbf{x}}}_{\mathbf{x}\in\R^3}$ defines a function

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) := \braket{\mathbf{x}_b|\hat{U}(t_b,t_a)|\mathbf{x}_a}
$$

called the *propagator* of a quantum system. The propagator gives an alternate representation for the wave function of a quantum particle. In the position basis $\set{\ket{\mathbf{x}}}_{\mathbf{x}\in\R^3}$, the completeness relation gives

$$
  \int_{\R^3} \ket{\mathbf{x}}\bra{\mathbf{x}}\;\d^3 x = 1
$$

The time evolution of a state vector $\ket{\psi(t)}$ from $t=0$ to $t$ can be written as

$$
\begin{align*}
  \ket{\psi(t)} =& \hat{U}(t,0)\ket{\psi(0)} = \int_{\R^3} \hat{U}(t,0) \ket{\mathbf{y}}\braket{\mathbf{y}|\psi(0)}\; \d^3 y \\
  =& \int_{\R^3} \hat{U}(t,0)\ket{\mathbf{y}} \psi(\mathbf{y}, 0)\;\d^3 y
\end{align*}
$$

The wave function $\psi(\mathbf{x},t) = \braket{\mathbf{x}|\psi(t)}$ thus takes the form

$$
\begin{align*}
  \psi(\mathbf{x},t) =& \braket{\mathbf{x}|\psi(t)} = \int_{\R^3} \braket{\mathbf{x}|\hat{U}(t,0)|\mathbf{y}}\psi(\mathbf{y},0)\; d^3 y \\
  =& \int_{\R^3} (\mathbf{x},0|\mathbf{y},t)\psi(\mathbf{y}, 0)\; \d^3 y
\end{align*}
$$

We can recover the time evolution operator from the propagator by

$$
  \hat{U}(t) = \int (\mathbf{x},0|\mathbf{y},t) \ket{\mathbf{x}}\bra{\mathbf{y}}\; \d^3 x\;\d^3 y
$$

The propagator and the time evolution operator both completely describe the behaviour a the system. One can intuitively think of the propagator $K(\mathbf{x}_a, t_a \mathbf{x}_b; t_b)$, as the probability amplitude for a particle to travel from $\mathbf{x}_a$ to $\mathbf{x}_b$ in time $t_b - t_a$ with $t_b > t_a$. The propagator is therefore also referred to as *time evolution amplitude*.

From the operator equations $\eqref{equation-8}$, the propagator satisfies the Schrödinger equation

$$
  i\hbar \frac{\partial}{\partial t_b} (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) = H(-i\hbar\nabla_{\mathbf{x}_b}, \mathbf{x}_b,t_b) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)
$$

When dealing with non-relativistic particles, it is customary to introduce a casual/retarded time evolution operator

$$
  \hat{U}_R (t_b,t_a) = \begin{cases}
    \hat{U}(t_b,t_a),\quad& t_b \geq t_a \\
    0,\quad& t_b < t_a
  \end{cases}
$$

and the associated casual/retarded time evolution amplitude

$$
  (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)_R := \braket{\mathbf{x}|\hat{U}_R (t_b,t_a)|\mathbf{y}}
$$

The retarded time evolution operator can be expressed in terms of the Heaviside step function

$$
  \Theta(t) := \begin{cases}
    1,\quad& t > 0 \\
    0,\quad& t \leq 0
  \end{cases}
$$

giving

$$
\begin{align*}
  \hat{U}_R (t_b,t_a) =& \Theta(t_b - t_a) \hat{U}(t_b, t_a) \\
  (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)_R =& \Theta(t_b - t_a) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)
\end{align*}
$$

Note that the derivative of the Heaviside function is given by Dirac's delta function, i.e.  $\frac{\d}{\d t}\Theta(t) = \delta(t)$. In terms of the Heaviside function, the retarded propagator satisfies the Schrödinger equations

$$
  \left[H_R(-i\hbar\nabla_{\mathbf{x}_b},\mathbf{x}_b,t_b) - i\hbar\frac{\partial}{\partial t_b}\right] (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) = -i\hbar \delta(t_b - t_a) \delta(\mathbf{x}_b - \mathbf{x}_a)
$$

The nonzero right-hand side arises from the extra term

$$
\begin{align*}
  -i\hbar \left(\frac{\partial}{\partial t_b}\Theta(t_b - t_a)\right) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) =& -i\hbar\delta(t_b - t_a) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) \\
  =& -i\hbar (\mathbf{x}_a,t_a|\mathbf{x}_b,t_a)
\end{align*}
$$

and the initial condition $K(\mathbf{x}_a,t_a;\mathbf{x}_b,t_a) = \braket{\mathbf{x}_b|\mathbf{x}_a}$ since $\hat{U}(t_a, t_a) = 1$.

If the Hamiltonian does not depend on time, the propagator depends only on the time difference $t = t_b - t_a$. The retarded propagator vanishes for $t < 0$. This property leads to a class of functions $f(t)$ with a characteristic Fourier transform of the form

$$
  \tilde{f}(E) = \int_0^\infty f(t) e^{iEt/\hbar} \;\d t
$$

which is analytic in the upper half of the complex energy plane. This analyticity property is necessary and sufficient to produce a factor $\Theta(t)$ in the inverse Fourier transform

$$
  f(t) = \frac{1}{2\pi\hbar} \int_{-\infty}^\infty \tilde{f}(E) e^{-iEt/\hbar}\;\d E 
$$

For $t < 0$, the contour integration may be closed by an infinite semicircle in the upper half-plane at no extra cost. Since the contour encloses no singularities, it can be contracted to a point, yielding $f(t) = 0$.

### Fixed-energy amplitude

The *fixed-energy amplitude* of a quantum system is defined by the Fourier transform of the retarded time evolution amplitude

$$
\begin{equation}
\begin{split}
  (\mathbf{x}_b,\mathbf{x}_a)_E =& \int_{-\infty}^\infty e^{iE(t_b - t_a)/\hbar} (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a)_R \;\d t_b \\
  =& \int_{t_a}^\infty e^{iE(t_b - t_a)/\hbar} (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) \;\d t_b
\end{split} \tag{\label{equation-11}}
\end{equation}
$$

If the Hamiltonian is time-independent, the propagator takes the form

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \braket{\mathbf{x}_b|e^{-i\hat{H}(t_b - t_a)/\hbar}|\mathbf{x}_a}
$$

In this case, the fixed-energy amplitudes are matrix element

$$
  (\mathbf{x}_b,\mathbf{x}_a)_E = \braket{\mathbf{x}_b |\hat{R}(E)|\mathbf{x}_a}
$$

of the *resolvent operator*

$$
  \hat{R}(E) = \frac{i\hbar}{E - \hat{H} + i\eta}
$$

which is the Fourier transform of the retarded time evolution operator

$$
\begin{align*}
  \hat{R}(E) =& \int_{-\infty}^\infty e^{iE(t_b - t_a)/\hbar} \hat{U}_R (t_b, t_a)\;\d t_b \\
  =& \int_{t_a}^\infty e^{iE(t_b - t_a)/\hbar} \hat{U}(t_b, t_a) \;\d t_0
\end{align*}
$$

If $\hat{H}$ has a discrete spectrum $\sigma(\hat{H}) = \Set{E_n}_{n\in\N}$ with corresponding eigenstates $\set{\ket{\psi_n}}_{n\in\N}$, the propagator has the following spectral representation

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) e^{-iE_n (t_b - t_a)/\hbar}
$$

where $\psi_n (\mathbf{x}) = \braket{\mathbf{x}|n}$ is the wave function associated with the eigenstate $\ket{\psi_n}$. Applying the Fourier transform $\eqref{equation-11}$, we obtain the fixed-energy amplitude

$$
\begin{equation}
\begin{split}
  (\mathbf{x}_b|\mathbf{x}_a)_E =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) R_n (E) \\
  =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) R_n (E) \frac{i\hbar}{E - E_n + i\eta}
\end{split}\tag{\label{equation-12}}
\end{equation}
$$

The time evolution amplitude is recovered by the inverse Fourier transform

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \frac{1}{2\pi\hbar}\int_{-\infty}^\infty e^{-iE(t_b - t_a)/\hbar} (\mathbf{x}_a|\mathbf{x}_b)_E \;\d E
$$

The small $i\eta$-shift in the energy $E$ in $\eqref{equation-12}$ can be thought of as being attached to each of the energies $E_n$, which are thus placed by an infinitesimal piece below the real energy axis. This makes the exponential behaviour of the wave functions slighty damped, vanishing at infinite time, i.e. $e^{-i(E_n - i\eta)t/\hbar} \xrightarrow{t\to\infty} 0$.

If the eigenstates are nondegenerate, the residues at the poles of $\eqref{equation-12}$ render directly the products of eigenfunctions (barring degeneracies, which must be discussed separately). For a system with a continuum of energy eigenvalues, there is a cut in the complex energy plane which may be thought of as a closely spaced sequence of poles. In general, the wave functions are recovered from the discontinuity of the amplitudes $(\mathbf{x}_b|\mathbf{x}_a)_E$ across the cut, using the formula

$$
\begin{align*}
  \operatorname{disc}\left(\frac{i\hbar}{E - E_n}\right) =& \frac{i\hbar}{E - E_n + i\eta} - \frac{i\hbar}{E - E_n - i\eta} \\
  =& 2\pi\hbar\delta(E - E_n)
\end{align*}
$$

This follows from Sochocki's formula, valid inside integrals over $E$

$$
  \frac{1}{E - E_n \pm i\eta} = \frac{\mathcal{P}}{E - E_n} \mp i\pi\delta(E - E_n)
$$

where $\mathcal{P}$ indicates that the principal value of the integral has to be taken.

The energy integral over the discontinuity of the fixed-energy amplitude $\eqref{equation-12}$ reproduces the completeness relation taken between the local states $\bar{\mathbf{x}_b}$ and $\ket{\mathbf{x}_a}$

$$
\begin{equation}
\begin{split}
  \int_{-\infty}^\infty \frac{\d E}{2\pi\hbar} \operatorname{disc}(\mathbf{x}_b|\mathbf{x}_a)_E =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) \\
  =& \braket{\mathbf{x}_b|\mathbf{x}_a} = \delta^(3) (\mathbf{x}_b - \mathbf{x}_a)
\end{split}\tag{\label{equation-13}}
\end{equation}
$$

The completeness relation reflects the following property of the resolvent operator

$$
  \int_{-\infty}^\infty \frac{\d E}{2\pi\hbar} \operatorname{disc}\left(\hat{R}(E)\right) = \hat{I}
$$

If the system also possesses a continuous spectrum, the completeness relation has the form

$$
  \sum_{n\in\sigma(\hat{H})} \ket{\psi_n}\bra{\psi_n} + \int \ket{\psi_\nu}\bra{\psi_\nu}\;\d\nu = 1
$$

The continuum causes a branch cut along in the complex energy plan, such that $\eqref{equation-13}$ also includes an integral over the discontinuity along the cut.

## Heisenberg picture

The Heisenberg picture gives an alternate formulation of quantum mechanics which is more closely related to classical mechanics than the Schrödinger picture. In the Heisenberg picture of quantum mechanics, the state vectors are time-independent, with all the time dependence shifted to the operators.

In the Heisenberg picture, the canonical variables $\mathbf{p}(t)$ and $\mathbf{x}(t)$ in phase space are replaced by Heisenberg operators, denoted $\hat{\mathbf{p}}_H (t)$ and $\hat{\mathbf{x}}_H(t)$, respectively. In Cartesian coordinates, the canonical equal-time commutation rules are

$$
\begin{align*}
  [\hat{\mathbf{p}}_H (t) , \hat{\mathbf{x}}_H] =& -i\hbar \\
  [\hat{\mathbf{p}}_H (t) , \hat{\mathbf{p}}_H] =& 0 \\
  [\hat{\mathbf{x}}_H (t) , \hat{\mathbf{x}}_H] =& 0 \\
\end{align*}
$$

According to Heisenberg, classical equations involving Poisson brackets remain valied if the Poisson brackets are replace by $i/\hbar$ times the matrix commutators at equal times. The Hamilton equations of motion turn into the Heisenberg equations

$$
\begin{align*}
  \frac{\d}{\d t}\hat{\mathbf{p}}_H (t) =& \frac{i}{\hbar}[\hat{H}_H, \hat{\mathbf{p}}_H (t)] \\
  \frac{\d}{\d t}\hat{\mathbf{x}}_H (t) =& \frac{i}{\hbar}[\hat{H}_H, \hat{\mathbf{x}}_H (t)]
\end{align*}
$$

where $\hat{H} = H(\hat{\mathbf{p}}_H (t), \hat{\mathbf{x}}_H, t)$ is the Hamiltonian in the Heisenberg picture. In Hamiltonian mechanics, an arbitrary observable function $O(\mathbf{p}(t), \mathbf{x}(t), t)$ satisfies the equation of motion

$$
\begin{align*}
  \frac{\d O}{\d t} =& \nabla_\mathbf{p} H \cdot\nabla_\mathbf{x} O - \nabla_\mathbf{p} O \cdot\nabla_\mathbf{x} H + \frac{\partial O}{\partial t} \\
  =& \{H, O\} + \frac{\partial O}{\partial t}
\end{align*}
$$

The corresponding Heisenberg operator $\hat{O}_H (t) = O(\hat{\mathbf{p}}_H (t), \hat{\mathbf{x}}_H (t), t)$ satisfies

$$
  \frac{\d}{\d t}\hat{O}_H = \frac{i}{\hbar} [\hat{H}_H, \hat{O}_H] + \frac{\partial}{\partial t} \hat{O}_H
$$

These rules are called *Heisenberg's correspondence principle*.

The relation between Schrödinger's and Heisenberg's picture is provided by the time evolution operator. Let $\hat{O}(t) = O(\hat{\mathbf{p}}, \hat{\mathbf{x}}, t)$ be an arbitrart observable in the Schrödinger picture. If the states $\ket{\psi_a (t)}$ are an arbitrary complete set of solution of the Schrödinger equation, where $a$ runs through discrete and continuous indices, the operator $\hat{O}(t)$ can be specified in terms of its functional matrix elements

$$
  O_{ab} (t) = \braket{\psi_a (t)|\hat{O}(t)|\psi_b (t)}
$$

We can now use the time evolution operator $\hat{U}(t, 0)$ to go to a new time-independent basis $\ket{\psi_{H;a}}$ defined by

$$
  \ket{\psi_a (t)} = \hat{U}(t, 0) \ket{\psi_{H;a}}
$$

Likewise, we transform the Schrödinger operators of the canonical coordinates $\hat{\mathbf{p}}$ and $\hat{\mathbf{x}}$ into the time-dependent canonical Heisenberg operators $\hat{\mathbf{p}}_H (t)$ and $\hat{\mathbf{x}}_H (t)$ via

$$
\begin{align*}
  \hat{\mathbf{p}}_H (t) =& \hat{U}(t,0)^{-1} \hat{\mathbf{p}} \hat{U}(t, 0) \\
  \hat{\mathbf{x}}_H (t) =& \hat{U}(t,0)^{-1} \hat{\mathbf{x}} \hat{U}(t, 0)
\end{align*}
$$

At the time $t = 0$, the Heisenberg operators $\hat{\mathbf{p}}_H (t)$ and $\hat{\mathbf{x}}_H (t)$ coincide with the time-independent Schrödinger oeprators $\hat{\mathbf{p}}$ and $\hat{\mathbf{x}}$, respectively. An arbitrary observable $\hat{O}(t)$ is transformed into the associated Heisenberg operator as

$$
\begin{equation}
\begin{split}
  \hat{O}_H (t) =& \hat{U}^{-1}(t, t_a) O(\hat{\mathbf{p}}, \hat{\mathbf{x}}, t) \hat{U}(t, t_a) \\
  =& O(\hat{\mathbf{p}}_H (t), \hat{\mathbf{x}}_H (t), t)
\end{split}\tag{\label{equation-7}}
\end{equation}
$$

The Heisenberg matrices $O_H (t)_{ab}$ are given by

$$
  O_H (t)_{ab} = \braket{\psi_{H;a}|\hat{O}_H (t)|\psi_{H;b}}
$$

To verify that $\eqref{equation-7}$ satisfy Heisenberg's correspondence principle, we take its time derivative to get

$$
\begin{align*}
  \frac{\d}{\d t} \hat{O}_H (t) =& \left(\frac{\d}{\d t} \hat{U}^{-1} (t, t_a) \right) \hat{O}(t) \hat{U}(t, t_a) \\
  &+ \hat{U}^{-1} (t, t_a) \left(\frac{\partial}{\partial t} \hat{O}(t) \right) \hat{U}(t, t_a) \\
  &+ \hat{U}^{-1} (t, t_a) \hat{O}(t)\left(\frac{\d}{\d t} \hat{U}(t, t_a) \right)
\end{align*}
$$

which can be rearranged as

$$
\begin{align*}
  &\left[\left(\frac{\d}{\d t} \hat{U}^{-1} (t, t_a) \right)\hat{U}(t, t_a)\right] \hat{U}^{-1} (t, t_a) \hat{O}(t)\hat{U}(t, t_a) \\
  &+ \left[\hat{U}^{-1} (t, t_a) \hat{O}(t) \hat{U}(t, t_a) \right] \hat{U}^{-1} (t, t_a) \frac{\d}{\d t} \hat{U}(t, t_a) \\
  &+ \hat{U}^{-1} (t, t_a) \left(\frac{\partial}{\partial t} \hat{O}(t)\right)\hat{U}(t, t_a)
\end{align*}
$$

Using $\eqref{equation-8}$, we obtain

$$
  \frac{\d}{\d} \hat{O}_H (t) = \frac{i}{\hbar} [\hat{U}^{-1} \hat{H}\hat{U}, \hat{O}_H] + \hat{U}^{-1}\left(\frac{\partial}{\partial t} \hat{O}(t) \right)\hat{U}
$$

Inserting $\eqref{equation-7}$, we retrieve the Heisenberg equation

$$
  \frac{\d}{\d t}\hat{O}_H = \frac{i}{\hbar} [\hat{H}_H, \hat{O}_H] + \frac{\partial}{\partial t} \hat{O}_H
$$

This shows equivalence of the Heisenberg and Schrödinger pictures of quantum mechanics.

## Dirac's interaction picture

Dirac's interaction picture is an intermediate representation between the Heisenberg and Schrödinger pictures, where both the state vectors and the operators carry part of the time dependence of observables. The interaction picture is formed by splitting the Hamiltonian operator in the Schrödinger picture into two contributions

$$
  \hat{H} = \hat{H}_0 + \hat{V}
$$

where $\hat{H}_0$ is the unperturbed Hamiltonian for which the Schrödinger equation can be solved, and $\hat{V}$ is a (possibly time-dependent) interaction potential which perturbs these solutions slightly.

We remove the time evolution of the unperturbed Schrödinger solutions and define the states

$$
  \ket{\psi_I (t)} = e^{i\hat{H}_0 t/\hbar} \ket{\psi(t)}
$$

Their time evolution comes entirely from the interaction potential $\hat{V}$ and is governed by the time evolution operator

$$
\begin{equation}
  \hat{U}_I (t_b, t_a) = e^{i\hat{H}_0 t_b /\hbar} e^{-i\hat{H}(t_b - t_a)/\hbar} e^{-i \hat{H}_0 t_a /\hbar} \tag{\label{equation-10}}
\end{equation}
$$

and reads

$$
  \ket{\psi_I (t_b)} = \hat{U}_I (t_b, t_a) \ket{\psi_I (t_a)}
$$

If $\hat{V} = 0$, the states $\ket{\psi_I (t_b)}$ are time-independent and coincide with the Heisenberg states of the operator $\hat{H}_0$. The operator $\hat{U}_I (t_b, t_a)$ satisfies the equation of motion

$$
  i\hbar\frac{\partial}{\partial t_b} \hat{U}_I (t_b, t_a) = \hat{V}_I (t_b) \hat{U}_I (t_b, t_a)
$$

where $\hat{V}_I = e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar}$ is the potential in the interaction picture. This equation of motion can be turned into an integral equation

$$
\begin{align*}
  \hat{U}_I (t_b, t_a) =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} \hat{V}_I \hat{U}_I (t, t_a)\;\d t \\
  =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar} \hat{U}_I (t, t_a)\;\d t
\end{align*}
$$

This equation can be iterated to find a perturbation expansion for the operator $\hat{U}_I (t_b, t_a)$ in powers of the interaction potential

$$
\begin{align*}
  \hat{U}_I (t_b, t_a) =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar} \\
  &+ \left(-\frac{i}{\hbar}\right)^2 \int_{t_a}^{t_b} \d t \int_{t_a}^t \d t' e^{i\hat{H}_0 t/\hbar}\hat{V}e^{-i\hat{H}_0 (t - t')/\hbar} \hat{V} e^{-i\hat{H}_0 t'/\hbar} + \cdots
\end{align*}
$$

Inserting $\eqref{equation-10}$ on the left-hand side and multiplying the equation from the left by $e^{-i\hat{H}_0 t_b/\hbar}$ and from the right by $e^{i\hat{H}_0 t_a/\hbar}$, this can be rewritten as

$$
\begin{align*}
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} =& e^{-i\hat{H}_0 (t_b - t_a)/\hbar} - \frac{i}{\hbar}\int_{t_a}^{t_b} \d t e^{-i\hat{H}_0 (t_b - t)/\hbar} \hat{V} e^{-i\hat{H}_0 (t-t_a)/\hbar} \\
  &+ \left(-\frac{i}{\hbar}\right)^2 \int_{t_a}^{t_b} \d t \int_{t_a}^t \d t' e^{i\hat{H}_0 (t_b - t)/\hbar}\hat{V}e^{-i\hat{H}_0 (t - t')/\hbar} \hat{V} e^{-i\hat{H}_0 (t' - t_a)/\hbar} + \cdots
\end{align*}
$$

This expansion is seen to bee the recursive solution of the integral equation

$$
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} = e^{-i\hat{H}_0 (t_b - t_a)/\hbar} - \frac{i}{\hbar}\int_{t_a}^{t_b} e^{-i\hat{H}_0 (t_b - t)/\hbar} \hat{V} e^{-i\hat{H}_0 (t-t_a)/\hbar} \;\d t
$$

In terms of a time-ordering operator $\hat{T}$, the expansion can also be written as

$$
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} = e^{-i\hat{H}_0 t_b/\hbar} \hat{T} \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar}\;\d t\right)e^{i\hat{H}t_a/\hbar}
$$

which can be represented as a mathematical operator formula

$$
  e^{T(\hat{A} + \hat{B})} = \hat{T}\exp\left(\int_0^T e^{(T - t)\hat{A}} \hat{B} e^{t\hat{A}} \; \d t \right) = e^{T\hat{A}}\hat{T} \exp\left(\int_0^T e^{-t\hat{A}} \hat{B} e^{t\hat{A}} \;\d t \right)
$$

Due to the time-ordering operator, the right-hand side cannot be evaluated using Lie's expansion formula (Hadamard's lemma). The proper expression of the right-hand side is given by the Campbell-Baker-Hausdorff expansion.

# Matter wave formulation

A free particle moving in a $3$-dimensional Euclidean space with momentum $\mathbf{p}$ is described by a plane wave $\psi_\mathbf{p}: \R^3 \times\R\to\mathbb{C}$, which in Cartesian coordinates takes the form

$$
  \psi_\mathbf{p}(\mathbf{x}, t) = N e^{i(\mathbf{k}\cdot\mathbf{x} - \omega t)}
$$

where
- $\mathbf{x}\in\R^3$ is the position of the particle
- $\mathbf{k}$ is the wave vector pointing in the same direction as a $\mathbf{p}$
- $\omega$ is the wave frequency
- $N$ is a normalization constant

The square norm of the wave function describes the probability density of the particle at $\mathbf{x}$, i.e. $|\psi(\mathbf{x}, t)|^2 \;\d^3 x$ gives the probability of finding the particle in the volume element $\d^3 x$ around $\mathbf{x}$. Thus, the square norm of the wave function is normalized to unity

$$
  \int |\psi(\mathbf{r}, t)|^2 \;\d^3 x = 1
$$

The de Broglie equations relate the wavelength $\lambda$ of the particle to the modulus of the momentum $|\mathbf{p}| = mv$, and the frequency $f$ of the particle to the energy $E$

$$
\begin{align*}
  \lambda =& \frac{2\pi}{|\mathbf{k}|} = \frac{h}{p} = \frac{h}{mv} \\
  f =& \frac{\omega}{2\pi} = \frac{E}{p}
\end{align*}
$$

where $h$ is the Planck constant. Introducing the reduced Planck constant $\hbar = h/2\pi$, the equations can be written as

$$
\begin{align*}
  \mathbf{p} =& \hbar\mathbf{k} \\
  E =& \hbar\omega
\end{align*}
$$

In terms of momentum and energy, the plane wave takes the alternative form

$$
  \psi(\mathbf{x},t) = N e^{i(\mathbf{p}\cdot\mathbf{x} - E_\mathbf{p})/\hbar}
$$

The energy $E_\mathbf{p}$ depends on the momentum of the particle in the following ways
- non-relativistic particles: $E_\mathbf{p} = \mathbf{p}^2 / 2m$
- relativistic particles: $E_\mathbf{p} = c\sqrt{\mathbf{p}^2 + m^2 c^2}$
- massless particles: $E_\mathbf{p} = c|\mathbf{p}|$

In an infinite volume, the normalization constant makes the wave function vanish. This can be avoided by introducing the *current density* of the particle probability

$$
  \mathbf{j}(\mathbf{x}, t) := -i\frac{\hbar}{2m} \psi^* (\mathbf{x}, t) \overset{\leftrightarrow}{\nabla} \psi(\mathbf{x},t)
$$

where $\overset{\leftrightarrow}{\nabla}$ is short notation for the difference between forward- and backward-gradients

$$
\begin{align*}
  \psi^* (\mathbf{x}, t) \overset{\leftrightarrow}{\nabla} \psi(\mathbf{x},t) :=& \psi^* (\mathbf{x}, t) \overset{\rightarrow}{\nabla} \psi(\mathbf{x},t) - \psi^* (\mathbf{x}, t) \overset{\leftarrow}{\nabla} \psi(\mathbf{x},t) \\
  =& \psi^* (\mathbf{x}, t) \nabla \psi(\mathbf{x},t) - [\nabla\psi^* (\mathbf{x}, t)]\psi(\mathbf{x}, t)
\end{align*}
$$

A particle wave can be expressed as a superposition of plane waves in the form of a Fourier transform

$$
  \psi(\mathbf{x},t) = \frac{1}{(2\pi\hbar)^3} \int f(\mathbf{p})e^{i(\mathbf{p}\cdot\mathbf{x} - E_\mathbf{p})/\hbar}\;\d^3 p
$$

The momentum wave function $f(\mathbf{p})$ is given by the inverse Fourier transform

$$
  f(\mathbf{p}) = \int e^{i\mathbf{p}\cdot\mathbf{x}/\hbar} \psi(\mathbf{x},0)\;\d^3 r
$$

By the uncertainty principle of Fourier transformations, the position and momentum wave functions cannot both be concentrated. In general the variances of the particles position and momentum distributions are related by

$$
  \Delta\mathbf{x} \Delta\mathbf{p} \geq \frac{\hbar}{2}
$$

which is known as Heisenberg's uncertainty principle.

## Schrödinger equation

The energy of a nonrelativistic particle with momentum $\mathbf{p}$ and mass $m$ is equal to its Hamiltonian

$$
  H(\mathbf{p}) = E_\mathbf{p} = \frac{\mathbf{p}^2}{2m}
$$

This gives the following identity for the wave function $\psi_\mathbf{p}(\mathbf{x},t)$ in Cartesian coordinates

$$
  \frac{1}{(2\pi\hbar)^3} \int f(\mathbf{p})[H(\mathbf{p} - E_\mathbf{p})]e^{i(\mathbf{p}\cdot\mathbf{x} - E_\mathbf{p}t)/\hbar} \;\d^3 p = 0
$$

Substituting for the operators

$$
\begin{align*}
  \hat{\mathbf{p}} =& -i\hbar\nabla \\
  \hat{E} =& i\hbar\frac{\partial}{\partial t}
\end{align*}
$$

we get the differential equation

$$
  \left[H(-i\hbar\nabla) - i\hbar\frac{\partial}{\partial t}\right] \psi(\mathbf{p},t) = 0
$$

which is the Schrödinger equation for the wave function of a free particle. For an arbitrary Hamiltonian $\hat{H} := H(-i\hbar\nabla,\mathbf{x},t)$, the equation takes the general form

$$
  \left(\hat{H} - i\hbar\frac{\partial}{\partial t}\right)\psi(\mathbf{x},t) = 0
$$

The rule of quantizing the classical Hamiltonian $H(\mathbf{p},\mathbf{x},t)$ by the substitution $\mathbf{p}\to\hat{\mathbf{p}} = -i\hbar\nabla$ is called the correspondence principle.

### Deriving the Schrödinger equation from the classical wave equation

The scalar wave displacement $\Psi(\mathbf{x},t)$ of a non-relativistic particle with mass $m$ and speed $v$ is given by the second-order linear partial differential equation 

$$
\begin{equation}
  \frac{\partial^2 }{\partial t^2}\Psi(\mathbf{x},t) = v^2 \nabla^2 u(\mathbf{x}, t) \tag{\label{equation-10}}
\end{equation}
$$

The wave equation can be solved by separation of variables. Assuming a solution of the form $\Psi(\mathbf{x},t) = \psi(\mathbf{x})g(t)$, equation $\eqref{equation-1}$ can be written as

$$
\begin{align*}
  \frac{\partial^2}{\partial t^2} \psi(\mathbf{x})g(t) =& v^2 \nabla^2 \psi(\mathbf{x})g(t) \\
  \psi(\mathbf{x}) \frac{\partial^2}{\partial t^2} g(t) =& v^2 g(t) \nabla^2 \psi(\mathbf{x}) \\
  \frac{1}{v^2 g(t)} \frac{\partial^2}{\partial t^2} g(t) =& \frac{1}{\psi(\mathbf{x})} \nabla^2 \psi(\mathbf{x}) \tag{\label{equation-9}}
\end{align*}
$$

The separated equation $\eqref{equation-9}$ holds if and only if both sides are equal to a constant $\alpha\in\R$, i.e.

$$
\begin{aligned}
  \frac{1}{v^2 g(t)} \frac{\partial^2}{\partial t^2} g(t) =& \alpha \\
  \frac{\partial^2}{\partial t^2} g(t) =& \alpha v^2 g(t)
\end{aligned}
\quad
\begin{aligned}
  \frac{1}{\psi(\mathbf{x})} \nabla^2 \psi(\mathbf{x}) =& \alpha \\
  \nabla^2 \psi(\mathbf{x}) = \alpha \psi(\mathbf{x})
\end{aligned}
$$

The spatial equation is an eigenvalue problem with real solutions for negative eigenvalues $\alpha = -k^2$, where $k = \frac{2\pi}{\lambda}$ is the wavenumber. Using the de Broglie relation $\lambda = \frac{h}{mv}$ and the energy relation $K = \frac{1}{2}mv^2 = E -V(\mathbf{x})$, assuming energy conservation, the spatial equation can be written

$$
\begin{align*}
  \nabla^2 \psi(\mathbf{x}) =& -k^2 \psi(\mathbf{x}) \\
  \nabla^2 \psi(\mathbf{x}) =& -\frac{4\pi^2}{\lambda^2} \tag{$k = \frac{2\pi}{\lambda}$} \\
  \nabla^2 \psi(\mathbf{x}) =& -\frac{4\pi^2 m^2 v^2}{h^2} \psi(\mathbf{x}) \tag{$\lambda = \frac{h}{mv}$} \\
  \nabla^2 \psi(\mathbf{x}) =& -\frac{8\pi^2 m K}{h^2}\psi(\mathbf{x}) \tag{$K = \frac{1}{2}mv^2$} \\
  \nabla^2 \psi(\mathbf{x}) =& -\frac{8\pi^2 m}{h^2} [E - V(\mathbf{x})]\psi(\mathbf{x}) \tag{$K = E - V(\mathbf{x})$} \\
  \nabla^2 \psi(\mathbf{x}) =& -\frac{2m}{\hbar^2} [E - V(\mathbf{x})] \psi(\mathbf{x}) \tag{$\hbar = \frac{h}{2\pi}$} \\
\end{align*}
$$

Reordering the equation and introducing the Hamiltonian operator $\hat{H} = -\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{x})$, we obtain the time-independent Schrödinger equation

$$
\begin{align*}
  -\frac{\hbar^2}{2m} \nabla^2 \psi(\mathbf{x}) + V(\mathbf{x})\psi(\mathbf{x}) =& E \psi(\mathbf{x}) \\
  \left(-\frac{\hbar^2}{2m}\nabla^2 + V(\mathbf{x}) \right)\psi(\mathbf{x}) =& E \psi(\mathbf{x}) \\
  \hat{H}\psi(\mathbf{x}) =& E \psi(\mathbf{x}) \tag{\label{equation-17}}
\end{align*}
$$

Noting that $\omega = kv$, the time equation takes the form

$$
  \frac{\partial^2}{\partial^2 t} g(t) = -\omega^2 g(t)
$$

with general solution $e^{-i\omega t}$. The solution to $\eqref{equation-10}$ therefore takes the form $\Psi(\mathbf{x}, t) = \psi(\mathbf{x}) e^{-i\omega t}$. Using the Planck-Einstein relation $E = hf = h\frac{\omega}{2\pi}$ and taking the partial time derivative yields

$$
\begin{align*}
  \Psi(\mathbf{x}, t) =& \psi(\mathbf{x})e^{-i\omega t} \\
  \Psi(\mathbf{x}, t) =& \psi(\mathbf{x})e^{-i2\pi Et/h} \tag{$\omega = \frac{2\pi E}{h}$} \\
  \frac{\partial}{\partial t}\Psi(\mathbf{x}, t) =& -i\frac{2\pi E}{h} \psi(\mathbf{x})e^{-i2\pi Et/h} \\
  \frac{\partial}{\partial t}\Psi(\mathbf{x}, t) =& -i\frac{2\pi E}{h} \Psi(\mathbf{x}, t) \\
  i\frac{h}{2\pi} \frac{\partial}{\partial t}\Psi(\mathbf{x}, t) =& E\Psi(\mathbf{x}, t) \\
  i\hbar \frac{\partial}{\partial t}\Psi(\mathbf{x}, t) =& E\Psi(\mathbf{x}, t) \tag{$\hbar = \frac{h}{2\pi}$}
\end{align*}
$$

Inserting the time-independent equation $\eqref{equation-17}$, we get

$$
  i\hbar \frac{\partial\Psi}{\partial t} = {H}\Psi
$$

# Quantum operators

## Canonical commutation relations

The commutation relations of $\hat{\mathbf{x}} = (\hat{x}_x, \hat{x}_y, \hat{x}_z)$ and $\hat{\mathbf{p}} = (\hat{p}_x, \hat{p}_y, \hat{p}_z)$ are

$$
  [\hat{x}_i, \hat{x}_j] = [\hat{p}_i, \hat{p}_j] = 0, \quad [\hat{x}_i, \hat{p}_i] = i\hbar\delta_{ij}
$$

<details>
<summary>Proof</summary>

The canonical commutation relations follows directly from the definitions

$$
  \hat{x}_i = x_i,\quad \hat{p}_i = -i\hbar\frac{\partial}{\partial x_i}
$$

The commutation of position operators is

$$
  [\hat{x}_i, \hat{x}_j]\psi(\mathbf{x}) = \underbrace{(x_i x_j - x_j x_i)}_{=0} \psi(\mathbf{x}) = 0, \;\forall\psi(\mathbf{x})
$$

By equality of mixed partials, the commutation of momentum operators is

$$
  [\hat{p}_i, \hat{p}_j]\psi(\mathbf{x}) = -i\hbar\left(\frac{\partial}{\partial x_i}\frac{\partial}{\partial x_j} \frac{\partial}{\partial x_j}\frac{\partial}{\partial x_i}\right)\psi(\mathbf{x}) = 0, \;\forall\psi(\mathbf{x})
$$

Finally,

$$
\begin{align*}
  [\hat{x}_i, \hat{p}_j]\psi(\mathbf{x}) =& -i\hbar\left(x_i \frac{\partia}{\partial x_j} - \frac{\partial}{\partial x_j} x_i \right)\psi(\mathbf{x}) \\
  =& -i\hbar\left(x_i \frac{\partial\psi(\mathbf{x})}{\partial x_j} - \psi(\mathbf{x})\frac{\partial x_i}{\partial x_j} - x_i \frac{\partial \psi(\mathbf{x})}{\partial x_j} \right) \\
  =& i\hbar\psi(\mathbf{x}) \frac{\partial x_i}{\partial x_j} = i\hbar_{ij} \psi(\mathbf{x}), \;\forall\psi(\mathbf{x})
\begin{align*}
$$


</details>

where $\delta_{ij}$ is the Kronecker delta. These are known as the *canonical commutation relations*.

## Orbital angular momentum

In classical mechanics, the angular momentum of a particle with momentum $\mathbf{p}$ is given by $\mathbf{L} = \mathbf{r}\times\mathbf{p}$ with respect to the origin. The corresponding quantum operator is obtained by substituting $\mathbf{p} \to -i\hbar\nabla$, giving

$$
  \hat{\mathbf{L}} = \hat{\mathbf{x}} \times \hat{\mathbf{p}} = -i\hbar(\mathbf{x} \times\nabla)
$$

Since both $\hat{\mathbf{x}}$ and $\hat{\mathbf{p}}$ are Hermitian it follows that

$$
  \mathbf{L}^\dagger = (\hat{\mathbf{x}} \times \hat{\mathbf{p}})^\dagger = -\hat{\mathbf{p}}^\dagger \times \hat{\mathbf{x}}^\dagger = -\hat{\mathbf{p}} \times \hat{\mathbf{x}} = \hat{\mathbf{x}} \times \hat{\mathbf{p}} = \mathbf{L}^\dagger
$$

showing that $\mathbf{L}$ is Hermitian. In Cartesian coordinates $\mathbf{x} = (x,y,z)$, the components of $\hat{\mathbf{L}}$ are given by

$$
\begin{align*}
  \hat{L}_x =& \hat{x}_y \hat{p}_z - \hat{p}_y \hat{x}_z = -i\hbar\left(y \frac{\partial}{\partial z} - z \frac{\partial}{\partial y}\right) \\
  \hat{L}_y =& \hat{x}_z \hat{p}_x - \hat{p}_z \hat{x}_x = -i\hbar\left(z \frac{\partial}{\partial x} - x \frac{\partial}{\partial z}\right) \\
  \hat{L}_z =& \hat{x}_x \hat{p}_y - \hat{p}_x \hat{x}_y = -i\hbar\left(x \frac{\partial}{\partial y} - y \frac{\partial}{\partial x}\right) 
\end{align*}
$$

Using the Levi-Civita symbol, $\varepsilon_{ijk}$, this can be compactly written as

$$
  \hat{L}_i = (\hat{\mathbf{x}} \times\hat{\mathbf{p}})_i = \varepsilon_{ijk} \hat{x}_j \hat{p}_k = -i\hbar \varepsilon_{ijk} x_j \frac{\partial}{\partial x_k}
$$

The angular momentum operator obeys the commutation relations

$$
\begin{align*}
  [\hat{L}_i, \hat{L}_j] =& i\hbar\varepsilon_{ijk} L_k \\
  [\hat{L}_i, \hat{x}_j] =& i\hbar\varepsilon_{ijk}\hat{x}_k \\
  [\hat{L}_i, \hat{p}_j] =& i\hbar\varepsilon_{ijk}\hat{p}_k
\end{align*}
$$

<details>
<summary>Details</summary>

Noting that $[\hat{x}_i, \hat{p}_j] = i\hbar\delta_{ij}$ and $\varepsilon_{ijk}\varepsilon_{klm} = \delta_{il} \delta_{jm} - \delta_{im} \delta_{jl}$, we obtain

$$
\begin{align*}
  [\hat{L}_i, \hat{L}_j] =& [\varepsilon_{ikl} \hat{x}_k \hat{p}_l, \varepsilon_{jrs} \hat{x}_r \hat{p}_s] = \varepsilon_{ikl} \varepsilon_{jrs}[\hat{x}_k \hat{p}_l, \hat{x}_r \hat{p}_s] \\
  =& \varepsilon_{ikl} \varepsilon_{jrs} (\hat{x}_k [\hat{p}_l, \hat{x}_r \hat{p}_s] + [\hat{x}_k, \hat{x}_r \hat{p}_s] p_l) \\
  =& \varepsilon_{ikl} \varepsilon_{jrs} (\hat{x}_k \underbrace{[\hat{p}_l, \hat{x}_r]}_{-i\hbar\delta_{lr}} \hat{p}_s + \hat{x}_r \underbrace{[\hat{x}_k, \hat{p}_s]}_{i\hbar\delta_{ks}}\hat{p}_l) \\
  =& \varepsilon_{ikl} \varepsilon_{jrs} (-i\hbar\delta_{lr} \hat{x}_k \hat{p}_s + i\hbar\delta_{ks} \hat{x}_r \hat{p}_l) \\
  =& -i\hbar \varepsilon_{ikl} \varepsilon_{jls} \hat{x}_k \hat{p}_s + i\hbar \varepsilon_{ikl} \varepsilon_{jrk} \hat{x}_r \hat{p}_k \\
  =& -i\hbar \varepsilon_{ikl} \varepsilon_{ljs} \hat{x}_k \hat{p}_s - i\hbar \varepsilon_{jrk} \varepsilon_{kil} \hat{x}_r \hat{p}_k \\
  =& i\hbar(\delta_{ij}\delta_{ks} - \delta_{is}\delta_{jk})\hat{x}_k \hat{p}_s - i\hbar(\delta_{ji}\delta_{rl} - \delta_{jl}\delta_{ri}) \hat{x}_r \hat{p}_l \\
  =& i\hbar (\delta_ij \hat{x}_k \hat{p}_k - \hat{x}_j \hat{p}_i) - i\hbar(\delta_{ij} \hat{x}_l \hat{p}_l - \hat{x}_i \hat{p}_j) \\
  =& i\hbar (\hat{x}_i \hat{p}_j - \hat{x}_j \hat{p}_j) = i\hbar \varepsilon_{ijk} (\hat{x} \times \hat{\mathbf{p}})_k  \\
  =& i\hbar \varepsilon_{ijk} \hat{x}_j \hat{p}_k = i\hbar \varepsilon_{ijk} L_k
\end{align*}
$$

Similarly,

$$
  [\hat{L}_i, \hat{x}_j] = [\varepsilon_{ikl} \hat{x}_k \hat{p}_l, \hat{x}_j] = \varepsilon_{ikl} \hat{x}_k \underbrace{[\hat{p}_l, \hat{x}_j]}_{-i\hbar\delta_{lj}} = -\varepsilon_{ikj} \hat{x}_k = \varepsilon_{ijk} \hat{x}_k
$$

and 

$$
  [\hat{L}_i, \hat{p}_j] = [\varepsilon_{ikl} \hat{x}_k \hat{p}_l, \hat{p}_j] = -\varepsilon_{ikl} [\hat{p}_l \hat{x}_k, \hat{p}_j] = \varepsilon_{ilk} \hat{p}_k \underbrace{[\hat{x}_l, \hat{p}_j]}_{i\hbar\delta_{lj}} = \varepsilon_{ijk} \hat{p}_k
$$
</details>

The components of $\hat{\mathbf{L}}$ are incompatible observables with uncertainty

$$
  \sigma_{\hat{L}_i} \sigma_{\hat{L}_j} \geq \left(\frac{1}{2i} \langle [\hat{L}_i, \hat{L}_j] \rangle \right) = \left(\frac{1}{2i} \langle i\hbar\hat{L}_k \rangle \right) = \frac{\hbar}{2} \langle \hat{L}_k \rangle
$$

The cross product of $\hat{\mathbf{L}}$ with itself is 

$$
\begin{align*}
  (\hat{\mathbf{L}}\times\hat{\mathbf{L}})_i =& -(\hat{\mathbf{L}}\times\hat{\mathbf{L}})_i + \varepsilon_{ijk} [\hat{L}_j, \hat{L}_k] \\
  =& \frac{i\hbar}{2} \varepsilon_{jki} \varepsilon_{jkm} \hat{L}_m \\
  =& \frac{i\hbar}{2}(\delta_{kk}\delta_{im} - \delta_{km} \delta_{ik}) \hat{L}_m \\
  =& \frac{i\hbar}{2}(\hat{L}_i - \delta_{ik} \hat{L}_k) \\
  =& i\hbar\hat{L}_i 
\end{align*}
$$

or

$$
  \hat{\mathbf{L}}\times\hat{\mathbf{L}} = i\hbar\hat{\mathbf{L}}
$$

The squre of the total angular momentum operator $\hat{L}^2 = \hat{\mathbf{L}}\cdot\hat{\mathbf{L}} = \sum_{i=1}^3 \hat{L}_i^2$ is a Hermitian operator that commutes with any one of the components of $\hat{\mathbf{L}}$

$$
  [\hat{L}^2, \hat{L}_i] = 0
$$

<details>
<summary>Proof</summary>

The momentum squared is $\hat{L}^2 = \hat{\mathbf{L}}\cdot\hat{\mathbf{L}}$ and therefore

$$
  [\hat{L}^2, \hat{L}_j] = [\hat{L}_i \hat{L}_i, \hat{L}_j] = \hat{L}_i [\hat{L}_i, \hat{L}_j] + [\hat{L}_i, \hat{L}_j]\hat{L}_i = i\hbar\varepsilon_{ijk}\hat{L}_i \hat{L}_k + i\hbar\varepsilon_{ijk}\hat{L}_k \hat{L}_i
$$

Since

$$
  \varepsilon_{ijk} \hat{L}_k \hat{L}_i = \varepsilon_{kji} \hat{L}_i \hat{L}_k = \varepsilon_{ijk}\hat{L}_i \hat{L}_k
$$

It follows that

$$
  [\hat{L}^2, \hat{L}_j] = 0
$$
</details>

This means that $\hat{L}^2$ is compatible with any one of the components of $\hat{\mathbf{L}}$. 

### Derivation of eigenvalues using ladder operators

The simultaneous eigenvalues of $\hat{L}^2$ and $\hat{L}_z$ can be determined algebraically using ladder operators

$$
\begin{align*}
  \hat{L}_+ =& \hat{L}_x + i \hat{L}_y \\
  \hat{L}_i =& \hat{L}_x - i \hat{L}_y = \hat{L}_+^\dagger
\end{align*}
$$

Since both $\hat{L}_x$ and $\hat{L}_y$ commute with $\hat{L}^2$, it follows that

$$
\begin{equation}
  [\hat{L}^2, \hat{L}_\pm] = [\hat{L}^2, \hat{L}_x] + i[\hat{L}^2, \hat{L}_y] = 0 \tag{\label{equation-22}}
\end{equation}
$$

The commutation of $\hat{L}_\pm$ with $\hat{L}_z$ is

$$
\begin{equation}
\begin{split}
  [\hat{L}_z, \hat{L}_{\pm}] =& [\hat{L}_z, \hat{L}_x] \pm i[\hat{L}_z, \hat{L}_y] \\
  =& i\hbar\hat{L}_y \pm i(-i\hbar\hat{L}_x) \\
  =& \pm\hbar (\hat{L}_x \pm i\hat{L}_y) = \pm\hbar\hat{L}_\pm 
\end{split}  
\tag{\label{equation-23}}
\end{equation}
$$

and

$$
  [\hat{L}_z, \hat{L}_\pm^2] = \hat{L}_\pm [\hat{L}_z, \hat{L}_\pm] + [\hat{L}_z, \hat{L}_\pm]\hat{L}_\pm = \pm 2\hbar\hat{L}_\pm^2
$$

Inductively, it follows that

$$
\begin{equation}
  [\hat{L}_z, \hat{L}_\pm^k] = \pm k\hbar\hat{L}_\pm^k,\; k\in\N_+ \tag{\label{equation-24}}
\end{equation}
$$

Furthermore, the ladder operators satisfy

$$
\begin{align*}
  \hat{L}_\pm \hat{L}_\mp =& (\hat{L}_x \pm i\hat{L}_y)(\hat{L}_x \mp i\hat{L}_y) \\
  =& \hat{L}_x^2 + \hat{L}_y^2 \mp i(\hat{L}_x \hat{L}_y - \hat{L}_y \hat{L}_z) \\
  =& \hat{L}^2 - \hat{L}_z \mp i[\hat{L}_x, \hat{L}_y] = \hat{L}^2 - \hat{L}_z \mp i\hbar\hat{L}_z
\end{align*}
$$

or

$$
\begin{equation}
  \hat{L}^2 = \hat{L}_\pm \hat{L}_\mp + \hat{L}_z^2 \mp \hbar\hat{L}_z \tag{\label{equation-26}}
\end{equation}
$$

Since each $\hat{L}_i$ and $\hat{L}^2$ are compatible, we can simultaneously diagonalize them. If $\ket{\psi}$ is a simulatenous eigenstate of $\hat{L}^2$ and $\hat{L}_z$, we get the eigenvalue equations

$$
  \hat{L}^2 \ket{\psi} = \lambda\ket{\psi},\quad \hat{L}_z \ket{\psi} = \mu\ket{\psi}
$$

requiring

$$
\begin{equation}
\begin{split}
  \lambda =& \langle L^2 \rangle = \underbrace{\langle L_x^2 \rangle}_{\geq 0} + \underbrace{\langle L_y^2 \rangle}_{\geq 0} + \underbrace{\langle L_z^2 \rangle}_{=\mu^2} \\
  =& \langle L_x^2 \rangle + \langle L_y^2 \rangle + \mu^2 \geq \mu^2
\end{split}
\tag{\label{equation-25}}
\end{equation}
$$

Letting $\hat{L}_\pm$ act on $\ket{\psi}$ and applying $\eqref{equation-22}$ we find 

$$
  \hat{L}^2 (\hat{L}_\pm \ket{\psi}) = \hat{L}_\pm (\hat{L}^2 \ket{\psi}) = \hat{L}_\pm (\lambda\ket{\psi}) = \lambda (\hat{L}_\pm \ket{\psi})
$$

showing that $\hat{L}_\pm \ket{\psi}$ is an eigenfunction of $\hat{L}^2$ sharing the same eigenvalue $\lambda$. Similarly, applying $\eqref{equation-23}$ we obtain

$$
\begin{align*}
  \hat{L}_z (\hat{L}_\pm \ket{\psi}) =& (\hat{L}_z \hat{L}_\pm - \hat{L}_\pm \hat{L}_z)\ket{\psi} + \hat{L}_\pm \hat{L}_z \ket{\psi} \\
  =& \pm\hbar\hat{L}_\pm \ket{\psi} + \hat{L}_\pm (\mu\ket{\psi}) \\
  =& (\mu \pm \hbar)(\hat{L}_\pm \ket{\psi})
\end{align*}
$$

showing that $\hat{L}_\pm$ raises or lowers the the eigenvalue of $\hat{L}_z$ by one unit of $\hbar$. In general, from $\eqref{equation-24}$ we see that

$$
\begin{align*}
  \hat{L}_z (\hat{L}_\pm^k \ket{\psi}) =& \hat{L}_\pm^k (\hat{L}_z \ket{\psi}) \pm k\hbar \hat{L}_\pm^k \ket{\psi} \\
  =& (\mu\pm k\hbar) \hat{L}_\pm^k \ket{\psi}
\end{align*}
$$

This shows that $\hat{L}_\pm^k \ket{\psi}$ is a simultaneous eigenfunction of both $\hat{L}^2$ and $\hat{L}_z$ with corresponding eigenvalues $\lambda$ and $\mu\pm k\hbar$. Thus, starting from a state $\ket{\psi}$ with a $\hat{L}^2$ eigenvalue $\lambda$ and a $\hat{L}_z$ eigenvalue $\mu$, we can repeatedly apply $\hat{L}_+$ to construct an ascending sequence of eigenstates with $\hat{L}_z$ eigenvalues $\mu, \mu + \hbar, \mu + 2\hbar, \dots$. Similarly, we can apply $\hat{L}_-$ to construct a descending sequence $\mu, \mu - \hbar, \mu - 2\hbar$. Since the $\hat{L}^2$ eigenvalue is preserved, it follows from $\eqref{equation-25}$ that both sequences must terminate.

If we let the upper and lower $\hat{L}_z$ eigenvalue be $\hbar n_\text{u}$ and $\hbar n_\text{l}$, respectively, we have

$$
  \hat{L}_z \ket{\psi_\text{u}} = \hbar n_\text{u} \ket{\psi_\text{u}},\quad \hat{L}_z \ket{\psi_\text{l}} = -\hbar n_\text{l} \ket{\psi_\text{l}}
$$

with

$$
\begin{equation}
  \hat{L}_+ \ket{\psi_\text{u}} = 0 = \hat{L}_- \ket{\psi_\text{l}} \tag{\label{equation-27}}
\end{equation}
$$

From $\eqref{equation-25}$, we must have $n_\text{u}^2 \leq \lambda$ and $n_\text{l}^2 \leq \lambda$. By construction, there must be a natural number $N\in\N$ of steps from $-n_\text{l}$ ot $n_\text{u}$, i.e.

$$
\begin{equation}
  n_\text{l} + n_\text{u} = N \in\N \tag{\label{equation-28}}
\end{equation}
$$

Applying $\eqref{equation-26}$ for $\hat{L}_- \hat{L}_+$, we obtain

$$
  \hat{L}^2 \ket{\psi_\text{u}} = \hat{L}_- \hat{L}_+ \ket{\psi_\text{u}} + (\hat{L}_z^2 + \hbar\hat{L}_z)\ket{\psi_\text{u}}
$$

Then by $\eqref{equation-27}$, this becomes

$$
  \lambda \ket{\psi_\text{u}} = \hbar^2 n_\text{u} (n_\text{u} + 1) \ket{\psi_\text{u}} \implies \lambda = \hbar^2 n_\text{u} (n_\text{u} + 1)
$$

Similarly, applying $\eqref{equation-26}$ for $\hat{L}_+ \hat{L}_-$, we obtain

$$
  \hat{L}^2 \ket{\psi_\text{l}} = \hat{L}_+ \hat{L}_- \ket{\psi_\text{l}} + (\hat{L}_z^2 - \hbar\hat{L}_z) \ket{\psi_\text{l}}
$$

or

$$
  \lambda \ket{\psi_\text{l}} = \hbar^2 n_\text{l} (n_\text{l} + 1) \ket{\psi_\text{l}} \implies \lambda = \hbar^2 n_\text{l} (n_\text{l} + 1)
$$

Equating both equations for $\lambda$ and using $\eqref{equation-28}$, we conclude that

$$
  n_\text{u} = n_\text{l} = \frac{N}{2} := \ell \in \N/2
$$

where $\ell$ is either integral or half-integral, depending on whether $N$ is even or odd. In either case, we finally arrive at $\lambda = \hbar^2 \ell(\ell + 1)$ where the eigenvalues of $\hat{L}_z$ range from $-\hbar\ell$ to $\hbar\ell$ in integral steps of $\hbar$. Relabeling the simultaneous eigenstates as $\ket{\ell, n}$, the eigenvalue equations can be witten

$$
\begin{align*}
  \hat{L}^2 \ket{\ell, n} =& \hbar^2 \ell(\ell + 1) \ket{\ell, n} \\
  \hat{L}_z \ket{\ell, n} =& \hbar n \ket{\ell, n}
\end{align*}
$$

Using $\eqref{equation-26}$, we have

$$
\begin{align*}
  \Braket{\ell, n | \hat{L}_\mp \hat{L}_\pm | \ell, n } =& \Braket{\ell, n| \hat{L}^2 - \hat{L}_z^2 \mp \hbar\hat{L}_z | \ell, n} \\
  =& \hbar^2 [\ell(\ell + 1) - n^2 \mp n] \Braket{\ell, n | \ell, n} \\
  =& \hbar^2 [\ell(\ell + 1) - n(n \pm 1)] \Braket{\ell, n | \ell, n}
\end{align*}
$$

We know that $\hat{L}_\pm \ket{\ell, n}$ is proportional to $\ket{\ell, n\pm 1}$. If we assume that the $\ket{\ell, n}$ are normalized, then this equation implies that

$$
\begin{equation}
  \hat{L}_\pm \ket{\ell, n} = \hbar\sqrt{\ell(\ell + 1) - n(n \pm 1)} \ket{\ell, n\pm 1} \tag{\label{equation-28}}
\end{equation}
$$

Starting at the top state $\ket{\ell, \ell}$, we can construct all of the states $\ket{\ell,n}$ by repeatedly applying $\hat{L}_-$. We could equally start from $\ket{\ell, -\ell}$ and repeatedly apply $\hat{L}_z$ to construct the states. From $\eqref{equation-28}$, we have

$$
\begin{gather*}
  \hat{L}_- \ket{\ell,\ell} = \hbar\sqrt{\ell(\ell + 1) - \ell(\ell - 1)} \ket{\ell, \ell-1} = \hbar\sqrt{2\ell} \ket{\ell,\ell-1} \\
  \ket{\ell,\ell - 1} = \hbar^{-1} \frac{1}{\sqrt{2\ell}} \hat{L}_- \ket{\ell,\ell}
\end{gather*}
$$

Applying $\hat{L}_-$ once more

$$
\begin{align*}
  \hat{L}_-^2 \ket{\ell,\ell} =& \hbar^2 \sqrt{2\ell}\sqrt{\ell(\ell+1) - (\ell - 1)(\ell-2)}\ket{\ell,\ell-2} \\
  =& \hbar^2 \sqrt{2\ell(2\ell - 1)2}\ket{\ell,\ell-2}
\end{align*}
$$

or

$$
  \ket{\ell,\ell-2} = \hbar^{-2} \frac{1}{\sqrt{(\ell(2\ell - 1)2}} \hat{L}_-^2 \ket{\ell,\ell}
$$

Applying $\hat{L}_-$ a third time gives

$$
\begin{align*}
  \hat{L}_-^3 \ket{\ell,\ell} =& \hbar^3 \sqrt{2\ell(2\ell - 1)2}\sqrt{\ell(\ell+1) - (\ell-2)(\ell-3)} \ket{\ell,\ell-3} \\
  =& \hbar^3 \sqrt{2\ell(2\ell - 1)(2\ell - 2)2\cdot 3} \ket{\ell,\ell-3}
\end{align*}
$$

or

$$
  \ket{\ell,\ell-3} = \hbar^{-3} \sqrt{1}{\sqrt{2\ell (2\ell - 1)(2\ell -2)3!}} \hat{L}_-^3 \ket{\ell, \ell}
$$

Noting that $n = \ell - 3$ so that $3! = (\ell - n)!$ and $2\ell - 3 = 2\ell - (\ell - n) = \ell + n$, we have shown that

$$
  \ket{\ell,n} = \hbar^{n-\ell} \sqrt{\frac{(\ell + n)!}{(2\ell)!(\ell - n)!}} \hat{L}_-^{\ell - n} \ket{\ell,\ell}
$$

Starting with $\ket{\ell,-\ell}$ and repeatedly applying $\hat{L}_+$ we can show analogously that

$$
  \ket{\ell,n} = \hbar^{-n -\ell} \sqrt{\frac{(\ell - n)!}{(2\ell)!(\ell + n)!}} \hat{L}_+^{\ell + n} \ket{\ell,-\ell}
$$

### Eigenfunctions

To construct the angular momentum wave functions $\ket{\ell, n} = Y_\ell^n$, we start by writing $\hat{\mathbf{L}}$ in spherical coordinates

$$
\begin{aligned}
  x =& r \sin(\theta) \cos(\phi) \\
  y =& r \sin(\theta) \sin(\theta) \\
  z =& r \cos(\theta)
\end{aligned}
\quad
\begin{aligned}
  r =& \sqrt{x^2 + y^2 + z^2} \\
  \theta =& \arccos(z / r) \\
  \phi =& \arctan(y / x)
\end{aligned}
$$

The gradient in spherical coordinates is given by

$$
  \nabla = \hat{\mathbf{r}}\frac{\partial}{\partial r} + \hat{\boldsymbol{\theta}} \frac{1}{r}\frac{\partial}{\partial\theta} + \hat{\boldsymbol{\phi}}\frac{1}{r\sin\theta}\frac{\partial}{\partial\phi}
$$

so that

$$
\begin{align*}
  \hat{\mathbf{L}} =& \hat{\mathbf{x}}\times\hat{\mathbf{p}} = -i\hbar\hat{\mathbf{x}}\times\nabla \\
  =& -i\hbar r \left(\hat{\mathbf{r}}\times\hat{\mathbf{r}} \frac{\partial}{\partial r} + \hat{\mathbf{r}}\times\hat{\boldsymbol{\theta}} \frac{1}{r}\frac{\partial}{\partial\theta} + \hat{\mathbf{r}}\times\hat{\boldsymbol{\phi}} \frac{1}{r\sin\theta} \frac{\partial}{\partial\phi} \right) \\
  =& i\hbar\left(\hat{\boldsymbol{\phi}}\frac{\partial}{\partial\theta} - \hat{\boldsymbol{\theta}} \frac{1}{\sin\theta} \frac{\partial}{\partial\phi} \right)
\end{align*}
$$

The spherical unit vectors can be refactored in terms of their Cartesian components

$$
\begin{align*}
  \hat{\boldsymbol{\theta}} =& \cos(\theta)\sin(\phi)\hat{\mathbf{x}}_1 + \cos(\theta)\sin(\phi) \hat{\mathbf{x}}_2 - \sin(\phi)\hat{\mathbf{x}}_3 \\
  \hat{\boldsymbol{\phi}} =& -\sin(\phi) \hat{\mathbf{x}}_1 + \cos(\phi) \hat{\mathbf{x}}_2
\end{align*}
$$

Substituting into $\hat{\mathbf{L}}$ gives

$$
\begin{align*}
  \hat{\mathbf{L}} =& -i\hbar\left[(-\sin\phi\hat{\mathbf{x}}_1 + \cos\phi\hat{\mathbf{x}}_2) \frac{\partial}{\partial\theta} \right. \\
  &- \left. (\cos\theta \cos\phi\hat{\mathbf{x}}_1 + \cos\theta\sin\phi\hat{\mathbf{x}}_2 - \sin\theta\hat{\mathbf{x}}_3) \frac{1}{\sin\theta} \frac{\partial}{\partial\phi} \right]
\end{align*}
$$

with componentwise operators

$$
\begin{align*}
  \hat{L}_x =& i\hbar \left(\sin(\phi)\frac{\partial}{\partial\theta} + \cot(\theta)\cos(\phi) \frac{\partial}{\partial\phi} \right) \\
  \hat{L}_y =& i\hbar \left(\cot(\theta)\sin(\phi)\frac{\partial}{\partial\phi} - \cos(\phi)\frac{\partial}{\partial\theta} \right) \\
  \hat{L}_z =& -i\hbar \frac{\partial}{\partial\phi}
\end{align*}
$$

In spherical coordinates, the ladder operators become

$$
\begin{align*}
  \hat{L}_\pm =& \hat{L}_x \pm i\hat{L}_y \\
  =& -i\hbar\left[(-\sin\phi \pm i\cos\phi)\frac{\partial}{\partial\theta} - (\cos\theta \pm i\sin\phi)\cot\theta \frac{\partial}{\partial\phi} \right] \\
  =& \pm\hbar e^{\pm i\phi}\left(\frac{\partial}{\partial\theta} \pm \cot(\theta) \frac{\partial}{\partial\phi}\right) \tag{\label{equation-30}}
\end{align*}
$$

Furthermore,

$$
  \hat{L}_+ \hat{L}_- = -\hbar^2 \left(\frac{\partial^2}{\partial\theta^2} + \cot\theta\frac{\partial}{\partial\theta} + \cot^2 \theta \frac{\partial^2}{\partial\phi^2} + i\frac{\partial^2}{\partial\phi^2} \right)
$$

such that

$$
  \hat{L}^2 = -\hbar^2 \left[\frac{1}{\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \frac{1}{\sin^2 \theta}\frac{\partial^2}{\partial\phi^2} \right]
$$

The eigenfunctions $Y_\ell^n (\theta, \phi)$ can be determined from the eigenvalue equations

$$
\begin{align*}
  \hat{L}^2 Y_\ell^n =& \hbar^2 \ell (\ell + 1) Y_\ell^n \\
  \hat{L}_z Y_\ell^n =& \hbar n Y_\ell^n
\end{align*}
$$

In spherical coordinates, the $\hat{L}_z$ equation takes the form

$$
\begin{align*}
  -i\hbar \frac{\partial Y_\ell^n}{\partial\phi} =& \hbar n Y_\ell^n \\
  -i \frac{\partial Y_\ell^n}{\partial\phi} =& Y_\ell^n
\end{align*}
$$

Assuming $Y_\ell^n (\theta, \phi) = \Theta_\ell^n(\theta) \Phi_n(\phi)$ and dividing by $\Theta$, gives the ordinary differential equation

$$
  -i \frac{\partial \Phi_n}{\partial\phi} = \Phi^n
$$

with solution

$$
  \Phi_n (\phi) = \frac{1}{\sqrt{2\pi}} e^{in\phi}
$$

Physically, when $\phi$ advances by $2\pi$, the eigenfunction $Y_\ell^n$ must return to the same point in space. Thus, we require $\Phi_n (2\pi) = \Phi_n (0)$, from which we find $e^{i2\pi n} = 1$. This is satisfied for $n\in\Z$.

In spherical coordinates, the $\hat{L}^2$ equation takes the form

$$
\begin{align*}
  \left[\frac{1}{\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \frac{1}{\sin^2 \theta}\frac{\partial^2}{\partial\phi^2} \right] Y_\ell^n =& \hbar^2 \ell(\ell + 1) Y_\ell^n \\
  \left[\frac{1}{\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \ell(\ell + 1)+ \frac{1}{\sin^2 \theta}\frac{\partial^2}{\partial\phi^2} \right] Y_\ell^n =& 0
\end{align*}
$$

which can be solved by separation of variables. Assuming $Y_\ell^n (\theta, \phi) = \Theta_\ell^n(\theta) \Phi_n(\phi)$, the equation can be refactored as

$$
\begin{align*}
  \left[\frac{1}{\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \ell(\ell + 1)+ \frac{1}{\sin^2 \theta}\frac{\sqrt{2\pi}}{e^{in\phi}}\frac{1}{\sqrt{2\pi}}\smash[t]{\overbrace{\frac{\d^2 e^{in\phi}}{\d\phi^2}}^{=-n^2 e^{in\phi}}} \right] \Theta_\ell^n =& 0 \vphantom{\overbrace{\frac{\d^2 e^{in\phi}}{\d\phi^2}}^{=-n^2 e^{in\phi}}} \\
  \left[\frac{1}{\sin\theta}\frac{\partial}{\partial\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \ell(\ell + 1)- \frac{n^2}{\sin^2 \theta} \right] \Theta_\ell^n =& 0
\end{align*}
$$

Substituting $w = \cos\theta$ and $F_\ell^m (w) = \Theta_\ell^n (\theta)$ with 

$$
  \frac{\d}{\d\theta} = \frac{\d}{\d w}\frac{\d w}{\d \theta} = -\sin(\theta) \frac{\d}{\d w}
$$

and noting that

$$
\begin{align*}
  \frac{1}{\sin\theta}\frac{\d}{\d\theta}\left(\sin\theta \frac{\d}{\d\theta}\right) =& \frac{\d}{\d w} \left(\sin^2 \theta \frac{\d}{\d w} \right) \\
  =& \frac{\d}{\d w} \left[(1 - w^2)\frac{\d}{\d w}\right] \\
  =& (1 - w^2) \frac{\d^2}{\d w^2} - 2w^2 \frac{\d}{\d w}
\end{align*}
$$

we arrive at

$$
  \left[(1 - w^2) \frac{\d^2}{\d w^2} - 2w \frac{\d}{\d w} + \ell(\ell + 1) - \frac{n^2}{1 - w^2} \right] F_\ell^n (w) = 0
$$

which is known as Legendre's associated differential equation. The solutions to this equation are given by the associated Legendre functions $P_\ell^m (w)$ defined by

$$
  P_\ell^n (w) = (1 - w^2)^{|n|/2} \left(\frac{\d}{\d w}\right)^{|n|} P_\ell (w)
$$

where $P_\ell (w)$ is the $\ell$-th Legendre polynomial given by the Rodrigues formula

$$
  P_\ell (w) = \frac{1}{2^\ell \ell!} \left(\frac{\d}{\d w} \right)^\ell (w^2 - 1)^\ell
$$

Using the Rodrigues formula and integrating by parts, we can show that the associated Legendre's functions $P_\ell^n$ are orthogonal to each other

$$
  \int_{-1}^1 P_\ell^{|n|} (w) P_{\ell'}^{|n|}(w) \;\d w = \frac{2}{2\ell + 1} \frac{(\ell + |n|)!}{(\ell - |n|)!} \delta_{\ell\ell'}
$$

The corresponding physical solutions $\Theta_\ell^n (\theta)$ are given by

$$
  \theta_\ell^n (\theta) = \begin{cases}
    (-1)^n \sqrt{\frac{(2\ell + 1)}{2} \frac{(\ell - n)!}{(\ell + n)!}} P_\ell^n (\cos\theta),\quad& n\geq 0 \\
    (-1)^n \Theta_\ell^{|n|} (\theta), \quad& n < 0
  \end{cases}
$$

which are orthonormal

$$
  \int_0^\pi (\Theta_{\ell'}^n)^*(\theta) \Theta_\ell^n (\theta) \sin(\theta)\;\d\theta = \delta_{\ell\ell'}
$$

Combining the solutions for $\Theta_\ell^n$ and $\Phi_n$, we arrive at the eigenfunctions

$$
  Y_\ell^n (\theta, \phi) = \begin{cases}
    (-1)^n \sqrt{\frac{(2\ell + 1)}{2} \frac{(\ell - n)!}{(\ell + n)!}} P_\ell^n (\cos\theta) e^{in\phi},\quad& n\geq 0 \\
    (-1)^n (Y_\ell^{-n})^* (\theta), \quad& n < 0
  \end{cases}
$$

which are known as spherical harmonics. These are normaliezd to unity on a unit sphere and are orthogonal:

$$
  \int (Y_{\ell'}^{n'})^* (\theta,\phi) Y_\ell^n (\theta) \;\d\Omega = \int_0^{2\pi} \d\phi \int_0^\pi (Y_{\ell'}^{n'})^* (\theta,\phi) Y_\ell^n (\theta, \phi) \sin(\theta) \;\d\theta = \delta_{\ell\ell'} \delta_{nn'}
$$


| $\ell$ | $n$ | $Y_\ell^n (\theta, \phi)$ |
| --- | --- | --- |
| $0$ | $0$ | $Y_0^0 = \frac{1}{\sqrt{4\pi}}$ |
| $1$ | $0$ | $Y_1^0 = \left(\frac{3}{8\pi}\right)^{1/2} \cos\theta$ |
| $1$ | $\pm 1$ | $Y_1^{\pm 1} = \mp \left(\frac{3}{8\pi}\right)^{1/2} \cos(\theta) e^{\pm i\phi}$ |
| $2$ | $0$ | $Y_2^0 = \mp \left(\frac{5}{16\pi}\right)^{1/2} [3\cos^2 (\theta) - 1]$ |
| $2$ | $\pm 1$ | $Y_2^{\pm 1} = \mp \left(\frac{15}{8\pi}\right)^{1/2} \sin(\theta) \cos(\theta) e^{\pm i\phi}$ |
| $2$ | $\pm 2$ | $Y_2^{\pm 2} = \mp \left(\frac{15}{32\pi}\right)^{1/2} \sin^2(\theta) e^{\pm i2\phi}$ |
| $3$ | $0$ | $Y_3^0 = \mp \left(\frac{7}{16\pi}\right)^{1/2} [5\cos^3(\theta) - 3\cos(\theta)]$ |
| $3$ | $\pm 1$ | $Y_3^{\pm 1} = \mp \left(\frac{21}{64\pi}\right)^{1/2} \sin(\theta)[5\cos^2(\theta) - 1] e^{\pm i\phi}$ |
| $3$ | $\pm 2$ | $Y_3^{\pm 2} = \mp \left(\frac{105}{32\pi}\right)^{1/2} \sin^2(\theta) \cos(\theta) e^{\pm i2\phi}$ |
| $3$ | $\pm 3$ | $Y_3^{\pm 3} = \mp \left(\frac{35}{64\pi}\right)^{1/2} \sin^3(\theta) e^{\pm i3\phi}$ |

#### Derivation using ladder operators

We can also find the eigenfunctions $Y_\ell^n (\theta, \phi)$ using ladder operators. Starting from the definition $\hat{L}_+ Y_\ell^\ell = 0$, we have

$$
  \frac{\partial Y_\ell^\ell}{\partial\theta} + i\cot\theta \frac{\partial Y_\ell^\ell}{\partial\phi} = 0
$$

Using separation of variables with $Y_\ell^\ell (\theta,\phi) = \Theta(\theta)\Phi(\phi)$ the equation can refactored as

$$
\begin{align*}
  \Phi\frac{\partial \Theta}{\partial\theta} =& -i \Theta \cot\theta \frac{\partial \Phi}{\partial\phi} \\
  \frac{1}{\Theta\cot\theta} \frac{\partial \Theta}{\partial\theta} =& -i\frac{1}{\Phi}\frac{\partial \Phi}{\partial\phi}
\end{align*}
$$

The separated equation hold if both sides equal some constant, say $k$. In this case, the zenital equation becomes

$$
  \frac{\d \Phi}{\Phi} = ik\d\phi
$$

which has solution $\Phi(\phi) = e^{ik\phi}$ up to normalization. Since $Y_\ell^\ell$ is an eigenfunction of $L_3 = -i\hbar (\partial/\partial\phi)$ with eigenvalue $\ell\hbar$, then so is $\Phi(\phi)$ (where $\Theta(\theta)$ just cancels out). This means that

$$
  -i\hbar\frac{\partial e^{ik\phi}}{\partial\phi} = k\hbar e^{ik\phi} := \ell\hbar e^{ik\phi}
$$

showing that we must have $k = \ell$ so that, up to normalization

$$
  Y_\ell^\ell = e^{il\phi} \Theta(\theta)
$$  

With $k = \ell$, the azimuthal equation becomes

$$
  \frac{\d\Theta}{\Theta} = \ell\cot\theta \;\d\theta = \ell\frac{\cos\theta}{\sin\theta} \;\d\theta = \ell\frac{\d\sin\theta}{\sin\theta}
$$

which has solution $Theta(\theta) = \sin^\ell \theta$ up to normalization. Thus, we can write

$$
  Y_\ell^\ell = c_\ell^\ell \sin^\ell (\theta) e^{il\phi},
$$

where $c_\ell^\ell$ is a normalization constant, fixed by the requirement that

$$
\begin{equation}
  \int |Y_\ell^\ell|^2 \;\d\Omega = 2\pi |c_\ell^\ell|^2 \int_0^\pi \sin^{2\ell} (\theta) \sin(\theta) \;\d\theta = 1 \tag{\label{equation-29}}
\end{equation}
$$

where $\d\Omega = \sin(\theta) \;\d\theta \;\d\phi$. To solve the integral, we use the relation

$$
  \int \sin^n x \;\d x = -\frac{1}{n} (\sin x)^{n-1} \cos x + \frac{n - 1}{n} \int (\sin x)^{n-2} \;\d x
$$

Since the limits of integration are $0$ and $\pi$, the first term on the right side always vanishes. With $n = 2\ell + 1$ we find

$$
\begin{align*}
  \int_0^\pi (\sin x)^{2\ell + 1} \;\d x =& \frac{2\ell}{2\ell + 1} \int_0^\pi (\sin x)^{2\ell - 1} \;\d x \\
  =& \left(\frac{2\ell}{2\ell + 1}\right)\left(\frac{2\ell - 2}{2\ell - 1}\right) \int_0^\pi (\sin x)^{2\ell - 3} \;\d x \\
  =& \cdots \\
  =& \left(\frac{2\ell}{2\ell + 1}\right) \left(\frac{2\ell - 2}{2\ell - 1}\right) \left(\frac{2\ell - 4}{2\ell - 3}\right) \\
  &\times\cdots\times \left(\frac{2\ell - (2\ell - 2)}{2\ell - (2\ell - 3)} \right) \underbrace{\int_0^\pi \sin x \;\d x}_{=2} \\
  =& \frac{2^\ell \ell (\ell - 1)(\ell - 2)\cdots (\ell - (\ell - 1))}{(2\ell + 1)!!} 2 \\
  =& 2\frac{2^\ell \ell!}{(2\ell + 1)!!} = 2\frac{(2^\ell \ell!)^2}{(2\ell + 1)!}
\end{align*}
$$

where we have used the fact that

$$
\begin{align*}
  n!! =& \prod_{j=0}^{(n-1)/2} 2j + 1 = \frac{\prod_{j=0}^n j}{\prod_{j=0}^{(n-1)/2} 2j} \\
  =& \frac{\prod_{j=0}^n j}{2^{(n-1)/2} \prod_{j=0}^{(n-1)/2} j} \\
  =& \frac{n!}{2^{(n-1)/2} \left(\frac{n-1}{2}\right)!}
\end{align*}
$$

Substituting $n = 2\ell + 1$ yields

$$
  (2\ell + 1)!! = 2\frac{(2^\ell \ell!)^2}{(2\ell + 1)!}
$$

Using the results, $\eqref{equation-29}$ becomes

$$
\begin{gather*}
  4\pi |c_\ell^\ell|^2 \frac{(2^\ell \ell!)^2}{(2\ell + 1)!} = 1 \\
  c_\ell^\ell = (-1)^\ell \left[\frac{(2\ell + 1)!}{4\pi} \right]^{1/2} \frac{1}{2^\ell \ell!}
\end{gather*}
$$

where we included a conventional arbitrary phase factor $(-1)^\ell$. Putting this all together, the top orbital angular momentum becomes

$$
  Y_\ell^\ell (\theta, \phi) = (-1)^\ell \left[\frac{(2\ell + 1)!}{4\pi}\right]^{1/2} \frac{1}{2^\ell \ell!} \sin^\ell (\theta) e^{i\ell\phi}
$$

To construct the rest of the states $Y_\ell^n$, we repeatedly apply $\eqref{equation-30}$ for $\hat{L}_-$ to finally obtain

$$
\begin{align*}
  Y_\ell^n (\theta, \phi) =& (-1)^\ell \left[\frac{(2\ell + 1)!}{4\pi}\right]^{1/2} \frac{1}{2^\ell \ell!} \left[\frac{(\ell + n)!}{(2\ell)!(\ell - n)!} \right]^{1/2} \\
  &\times e^{in\phi} \sin^{-n} (\theta) \frac{\d^{\ell - n}}{\d(\cos\theta)^{\ell - n}} \sin^{2\ell} (\theta)
\end{align*}
$$

## Spin

In addition to orbital angular momentum, elementary particles also carry intrinsic angular momentum, called spin. This was originally thought be analogous to classical spin angular momentum, $\mathbf{S} = I\boldsymbol{\omega}$, associated with motion about the senter of mass. However, experiments have shown that spin is a purely quantum phenomena without a classical analogue.

The algebraic theory of the spin is the same as for orbital angular momentum operator. This means that the spin operator $\hat{\mathbf{S}}$ obeys the commutation relations

$$
  [\hat{S}_i, \hat{S}_j] = i\hbar\varepsilon_{ijk} \hat{S}_k
$$

and that the eigenvectors of $\hat{S}^2$ and $\hat{S}_z$ satisfy

$$
\begin{align*}
  \hat{\mathbf{S}}^3 \ket{s, n_s} =& \hbar^2 s(s + 1)\ket{s, n_s} \tag{\label{equation-31}} \\
  \hat{S}_z \ket{s, n_s} =& \hbar n_s \ket{s, n_s} \tag{\label{equation-32}}
\end{align*}
$$

We can also define spin ladder operators $\hat{S}_\pm = \hat{S}_x \pm i\hat{S}_y$ satisfying

$$
\begin{equation}
  \hat{S}_\pm \ket{s, n_s} = \hbar\sqrt{s(s+1) - n_s(n_s \pm 1)} \ket{s, n_s\pm 1} \tag{\label{equation-33}}
\end{equation}
$$

### Spin 1/2

For particles with spin $s = 1/2$, each component of $\hat{\mathbf{S}}$ can take two eigenstates

- Spin up: $\Ket{\frac{1}{2}, \frac{1}{2}} = \ket{\chi_+} = \ket{\uparrow}$
- Spin down: $\Ket{\frac{1}{2}, -\frac{1}{2}} = \ket{\chi_-} = \ket{\downarrow}$

An arbitrary spin state $\ket{\chi}\in\mathbb{C}^2$, called a spinor, is of the form

$$
  \ket{\chi} = a \ket{\chi_+} + b\ket{\chi_-}
$$

Because spin-1/2 particles have two possible eigenstates, a matrix representation of $\hat{\mathbf{S}}$ forms a two-dimensional space. By convention, the eigenvectors of $\hat{S}_z$ is set as the standard basis

$$
  \ket{\chi_+}_z = \left[\begin{smallmatrix} 1 \\ 0 \end{smallmatrix}\right], \quad \ket{\chi_-}_z = \left[\begin{smallmatrix} 0 \\ 1 \end{smallmatrix}\right]
$$

To find the matrix representation of $\hat{S}_z$, we know from $\eqref{equation-32}$

$$
  \hat{S}_z \ket{\chi_\pm}_3 = \pm \frac{\hbar}{2} \ket{\chi_\pm}_3
$$

so that $\hat{S}_z \in \R^{2\times 2}$ is represented by the $2\times 2$ matrix 

$$
  \hat{S}_z = \frac{\hbar}{2} \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix} = \frac{\hbar}{2} \sigma_3
$$

To find the matrix representation of $\hat{S}_x$ and $\hat{S}_y$, we know from $\eqref{equation-33}$

$$
  \hat{S}_\pm \Ket{\frac{1}{2}, n_s} = \hbar\sqrt{3/4 - n_s (n_s \pm 1)} \Ket{\frac{1}{2}, n_s \pm 1}
$$

giving

$$
\begin{aligned}
  \hat{S}_+ \ket{\chi_+}_z =& 0 \\
  \hat{S}_+ \ket{\chi_-}_z =& \hbar\ket{\chi_+}_z
\end{aligned}
\quad
\begin{aligned}
  \hat{S}_- \ket{\chi_+}_z =& \hbar\ket{\chi_-}_z \\
  \hat{S}_- \ket{\chi_-}_z =& 0
\end{aligned}
$$

Thus, the only non-zero entry in $\hat{S}_+$ is $\braket{\chi_+ | \hat{S}_+ | \chi_-}$ and the only non-zero entry in $\hat{S}_-$ is $\braket{\chi_- | \hat{S}_- | \chi_+}$, resulting in

$$
  \hat{S}_+ = \hbar\begin{bmatrix} 0 & 1 \\ 0 & 0 \end{bmatrix}, \quad \hat{S}_- = \hbar\begin{bmatrix} 0 & 0 \\ 1 & 0 \end{bmatrix}
$$

From $\hat{S}_\pm = \hat{S}_x \pm i\hat{S}_y$ we find

$$
  \hat{S}_x = \frac{\hbar}{2} \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix} = \frac{\hbar}{2} \sigma_1,\quad \hat{S}_y = \frac{\hbar}{2} \begin{bmatrix} 0 & -i \\ i & 0 \end{bmatrix} = \frac{\hbar}{2} \sigma_2
$$

With the components representation we find from $\hat{S}^2 = \hat{S}_x^2 + \hat{S}_y^2 + \hat{S}_z^2$ that

$$
  \hat{S}^2 = \frac{3}{4}\hbar^2 \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}
$$

<details>
<summary>Details</summary>

The matrix representation of $\hat{S}^2$ can also be determined from $\eqref{equation-31}$ giving

$$
  \hat{S}^2 \ket{\chi_\pm} = \frac{3}{4}\hbar^2 \ket{\chi_\pm}
$$

If we write $\hat{S}^2 = \left[\begin{smallmatrix} c & d \\ e & f \end{smallmatrix}\right]$ as a matrix with undetermined elements, the first equation says

$$
\begin{gather*}
  \begin{bmatrix} c & d \\ e & f \end{bmatrix} \cdot \begin{bmatrix} 1 \\ 0 \end{bmatrix} = \frac{3}{4}\hbar^2 \begin{bmatrix} 1 \\ 0 \end{bmatrix} \\
  \implies \begin{bmatrix} c \\ e \end{bmatrix} = \begin{bmatrix} \frac{3}{4}\hbar^2 \\ 0 \end{bmatrix}
\end{gather*}
$$

The second equation says

$$
\begin{gather*}
  \begin{bmatrix} c & d \\ e & f \end{bmatrix} \cdot \begin{bmatrix} 0 \\ 1 \end{bmatrix} = \frac{3}{4}\hbar^2 \begin{bmatrix} 0 \\ 1 \end{bmatrix} \\
  \implies \begin{bmatrix} d \\ f \end{bmatrix} = \begin{bmatrix} 0 \\ \frac{3}{4}\hbar^2 \end{bmatrix}
\end{gather*}
$$

Hence,

$$
  \hat{S}^2 = \frac{3}{4}\hbar^2 \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}
$$
</details>

Here we chose to represent the general spin $\ket{\chi}$ in terms of eigenvectors of $\hat{S}_z$, but can equally well choose another component, say $\hat{S}_x$. In this case, we diagonalize $\hat{S}_x$ and use its eigenvectors as a new basis for the spinor space. The eigenvalue equation is $(\hat{S}_x - \lambda I)\ket{\chi_+}_x = \mathbf{0}$, so in order to have a nontrivial solution, we must have

$$
  \det(\hat{S}_x - \lambda I) = \begin{vmatrix} -\lambda & \hbar/2 \\ \hbar/2 & -\lambda \end{vmatrix} = -\lambda^2 - \hbar^2 / 4 = 0 \iff \lambda_\pm = \pm \hbar/2
$$

To find the eigenvector corresponding to $\lambda_+ = \hbar/2$, we solve

$$
  (\hat{S}_x - \lambda_+ I) \ket{\chi_+}_x = \frac{\hbar}{2} \begin{bmatrix} -1 & 1 \\ 1 & -1 \end{bmatrix}\cdot\begin{bmatrix} a \\ b \end{bmatrix} = 0
$$

so that $a = b$ and the normalized eigenvector is

$$
  \ket{\chi_+}_x = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ 1 \end{bmatrix}
$$

For $\lambda_- = -\hbar/2$ we have

$$
  (\hat{S}_x - \lambda_- I) \ket{\chi_-}_x = \frac{\hbar}{2} \begin{bmatrix} -1 & 1 \\ 1 & -1 \end{bmatrix}\cdot\begin{bmatrix} c \\ d \end{bmatrix} = 0
$$

so that $c = -d$ and the normalized eigenvector is (choosing $c = 1$)

$$
  \ket{\chi_-}_x = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ -1 \end{bmatrix}
$$

Suppose we have spin state $\ket{\chi} = \left[\begin{smallmatrix} \alpha \\ \beta \end{smallmatrix}\right]$ with $\braket{\chi|\chi} = |\alpha|^2 + |\beta|^2 = 1$. In terms of the eigenspace of $\hat{S}_z$, we can write

$$
  \ket{\chi} = \alpha \ket{\chi_+}_z + \beta \ket{\chi_-}_z = \alpha\begin{bmatrix} 1 \\ 0 \end{bmatrix} + \beta\begin{bmatrix} 0 \\ 1 \end{bmatrix}
$$

so that the probability is $|\alpha|^2$ that we will measure the $z$-component of spin to be $\hbar/2$ and $|\beta|^2$ that we will measure it to be $-\hbar/2$. Alternatively, we can express $\ket{\chi}$ in terms of the eigenspace of $\hat{S}_x$

$$
  \begin{bmatrix} \alpha \\ \beta \end{bmatrix} = \frac{a}{\sqrt{2}}\begin{bmatrix} 1 \\ 1 \end{bmatrix} + \frac{b}{\sqrt{2}} \begin{bmatrix} 1 \\ -1 \end{bmatrix} = \frac{1}{\sqrt{2}}\begin{bmatrix} a + b \\ a - b \end{bmatrix}
$$

or

$$
\begin{align*}
  \alpha =& \frac{1}{\sqrt{2}}(a + b) + \frac{b}{\sqrt{2}} \\
  \beta =& \frac{1}{\sqrt{2}}(a - b)
\end{align*}
$$

Solving for $a$ and $b$, we obtain

$$
\begin{align*}
  a =& \frac{1}{\sqrt{2}} (\alpha + \beta) \\
  b =& \frac{1}{\sqrt{2}} (\alpha - \beta)
\end{align*}
$$

so that

$$
  \ket{\chi} = \frac{\alpha + \beta}{\sqrt{2}} \ket{\chi_+}_x + \frac{\alpha - \beta}{\sqrt{2}} \ket{\chi_-}_x
$$

Thus, the probability of measuring the $x$ component of spin to be $\hbar/2$ is $|\alpha + \beta|^2 / 2$ and the probability of measuring the value to be $-\hbar/2$ is $|\alpha - \beta|^2 / 2$.

#### Pauli matrices
In terms of the standard basis, it is conventional to write $\hat{\mathbf{S}}$ in terms of the Pauli matrices $\boldsymbol{\sigma}$ defined by

$$
  \hat{\mathbf{S}} = \frac{\hbar}{2}\boldsymbol{\sigma}
$$

where

$$
  \sigma_1 = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}, \quad \sigma_2 = \begin{bmatrix} 0 & -i \\ i & 0 \end{bmatrix}, \quad \sigma_2 = \begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}
$$

The Paul matrices satisfy
- $[\sigma_i, \sigma_j] = 2i\varepsilon_{ijk} \sigma_k$
- $\sigma_i \sigma_j = i\varepsilon_{ijk} \sigma_k$ for $i\neq j$
- $[\sigma_i, \sigma_j]_+ = 2I_2 \delta_{ij}$
- $\sigma_i = \sigma_j = I_2 \delta_{ij} + i\varepsilon_{ijk} \sigma_k$ 

Additionally

$$
  (\mathbf{a}\cdot\boldsymbol{\sigma})(\mathbf{b}\cdot\boldsymbol{\sigma}) = (\mathbf{a}\cdot\mathbf{b})I_2 + i(\mathbf{a} \times \mathbf{b})\cdot\boldsymbol{\sigma}
$$

## Total angular momentum

The total angular momentum of a quantum particle, $\hat{\mathbf{J}}$, is the sum of its orbital angular momentum $\hat{\mathbf{L}}$ and spin $\hat{\mathbf{S}}$, i.e.

$$
  \hat{\mathbf{J}} = \hat{\mathbf{L}} + \hat{\mathbf{S}}
$$

The total angular momentum has the same algebraic properties as $\hat{\mathbf{L}}$ and $\hat{\mathbf{S}}$.

### Composition of angular momentum

Suppose we have two particles with independent total angular momentum $\hat{\mathbf{J}}_1$ and $\hat{\mathbf{J}}_2$. The resulting angular momentum of the system is $\hat{\mathbf{J}} = \hat{\mathbf{J}}_1 + \hat{\mathbf{J}}_2$. Each particle's angular momentum operator satifies the commutation relation

$$
  [\hat{J}_{ai}, \hat{J}_{aj}] = i\hbar\varepsilon_{ijk} J_{ak},\; a\in\set{1,2}
$$

with corresponding eigenstate $\ket{j_a, n_a}$. Since we assume that $[\hat{\mathbf{J}}_1, \hat{\mathbf{J}}_2] = 0$, it follows that $\hat{\mathbf{J}}$ obeys the commutation relation 

$$
\begin{align*}
  [\hat{J}_i, \hat{J}_j] =& [\hat{J}_{1i} + \hat{J}_{2i}, \hat{J}_{1j} + \hat{J}_{2j}] = [\hat{J}_{1i}, \hat{J}_{1j}] + [\hat{J}_{2i}, \hat{J}_{2j}] \\
  =& i \varepsilon_{ijk} \hat{J}_{1k} + i \varepsilon_{ijk} \hat{J}_{2k} = i \varepsilon_{ijk} (\hat{J}_{1k} + \hat{J}_{2k}) \\
  =& i \varepsilon_{ijk} \hat{J}_k
\end{align*}
$$

showing that $\hat{\mathbf{J}}$ is an angular momentum operator with eigenstates $\ket{j,n}$ satisfying 

$$
\begin{align*}
  \hat{J}^2 \ket{j, n} =& \hbar^2 j(j + 1)\ket{j, n} \\
  \hat{J}_z \ket{j, n} =& \hbar n \ket{j, n} \\
  \hat{J}_\pm \ket{j, n} =& \hbar\sqrt{j(j + 1) - n(n \pm 1)} \ket{j, n \pm 1}
\end{align*}
$$

From $[\hat{\mathbf{J}}_1, \hat{\mathbf{J}}_2] = 0$, it follows that $[\hat{\mathbf{J}}_1^2, \hat{\mathbf{J}}_2^2] = 0$, and since $[\hat{J}_a^2, \hat{J}_{az}] = 0$, we see that we can choose our states to be simultaneous eigenstates of $\hat{J}_1^2$, $\hat{J}_2^2$, $\hat{J}_{1z}$ and $\hat{J}_{2z}$. An obvious basis for the resulting product space is given by

$$
  \ket{j_1 j_2, n_1, n_2} := \ket{j_1, n_1} \otimes \ket{j_2, n_2}
$$

Alternatively, we can choose our states to be simultaneous eigenstates of $\hat{J}^2$, $\hat{J}_1^2$, $\hat{J}_2^2$ and $\hat{J}_z$. Since $\hat{\mathbf{J}}$ is an angular momentum operator, it follows that $[\hat{J}^2, \hat{J}_z] = 0$. The fact that $[\hat{J}_a^, \hat{J}_z] = 0$ follows because $\hat{\mathbf{J}}_a$ is an angular momentum operator, $\hat{J}_z = \hat{J}_{1z} + \hat{J}_{2z}$ and $[\hat{\mathbf{J}}_1, \hat{\mathbf{J}}_2] = 0$. To show that $[\hat{J}^2, \hat{J}_a^2] = 0$, we note that

$$
\begin{align*}
  \hat{J}^2 =& (\hat{\mathbf{J}}_1 + \hat{\mathbf{J}}_2)^2 \\
  =& \hat{J}_1^2 + \hat{J}_2^2 + 2\hat{\mathbf{J}}_1 \cdot \hat{\mathbf{J}}_2 \\
  =& \hat{J}_1^2 + \hat{J}_2^2 + 2(\hat{J}_{1x} \hat{J}_{2x} + \hat{J}_{1y} \hat{J}_{2y} + \hat{J}_{1z} \hat{J}_{2z})
\end{align*}
$$

It follows that $[\hat{J}^2, \hat{J}_a^2] = 0$ because $[\hat{\mathbf{J}}_1, \hat{\mathbf{J}}_2] = 0$ and $[\hat{J}_a^2, \hat{J}_{ai}] = 0$ for $i = x,y,z$. We denote these simultaneous eigenstates by $\ket{j_1 j_2 j n}$. Although $[\hat{J}^2, \hat{J}_z] = 0$, we have on the other hand $[\hat{J}^2, \hat{J}_{az}] \neq 0$. This means that we cannot specify $\hat{J}^2$ in the states $\ket{j_1 j_2, n_1, n_2}$ and we cannot specify either $\hat{J}_{1z}$ or $\hat{J}_{2z}$ in the states $\ket{j_1 j_2 j n}$.

<details>
<summary>Details</summary>

Written as a tensor product, the total angular momentum operator takes the form

$$
  \hat{\mathbf{J}} = \hat{\mathbf{J}}_1 \otimes \mathbf{1}_2 + \hat{\mathbf{1}}_1 \otimes \hat{\mathbf{J}}_2
$$

Letting $\hat{J}_z$ act on the two-particle sates, we get

$$
\begin{align*}
  \hat{J}_z (\ket{j_1, n_1} \otimes \ket{j_2, n_2}) =& [\hat{J}_{1z} \otimes 1 + 1 \otimes \hat{J}_{2z}](\ket{j_1, n_1} \times \ket{j_2, n_2}) \\
  =& J_{1z} \ket{j_1, n_1} \otimes\ket{j_2, n_2} + \ket{j_1, n_2} \otimes\hat{J}_{2z} \ket{j_2, n_2} \\
  =& \hbar(n_1 + n_2) (\ket{j_1, n_1}\otimes\ket{j_2, n_2})
\end{align*}
$$
</details>

To find the interval of possible $j$ valies, we know that $n_1 \leq |j_1|$ and $n_2 \leq |j_2|$. Thus, from $n = n_1 + n_2$, the maximum value of $n$ must be $j_1 + j_2$. Since $n \leq |j|$, it follows that the maximum value of $j$ is $j_1 + j_2$. Corresponding to this maximum value $j_1 + j_2$ of $j$, we have a multiplet of $2(j_1 + j_2) + 1$ vales of $n$, i.e. $n \leq |j_1 + j_2|$. The total number of possible $n_1 + n_2 = n$ values is $(2j_1 + 1)(2j_2 + 1)$. For each natural number $k\in\N$, the state with $j = j_1 + j_2 - k$ contains $2(j_1 + j_2 - k) + 1$ values of $n$, subject to the constraint

$$
\begin{equation}
  \sum_{k=0}^b [2(j_1 + j_2 - k) + 1] = (2j_1 + 1)(2j_2 + 1) \tag{\label{equation-36}}
\end{equation}
$$

where the minimum value is $j_\text{min} = j_1 + j_2 - b$. Recalling the formula

$$
  \sum_{k=n}^m k = \frac{m - n + 1}{2}(m + n)
$$

we have

$$
\begin{align*}
  \sum_{k=0}^b [2(j_1 + j_2 - k) + 1] =& 2(j_1 + j_2)(b + 1) - 2\sum_{k=0}^b k + (b + 1) \\
  =& 2(j_1 + j_2)(b + 1) - (b + 1)b + (b + 1) \\
  =& (b + 1)[2(j_1 + j_2) + 1 - b]
\end{align*}
$$

Then $\eqref{equation-36}$ becomes

$$
\begin{gather*}
  (b + 1)[2(j_1 + j_2) + 1 - b] = (2j_1 + 1)(2j_2 + 1) \\
  \implies b^2 - 2(j_1 + j_2)b + 4j_1 j_2 = 0
\end{gather*}
$$

Solving for $b$ using the quadratic formula yields

$$
\begin{align*}
  b =& (j_1 + j_2) \pm \sqrt{(j_1 + j_2)^2 - 4j_1 j_2} \\
  =& (j_1 + j_2) \pm (j_1 - j_2)
\end{align*}
$$

so that $b = 2j_1$ or $b = 2j_2$ giving $j_\text{min} = j_2 - j_1$ or $j_\text{min} = j_1 - j_2$. If $j_1 \neq j_2$, then one of these is negative and must be rejected, and hence we conclude that $j_\text{min} = |j_1 - j_2|$. Consequently

$$
\begin{equation}
  |j_1 - j_2| \leq j \leq j_1 + j_2 \tag{\label{equation-37}}
\end{equation}
$$

### Clebsch-Gordan coefficients

If we denote the two individual momentum states by $\ket{j_a, n_a}$ for $a\in{1,2}$, then the two-particle basis states are given as the tensor product

$$
  \ket{j_1 j_2, n_1 n_2} = \ket{j_1, n_1} \ket{j_2, n_2} = \ket{j_1, n_1} \otimes \ket{j_2, n_2}
$$

In this notation, we have

$$
  (\bra{j_1, n_1}\otimes\bra{j_2, n_2})(\ket{j'_1 n'_1} \otimes \ket{j'_2, n'_2}) = \braket{j_1, n_1 | j'_1, n'_1} \braket{j_2, n_2 | j'_2, n'_2}
$$

Since these two-particle states form a complete set, we can write the total combined angular momentum states of both particles as

$$
\begin{equation}
  \ket{j_1 j_2 j n} = \sum_{\substack{j'_1 j'_2 \\ n'_1 n'_2}} \ket{j'_1 j'_2 n_1 n_2} \braket{j'_1 j'_2 n_1 n_2|j_1 j_2 j n} \tag{\label{equation-34}}
\end{equation}
$$

We now show that many of the matrix elements $\braket{j'_1 j'_2, n_1 n_2 | j_1 j_2 j n}$ vanish. For our two-particle operators with $a\in\set{1,2}$ we have

$$
\begin{align*}
  \hat{J}_a^2 \ket{j_1 j_2, n_1 n_2} =& \hbar^2 j_a (j_a + 1) \ket{j_1 j_2, n_1 n_2} \\
  \hat{J}_{az}^2 \ket{j_1 j_2, n_1 n_2} =& \hbar n_a \ket{j_1 j_2, n_1 n_2}
\end{align*}
$$

Taking the matrix element of $\hat{J}_1^2$ acting to both the left and right, we see that

$$
\begin{align*}
  \braket{j'_1 j'_2, n_1 n_2|\hat{J}_1^2 | j_1 j_2 j n} =& \hbar^2 j'_1 (j'_1 + 1) \braket{j'_1 j'_2, n_1 n_2 | j_1 j_2 j n} \\
  =& \braket{j'_1 j'_2, n_1 n_2| j_1 j_2 j n} \hbar^2 j_1 (j_1 + 1)
\end{align*}
$$

or

$$
  [j'_1 (j'_1 + 1) - j_1 (j_1 + 1)] \braket{j'_1 j'_2, n_1 n_2 | j_1 j_2 j n} = 0
$$

Since this result clearly applies to $\hat{J}_2^2$ as well, we must have

$$
  \braket{j'_1 j'_2, n_1 n_2 | j_1 j_2 n} = 0, \; j'_1 \neq j_1 \lor j'_2 \neq j_2
$$

This simplifies $\eqref{equation-34}$ to

$$
  \ket{j_1 j_2 j n} = \sum_{n_1 n_2} \ket{j_1 j_2, n_1 n_2} \braket{j_1 j_2, n_1 n_2|j_1 j_2 j n}
$$

From $\hat{J}_z = \hat{J}_{1z} + \hat{J}_{2z}$, we can let $\hat{J}_{1z} + \hat{J}_{2z}$ act to the left and $\hat{J}_z$ act to the right so that

$$
\begin{align*}
  \braket{j_1 j_2, n_1 n_2 | \hat{J}_z | j_1 j_2 j n} =& \hbar(n_1 + n_2) \braket{j_1 j_2, n_1 n_1 | j_1 j_2 j n} \\
  =& \braket{j_1 j_2, n_1 n_2|j_1 j_2 j n} \hbar n
\end{align*}
$$

This shows that $\braket{j_1 j_2, n_1 n_2 | j_1 j_2 j n = 0}$ unless $n = n_1 + n_1$. This simplifies $\eqref{equation-34}$ to

$$
  \ket{j_1 j_2 j n} = \sum_{\substack{n_1 n_2 \\ n_1 + n_2 = n}} \ket{j_1 j_2, n_1 n_2} \braket{j_1 j_2, n_1 n_2|j_1 j_2 j n}
$$

If we regard the values of $j_1$ and $j_2$ as fixed, we can simply write the total angular momentum state as

$$
\begin{equation}
  \ket{j, n} = \sum_{\substack{n_1 n_2 \\ n_1 + n_2 = n}} \ket{n_1 n_2}\braket{n_1 n_2| j n} \tag{\label{equation-35}}
\end{equation}
$$

The complex numbers $\braket{n_1 n_2| j m}\in\mathbb{C}$ are called *Clebsch-Gordan coefficients*. Since normalized eigenfunction corresponding to distinct eigenvalues of a Hermitian opreator are orthonormal, we know that

$$
\begin{align*}
  \braket{j', n|j, n} =& \delta_{jj'} \delta_{nn'} \\
  \braket{n'_1 n'_2 | n_1 n_2} =& \delta_{n_1 n'_1} \delta_{n_2 n'_2}
\end{align*}
$$

Thus, taking the inner product of $\eqref{equation-35}$ with itself, we see that

$$
\begin{equation}
  \sum_{\substack{n_1 n_2 \\ n_1 + n_2 = n}} |\braket{n_1 n_2 | j n}|^2 = 1 \tag{\label{equation-38}}
\end{equation}
$$

A general formula for the Clebsch-Gordan coefficients is

$$
  \braket{j_1 j_2, n_1 n_2} = (-1)^{j_1 - j_2 + n} \sqrt{2j + 1} \binom{j_1 \; j_2 \; j}{n_1 \; n_2 \; -n}
$$

where

$$
\begin{align*}
  &\binom{j_2 \; j_2 \; j_3}{n_1 \; n_2 \; n_3} = \sqrt{\frac{(j_1 + j_2 - j_3)! (j_1 - j_2 + j_3)! (-j_1 + j_2 + j_3)!}{(j_1 + j_2 + j_3 + 1)!}} \\
  &\times \sqrt{(j_1 + n_1)! (j_1 - n_1)! (j_2 + n_2)! (j_2 - n_2)! (j_3 + n_3)! (j_3 - n_3)!} \\
  &\times \sum_{z\in\N} \frac{(-1)^{z + j_1 - j_2 - n_3}}{z! (j_1 + j_2 - j_3 - z)! (j_1 - m_1 - z)! (j_2 + n_2 - z)!} \\
  &\times \frac{1}{(j_3 - j_2 + n_1 + z)! (j_3 - j_1 - n_2 + z)!}
\end{align*}
$$

are the so-called $3j$-symbols. The sum is in principle infinite. However, since $j_1$, $j_2$ and $j_3$ are finite numbers, the sum truncated due to the fact that the factorial of a negative number in the term $(j_1 + j_2 - j_3 - z)!$ is infinite.

<MathBox title='Two spin-1/2 particles' boxType='example'>
Consider the case of two spin-1/2 particles with $j_1 = j_2 = 1/2$. In this case, we have $n_1 = n_2 = \pm 1/2$, so according to $\eqref{equation-37}$ we have $0 \leq j \leq 1$. For $j_\text{max} = 1$, the top state occurs for $n_1 + n_2 = 1$. Using $\eqref{equation-35}$ we get 

$$
\begin{equation}
  \ket{j=1, m=1} = \Ket{n_1=\tfrac{1}{2},n_2=\tfrac{1}{2}}\Braket{n_1=\tfrac{1}{2},n_2=\tfrac{1}{2}|j=1, n=1} \tag{\label{equation-39}}
\end{equation}
$$

and by $\eqref{equation-38}$, we must have

$$
  \left|\Braket{\tfrac{1}{2},\tfrac{1}{2}|1, 1}\right|^2 = 1
$$

This specifies the topmost state up to a phase factor. Choosing this phase to be $1$, known as the Condon-Shortley convention, $\eqref{equation-39}$ becomes

$$
\begin{equation}
  \ket{1, 1} = \Ket{\tfrac{1}{2},\tfrac{1}{2}} = \ket{\uparrow\uparrow} \tag{\label{equation-40}}
\end{equation}
$$

To construct the next lowest state, we act on the left side of $\eqref{equation-40}$ with $\hat{J}_-$ and on the right side with $\hat{J}_- = \hat{J}_{1-} + \hat{J}_{2-}$

$$
\begin{align*}
  \sqrt{2}\ket{1, 0} =& \sqrt{\frac{3}{4} + \frac{1}{4}}\left(\Ket{-\tfrac{1}{2},\tfrac{1}{2}} + \Ket{\tfrac{1}{2},-\tfrac{1}{2}} \right) \\
  \ket{1, 0} =& \frac{1}{\sqrt{2}}\left(\Ket{-\tfrac{1}{2},\tfrac{1}{2}} + \Ket{\tfrac{1}{2},-\tfrac{1}{2}} \right) \tag{\label{equation-41}}
\end{align*}
$$

Since by $\eqref{equation-35}$

$$
  \ket{1, 0} = \Ket{\tfrac{1}{2},-\tfrac{1}{2}}\Braket{\tfrac{1}{2}, -\tfrac{1}{2}|1,0} + \Ket{-\tfrac{1}{2},\tfrac{1}{2}}\Braket{-\tfrac{1}{2},\tfrac{1}{2}|1,0}
$$

we see that

$$
  \Braket{\tfrac{1}{2},-\tfrac{1}{2}|1,0} = \Braket{-\tfrac{1}{2},\tfrac{1}{2}|1,0} = \frac{1}{\sqrt{2}}
$$

Acting on $\eqref{equation-41}$ with $\hat{J}_- = \hat{J}_{1-} + \hat{J}_{2-}$ yields

$$
\begin{align*}
  \sqrt{2}\ket{1,-1} =& \frac{1}{\sqrt{2}}\left[\sqrt{\frac{3}{4} + \frac{1}{4}}\left(\Ket{-\tfrac{1}{2},-\tfrac{1}{2}} + \Ket{-\tfrac{1}{2},-\tfrac{1}{2}} \right)\right] \\
  =& \frac{1}{\sqrt{2}}\left(\ket{\downarrow\uparrow} + \ket{\uparrow\downarrow} \right)
\end{align*}
$$

or

$$
  \ket{1, -1} = \Ket{-\tfrac{1}{2},-\tfrac{1}{2}} = \ket{\downarrow\downarrow}
$$

This completes the $j=1$ multiplet, which are called the triplet states:

$$
  j = 1 : \begin{cases}
    \ket{1, 1} = \ket{\uparrow\uparrow} \\
    \ket{1, 0} = \frac{1}{\sqrt{2}}\left(\ket{\downarrow\uparrow} + \ket{\uparrow\downarrow} \right) \\
    \ket{1, -1} = \ket{\downarrow\downarrow}
  \end{cases}
$$

The triplet states are symmetric because interchanging the two particles leaves the states unchanges. For $j_\text{min} = 0$, we get from $\eqref{equation-35}$ that

$$
\begin{align*}
  \ket{0,0} =& \Ket{\tfrac{1}{2},-\tfrac{1}{2}}\overbrace{\Braket{\tfrac{1}{2},-\tfrac{1}{2}|0,0}}^{a} + \Ket{-\tfrac{1}{2},\tfrac{1}{2}}\overbrace{\Braket{-\tfrac{1}{2},\tfrac{1}{2}|0,0}}^{b} \\
  =& \Ket{\tfrac{1}{2},-\tfrac{1}{2}}a + \Ket{-\tfrac{1}{2},\tfrac{1}{2}}b
\end{align*}
$$

To solve for $a$ and $b$, we first see from $\eqref{38}$ that $a^2 + b^2 = 1$. Since $\ket{j=1,n=0}$ is orthogonal to $\ket{j=0,n=0}$, we get

$$
  0 = \ket{1,0|0,0} = \frac{1}{\sqrt{2}}(a + b) \iff a = -b
$$

Thus, $2a^2 = 1$ so that $a = -b = 1/\sqrt{2}$ giving

$$
  \ket{0,0} = \frac{1}{\sqrt{2}}\left(\Ket{\tfrac{1}{2}, \tfrac{1}{2}} - \Ket{-\tfrac{1}{2},\tfrac{1}{2}} \right) = \frac{1}{\sqrt{2}}\left(\ket{\uparrow\downarrow} - \ket{\downarrow\uparrow} \right)
$$

which is called the singlet state. Interchanging the two particles changes the overall sign of the singlet states, showing that it is antisymmetric.
</MathBox>

# Non-relativistic quantum systems

## Free particle

A particle with no forces acting on it is called a free particle. This means that the particle moves in the absence of any potential. Classically, a free particle is moving at constant velocity. In quantum mechanics, the stationary position wavefunction $\psi(x,0)$ of the particle is governed by the time-independent Schrödinger equation $\hat{H}\psi = E\psi$. Assuming that a free particle with mass $m$ moves in the $x$-direction, the Schrödinger equation reads

$$
  -\frac{\hbar^2}{2m}\frac{\d^2 \psi}{\d x^2} = E\psi
$$

introducing $k = \sqrt{2mE}/\hbar$, this simplifies to

$$
  \frac{\d^2}{\d x^2} = -k^2 \psi
$$

with general solution

$$
  \psi(x) = Ae^{ikx} + Be^{-ikx}
$$

The wavefunction for the free particle takes the form

$$
\begin{align*}
  \Psi(x, t) =& \psi(x) e^{-iEt/\hbar} \\
  =& Ae^{ik\left(x - \hbar k t / 2m \right)} + Be^{-ik\left(x + \hbar k t / 2m \right)}
\end{align*}
$$

The two terms describe wave propagation in positive and negative $x$-direction with wave number $k$ and angular velocity $\omega = \hbar k^2 / 2m$. Letting $\mathbf{k} = k\hat{x}$, we can write the solution as

$$
  \Psi_k (\mathbf{x}, t) = Ae^{i (\mathbf{k}\cdot\mathbf{x} - \omega t )}
$$

which represents planar waves with de Broglie wavelength $\lambda = 2\pi/|k|$. According to the de Broglie formula, they carry momentum $p = \hbar k$ and energy $E = \hbar^2 k^2 / 2m$ such that the wavefunction can also be formulated

$$
  \Psi_k (\mathbf{x}, t) = Ae^{i\left(\hbar\mathbf{k}\cdot\mathbf{x} - \hbar^2 k^2 t/2m \right)/\hbar} = Ae^{i\left(\mathbf{p}\cdot\mathbf{x} - Et \right)/\hbar}
$$

The general wavefunction is given as a superposition of planar waves in the form of a integral over $k$:

$$
\begin{equation}
  \Psi (x, t) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty \phi(k) e^{i(kx - \omega t)} \;\d k \tag{\label{equation-63}}
\end{equation}
$$

where $1/\sqrt{2\pi}$ is factored out for convenience. This describes a the motion of a wave packet whose amplitude is modulated by $\phi$. Noting that

$$
  \Psi(x, 0) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty \phi(k) e^{ikx} \;\d x
$$

defines a Fourier transform, the coefficient function $\phi$ is given by the inverse Fourier transform

$$
  \phi(k) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty \Psi (x, 0) e^{-ikx} \;\d x
$$

A wavefunction $\Psi_k$ travels with a phase velocity given by

$$
  v_k = \frac{\hbar|k|}{2m} = \sqrt{\frac{E}{2m}}
$$

In the classical case, the particle's energy equals the its kinetic energy $E_\text{classic} = \frac{p^2}{2m} = mv^2 / 2$. This implies that the particle's velocity is twice the phace velocity.

$$
  v_\text{classic} = \sqrt{\frac{2E}{m}} = 2v_k
$$

This can be shown in the quantum case as follows. We assume that $\phi(k)$ is narrowly peaked about $k = k_0$. Since the integrand in $\eqref{equation-63}$ is negligable except in the vicinity of $k_0$, we can approximate the dispersion relation $\omega(k)$ to its first-order Taylor expansion about $k_0$:

$$
  \omega(k) \approx \omega_0 + \underbrace{\frac{\d\omega(k_0)}{\d k}}_{\omega'_0} (k - k_0)
$$

Changing varibles $s = k - k_0$, the wavefunction is approximated by

$$
\begin{align*}
  \Psi(x, t) \approx& \frac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty \phi(k_0 + s) e^{i[(k_0 + s)x - (\omega_0 + \omega'_0 s)t]} \;\d s \\
  =& \frac{1}{\sqrt{2\pi}} e^{i(k_0 x - \omega_0 t)} \int_{-\infty}^\infty \phi(k_0 + s) e^{is(x - \omega'_0 t)} \;\d s
\end{align*}
$$

The exponential coefficient is sinusoidal wave traveling at phase velocity

$$
  v_\text{phase} = \omega / k = \frac{\hbar k^2}{2m} 
$$

It is modulated by a wave packet traveling at group velocity 

$$
  v_\text{group} = \frac{\partial\omega}{\partial k} = \frac{\hbar k}{2m}
$$

showing that 

$$
  v_\text{classic} = v_\text{group} = 2v_\text{phase}
$$

### Invariance under Galilean transformations

If $\mathcal{R}$ and $\mathcal{R}'$ are two reference systems such that $\mathcal{R}'$ moves with respect to $\mathcal{R}$ with velocity $\mathbf{v}$. Assuming that the origins of the two frames coincide at time $t = 0$, the relation between the space-time coordinates in $\mathcal{R}$ and $\mathcal{R}'$ is given by the Galilean transformation

$$
\begin{align*}
  \mathbf{x} =& \mathbf{x}' + \mathbf{v}t \\
  t =& t'
\end{align*}
$$

where $\mathbf{x}$ and $\mathbf{x}'$ is the position of a particl in $\mathcal{R}$ and $\mathcal{R}'$, respectively. The momentum and energy of a free particle with mass $m$ get transformed as

$$
\begin{align*}
  \mathbf{p} =& \mathbf{p}' + m\mathbf{v} \\
  E =& E' + \mathbf{v} \cdot \mathbf{p}' + \frac{1}{2}m\mathbf{v}^2
\end{align*}
$$

The position wavefunction of the particle gets transformed as

$$
\begin{align*}
  \psi' (\mathbf{x}, t) =& \exp\left[\frac{i}{\hbar}(\mathbf{p}\cdot\mathbf{x} - Et)\right] \\
  =& \exp\left\{\frac{i}{\hbar} \left[(\mathbf{p} - m\mathbf{v}) \cdot (\mathbf{x} - \mathbf{v}t) + \left(E - \mathbf{v}\cdot\mathbf{p}' - \frac{1}{2}m\mathbf{v}^2 \right)t \right] \right\} \\
  =& \exp\left[\frac{i}{\hbar} \left(\mathbf{p}\cdot\mathbf{x} - Et \right) \right] \exp\left[\frac{i}{\hbar}\left(\frac{1}{2}m\mathbf{v}^2 t - m\mathbf{v}\cdot\mathbf{x} \right)\right] \\
  =& \psi(\mathbf{x}, t) \exp\left[\frac{i}{\hbar}\left(\frac{1}{2}m\mathbf{v}^2 t - m\mathbf{v}\cdot\mathbf{x} \right)\right]
\end{align*}
$$

and

$$
  \psi(\mathbf{x}, t) =& \psi' (\mathbf{x} - \mathbf{v}t, t)  \exp\left[\frac{i}{\hbar}\left(m\mathbf{v}\cdot\mathbf{x} - \frac{1}{2}m\mathbf{v}^2 t \right)\right]
$$

Consequently, the wavefunction is invariant under Galilean transformations because the attained exponential is just a phase factor that does not carry the relevant quantities of the free motion of the particle.

### Gaussian wavepacket

The time dependent Schrödinger equation for a free particle reads

$$
  i\hbar \frac{\partial \psi}{\partial t} = -\frac{\hbar^2}{2m}\frac{\partial^2 \psi}{\partial x^2}
$$

This is solved by the separable solution

$$
  \psi_k (x, t) = e^{iE_k t/\hbar}e^{ikx} \quad \forall k \in \R
$$

Although $\psi_k$ itself is non-normalisable, a valid solution can be formed from superpositions of $\psi_k$ with the Fourier transform

$$
  \psi(x, t) = \int_{-\infty}^\infty A(k) \psi_k (x,t) \d k
$$

An appropriate function for $A(k)$ is the Gaussian distribution

$$
  A(k) = \exp\left[-\frac{\left( k - k_0 \right)^2}{2\sigma} + \frac{k_0^2}{2\sigma} \right]
$$

The resulting wavefunction becomes

$$
\begin{align*}
  \psi(x, t) &= \int_{-\infty}^\infty \exp\left(-\frac{k^2 - 2kk_0}{2\sigma} - i\frac{\hbar t k^2}{2m} + ikx \right)\d k \\
  &= \int_{-\infty}^\infty \exp\left[ -\frac{\alpha}{2}\left(k - \frac{\beta}{\alpha} \right)^2 + \frac{\beta^2}{2\alpha} \right] \d k
\end{align*}
$$

with

$$
\begin{aligned}
  \alpha = \frac{1}{\sigma} + \frac{i\hbar t}{m}
\end{aligned}\quad
\begin{aligned}
  \beta = \frac{k_0}{\sigma} + ix
\end{aligned}\quad
$$

integrating gives

$$
  \psi(x, t) = \sqrt{\frac{2\pi}{\alpha (t)}}\exp\left[ -\frac{1}{2\alpha}\left( x - \frac{ik_0}{\sigma} \right)^2 \right]
$$

which is known as a Gaussian wavepacket. The probability density is given by

$$
  P(x, t) = |\psi(x, t)|^2 = \frac{2\pi C e^{k_0^2/\sigma}}{|\alpha|}\exp\left[ -\frac{1}{\sigma|\alpha|^2} \left(x - \frac{\hbar k_0 t}{m} \right)^2 \right]
$$

<details>
<summary>Details</summary>

$$
\begin{align*}
  P(x, t) = |\psi(x, t)|^2 &= \frac{2\pi C}{|\alpha|}\exp\left[-\frac{1}{2\alpha}\left( x - ik_0/\sigma \right)^2 -\frac{1}{2\alpha^*}\left( x + ik_0/\sigma \right)^2 \right] \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{2|\alpha|^2} \left[ \alpha^* \left( x - ik_0/\sigma \right)^2 + \alpha \left( x + ik_0/\sigma \right)^2 \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{2|\alpha|^2} \left[ \left(\alpha + \alpha^* \right) \left( x^2 - \frac{k_0^2}{\sigma^2} \right) + i2\left(\alpha - \alpha^* \right)k_0 x  \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{2|\alpha|^2} \left[ \frac{2}{\sigma} \left( x^2 - \frac{k_0^2}{\sigma^2} \right) - \frac{2}{\sigma}\frac{2\hbar k_0 t}{m} x \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{\sigma|\alpha|^2} \left[ \left( x^2 - \frac{k_0^2}{\sigma^2} \right) - 2\frac{\hbar k_0 t}{m} x \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{\sigma|\alpha|^2} \left[ \left( x - \frac{\hbar k_0 t}{m}\right)^2 - \frac{k_0^2}{\sigma^2} - \left(\frac{\hbar k_0 t}{m}\right)^2 \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{\sigma|\alpha|^2} \left[ \left( x - \frac{\hbar k_0 t}{m}\right)^2 - k_0^2 \left( \frac{1}{\sigma^2} + \frac{\hbar^2 t^2}{m^2}\right) \right]\right\} \\
  &= \frac{2\pi C}{|\alpha|}\exp\left\{-\frac{1}{\sigma|\alpha|^2} \left[ \left( x - \frac{\hbar k_0 t}{m}\right)^2 - k_0^2 |\alpha|^2 \right]\right\} \\
  &= \frac{2\pi C e^{k_0^2/\sigma}}{|\alpha|}\exp\left[ -\frac{1}{\sigma|\alpha|^2} \left(x - \frac{\hbar k_0 t}{m} \right)^2 \right]
\end{align*}
$$
</details>

where $C = \frac{e^{-k_0^2/\sigma}}{\sqrt{4\sigma\pi^3}}$ is the normalisation coefficient. Because $\alpha$ increases with time, the wavepacket spreads out, and because the spatial dependence is of the form $x - vt$ with $v = \frac{\hbar k_0}{m}$, it also shifts with time. This can be shown more rigorously by finding the expected value for position

$$
\begin{align*}
  \langle x \rangle &= \frac{1}{\sqrt{\pi\sigma|\alpha|^2}} \int_{-\infty}^\infty x \exp\left[-\frac{1}{\sigma|\alpha|^2}\left( x - \frac{\hbar k_0 t}{m} \right)^2 \right] \d x \\
  &= \frac{1}{\sqrt{\pi\sigma|\alpha|^2}} \int_{-\infty}^\infty \left(\tilde{x} + \frac{\hbar k_0 t}{m} \right) \exp\left( -\frac{\tilde{x}^2}{\sigma|\alpha|^2} \right)\d\tilde{x} \\
  &= \frac{\hbar k_0}{m}t
\end{align*}
$$

This suggests that the momentum is $p = mv = \hbar k_0$. This can be show by calculating the expected value for the momentum operator $p = -i\hbar\frac{\d}{\d x}$

$$
\begin{align*}
  \langle p \rangle &= -i\hbar \int_{-\infty}^\infty \d x \, \frac{\d|\psi|^2}{\d x} = -i\hbar \int_{-\infty}^\infty \d x \, \psi^* \frac{\d\psi}{\d x} \\
  &= \frac{1}{\sqrt{\pi\sigma|\alpha|^2}} \int_{-\infty}^\infty \exp\left[ -\frac{1}{2a^*} \left(x + ik_0/2 \right) \right] \cdot -i\hbar \frac{\d}{\d x} \exp\left[ -\frac{1}{2a} \left(x - ik_0/2 \right) \right] \\
  &= \frac{1}{\sqrt{\pi\sigma|\alpha|^2}} \int_{-\infty}^\infty \frac{i\hbar}{\alpha} \left(x - \frac{ik_0}{\sigma} \right) \exp\left[-\frac{1}{\sigma|\alpha|^2}\left( x - \frac{\hbar k_0 t}{m} \right)^2 \right] \d x \\
  &= \frac{1}{\sqrt{\pi\sigma|\alpha|^2}} \int_{-\infty}^\infty \frac{i\hbar k_0}{\alpha} \left(\frac{\tilde{x}}{k_0} + \frac{\hbar t}{m} - \frac{i}{\sigma} \right) \exp\left( -\frac{\tilde{x}^2}{\sigma|\alpha|^2} \right)\d\tilde{x} \\
  &= \hbar k_0
\end{align*}
$$

## Infinite potential well 

The infinite potential well is used as an ideal model to describe a spatially trapped quantum particle. This is achieved by setting

$$
  V(x) = \begin{cases} 0 &\quad 0 < x < a \\ \infty &\quad \textrm{otherwise} \end{cases}
$$

Inside the well, the time-independent Schrödinger equation is

$$
\begin{align*}
  -\frac{\hbar^2}{2m}\frac{\d^2 \psi}{\d x^2} =& E\psi \\
  \frac{\d^2 \psi}{\d x^2} =& -k^2 \psi
\end{align*}
$$

where $k = \sqrt{2mE}/\hbar$. This is the simple harmonic oscillator equation with general solution

$$
  \psi(x) = A \sin(kx) + B\cos(kx)
$$

which is the superposition of two states, with momentums $p_\pm = \pm \hbar k$. This configuration is therefore similar to that of standing waves, bouncing backwards and forwards inside the well. To ensure continuity of $\psi$, the boundary conditions are $\psi(0) = \psi(a) = 0$. The boundary condition $\psi(0) = 0$ implies $B = 0$, so that the wavefunction must be of the form

$$
  \psi(x) = A \sin(kx)
$$

The boundary conditon $\psi(a) = 0$ implies that $A = 0$, resulting in a trivial non-normalizable solution, or 

$$
  \sin(ka) = n\pi, \; n \in\Z
$$

For $k = 0$ we again get a trivial solution $\psi(x) = 0$, and for negative $k$, we can absorb the minus sign into $A$ since $\sin(-\theta) = -\sin(\theta)$. Hence,

$$
  k_n = \frac{n\pi}{a},\; n\in\N_+
$$

and the possible energy states are given by

$$
  E_n = \frac{(\hbar k_n)^2}{2m} = \frac{(\hbar \pi n)^2}{2m a^2}
$$

Normalizing $\psi$, we find

$$
  \braket{\psi|\psi} = \int_0^a |A|^2 \sin^2 (kx) \;\d x = |A|^2 \frac{a}{2} = 1 \implies |A|^2 = \frac{2}{a} 
$$

since the phase of $A$ carries no physical significance, we can set $A = \sqrt{2/a}$, giving the solutions

$$
  \psi_n (x) = \sqrt{\frac{2}{a}} \sin\left(\frac{n\pi}{a} x\right)
$$

The wavefunctions $\psi_n$ are orthonormal since

$$
\begin{align*}
  \braket{\psi_m|\psi_n} =& \int_0^a \psi_m^* (x) \psi_n (x) \;\d x = \frac{2}{a} \int_0^a \sin\left(\frac{m\pi}{a}x \right) \sin\left(\frac{n\pi}{a}x \right) \;\d x \\
  =& \frac{1}{a} \int_0^a \left[\cos\left(\frac{m - n}{a}\pi x\right) - \cos\left(\frac{m+n}{a}\pi x \right)\right] \;\d x \\
  =& \left[\frac{1}{(m - n)\pi} \sin\left(\frac{m-n}{a}\pi x\right) - \frac{1}{(m + n)\pi} \sin\left(\frac{m + n}{a} \pi x \right)\right]_0^a \\
  =& \frac{1}{\pi} \left(\frac{\sin[(m-n)\pi]}{m - n} - \frac{\sin[(m+n)\pi]}{m + n} \right) = \delta_{mn}
\end{align*}
$$

From Fourier theory, we know that $\sin(n\pi/a)$ forms a basis for the Hilbert space $L^2 ([0,a])$. This means that $\psi_n$ are complete, in the sense that any function $f(x)$ can be expressed as a linear combination

$$
  f(x) = \sum_{n=1}^\infty c_n \psi_n (x) = \sqrt{\frac{2}{a}} \sum_{n=1}^\infty c_n \sin\left(\frac{n\pi}{a}x\right)
$$

where the coefficients are given by 

$$
  c_n = \braket{\psi_n|f} = \int_0^a \psi_n^* (x) f(x) \;\d x
$$

<details>
<summary>Details</summary>

For any $\psi_m$ we have

$$
\begin{align*}
  \braket{\psi_m | f} =& \int_0^a \psi_m^* (x) f(x) \;\d x = \sum_{n=1}^\infty c_n \int_0^a \psi_m^* (x) \psi_n \;\d x \\
  =& \sum_{n=1}^\infty c_n \delta_{mn} = c_n
\end{align*}
$$
</details>

The stationary states of the infinite square well are

$$
  \Psi_n (x, t) = \psi_n (x) e^{-iEt/\hbar} = \sqrt{\frac{2}{a}} \sin\left(\frac{n\pi}{a} x \right) \exp\left(-\frac{i n^2 \pi^2 \hbar}{2ma^2}t \right)
$$

The general solution to the time-dependent Schrödinger equation for the infinite potential well is a linear combination of stationary states:

$$
  \Psi(x,t) = \sum_{n=1}^\infty c_n \sqrt{\frac{2}{a}} \sin\left(\frac{n\pi}{a} x \right) \exp\left(-\frac{i n^2 \pi^2 \hbar}{2ma^2}t \right)
$$

By the completenes of $\psi_n$ it follows that $\Psi(x, 0) = \sum_{n=1}^\infty c_n \psi_n (x)$ so that

$$
  c_n = \sqrt{\frac{2}{a}} \int_0^a \sin\left(\frac{n\pi}{a} x \right) \Psi(x, 0) \;\d x
$$

The general state $\Psi(x,t)$ is normalized since

$$
\begin{align*}
  \braket{\Psi|\Psi} =& \int \Psi^* \Psi \; \d x = \int |\psi|^2 \;\d x \\
  =& \int \left(\sum_{m=1}^\infty c_m \psi_m (x) \right)^* \left(\sum_{n=1}^\infty c_n \psi_n (x) \right) \;\d x \\
  =& \sum_{m=1}^\infty \sum_{n=1}^\infty c_m^* c_n \int \psi_m^* (x) \psi_n (x) \;\d x \\
  =& \sum_{n=1}^\infty \sum_{m=1}^\infty c_m^* c_n \delta_{mn} = \sum_{n=1}^\infty |c_n|^2
\end{align*}
$$

The expected value for the total energy is

$$
\begin{align*}
  \langle H \rangle =& \braket{\Psi|\hat{H}\Psi} = \int \Psi^* \hat{H} \Psi \;\d x = \int \left(\sum_{m=1}^\infty c_m \psi_m \right)^* \hat{H} \left(\sum_{n=1}^\infty c_n \psi_n \right) \;\d x \\
  =& \sum_{m=1}^\infty \sum_{n=1}^\infty c_m^* c_n E_n \int \psi_m^* \psi_n \;\d x = \sum_{n=1}^\infty |c_n|^2 E_n
\end{align*}
$$

## Harmonic oscillator

The classical harmonic oscillator consists of a mass $m$ attached to a spring of forces constant $k$. The oscillatory motion is given by Hooke's law

$$
  F = -kx = m \frac{\d^2 x}{\d t^2}
$$

with solution

$$
  x(t) = A\sin(\omega t) + B\cos(\omega t)
$$

where $\omega = \sqrt{k/m}$ is the angular frequency of oscillation. The potential energy has the quadratic form

$$
\begin{equation}
  V(x) = \frac{1}{2}kx^2 = \frac{1}{2}m\omega^2 x^2 \tag{\label{equation-55}}
\end{equation}
$$

The harmonic oscillator is an ideal model. However, any potential can be approximated by a parabolic function in the neighbourhood of a local minimum. The Taylor expansion of a potential $V(x)$ about a minimum $x_0$ is

$$
  V(x) = V(x_0) + \underbrace{V' (x_0)}_{=0} (x - x_0) + \frac{1}{2} V'' (x_0) (x - x_0)^2 +\cdots
$$

We are free to substract the constant $V(x_0)$ because that does not change to force. This means that

$$
  V(x) \approx \frac{1}{2} V''(x_0) (x - x_0)^2
$$

which describes simple harmonic oscillation about $x_0$ with an effective spring constant $k = V''(x_0)$.

With the quadratic potential $\eqref{equation-55}$, the Hamiltonian becomes

$$
  \hat{H} = -\frac{\hbar^2}{2m}\frac{\d^2}{\d x^2} + \frac{1}{2}m\omega^2 x^2
$$

giving the time-independent Shrödinger equation

$$
\begin{equation}
  -\frac{\hbar^2}{2m}\frac{\d^2\psi}{\d x^2} + \frac{1}{2}m\omega^2 x^2 \psi = E\psi \tag{\label{equation-56}}
\end{equation}
$$

### Algebraic method

To solve $\eqref{equation-56}$ algebraically using ladder operators, we write the Hamiltonian as

$$
  \hat{H} = \frac{1}{2m} \left[\hat{p}^2 + (m\omega x)^2 \right]
$$

We want to find operators that factor the Hamiltonian. This motivates us to define the operators

$$
  \hat{a}_\pm := \frac{1}{\sqrt{2\hbar m}} (\mp i\hbar\hat{p} + m\omega x)
$$

Calculating $\hat{a}_- \hat{a}_+$, we find

$$
\begin{align*}
  \hat{a}_- \hat{a}_+ =& \frac{1}{2\hbar m\omega} (i\hat{p} + m\omega x) (-i\hat{p} + m\omega x) \\
  =& \frac{1}{2\hbar m \omega} \left[\hat{p}^2 + (m\omega x)^2 - i m \omega (x\hat{p} - \hat{p}x)\right] \\
  =& \frac{1}{2\hbar m \omega} \left[\hat{p}^2 + (m\omega x)^2 \right] - \frac{i}{2\hbar} \underbrace{[\hat{x},\hat{p}]}_{=i\hbar} \\
  =& \frac{1}{\hbar\omega} \hat{H} + \frac{1}{2}
\end{align*}
$$

or

$$
  \hat{H} = \hbar\omega\left(\hat{a}_- \hat{a}_+ - \frac{1}{2} \right)
$$

Similarly, we find

$$
  \hat{a}_+ \hat{a}_- = \frac{1}{\hbar\omega}\hat{H} - \frac{1}{2}
$$

giving

$$
  \hat{H} = \hbar\omega\left(\hat{a}_+ \hat{a}_- + \frac{1}{2} \right)
$$

Furthermore, we note that

$$
  [\hat{a}_- \hat{a}_+] = \hat{a}_- \hat{a}_+ - \hat{a}_+ \hat{a}_- = 1
$$

In terms of $\hat{a}_\pm$, the time-independent Schrödinger equation takes the form

$$
\begin{equation}
  \hbar\omega\left(\hat{a}_\pm \hat{a}_\mp \pm \frac{1}{2}\right) \psi = E\psi \tag{\label{equation-57}}
\end{equation}
$$

Applying $\hat{H}$ to $\hat{a}_+ \psi$ and using $\hat{a}_- \hat{a}_+ = \hat{a}_+ \hat{a}_- + 1$ we get

$$
\begin{align*}
  \hat{H}(\hat{a}_+ \psi) =& \hbar\omega\left(\hat{a}_+ \hat{a}_- + \frac{1}{2} \right) (\hat{a}_+ \psi) = \hbar\omega\left(\hat{a}_+ \hat{a}_- \hat{a}_+ + \frac{1}{2}\hat{a}_+ \right)\psi \\
  =& \hbar\omega\hat{a}_+ \left(\hat{a}_- \hat{a}_+ + \frac{1}{2} \right)\psi = \hat{a}_+ \left[\hbar\omega\left(\hat{a}_+ \hat{a}_- + 1 +\frac{1}{2} \right)\psi \right] \\
  =& \hat{a}_+ (\hat{H} + \hbar\omega)\psi  = \hat{a}_+ (E + \hbar\omega)\psi = (E + \hbar\omega)(\hat{a}_+ \omega)
\end{align*}
$$

Likewise, applying $\hat{H}$ to $\hat{a}_- \psi$ and using $\hat{a}_+ \hat{a}_- = \hat{a}_- \hat{a}_+ - 1$ yields

$$
\begin{align*}
  \hat{H}(\hat{a}_- \psi) =& \hbar\omega\left(\hat{a}_- \hat{a}_+ - \frac{1}{2} \right) (\hat{a}_- \psi) = \hbar\omega\left(\hat{a}_- \hat{a}_+ \hat{a}_- - \frac{1}{2}\hat{a}_- \right)\psi \\
  =& \hbar\omega\hat{a}_- \left(\hat{a}_+ \hat{a}_- - \frac{1}{2} \right)\psi = \hat{a}_- \left[\hbar\omega\left(\hat{a}_- \hat{a}_+ - 1 - \frac{1}{2} \right)\psi \right] \\
  =& \hat{a}_- (\hat{H} - \hbar\omega)\psi  = \hat{a}_- (E - \hbar\omega)\psi = (E - \hbar\omega)(\hat{a}_- \omega)
\end{align*}
$$

This shows that $\hat{a}_\pm$ act as ladder operators such that when applied to $\psi$, the raise or lower the energy by $\hbar\omega$. If we apply the lowering operator $\hat{a}_-$ act on the ground state $\psi_0$, we expect that $\hat{a}_- \psi_0 = 0$. This gives the ordinary differential equation

$$
\begin{gather*}
  \frac{1}{\sqrt{2\hbar m \omega}}\left(\hbar\frac{\d}{\d x} + m\omega x \right)\psi_0 = 0 \\
  \frac{\d\psi_0}{\d x} = -\frac{m\omega}{\hbar} x\psi_0
\end{gather*}
$$

Integrating the equation gives

$$
\begin{gather*}
  \int \frac{\d\psi_0}{\psi_0} = -\frac{m\omega}{\hbar} \int x \;\d x \\
  \implies \ln\psi_0 = -\frac{m\omega}{2\hbar} x^2 + \tilde{A}
\end{gather*}
$$

so that the solution is

$$
  \psi_0 (x) = A \exp\left(-\frac{m\omega}{2\hbar} x^2 \right)
$$

Normalizing $\psi_0$ yields

$$
  1 = |A|^2 \int_{-\infty}^\infty e^{-m\omega x^2 / \hbar} \;\d x = |A|^2 \sqrt{\frac{\pi\hbar}{m \omega}} \implies A = \left(\frac{m\omega}{\pi\hbar}\right)^{1/4}
$$

resulting in the wavefunction

$$
  \psi_0 (x) = \left(\frac{m\omega}{\pi\hbar}\right)^{1/4} \exp\left(-\frac{m\omega}{2\hbar} x^2 \right)
$$

Using the fact that $\hat{a}_0 \psi_0 = 0$ we get from $\eqref{equation-57}$ that

$$
\begin{align*}
  \hbar\omega\left(\hat{a}_+ \hat{a}_-  +\frac{1}{2}\right)\psi_0 =& E_0 \psi_0 \\
  \frac{1}{2}\hbar\omega \psi_0 = E\psi_0
\end{align*}
$$

implying that the energy for the ground state is

$$
  E_0 = \frac{1}{2}\hbar\omega
$$

Having determined the ground state, we can find the excited states by repeatedly applying the raising operator $\hat{a}_+$, i.e.

$$
  \psi_n (x) = A_n (\hat{a}_+)^n \psi_0 (x)
$$

The corresponding energies are given by

$$
\begin{equation}
  E_n = \left(n + \frac{1}{2}\right)\hbar\omega \tag{\label{equation-58}}
\end{equation}
$$

To find the normalization constants we note that $\hat{a}_\pm \psi_n$ is proportional to $\psi_{n\pm 1}$, i.e.

$$
  \hat{a}_+ \psi_n = c_n \psi_{n+1}, \quad \hat{a}_- \psi_n = d_n \psi_{n-1}
$$

Furthermore, we have

$$
\begin{equation}
\begin{split}
  \braket{\hat{a}_\pm \psi_n | \hat{a}_\pm \psi_n} =& \int_{-\infty}^\infty (\hat{a}_\pm \psi_n)^* (\hat{a}_\pm \psi_n) \;\d x \\
  =& \int_{-\infty}^\infty (\hat{a}_\mp \hat{a}_\pm \psi_n)^* \psi_n \;\d x \\
  =& \braket{\hat{a}_\mp \hat{a}_\pm \psi_n|\psi_n}
\end{split}
\tag{\label{equation-59}}
\end{equation}
$$

<details>
<summary>Proof</summary>

Let $f, g \in L^2 (\R)$ be square integrable functions. Noting that $\hat{a}_\pm^* = \hat{a}_\mp$ we find using integration by parts that

$$
\begin{align*}
  \braket{f|\hat{a}_\pm g} =& \int_{-\infty}^\infty f^* (\hat{a}_\pm g) \;\d x \\
  =& \frac{1}{\sqrt{2\hbar m \omega}} \int_{-\infty}^\infty f^* \left(\mp \hbar \frac{\d}{\d x} + m\omega x \right) g \;\d x
\end{align*}
$$

Using integration by parts, we get

$$
  \int_{-\infty}^\infty f^* \frac{\d g}{\d x} \; \d x = \underbrace{\left[ f^* g \right]_{-\infty}^\infty}_{=0} - \int_{-\infty}^\infty \frac{\d f^*}{\d x}
$$

so

$$
\begin{align*}
  \int_{-\infty}^\infty f^* (\hat{a}_\pm g) \;\d x =& \frac{1}{\sqrt{2\hbar m \omega}} \int_{-\infty}^\infty \left[\left(\pm\hbar\frac{\d}{\d x} + m\omega x \right) f \right]^* g \;\d x \\
  =& \int_{-\infty}^\infty (\hat{a}_\pm f)^* g \;\d x = \braket{\hat{a}_\mp f| g}
\end{align*}
$$

This shows that

$$
  \braket{f|\hat{a}_\pm g} = \braket{\hat{a}_\mp f| g}
$$
</details>

Using $\eqref{equation-57}$ and $\eqref{equation-58}$, we obtain

$$
\begin{equation}
  \hat{a}_+ \hat{a}_- \psi_n = n\psi_n, \quad \hat{a}_- \hat{a}_+ \psi_n = (n + 1)\psi_n \tag{\label{equation-60}}
\end{equation}
$$

so

$$
\begin{align*}
  \braket{\hat{a}_+ \psi_n | \hat{a}_+ \psi_n} =& \braket{c_n \psi_{n+1} | c_n \psi_{n+1}} \\
  =& |c_n|^2 \braket{\psi_{n+1}|\psi_{n+1}} = (n + 1) \braket{\psi_n|\psi_n}
\end{align*}
$$

and

$$
\begin{align*}
  \braket{\hat{a}_- \psi_n | \hat{a}_- \psi_n} =& \braket{d_n \psi_{n-1} | d_n \psi_{n-1}} \\
  =& |d_n|^2 \braket{\psi_{n-1}|\psi_{n-1}} = n \braket{\psi_n|\psi_n}
\end{align*}
$$

Since $\psi_n$ and $\psi_{n+1}$ are normalized, it follows that $|c_n|^2 = n + 1$ and $|d_n|^2 = n$, resulting in

$$
  \hat{a}_+ \psi_n = \sqrt{n + 1} \psi_{n+1}, \quad \hat{a}_- \psi_n = \sqrt{n} \psi_{n-1}
$$

This shows that the normalization factor is $A_n = 1/\sqrt{n!}$ so that

$$
  \psi_n = \frac{1}{\sqrt{n!}} (\hat{a}_+)^n \psi_0
$$

Furthermore, using $\eqref{equation-59}$ and $\eqref{equation-60}$ we have

$$
\begin{align*}
  \braket{\psi_m | \hat{a}_+ \hat{a}_- \psi_n} =& n\braket{\psi_m|\psi_n} = \braket{\hat{a}_- \psi_m| \hat{a}_- \psi_n} \\
  =& \braket{\hat{a}_+ \hat{a}_- \psi_m | \psi_n} = m \braket{\psi_m | \psi_n}
\end{align*}
$$

This only holds if $\braket{\psi_m | \psi_n} = 0$ for $m \neq n$, showing that the wavefunctions $\psi_n$ are orthonormal.

### Analytic method

To solve $\eqref{equation-58}$ analytically, we introduce the dimensionless variables

$$
  u = \sqrt{\frac{m\omega}{\hbar}}x, \quad K = \frac{2E}{\hbar\omega}
$$

reducing the time-independent Schrödinger equation to

$$
\begin{equation}
  \frac{\d^2\psi}{\d u^2} = (u^2 -K)\psi \tag{\label{equation-60}}
\end{equation}
$$

In the limit $u\to\infty$, the equation approximates to

$$
  \frac{\d^2\psi}{\d u^2} \approx u^2 \psi
$$

with general solution in the form of the Gaussian wavefunction

$$
  \psi(u) \approx Ae^{-u^2 / 2} + B e^{u^2 / 2}
$$

The $B$ term blows up as $|u| \to \infty$, suggesting that physically solutions have the asymptotic form

$$
  \psi(u) \approx Ae^{-u^2 / 2}
$$

This motivates us to seek solutions of the form

$$
\begin{equation}
  \psi(u) = h(u) e^{-u^2 / 2} \tag{\label{equation-60}}
\end{equation}
$$

where $h(u)$ is a polynomial. The derivatives of $\psi(u)$ are

$$
\begin{align*}
  \frac{\d\psi}{\d u} =& \left(\frac{\d h}{\d u} - uh \right) e^{-u^2 / 2} \\
  \frac{\d^2 \psi}{\d u^2} =& \left(\frac{\d^2 h}{\d u^2} - 2u \frac{\d h}{\d u} + (u^2 - 1)h \right) e^{-u^2 / 2}
\end{align*}
$$

Substituting $\psi(u) = h(u) e^{-u^2 / 2}$ into $\eqref{equation-60}$ yields a second order ordinary diffential equation with respect to $h$:

$$
\begin{equation}
  \frac{\d^2 h}{\d u^2} - 2u \frac{\d h}{\d u} + (K - 1)h = 0 \tag{\label{equation-61}}
\end{equation}
$$

This equation can be solved using the power series method assuming a solution of the form

$$
  h(u) = \sum_{j=0}^\infty a_j u^j
$$

with derivatives

$$
\begin{align*}
  \frac{\d h}{\d u} =& \sum_{j=0}^\infty j a_j u^{j-1}
  \frac{\d^2 h}{\d u^2} =& \sum_{j=0}^\infty (j + 1)(j + 2) a_{j+2} u^j 
\end{align*}
$$

Inserting the power series into $\eqref{equation-61}$ gives

$$
\begin{align*}
  \sum_{j=0}^\infty j(j-1) a_j u^{j-2} - 2\sum_{j=0}^\infty j a_j u^j (K - 1) \sum_{j=0}^\infty a_j u^j = 0 \\
  \sum_{j=0}^\infty \left[(j + 2)(j + 1)a_{j+2} - 2ja_j - (K - 1)a_j \right] u = 0
\end{align*}
$$

From the uniqueness of power series expansions, it follows that the coefficient of each power of $u$ must vanish, i.e.

$$
  (j + 1)(j + 2) a_{j + 2} - 2j a_j + (K - 1)a_j = 0
$$

This results in the recursive relation

$$
\begin{equation}
  a_{j+2} = \frac{2j + 1 - K}{(j + 1)(j + 2)}a_j \tag{\label{equation-62}}
\end{equation}
$$

If the series does not terminate, then the recursion relation approximates to $a_{j+2} \approx 2a_j / j$ as $j \to \infty$ with approximate solution

$$
  a_j \approx \frac{C}{(j/2)!}
$$

for some constant $C$. This means that $h(u)$ gets the asymptotic form

$$
  h(u) \approx C \sum_{j=0}^\infty \frac{1}{(j/2)!} u^j \approx C \sum_{j=0}^\infty \frac{1}{j!} u^{2j} \approx C^2
$$

which blows up as $|u| \to \infty$. The power series must therefore terminate for some $j$ to be normalisable. From the recursive relation $\eqref{equation-62}$, we require $K = 2n + 1$ for $n\in\N$. This mean that the total energy is given by

$$
  E_n = \left(n + \frac{1}{2} \right)\hbar\omega, \; n\in\N
$$

in general, the recursive relation $\eqref{equation-62}$ defines the Hermite polynomials $H_n$ given by the Rodrigues formula

$$
  H_n (u) = (-1)^n e^{u^2} \left(\frac{\d}{\d u})^n e^{-u^2}
$$

The stationary states for the harmonic oscialltor are

$$
  \psi_n (x) = \left(\frac{m\omega}{\pi\hbar}\right)^{1/4} \frac{1}{\sqrt{2^n n!}} H_n (u) e^{-u^2 / 2}
$$

## Delta-function well

The delta-function well is a potential of the form

$$
  V(x) = -\alpha \delta(x), \; \alpha\in\R_+
$$

where $\delta$ is the Dirac delta function defined as

$$
  \delta(x) := \begin{cases}
    0, \quad& x \neq 0 \\
    \infty, \qyad x = 0
  \end{cases},\quad \int_{-\infty}^\infty \delta(x) \;\dx = 1
$$

The time-independent Schrödinger equation for particle of mass $m$ subject to this potential reads

$$
  -\frac{\hbar^2}{2m} \frac{\d^2 \psi}{\d x^2} - \alpha \delta (x) \psi = E \psi
$$

and allows both bound states for $E < 0$ and scattering states for $E > 0$. We will first consider bound states. In the region $x < 0$, we have $V(x) = 0$, giving

$$
  \frac{\d^2 \psi}{\d x^2} = -\frac{2mE}{\hbar^2} \psi = \kappa^2 \psi
$$

where

$$
  \kappa := \frac{\sqrt{-2mE}}{\hbar}
$$

is real a positive. The equation has general solution

$$
  \psi(x) = Ae^{-\kappa x} + Be^{\kappa x}
$$

The first term blows up as $x\to -\infty$, so we must choose $A = 0$ for a normalizable solution. In the region $x > 0$, we also have $V(x) = 0$, and the general solution is of the form

$$
  \psi(x) = Fe^{-\kappa x} + Ge^{\kappa x}
$$

In this case, the second term blows up as $x \to\infty$, so we must have $G = 0$. At $x = 0$, we require that $\psi$ is continuous, implying that $F = B$, i.e.

$$
  \psi(x) = Be^{\kappa|x|}
$$

Taking the derivative

$$
\begin{equation}
  \frac{\d\psi}{\d x} = \begin{cases}
    -B\kappa e^{-\kappa x}, \quad& x > 0 \\
    B\kappa e^{\kappa x},\quad& x < 0
  \end{cases}
  \tag{\label{equation-64}}
\end{equation}
$$

shows that $\psi$ is not continuously differentiable at $x = 0$. The discontinuity of $\d\psi/\d x$ of can be determined by integrating the Schrödinger equation in a neighbourhood $[-\epsilon,\epsilon]$ about $x = 0$, and then take the limit as $\epsilon\to 0$

$$
  -\frac{\hbar^2}{2m} \int_{-\epsilon}^\epsilon \frac{\d^2 \psi}{\d x^2} \;\d x + \int_{-\epsilon}^\epsilon V(x) \psi(x) \;\d x = E \int_{-\epsilon}^\epsilon \psi(x) \;\d x
$$

In the limit $\epsilon\to 0$, the right hand side vanishes so that

$$
\begin{align*}
  \Delta\left(\frac{\d\psi}{\d x}\right) :=& \lim_{\epsilon\to 0} \left( \left.\frac{\d\psi}{\d x}\right|_{\epsilon} - \left.\frac{\d\psi}{\d x}\right|_{-\epsilon} \right) \\
  =& \frac{2m}{\hbar^2} \lim_{\epsilon\to 0} \int_{-\epsilon}^\epsilon V(x) \psi(x) \;\d x \\
  =& -frac{2m\alpha}{\hbar^2} \lim_{\epsilon\to 0} \underbrace{\int_{-\epsilon}^\epsilon \delta(x) \psi(x) \;\d x}_{=\psi(0)} \\
  =& -frac{2m\alpha}{\hbar^2} \psi(0) \tag{\label{equation-65}}
\end{align*}
$$

From $\eqref{equation-64}$ we get that

$$
  \Delta\left(\frac{\d\psi}{\d x}\right) = -2B\kappa
$$

Since $B = \psi(0)$, we obtain 

$$
  \kappa = \frac{m\alpha}{\hbar}
$$

and the allowed energy is

$$
  E = -\frac{\hbar^2 \kappa^2}{2m} = -\frac{m\alpha^2}{2\hbar^2}
$$

To determine $B$, we normalize $\psi$:

$$
  1 = \int_{-\infty}^\infty |\psi(x)|^2 \;\d x = 2|B|^2 \int_0^\infty e^{-2\kappa x} \;\d x = \frac{|B|^2}{\kappa}
$$

Choosing the positive real root we find

$$
  B = \sqrt{\kappa} = \frac{\sqrt{m\alpah}}{\hbar}
$$

This shows that the delta-function well has a single bound state

$$
  \psi(x) = \frac{\sqrt{m\alpha}}{\hbar} e^{-m\alpha|x|/\hbar^2}
$$

Next, we consider scattering states with $E > 0$. In the region $x < 0$, the Schrödinger equation reads

$$
  \frac{\d^2 \psi}{\d x^2} = -\frac{2mE}{\hbar^2} \psi = -k^2 \psi
$$

where

$$
  k := \frac{\sqrt{2mE}}{\hbar}
$$

is real and positive. The equation has general solution

$$
  \psi(x) = Ae^{ikx} + Be^{-ikx}
$$

describing waves with amplitude $A$ and $B$ propagating in positive and negative $x$-direction, respectively. Likewise, for $x > 0$ the general solution is

$$
  \psi(x) = Fe^{ikx} + Ge^{-ikx}
$$

describing waves with amplitude $F$ and $G$ propagating in positive and negative $x$-direction, respectively. The continuity of $\psi$ at $x$ requires that

$$
\begin{equation}
  F + G = A + B \tag{\label{equation-66}}
\end{equation}
$$

and the derivatives are

$$
\frac{\d\psi}{\d x} = \begin{cases}
  ik(Fe^{ikx} - Ge^{-ikx}) \\
  ik(Ae^{ikx} - Be^{-ikx})
\end{cases}
$$

so that

$$
  \Delta\left(\frac{\d\psi}{\d x}\right) = ik(F - G - A + B)
$$

Since $\psi(0) = A + B$, the second boundary condition $\eqref{equation-65}$ implies that

$$
  ik(F - G - A + B) = -\frac{2m\alpha}{\hbar^2} (A + B)
$$

or, more compactly

$$
\begin{equation}
  F - G = A(1 + 2i\beta) - B(1 - 2i\beta) \tag{\label{equation-67}}
\end{equation}
$$

where

$$
  \beta := \frac{m\alpha}{\hbar^2 k}
$$

If we consider scattering of a particle travelling from left (positive $x$ direction), the amplitude of the wave originating from right is zero, i.e. $G = 0$. This describes a scattering process where
- $A$ is the amplitude of an incident wave propagating in positive $x$ direction
- $B$ is the amplitude of a reflect wave in negative $x$ direction
- $F$ is the amplitude of a transmitted wave in positive $x$ direction 

Solving $\eqref{equation-66}$ and $\eqref{equation-67}$ for $B$ and $F$, we find

$$
  B = \frac{i\beta}{1 - i\beta}A, \quad F = \frac{1}{1 - i\beta} A
$$

The probability of finding the particle at a specific location is given by $|\Psi|^2$, so the relative probability that incident particle will be reflected back is

$$
  R := \frac{|B|^2}{|A|^2} = \frac{\beta^2}{1 + \beta^2} = \frac{1}{1 + (2\hbar^2 E/m\alpha^2)}
$$

called the *reflection coefficient*. Meanwhile, the probability that a particle will continue right is

$$
  T := \frac{|F|^2}{|A|^2} = \frac{1}{1 + \beta^2} = \frac{1}{1 + (m\alpha^2 / 2\hbar^2 E)}
$$

called the *transmission coefficient*. Since probability is preserved, we find

$$
  R + T = 1
$$

Note that since $\psi$ is not normalizable in this case, it does not represent physically possible particle states. Thus, $R$ and $T$ are approximate reflection and transmission probabilities for particles with energy $E$.

## Finite square well

A finite square well is described by a potential

$$
  V(x) = \begin{cases}
    -V_0, \quad& |x| \leq a \\
    0, \quad& |x| > a
  \end{cases},\; V_0 \in\R
$$

This potential admits both bound and scattering states. We first consider bound states. In the region $|x| > a$, the potential is zero, so the time-independent Schrödinger equation is

$$
  \frac{\d^2 \psi}{\d x^2} = \kappa^2 \psi
$$

where

$$
\begin{equation}
  \kappa := \frac{\sqrt{-2mE}}{\hbar} \tag{\label{equation-70}}
\end{equation}
$$

is real and positive. In the region $x < -a$, the general solution is

$$
  \psi(x) = Ae^{-\kappa x} + Be^{\kappa x}
$$

The first term blows up as $x\to -\infty$, so we must have $A = 0$ for a normalizable solution. Likewise, in the region $x > a$, the general solution is

$$
  \psi(x) = Fe^{-\kappa x} + Ge^{\kappa x}
$$

However, this time the second term blows up as $x \to\infty$, so we require $G = 0$. In the region $|x| \leq a$, the potential is $V(x) = -V_0$, and the Schrödinger equation is

$$
  \frac{\d^2 \psi}{\d x^2} = -l^2 \psi
$$

where

$$
\begin{equation}
  l := \frac{\sqrt{2m(E + V_0)}}{\hbar} \tag{\label{equation-71}}
\end{equation}
$$

For bound states, $E > V_0$, meaning that $l > 0$. The general solution is

$$
  \psi(x) = C \sin(lx) + D\cos(lx)
$$

Since $V(x)$ is an even function, the wavefunctions are either even or odd. This means that we only need to impose the boundary conditions on one side because $\psi(-x) = \pm\psi(x)$. If we assume that $\psi$ is even, we must have $C = 0$ and the wavefunctions have the form

$$
  \psi(x) = \begin{cases}
    Fe^{-\kappa x}, \quad& x > a \\
    D\cos(lx), \quad& 0 < x a \\
    \psi(-x), \quad& x < 0
  \end{cases}
$$

The continuity of $\psi$ at $x = a$ says

$$
\begin{equation}
  Fe^{-\kappa a} = D\cos(la) \tag{\label{equation-68}}
\end{equation}
$$

and the continuity of $\d\psi/\d x$ says

$$
\begin{equation}
  -\kappa Fe^{-\kappa a} = -lD\sin(la) \tag{\label{equation-69}}
\end{equation}
$$

Dividing $\eqref{equation-69}$ by $\eqref{equation-68}$, we find

$$
\begin{equation}
  \kappa = l\tan(la) \tag{\label{equation-72}}
\end{equation}
$$

This equation determines the allowed energies, since $\kappa$ and $l$ are both functions of $E$. For convenience, we introduce the notation

$$
\begin{equation}
  z := \la, \quad z_0 := \frac{a}{\hbar}\sqrt{2mV_0} \tag{\label{equation-73}}
\end{equation}
$$

From $\eqref{equation-70}$ and $\eqref{equation-71}$, we have $(\kappa^2 + l^2) = 2mV_0 / \hbar^2$, so $\kappa a = \sqrt{z_0^2 - x^2}$, and $\eqref{equation-72}$ becomes

$$
\begin{equation}
  \tan(z) = \sqrt{(z_0/z)^2 - 1} \tag{\label{equation-74}}
\end{equation}
$$

This is a transcendental equation for $z$ as a function of $z_0$ and must be solved numerically. Two limiting cases are of special interest:
1. **Wide, deep well:** If $z_0$ is very large, the solutions to $\eqref{equation-74}$ occur slightly below $z_n = n\pi/2$ with $n$ odd. It follows from $\eqref{equation-73}$ that 
$$
  E_n + V_0 \approx \frac{n^2 \pi^2 \hbar^2}{2m(2a)^2}, \; n\in (\N/2)^C
$$
The right-hand size coincides with the infinite square well energies $\eqref{equation-}$. In the limit $V_0 \to\infty$, the finite square well goes over to the infinite square well.
2. **Shallow, narrow well:** As $z_0$ decreases, there are fewer and fewer bound states, until only one remains for $z_0 < \pi/2$.

Next, we consider scattering states, $E > 0$. Outside the well for $x z -a$, the wavefunctions take the form

$$
  \psi(x) = Ae^{ikx} + Be^{-ikx}
$$

with

$$
  \kappa := \frac{\sqrt{2mE}}{\hbar}
$$

Inside the well for $|x| \leq a$ with $V(x) = -V_0$, the wavefunctions have the form

$$
  \psi(x) = C\sin(lx) + D\cos(lx)
$$

with

$$
  l := \frac{\sqrt{2m(E + V_0)}}{\hbar}
$$

Assuming there are no incident waves coming from the other side of the well for $x > a$, the wavefunctions take the 

$$
  \psi(x) = Fe^{ikx}
$$

This describes a scattering process where
- $A$ is the incident amplitude
- $B$ is the reflected amplitude
- $F$ is the transmitted amplitude

There are four boundary conditions:
1. Continuity of $\psi$ at $x = -a$ requires
$$
  Ae^{-ika} + Be^{ika} = -C\sin(la) + D\cos(la)
$$
2. Continuity of $\d\psi/\d x$ at $x = -a$ gives
$$
  ik[Ae^{-ika} - Be^{ika}] = l[C\cos(la) + D\sin(la)]
$$
3. Continuity of $\psi$ at $x = a$ yields
$$
  C\sin(la) + D\cos(la) = Fe^{ika}
$$
4. Continuity of $\d\psi/\d x$ at $x = a$ says
$$
  l[C\cos(la) - D\sin(la)] = ikFe^{ika}
$$

We can use two of the boundary conditions to eliminate $C$ and $D$, and solve the remaining two for $B$ and $F$, resulting in

$$
\begin{align*}
  B =& i\frac{i\sin(2la)}{2kl} (l^2 - k^2) F \\
  F =& \frac{e^{-2ika A}}{\cos(2la) - i\frac{(k^2 + l^2)}{2kl}\sin(2la)}
\end{align*}
$$

The transmission coefficient $T = |F|^2 / |A|^2$ is given by

$$
  T^{-1} = 1 + \frac{V_0^2}{4E(E + V_0)} \sin^2 \left(\frac{2a}{\hbar} \sqrt{2m(E + V_0)} \right)
$$

Note that $T = 1$, when the sine is zero, or

$$
  \frac{2a}{\hbar}\sqrt{2m (E_n + V_0)} = n\pi\; \n \in\Z
$$

The energies for perfect transmission are given by

$$
  E_n + V_0 = \frac{n^2 \pi^2 \hbar^2}{2m (2a)^2}
$$

which happens to be precisely the allowed energies for infinite square well.

## Particle in a central potential

A central potential depends only on the radial distance from the origin, $r = |\mathbf{x}|$. The rotational symmetry of such potensials implies that orbital angular momentum, $\hat{\mathbf{L}} = \hat{\mathbf{x}} \times \hat{\mathbf{p}}$ is conserved. This latter fact follows from the classical equation of motion $\dot{\mathbf{p}} = -\nabla V$, where $\nabla V$ is parallel to $\mathbf{x}$ if $V$ is central. We then have

$$
  \frac{\d\mathbf{L}}{\d t} = \dot{\mathbf{x}} \times \mathbf{p} + \mathbf{x} \times \dot{\mathbf{p}} = 0
$$

The Hamiltonian operator of a particle with mass $m$ subject to a central potential $V$ is given by

$$
  \hat{H} = \frac{\hat{\mathbf{p}}^2}{2m}\nabla^2 + V(r) = -\frac{\hbar^2}{2m}\nabla^2 + V(r)
$$

Using spherical coordinates and recalling $\eqref{}$, the Laplacian is

$$
\begin{align*}
  \nabla^2 =& \frac{1}{r^2}\frac{\partial}{\partial r} \left(r^2 \frac{\partial}{\partial r} \right) + \frac{1}{r^2 \sin\theta} \left(\sin\theta \frac{\partial}{\partial\theta} \right) + \frac{1}{r^2 \sin^2 \theta} \left(\frac{\partial^2}{\partial\phi^2}\right) \\
  =& \frac{1}{r^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial}{\partial r} \right) - \frac{\hat{L}^2}{\hbar^2 r^2}
\end{align*}
$$

Introducing the operator corresponding to the radial component of the momentum

$$
  \hat{p}_r = -i\hbar\frac{1}{r}\frac{\partial}{\partial r} r = -i\hbar\left(\frac{\partial}{\partial r} + \frac{1}{r}\right)
$$

the Hamiltonian can be written

$$
\begin{align*}
  \hat{H} =& -\frac{\hbar^2}{2m} \left[\frac{1}{r^2} \left(r^2 \frac{\partial}{\partial r} \right) - \frac{\hat{L}^2}{\hbar^2 r^2}\right] + V(r) \\
  =& \frac{1}{2m}\left(\hat{p}_r^2 + \frac{\hbar^2 \hat{L}^2}{r^2} \right) + V(r)
\end{align*}
$$

which corresponds to the classical Hamiltonian in spherical coordinates. The time-independent Schrödinger equation can be expressed as

$$
\begin{equation}
  \left\{-\frac{\hbar^2}{2m}\left[\frac{1}{r^2} \frac{\partial}{\partial r}\left(r^2 \frac{\partial}{\partial r} \right) - \frac{\hat{L}^2}{\hbar^2 r^2} \right] + V(r) \right\} \psi(r,\theta,\phi) = E\psi(r,\theta,\phi) \tag{\label{equation-42}}
\end{equation}
$$

Since $\hat{L}_i$ and $\hat{L}^2$ are independent on $r$ and $[\hat{L}_i, \hat{\mathbf{x}}^2] = 0 = [\hat{L}_i, \hat{\mathbf{p}}^2]$, it follows that $[\hat{H}, \hat{L}_i] = 0$ and $[\hat{H}, \hat{L}^2] = 0$. In other words, the simultanous eigenfunctions of $\hat{L}^2$ and $\hat{L}_z$, given by the spherical harmonics $Y_\ell^n (\theta, \phi)$ are also eigenfunctions of $\hat{H}$. Thus, the eigenstates of $\hat{H}$, solving $\eqref{equation-42}$, take the form

$$
  \psi(r,\theta,\phi) = R(r) Y_\ell^n (\theta, \phi)
$$

Using the fact that $\hat{L}^2 Y_\ell^n (\theta,\phi) = \hbar^2\ell(\ell + 1) Y_\ell^n (\theta,\phi)$, we can refactor $\eqref{equation-42}$ as

$$
\begin{equation}
  \left[-\frac{\hbar^2}{2mr^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial}{\partial r} \right) + \frac{\hbar^2 \ell(\ell + 1)}{2mr^2} + V(r) - E \right] R(r) = 0 \tag{\label{equation-43}}
\end{equation}
$$

Substituting $u(r) = rR(r)$ with

$$
\begin{equation}
  R(r) = u(r)/r \tag{\label{equation-51}}
\end{equation}
$$ 

and

$$
\begin{gather*}
  \frac{\d R}{\d r} = \frac{1}{r^2}\left(r \frac{\d u}{\d r} - u \right) \\
  \frac{1}{r^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial}{\partial r} \right) \frac{u}{r} = \frac{1}{r} \frac{\partial^2}{\partial r^2}
\end{gather*}
$$

we can simplify $\eqref{equation-43}$ to the radial equation

$$
\begin{equation}
  -\frac{\hbar^2}{2m} \frac{\d^2}{\d r^2}u(r) + \left[V(r) + \frac{\hbar^2 \ell(\ell + 1)}{2m r^2}\right]u(r) = Eu(r) \tag{\label{equation-44}}
\end{equation}
$$

which is analogous to the one-dimensional Schrödinger equation apart from the additive term

$$
  V_\text{c} (r) = \frac{\hbar^2 \ell(\ell + 1)}{2mr^2}
$$

representing a repulsive centrifugal barrier. The eigenstates of $\hat{H}$ must satisfy the normalization condition

$$
\begin{align*}
  1 =& \int_{\R^3} |\psi(r,\theta,\phi)|^2 r^2 \;\d r \;\d \Omega \\ 
  =& \int_0^\infty \underbrace{r^2 |R(r)|^2}_{|u(r)|^2} \;\d r \underbrace{\int_\Omega |Y_\ell^n (\theta,\phi)|^2 \;\d\Omega}_{=1} \\
  =& \int_0^\infty |u(r)|^2 \;\d r
\end{align*}
$$

Additionally, the eigenstates require that $R(r)$ remains finite at the origin $r = 0$. Since $R(r) = u(r)/r$ this implies we must have $u(0) = 0$.

## Hydrogen atom

The hydrogen atom consists of a proton of charge $e$ and an orbiting electron with charge $-e$ mass $m_e$, bound by the mutual attraction of opposite charges. Since the proton is much heavier than the electron, we can neglect its motion. Assuming that the proton is located at the origin, the potential energy of the electron at a distance $r$ from the origin is given by Columb's law as

$$
  V(r) = -\frac{e^2}{4\pi \epsilon_0} \frac{1}{r}
$$

Inserting this into the radial equation $\eqref{equation-44}$ yields

$$
  -\frac{\hbar^2}{2m_e} \frac{\d^2}{\d r^2} + \underbrace{\left[-\frac{e^2}{4\pi\epsilon_0} \frac{1}{r} + \frac{\hbar^2}{2m_e} \frac{\ell(\ell + 1)}{r^2} \right]}_{V_\text{eff} (r)}u = Eu
$$

Note that the potential terms vanishes in the limit $r\to\infty$, i.e. $V_\text{eff} (r) \xrightarrow{r\to\infty} 0$, implying that there is an acceptable eigenfunction $u(r)$ for any positive energy. Thus, there is a continuous spectrum for $E > 0$, describing scattering between the electron and the proton. The eigenfunctions for $E < 0$ are called bound states giving a discrete energy spectrum. In the following derivation we focus exclusively on the bound states.

To simplify the the notation we let

$$
\begin{equation}
  \kappa := \frac{\sqrt{-2m_e E}}{\hbar} \tag{\label{equation-47}}
\end{equation}
$$

giving

$$
\begin{equation}
  \frac{1}{\kappa^2} \frac{\d^2 u}{\d r^2} = \left[1 - \frac{m_e e^2}{2\pi\epsilon_0 \hbar^2 \kappa^2 r} + \frac{\ell(\ell + 1)}{\kappa^2 r^2}\right]u \tag{\label{equation-45}}
\end{equation}
$$

Introducing

$$
\begin{equation}
  \rho = \kappa r, \quad \rho_0 = \frac{m_e e^2}{2\pi\epsilon_0 \hbar^2 \kappa} \tag{\label{equation-48}}
\end{equation}
$$

the radial equation $\eqref{equation-45}$ reduces to

$$
  \frac{\d^2 u}{\d\rho^2} = \left[1 - \frac{\rho_0}{\rho} + \frac{\ell(\ell + 1)}{\rho^2}\right]
$$

We first examine the asymptotic behaviour of solutions. As $\rho\to\infty$, the equation approximates to

$$
  \frac{\d^2 u}{\d \rho^2} = u
$$

with general solution $u(\rho) = Ae^{-\rho} + Be^{\rho}$. Since $e^\rho$ blows up as $r\to\infty$, we must have $B = 0$. Thus, $u(\rho) \approx Ae^{-\rho}$ for large $\rho$. On the other hand, as $\rho\to 0$ the centrifugal term dominates, approximating the equation to

$$
  \frac{\d^2 u}{\d\rho^2} = \frac{\ell(\ell + 1)}{\rho^2} u
$$

with general solution $u(\rho) = C\rho^{\ell + 1} + D\rho^{-\ell}$. Since $\rho^{-\ell}$ blows up as $\rho\to 0$, we must have $D = 0$. Thus, $u(\rho) \approx C\rho^{\ell + 1}$ for small $\rho$. This motivates us to look for solutions of the form

$$
\begin{equation}
  u(\rho) = \rho^{\ell + 1} e^{-\rho} v(\rho) \tag{\label{equation-50}}
\end{equation}
$$

with derivatives

$$
  \frac{\d u}{\d\rho} = \rho^{-\ell} e^{-\rho} \left[(\ell + 1 - \rho)v + \rho\frac{\d v}{\d\rho}\right]
$$

and

$$
  \frac{\d^2 u}{\d\rho^2} = \rho^\ell e^{-\rho} \left(\left[-2\ell - 2 + \rho + \frac{\ell(\ell + 1)}{\rho} \right]v + 2(\ell + 1 - \rho) \frac{\d v}{\d\rho} + \rho \frac{\d^2 v}{\d\rho^2} \right)
$$

In terms $v(\rho)$, the radial equation becomes

$$
\begin{equation}
  \rho\frac{\d^2}{\d\rho^2} + 2(\ell + 1 - \rho)\frac{\d v}{\d\rho} + [\rho_0 - 2(\ell + 1)]v = 0 \tag{\label{equation-46}}
\end{equation}
$$

which can be solved using a power series method. We assume $v(\rho)$ can be expressed as a power series

$$
  v(\rho) = \sum_{j=0}^\infty c_j \rho^j
$$

with derivatives

$$
\begin{align*}
  \frac{\d v}{\d\rho} =& \sum_{j=0}^\infty j c_j \rho^{j-1} = \sum_{j=0}^\infty (j + 1) c_{j+1} \rho^j \\
  \frac{\d^2 v}{\d\rho^2} =& \sum_{j=0}^\infty j(j + 1) c_{j+1} \rho^{j-1}
\end{align*}
$$

Inserting these into $\eqref{equation-46}$ yields

$$
\begin{align*}
  0 =& \sum_{j=0}^\infty j(j + 1) c_{j+1} \rho^j + 2(\ell + 1) \sum_{j=0}^\infty j(j + 1) c_{j + 1} \rho^j \\
  &- 2\sum_{j=0}^\infty j c_j \rho^j + [\rho_0 - 2(\ell + 1)] \sum_{j=0}^\infty c_j \rho^j
\end{align*}
$$

Equating the coefficients of like powers give

$$
  j(j + 1)c_{j+1} + 2(\ell + 1) (j + 1) c_{j + 1} - 2j c_j + [\rho_0 - 2(\ell + 1)]c_j = 0
$$

resulting in the recursive relation

$$
\begin{equation}
  c_{j+1} = \frac{2(j + \ell + 1) - \rho_0}{(j + 1)(j + 2\ell + 2)} c_j \tag{\label{equation-52}}
\end{equation}
$$

If the power series $v(\rho)$ fails to terminate, then for large $j$ the recursion formula approximates to

$$
  c_{j+1} \approx \frac{2j}{j(j + 1)}c_j = \frac{2}{j + 1} c_j
$$

or

$$
  c_j \approx \frac{2^j}{j!} c_0
$$

In this case, we get an exponentially divergent function

$$
  v(\rho) \approx c_0 \sum_{j=0}^\infty \frac{2^j}{j!} \rho^j = c_0 e^{2\rho}
$$

and hence

$$
  u(\rho) \approx c_0 \rho^{\ell+1} e^\rho
$$

which blows up at large $\rho$. To find normalizable solutions, we require that the power series terminate for some integer $j = N$, i.e. $c_N = 0$. In this case the recursion relation says

$$
  2(N + \ell) - \rho_0 = 0
$$

Defining 

$$
\begin{equation}
  k := N + \ell \tag{\label{equation-53}}
\end{equation}
$$

called the *principal quantum number*, we get 

$$
\begin{equation}
  \rho_0 = 2q \tag{\label{equation-49}}
\end{equation}
$$

which determines $E$. From $\eqref{equation-47}$ and $\eqref{equation-48}$, we find

$$
  E = -\frac{\hbar^2 \kappa^2}{2m_e} = -\frac{m_e e^4}{8 \pi^2 \epsilon_0^2 \hbar^2 \rho_2}
$$

Inserting $\eqref{equation-49}$ we obtain the energy eigenvalues

$$
  E_k = -\left[\frac{m_e}{2\hbar^2} \left(\frac{e^2}{4\pi\epsilon_0} \right)^2 \right] \frac{1}{k^2} = \frac{E_1}{k^2}, \; k \in\N_+
$$

which is known as the *Bohr formula*. The ground state of the electron

$$
  E_1 = -\frac{m_e}{2\hbar^2} \left(\frac{e^2}{4\pi\epsilon_0} \right)^2 = -13.6 \text{eV}
$$

which defines the binding energy of the atom. That is, the amount of energy needed to ionize a hydrogen atom in its ground state. 


Combining $\eqref{equation-48}$ and $\eqref{equation-49}$, we get

$$
  \kappa = \left(\frac{m_e e^2}{4\pi\epsilon_0} \right) \frac{1}{k} = \frac{1}{ak}
$$

where

$$
  a := \frac{4\pi\epsilon_0 \hbar^2}{m_e e^2} = 5.29 \times 10^{-11} \text{m}
$$

is the *Bohr radius*. For an arbitrary $k$, the possible values $\ell$ consistent with $\eqref{equation-53}$ are $\ell = 0, 1,\dots,k-1$, and for each $\ell$, there are $2\ell + 1$ possible values of $n$. The total degeneracy of the energy level $E_k$ is

$$
  d(k) = \sum_{\ell = 0}^{k-1} (2\ell + 1) = k^2
$$

### Wavefunctions

Using $\eqref{equation-51}$ and $\eqref{equation-50}$ we get the radial solutions

$$
\begin{equation}
  R_{k\ell} (r) = \frac{1}{\rho} \rho^{\ell + 1} e^{-\rho} v(\rho) \tag{\label{equation-54}}
\end{equation}
$$

The polynomials $v(\rho)$ defined by the recursion relation $\eqref{equation-52}$ can be defined as

$$
  v(\rho) = L_{k - \ell + 1}^{2\ell + 1} (2\rho)
$$

where

$$
  L_q^p (x) := (-1)^p \left(\frac{\d}{\d x} \right)^p L_{p+q} (x)
$$

is an associated Laguerre polynomial, and

$$
  L_q (x) := \frac{e^x}{q!} \left(\frac{\d}{\d x}\right)^q (e^{-x} x^q)
$$

is the $q$th Laguerre polynomial. From $\eqref{equation-48}$ we get

$$
  \rho = \frac{r}{ak}
$$

so that the wavefunction $\psi_{k \ell n}(r,\theta,\phi) = R_{k\ell} (r) Y_\ell^n (\theta, \phi)$ can be written

$$
  \psi_{k\ell n} = \sqrt{\left(\frac{2}{ka}\right)^3 \frac{(k - \ell - 1)!}{2k(k + \ell)!}} e^{-r/ka} \left(\frac{2r}{ka}\right)^\ell \left[L_{k - \ell - 1}^{2\ell + 1} (2r / ka) \right] Y_\ell^n (\theta, \phi)
$$

which are mutually orthonormal, i.e.

$$
  \int_{\R^3} \psi_{k \ell n}^* \psi_{k' \ell' n'} r^2 \;\d r \; \d\Omega = \delta_{kk'} \delta_{\ell\ell'} \delta_{nn'}
$$


| $k$ | $\ell$ | $R_{k\ell} (r)$ |
| --- | --- | --- |
| $1$ | $0$ | $R_{10} = 2a^{-3/2} \exp(-r/a)$ |
| $2$ | $0$ | $R_{20} = \frac{1}{\sqrt{2}}a^{-3/2} \left(1 - \frac{1}{2}\frac{r}{a} \right) \exp(-r/2a)$ |
| $2$ | $1$ | $R_{21} = \frac{1}{2\sqrt{6}}a^{-3/2} \left(\frac{r}{a} \right) \exp(-r/2a)$ |
| $3$ | $0$ | $R_{30} = \frac{2}{3\sqrt{3}}a^{-3/2} \left[1 - \frac{2}{3}\frac{r}{a} + \frac{2}{27}\left(\frac{r}{a}\right)^2 \right] \exp(-r/3a)$ |
| $3$ | $1$ | $R_{31} = \frac{8}{27\sqrt{6}}a^{-3/2} \left(1 - \frac{1}{6}\frac{r}{a} \right) \left(\frac{r}{a}\right) \exp(-r/3a)$ |
| $3$ | $2$ | $R_{32} = \frac{4}{81\sqrt{30}}a^{-3/2} \left(\frac{r}{a}\right)^2 \exp(-r/3a)$ |
| $4$ | $0$ | $R_{40} = \frac{1}{4}a^{-3/2} \left[1 - \frac{4}{3}\frac{r}{a} + \frac{1}{8}\left(\frac{r}{a}\right)^2 - \frac{1}{192}\left(\frac{r}{a}\right)^3\right] \exp(-r/4a)$ |
| $4$ | $1$ | $R_{41} = \frac{5}{16\sqrt{15}}a^{-3/2} \left[1 - \frac{1}{4}\frac{r}{a} + \frac{1}{80}\left(\frac{r}{a}\right)^2\right]\left(\frac{r}{a}\right) \exp(-r/4a)$ |
| $4$ | $2$ | $R_{41} = \frac{1}{64\sqrt{5}}a^{-3/2} \left(1 - \frac{1}{12}\frac{r}{a}\right)\left(\frac{r}{a}\right)^2 \exp(-r/4a)$ |
| $4$ | $3$ | $R_{41} = \frac{1}{768\sqrt{35}}a^{-3/2} \left(\frac{r}{a}\right)^3 \exp(-r/4a)$ |


# Relativistic particles

## The Klein-Gordon equation

The Klein-Gordon equation is derived by quantizing the relativistic energy-momentum relation for a particle with with energy $E$, momentum $\mathbf{p}$ and rest mass $m$

$$
  E^2 = \mathbf{p}^2 c^2 + m^2 c^4
$$

