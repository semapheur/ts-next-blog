---
title: 'Hilbert space formulation'
subject: 'Physics/quantum mechanics'
showToc: true
references:
  - book_auletta_etal_2009
  - book_manoukian_2006
  - book_scherer_2019
---

# Postulates

1. **Description of quantum states** The state space of a quantum system is described a complex separable Hilbert space $\mathcal{H}$. The possible states of the system can be categorized into *pure states* and *mixed states*:

    - A pure state is described by a ray $[\psi]_\sim \in\mathcal{PH}$ in the projective Hilbert space $\mathcal{PH} = \mathcal{H}/\sim$, where vectors differing only by a global phase are equivalent. Formally, a pure state is given by an equivalence classes of normalized vectors $\ket{\psi}\in\mathcal{H}$ with $\norm{\psi} = 1$:
    $$
      [\psi]_\sim = \set{e^{i\phi} \ket{\psi} : \ket{\psi}\in\mathcal{H}, \norm{\psi} = 1, \phi\in\R}
    $$
    For convenience, the equivalence class notation is often omitted, as the the global phase has no physical significance.

    - A mixed state is described by a *density operator* $\hat{\rho}$, which is a positive semidefinite operator on $\mathcal{H}$ with unit trace, i.e. $\operatorname{tr}(\hat{\rho}) = 1$. The operator $\hat{\rho}$ represents a statistical mixture of pure states and can be expressed as
    $$
      \hat{\rho} = \sum_i p_i \ket{\psi_i} \bra{\psi_i}
    $$
    where $\set{\ket{\psi_i}}$ are pure states, $p_i$ are probabilities satisfying $p_i \geq 0$ and $\sum_i p_i = 1$.

2. **Description of system observables:** Each physical observable $A$ of a quantum system is associated with a Hermitian operator $\hat{A}$ acting on $\mathcal{H}$. Since $\hat{A}$ is Hermitian, its eigenvalues are real, and its eigenstates form a complete, orthonormal set that spans $\mathcal{H}$, provided that $\hat{A}$ has a discrete spectrum. If $\hat{A}$ has a continuous spectrum, its eigenstates form a generalized orthonormal basis, expressed using distribution functions. 
3. **Measurement of physical observables:** The possible measurable values of an observable $A$ corresponds to the spectrum of its associated operator $\hat{A}$. The probability of measuring an eigenvalue $\lambda$ of $\hat{A}$ depends on whether the system is in a pure state or a mixed state.
    - If the quantum system is in a pure state $\ket{\psi}\in\mathcal{H}$, the probability $\Pr_\psi (\lambda)$ of measuring $A$ and obtaining $\lambda$ is given by
    $$
      \Pr_\psi (\lambda) = \norm{\hat{P}_\lambda \ket{\psi}}
    $$
    where $\hat{P}_\lambda$ is the projection onto the eigenspace $\operatorname{eig}(\hat{A}, \lambda)$. The expectation value of $A$ is given by $\langle A \rangle = \braket{\psi|\hat{A}|\psi}$.
    - If the system is in a mixed state $\hat{\rho}$, the probability $\Pr_{\hat{\rho}} (\lambda)$ that a measurement of $A$ yields the eigenvalue $\lambda$ is given by
    $$
      \Pr_{\hat{\rho}} (\lambda) = \operatorname{tr}(\hat{\rho}\hat{P}_\lambda)
    $$
    The expectation values is given by $\braket{A}_{\hat{\rho}} = \operatorname{tr}(\hat{\rho}\hat{A})$.

4. **Effect of measurement on the state:** A measurement of an observable $A$ modifies the quantum state depending on whether the quantum system was initially in a pure state or a mixed state.
    - If the system initially exists in a pure state $\ket{\psi}$, measuring $A$ and obtaining eigenvalue $\lambda$ transforms the state to
    $$
      \ket{\psi'} = \frac{\hat{P}_\lambda \ket{\psi}}{\sqrt{\braket{\psi|\hat{P}_\lambda|\psi}}}
    $$
    where $\hat{P}_\lambda$ is the projection onto the eigenspace $\operatorname{eig}(\hat{A}, \lambda)$.

    - If the system is initially described by a mixed state $\hat{\rho}$, a measurement of $A$ yielding $\lambda$, projects the state to
    $$
      \hat{\rho}' = \frac{\hat{P}_\lambda \hat{\rho} \hat{P}_\lambda}{\operatorname{tr}(\hat{\rho}\hat{P}_\lambda)}
    $$
5. **Time evolution of a system:** In the Schrödinger picture, any time evolution of a pure state $\ket{\psi(t)}\in\mathcal{H}$ that is not caused by a measurement is governed by a unitary evolution operator $\hat{U}(t, t_0)$ satisfying
$$
  \ket{\psi(t)} = U(t,t_0)\ket{\psi (t_0)}
$$
which is equivalent to the Schrödinger equation
$$
  i\hbar\frac{\d}{\d t}\ket{\psi(t)} = \hat{H}\ket{\psi(t)}
$$
where $\hat{H}$ is the Hamiltonian of the quantum system.
    - For a mixed state $\hat{\rho}$, the time evolution is given by
    $$
      \hat{\rho}(t) = \hat{U}(t, t_0) \hat{\rho}(t_0) \hat{U}^\dagger(t, t_0)
    $$

6. **Description of composite systems:** The Hilbert space of a composite system that consists of the subsystems $\mathcal{H}_{A_i}$ for $i\in I\subseteq\N$ is the tensor product $\bigotimes_{i\in I} \mathcal{H}_{A_i}$.

## Time evolution pictures

| Evolution of | Schrödinger $(S)$ | Heisenberg $(H)$ | Interaction $(I)$ |
| --- | --- | --- | --- |
| State vector | $\ket{\psi_s (t)} = e^{-i\hat{H}_S t/\hbar} \ket{\psi_S (0)}$ | constant | $\ket{\psi_I (t)} = e^{i\hat{H}_{0;S} t/\hbar} \ket{\psi_S (t)}$ |
| Observable | constant | $\hat{O}_H = e^{i\hat{H}_S t/\hbar} \hat{O}_S e^{-i\hat{H}_S t/\hbar}$ | $\hat{O}_I = e^{i\hat{H}_{0;S} t/\hbar} \hat{O}_S e^{-i\hat{H}_{0;S} t/\hbar}$ |
| Density matrix | $\rho_S (t) = e^{i\hat{H}_S t/\hbar} \rho_S (0) e^{-i\hat{H}_S t/\hbar}$ | constant | $\rho_I (t) = e^{i\hat{H}_{0;S} t/\hbar} \rho_S (t) e^{-i\hat{H}_{0;S} t/\hbar}$ |

# Quantum states and observables

The pure state of a quantum system is represented by a ray $[\ket{\psi}]_\sim \in \mathcal{PH}$, where $\mathcal{PH} = \mathcal{H}/\sim$ is the projective Hilbert space of a complex separable Hilbert space $\mathcal{H}$, and $\sim$ is an equivalence relation on $\mathcal{H}$. For $\ket{\psi},\ket{\varphi}\in\mathcal{H}$, this relation is defined as

$$
  \ket{\psi}\sim\ket{\varphi} \iff \ket{\varphi} = e^{i\alpha} \ket{\psi}, \alpha\in\R
$$

Each ray $S_\psi$ associated with a normalized vector $\ket{\psi}\in\mathcal{H}$, i.e. $\norm{\psi} = 1$, is the equivalence class

$$
  S_\psi = [\ket{\psi}]_\sim := \set{e^{i\alpha} \ket{\psi} | \alpha\in\R}
$$

representing a pure state of the quantum system. All vectors in $S_\psi$ differ only by a global phase factor and correspond to the same physical state.

For convenience, the global phase factor $e^{i\alpha}$ is typically ignored when dealing with pure states. In practice, we often identify a pure state with a normalized vector $\ket{\psi}\in\mathcal{H}$ with $\norm{\psi} = 1$, rather than considering the entire equivalence class of vectors that differ only by a global phase. This is because the global phase does not affect physical observables or measure quantities, which are invariant under such transformations. Thus, we can simplify the description of pure states by associating them directly with normalized vectors in $\mathcal{H}$, leaving the equivalence class formalism implicit.

The dimensionality of $\mathcal{H}$ is determined by the degrees of freedom of the system. Systems with continuous degrees of freedom (like position and momentum) have infinite-dimensional Hilbert spaces, while systems of discrete degrees of freedom have finite-dimensional Hilbert spaces. For instance, the Hilbert space for the position and momentum of a particle in $n$ dimensions is the space of square-integrable complex-valued function function $\mathcal{L}^2 (\R^n, \mathbb{C})$, while for a spin-$s$ particle it is the finite-dimensional complex vector space $\mathbb{C}^{2s + 1}$.

An observable refers to a physcial quantity that can be measured in a quantum system. All quantum observables are represented by Hermitian operators on $\mathcal{H}$. The possible values of an observable are given by the spectrum of the operator, which can be discrete (finite or infinite-dimensional), continuous or a combination of both. In general, systems with bound states (e.g., a particle confined in a potential well) have discrete spectra, corresponding to quantized energy levels. In contrast, for scattering states (e.g., a free particle or a particle with energy above a potential barrier), the spectrum is continuous, corresponding to a range of energies.

<details>
<summary>Details</summary>

For infinite-dimensional Hilbert spaces, we also require that a Hermitian operator $\hat{Q}$ is bounded. In this case, there exists a constant $c$ such that, for any non-zero vector $\ket{\psi}\in\mathcal{H}$, we have

$$
  \frac{\braket{\psi|\hat{Q}^\dagger \hat{Q}|\psi}}{\braket{\psi|\psi}} \leq c^2
$$

The operator norm of $\hat{Q}$ is defined as the lower bound of $c$.
</details>

The Hermiticity of a quantum operator ensures that its spectrum is real. Furthermore, the eigenvectors corresponding to distinct eigenvalues are orthogonal and can be normalized to form an orthonormal basis. In the case of degenerate eigenvalues, the corresponding eigenspace can be spanned by orthonormal eigenvectors. For continuous spectra, generalized eigenstates may be used.

## Discrete observables

A discrete quantum observable is represented by a Hermitian operator $\hat{Q}$ on a Hilbert space $\mathcal{H}$ with a discrete spectrum $\set{q_j}_j$. If $\hat{Q}$ has eigenbasis $\set{\ket{q_{j,\alpha}}}$, where $\alpha \in\set{1,\dots,d_j}$ denotes the degeneracy of $q_j$, i.e. $d_j = \dim[\operatorname{eig}(\hat{Q}, q_j)]$, the spectral representation of $\hat{Q}$ is

$$
  \hat{Q} = \sum_j q_j \hat{P}_j = \sum_j q_j \sum_{\alpha=1}^{d_j} \ket{q_{j,\alpha}} \bra{q_{j,\alpha}}
$$

where $\hat{P}_j$ is the projector onto the eigenspace $\operatorname{eig}(\hat{Q}, q_j)$. Since $\hat{Q}$ is Hermitian, the eigenbasis $\set{\ket{q_{j,\alpha}}}$ is orthonormal, i.e.

$$
  \braket{q_{j,\alpha}|a_{k,\beta}} = \delta_{jk} \delta_{\alpha\beta}
$$

From the spectral representation, we can derive the action of $\hat{Q}$ on the eigenvectors $\ket{q_{k,\beta}}$

$$
\begin{align*}
  \hat{Q}\ket{q_{k,\beta}} =& \sum_j q_{j,\alpha} \hat{P}_j \ket{q_{k\beta}} \\
  =& \sum_j q_j \sum_{\alpha=1}^{d_j} \ket{q_{j,\alpha}} \underbrace{\braket{q_{j,\alpha}|q_{k,\beta}}}_{\delta_{jk} \delta_{\alpha\beta}} \\
  =& q_k \ket{q_{k,\beta}}
\end{align*}
$$

The relation $\hat{Q}\ket{q_{k,\beta}} = q_k \ket{q_{k,\beta}}$ is the eigenvalue equation of $\hat{Q}$. 

If the spectrum of $\hat{Q}$ is finite-dimensional, the set of eigenvectors forms a complete orthonormal basis for $\mathcal{H}$, meaning that: 

$$
  \operatorname{span}(\set{\ket{q_{j,\alpha}}}_j) = \mathcal{H}
$$

Thus, the Hilbert space $\mathcal{H}$ is spanned by the eigenstates of $\hat{Q}$, and any state $\ket{\psi}\in\mathcal{H}$ can be expressed as a linear combination (or superposition):

$$
  \ket{\psi} = \sum_{j,\alpha} c_{j,\alpha} \ket{q_{j,\alpha}}
$$

where $c_{j,\alpha}$ are complex coefficients representing probability amplitudes. Applying $\bra{q_{k,\beta}}$ to $\ket{\psi}$ yields

$$
  \braket{q_{k,\beta} | \psi} = \sum_{j,\alpha} c_{j,\alpha} \underbrace{\braket{q_{k,\beta}|q_{j,\alpha}}}_{\delta_{kj}\delta_{\beta\alpha}} = c_{k,\beta}
$$

showing that $c_{k,\beta}$ is the projection of $\ket{\psi}$ onto $\ket{q_{k,\beta}}$.

### Matrix representation of observables

The matrix representation of an observable $\hat{Q}$ with finite-dimensional discrete spectrum can be obtained by expanding $\mathbf{Q}$ in terms of an orthonormal basis $\set{\ket{b_j}}_j$. Using the completeness relation $\sum_j \ket{b_j}\bra{b_j} = \hat{I}$, we write

$$
  \hat{Q} = \sum_j \ket{b_j} \bra{b_j} \hat{Q} = \sum_{j,k} \ket{b_j} \braket{b_j|\hat{Q}|b_k} \bra{b_k}
$$

The matrix elements of $\hat{Q}$ in this basis are given by

$$
  \mathbf{Q}_{jk} = \braket{b_j|\hat{Q}|b_k}
$$

An observable $\hat{Q}$ with a non-degenerate spectrum $\set{q_j}_{j=1}^n$ can be diagonalized. The resulting matrix representation has diagonal elements corresponding to the eigenvalues of $\hat{Q}$:

$$
  \mathbf{Q}_{jk} = q_j \delta_{jk} 
$$

The $n\times n$ matrix $\mathbf{U}$ that diagonalizes $\hat{Q}$ is formed by using the eigenvectors $\ket{q_j}$ as its columns. In a basis $\set{\ket{b_k}}_k$, the eigenvector $\ket{q_j}$ can be expanded as

$$
  \ket{q_j} = \sum_k q_{jk} \ket{b_k}, \; q_{jk} = \braket{b_k | q_j}
$$

showing that $\mathbf{U}$ has matrix elements $\mathbf{U}_{jk} = q_{jk}$. Since the eigenbasis $\set{\ket{q_j}}_j$ is orthonormal, we have

$$
  \sum_\ell (q_{k\ell})^* q_{j\ell} = \braket{q_k | q_j} = \delta_{kj}
$$

This can be used to verify that $\mathbf{U}$ is unitary:

$$
\begin{align*}
  (\mathbf{U}^\dagger \mathbf{U})_{kj} =& \sum_\ell \mathbf{U}_{k\ell}^\dagger \mathbf{U}_{\ell j} = \sum_\ell \mathbf{U}_{\ell k}^* \mathbf{U}_{\ell j} \\
  =& \sum_\ell (q_{k\ell})^* q_{j\ell} = \braket{q_k | q_j} = \delta_{kj}
\end{align*}
$$

## Continuous observables and wavefunctions

A quantum observable $\hat{Q}$ with a continuous spectrum has spectral representation

$$
  \hat{Q} = \int q \hat{P}(q) \;\d q = \int q \ket{q}\bra{q} \;\d q
$$

where $q$ is a continuous eigenvalue, and $\ket{q}$ is the corresponding eigenfunction. These eigenvectors are not normalizable in the usual sense, but satisfy the orthogonality condition

$$
  \braket{q' | q} = \delta(q - q')
$$

where $\delta$ is the Dirac delta function. In this representation, any state vector $\ket{\psi}$ can be expanded as

$$
  \ket{\psi} = \int \psi(q) \ket{q} \; \d q
$$

where $\psi(q) = \braket{q|\psi}$ is called the wavefunction. The wavefunction $\psi(q)$ is the projection of $\ket{\psi}$ onto $\ket{q}$. It is describes how $\ket{\psi}$ is distributed over the eigenstates of $\hat{Q}$.

## Change of basis

If $\mathcal{H}$ is a finite-dimensional Hilbert space with orthonormal basis $\set{\ket{b_n}}_n$, a state vector $\ket{\psi}\in\mathcal{H}$ can be expanded as

$$
\begin{equation*}
  \ket{\psi} = \sum_k c_{b_k} \ket{b_k}, \; c_{b_k} = \braket{b_k | \psi} \in\mathbb{C} 
\tag{\label{equation-76}}
\end{equation*}
$$

We can expand $\ket{\psi}$ in terms of another orthonormal basis $\set{\ket{a_k}}_k$:

$$
\begin{equation*}
  \ket{\psi} = \sum_k c_{a_k} \ket{a_k}, \; c_{a_k} = \braket{a_k | \psi} 
\tag{\label{equation-77}}
\end{equation*}
$$

To find a relationship between the coefficients $\set{c_{b_k}}_k$ and $\set{c_{a_k}}_k$, we insert $\sum_j \ket{a_j} \bra{a_j} = 1$ into $\eqref{equation-76}$ to get

$$
\begin{align*}
  \ket{\psi} =& \sum_{j,k} c_{b_k} \ket{a_j} \braket{a_j | b_k} \\
  =& \sum_{j,k} \mathbf{U}_{j,k} c_{b_j} \ket{a_k}
\end{align*}
$$

with the matrix elements $\mathbf{U}_{j,k} = \braket{a_k | b_j}$. Equating this with $\eqref{equation-77}$, we find

$$
  c_{a_j} = \sum_{k} \mathbf{U}_{j, k} c_{b_k}
$$

or in matrix form

$$
  \mathbf{c}_a = \mathbf{Uc}_b
$$

A change of basis has the following properties:
1. The matrix $\mathbf{U}$ is unitary.
2. The inner product of $\mathcal{H}$ is preserved
3. The trace of an operator is preserved

<details>
<summary>Proof</summary>

**(1):** If $\mathbf{U}_{j,k} = \braket{a_j | b_k}$, then

$$
\begin{align*}
  (\mathbf{U}_{j,k})^* =& \braket{b_k | a_j} \\
  \mathbf{U}_{j,k}^\dagger =& \braket{b_j | a_k}
\end{align*}
$$

Consequently, we have

$$
\begin{align*}
  (\mathbf{UU}^\dagger)_{j,k} =& \sum_\ell \mathbf{U}_{j,\ell} U_{\ell, k} = \sum_\ell \braket{a_j | b_\ell} \braket{b_\ell | a_k} \\
  =& \braket{a_j | a_k} = \delta_{jk}
\end{align*}
$$

Similarly, we have

$$
\begin{align*}
  (\mathbf{U}^\dagger \mathbf{U})_{j,k} =& \sum_\ell \mathbf{U}_{j,\ell}^\dagger \mathbf{U}_{\ell,k} = \sum_\ell \braket{b_j | a_\ell}\braket{a_\ell | b_k} \\
  =& \delta_{jk}
\end{align*}
$$

Hence, it follows that $\mathbf{UU}^\dagger = \mathbf{U}^\dagger U = \mathbf{I}$.

**(2):** If $\set{\ket{b_j}}$ and $\set{\ket{a_j}}$ are two orthonormal bases on $\mathcal{H}$, then the two state vectors $\ket{\psi}, \ket{\phi}\in\mathcal{H}$ can be expanded as

$$
\begin{align*}
  \psi =& \sum_j c_{b_j} \ket{b_j} = \sum_j c_{a_j} \ket{a_j}
  \phi =& \sum_j d_{b_j} \ket{b_j} = \sum_j d_{a_j} \ket{a_j}
\end{align*}
$$

The inner product $\braket{\psi|\phi}$ in the basis $\set{\ket{b_j}}$ is

$$
  \braket{\phi|\psi} = \sum_{j,k} d_{b_j}^* c_{b_k} \underbrace{\braket{b_j | b_k}}_{\delta_{jk}} = \sum_j d_{b_j} c_{b_j}
$$

The inner product $\braket{\psi|\phi}$ in the basis $\set{\ket{a_j}}$ is

$$
\begin{equation*}
  \braket{\phi|\psi} = \sum_{j,k} d_{a_j}^* c_{a_k} \underbrace{\braket{a_j | a_k}}_{\delta_{jk}} = \sum_j d_{a_j} c_{a_j} 
\tag{\label{equation-78}}
\end{equation*}
$$

Substituting

$$
  c_{a_j} = \sum_k \mathbf{U}_{j,k} c_{b_j}
$$

and

$$
  d_{a_j}^* = \sum_k \mathbf{U}_{j,k}^* d_{b_k}^* = \sum_k d_{b_k}^* \mathbf{U}_{k,j}^\dagger
$$

into $\eqref{equation-78}$, we get

$$
\begin{align*}
  \braket{\phi|\psi} =& \sum_{j,k} d_{b_k}^* \mathbf{U}_{k,j}^\dagger \sum_\ell \mathbf{U}_{j,\ell} c_{b_\ell} \\
  =& \sum_{k,\ell} d_{b_k}^* \underbrace{\left(\sum_j \mathbf{U}_{k,j}^\dagger \mathbf{U}_{j, \ell} \right)}_{(\mathbf{U}^\dagger \mathbf{U})_{k,\ell} = \delta_{k,\ell}} c_{b_\ell} \\
  =& \sum_\ell d_{b_\ell}^* c_{b_\ell}
\end{align*}
$$

**(3):** Let $\hat{Q}$ be a linear operator on $\mathcal{H}$. The trace of $\hat{O}$ in the orthonormal basis $\set{\ket{a_j}}$ is given by

$$
  \operatorname{tr}(\hat{Q}) = \sum_j \braket{a_j |\hat{Q}| a_j}
$$

The trace of $\hat{Q}$ in the orthonormal basis $\set{\ket{b_j}}$ can be written

$$
\begin{align*}
  \operatorname{tr}(\hat{Q}) =& \sum_j \braket{b_j |\hat{Q}|b_j} \\
  =& \sum_{j,k,\ell} \braket{b_j | a_k} \braket{a_k | \hat{Q} | a_\ell} \braket{a_\ell | b_j} \\
  =& \sum_{j,k,\ell} \braket{a_\ell | b_j} \braket{b_j | a_k} \braket{a_k | \hat{Q} | a_\ell} \\
  =& \sum_{k, \ell} \braket{a_\ell | a_k} \braket{a_k |\hat{Q}| a_k} \\
  =& \sum_\ell \braket{a_\ell | \hat{Q} | a_\ell}
\end{align*}
$$
</details>

### Infinite-dimensional case

If $\mathcal{H}$ is an infinite-dimensional Hilbert space with basis $\set{\ket{\xi}}$, then any state vector $\ket{\psi}\in\mathcal{H}$ can be expanded as

$$
  \ket{\psi} = \int \psi_\xi (\xi) \ket{\xi} \;\d \xi, \; \psi_\xi (\xi) = \braket{\xi|\psi}
$$

We can expand $\ket{\psi}$ in terms of another orthonormal basis $\set{\ket{\eta}}$ as

$$
  \ket{\psi} = \int \psi_\eta (\eta) \ket{\eta}, \; \psi_\eta (\eta) = \braket{\eta|\psi}
$$

Using the completeness relation of $\ket{\eta}$, we can express $\psi_\xi$ as

$$
\begin{align*}
  \psi_\xi (\xi) =& \braket{\xi|\psi} = \int \overbrace{\braket{\xi|\eta}}^{\phi_\eta (\xi)} \overbrace{\braket{\eta|\psi}}^{\psi_\eta (\eta)} \;\d\eta \\
  =& \int \phi_\eta (\xi) \psi_\eta (\eta) = \hat{U}(\eta,\xi) \psi(\eta)
\end{align*}
$$

In the following we show that the transformation

$$
  \hat{U}(\eta,\xi) = \int \phi_\eta (\xi) \;\d\eta
$$

is unitary. The scalar product of two wavefunctions $\psi_\eta$ and $\psi'_\eta$ in the $\eta$-representation is given by

$$
  \braket{\psi_\eta, \psi_\eta'} = \int \psi_\eta^* (\eta) \psi'_\eta (\eta) \;\d\eta
$$

Applying $\hat{U}$ to $\psi_eta$ and $\psi'_\eta$ and taking the scalar product yields

$$
\begin{align*}
  \braket{\hat{U}\psi_\eta, \hat{U} \psi'_\eta} =& \int \d\xi \left(\int \phi_\eta^* (\xi) \psi_\eta^* (\eta) \;\d\eta \right) \left(\int \phi_{\eta'} (\xi) \psi'_\eta (\eta') \;\d\eta' \right) \\
  =& \int \eta' \psi_\eta^* (\eta) \psi'_\eta (\eta') \;\d\eta \int \phi_\eta^* (\eta) \phi_{\eta'} (\eta) \;\d\xi \tag{\label{equation-94}}
\end{align*}
$$

Since $\phi_\eta (\xi) = \braket{\xi|\eta'}$ and $\phi_\eta (\xi) = \braket{\xi|\eta}$, we obtain

$$
\begin{align*}
  \int \phi_\eta^* (\xi) \phi_{\eta'} (\xi) =& \int \braket{\eta|\xi}\braket{\xi|\eta'} \\
  =& \braket{\eta|\eta'} = \delta(\eta - \eta')
\end{align*}
$$

Substituting this into $\eqref{equation-94}$, we get

$$
\begin{align*}
  \braket{\hat{U}\psi, \hat{U}\psi'} =& \int \eta' \psi_\eta^* (\eta) \psi'_\eta (\eta') \delta(\eta - \eta') \\
  =& \int \psi_\eta^* (\eta) \psi_\eta (\eta) \;\d\eta = \braket{\psi,\psi'}
\end{align*}
$$

showing that $\hat{U}$ preserves the inner product. Hence, it follows that $\hat{U}$ is unitary.

# Measurements

Let $\hat{Q}$ be a Hermitian operator on $\mathcal{H}$ with a discrete spectrum $\set{q_j}_j$, and an orthonormal eigenbasis $\set{\ket{q_{j,\alpha}}}$, where $\alpha\in\set{1,\dots,d_j}$ denotes the degeneracy $q_j$, i.e. $d_j = \dim[\operatorname{eig}(\hat{Q}, q_j)]$. If $Q$ is the corresponding observable on a quantum system in state 

$$
  \ket{\psi} = \sum_{j,\alpha} c_{j,\alpha} \ket{q_{j,\alpha}}, \; c_{j,\alpha} = \braket{q_{j,\alpha} | \psi}
$$

then the probability of measuring the eigenvalue $q_j$ is given by

$$
\begin{align*}
  \Pr_\psi (q_j) =& \norm{\hat{P}_j \ket{\psi}}^2 \\
  =& \Norm{\sum_{\alpha=1}^{d_j} \ket{q_{j,\alpha}}\braket{q_{j,\alpha}|\psi}} \\
  =& \sum_{\alpha=1}^{d_j} |\braket{q_{j,\alpha}|\psi}|^2 = \sum_{\alpha=1}^{d_j} |c_{j,\alpha}|^2
\end{align*}
$$

This statistical interpretation of quantum observables is known as *Born's rule*, which states that the probability of obtaining an eigenvalue $q_j$ in a measurement of $Q$ is given by the square modulus of the projection of $\ket{\psi}$ onto the corresponding eigenspace.

To see that the map $\Pr_\psi : \sigma(\hat{Q}) \to [0,1]$ defines a probability measure on $\sigma(\hat{Q})$, we note that $\Pr_\psi (q_j) \geq 0$ because square moduli are non-negative. Furthermore, since $\set{\ket{q_{j,\alpha}}}$ forms an orthonormal basis for $\mathcal{H}$ and $\ket{\psi}$ is normalized, it follows that

$$
\begin{align*}
  \sum_j \Pr_\psi (q_j) =& \sum_j \norm{\hat{P}_{q_j} \ket{\psi}}^2 \\
  =& \sum_j \sum_{\alpha=1}^{d_j} |\braket{q_{j,\alpha}|\psi}|^2 \\
  =& \norm{\psi} = 1
\end{align*}
$$

Thus, the normalization condition of quantum states ensures that the total probability sums to $1$, validating that $\Pr_\psi$ is a probability measure over the spectrum $\sigma(\hat{Q})$.

If a quantum system has been prepared in the state $\ket{\psi}\in\mathcal{H}$, the probability to observe it in the state $\ket{\varphi}\in\mathcal{H}$ is given by $\Pr(\varphi|\psi) = |\braket{\varphi|\psi}|^2$, assuming both states are normalized, i.e. $\norm{\psi}^2 = 1 = \norm{\varphi}$. To see this, note that the measurement corresponds to the observable given by the orthogonal projection $\hat{P}_\varphi = \ket{\varphi}\bra{\varphi}$ onto $\ket{\varphi}$. This operator has the eigenvalues $0$ and $1$. The eigenvalue $\lambda = 1$ is non-degenerate and its eigenspace is spanned by $\ket{\varphi}$. Hence, the projection onto the eigenspace for eigenvalue $\lambda = 1$ is given by

$$
\begin{align*}
  \Pr_\psi (\lambda = 1) =& \norm{\hat{P}_\varphi \ket{\psi}}^2 = \norm{\ket{\varphi}\braket{\varphi|\psi}}^2 \\
  =& |\braket{\varphi|\psi}|^2 \underbrace{\norm{\varphi}^2}_{=1} = |\braket{\varphi|\psi}|^2
\end{align*}
$$

## Expectation value

The expectation value of an observable $Q$ in the normalized state $\ket{\psi}\in\mathcal{H}$ is defined as

$$
  \braket{Q}_\psi := \frac{\braket{\psi|\hat{Q}|\psi}}{\braket{\psi|\psi}} = \braket{\psi|\hat{Q}|\psi}
$$

If $\hat{Q}$ has spectral decomposition

$$
  \hat{Q} = \sum_{j,\alpha} q_j \ket{q_{j,\alpha}}\bra{q_{j,\alpha}}
$$

the expectation value is given by

$$
\begin{align*}
  \braket{Q}_\psi =& \braket{\psi|\hat{Q}|\psi} = \Braket{\psi|\sum_{j,\alpha} q_j \ket{q_{j,\alpha}}\braket{q_{j,\alpha}|\psi}} \\
  =& \sum_{j,\alpha} q_j \braket{\psi|q_{j,\alpha}}\braket{q_{j,\alpha}|\psi} \\
  =& \sum_{j,\alpha} q_j |\braket{\psi|q_{j,\alpha}}|^2 = \sum_{j,\alpha} q_j |c_{j,\alpha}|^2
\end{align*}
$$

Properties of expectation values
1. $\braket{Q}_\psi \in\R$ is real since $\hat{Q}$ is Hermitian
2. **Invariance unde global phase:** For any global phase factor $e^{i\phi}$, where $\phi\in\R$, we have $\braket{Q}_{e^{i\phi} \psi} = \braket{Q}_\psi$
3. **Equality of observables:** Two observables $\hat{Q}$ and $\hat{Q}'$ are equal if and only if $\braket{\psi|\hat{Q}|\psi} = \braket{\psi|\hat{Q}'|\psi}$ for all $\ket{\psi}\in\mathcal{H}$

<details>
<summary>Proof</summary>

**(1):** Taking the complex conjugate of $\braket{Q}_\psi$, we find

$$
\begin{align*}
  \braket{Q}_\psi^* =& \braket{\psi|\hat{Q}|\psi}^* = \braket{\psi|\hat{Q}^\dagger|\psi} \\
  =& \braket{\psi|\hat{Q}|\psi} = \braket{Q}_\psi
\end{align*}
$$

Since $\braket{Q}_\psi^* = \braket{Q}_\psi$, it follows that $\braket{Q}_\psi \in\R$ is real.

**(2):** Calculating $\braket{Q}_{e^{i\phi}\psi}$, we find 

$$
\begin{align*}
  \braket{Q}_{e^{i\phi} \psi} =& \braket{e^{i\phi}\psi |\hat{Q}|e^{i\phi} \psi} = e^{-i\phi} e^{i\phi} \braket{\psi|\hat{Q}|\psi} \\
  =& \braket{\psi|\hat{Q}|\psi} = \braket{Q}_\psi
\end{align*}
$$
</details>

The expectation value of any observable $Q$ in the state $\ket{\psi}\in\mathcal{H}$ is unaffected under a global phase transformation $e^{i\phi} \ket{\psi}$. In an orthonormal basis $\set{\ket{q_j}}$, we have

$$
  |\braket{e^{i\phi}\psi|q_j}|^2 = |e^{-i\phi}|^2 \cdot |\braket{\psi|q_j}|^2 = |\braket{\psi|q_j}|
$$

showing that the measurement probabilities remain the same. This means that the states $e^{i\phi}\ket{\psi}$ and $\ket{\psi}$ are physically indistinguishable.

While global phase is physically irrelevant, relative phases between components in a quantum superposition can have physical consequences. Specifically, consider two orthonormal states $\ket{\eta},\ket{\psi}\in\mathcal{H}$ satisfying $\braket{\eta|\psi} = 0$. Then 

$$
\begin{align*}
  \ket{a} =& 2^{-1/2} (\ket{\eta} + \ket{\psi}) \\ 
  \ket{b} =& 2^{-1/2} (\ket{\eta} + e^{i\phi} \psi)
\end{align*}
$$

are normalized state vectors. However, while $\ket{\psi}$ and $e^{i\phi} \ket{\psi}$ represents the same state, the states $\ket{a}$ and $\ket{b}$ are physically distinct because they lead to different measurement outcomes. The expectation value of an observable $A$ in state $\ket{a}$ is

$$
\begin{align*}
  \braket{A}_{\ket{\eta} + \ket{\psi}/\sqrt{2}} =& \frac{1}{2} (\braket{\eta + \psi|\hat{A}|\varphi + \psi}) \\
  =& \frac{1}{2}(\braket{\eta|\hat{A}|\eta} + \braket{\psi|\hat{A}|\psi} + \braket{\eta|\hat{A}|\psi} + \underbrace{\braket{\psi|\hat{A}|\eta}}_{\braket{\hat{A}\psi|\eta}}) \\
  =& \frac{1}{2}(\braket{A}_\eta + \braket{A}_\psi) + \Re(\braket{\eta|\hat{A}|\psi})
\end{align*}
$$

where $\Re(\braket{\eta|\hat{A}|\psi})$ is called the interference terms, which arises du to quantum superposition. Similarly, for $\ket{b}$, we find

$$
\begin{align*}
  \braket{A}_{\ket{\eta} + e^{i\phi}\ket{\psi}/\sqrt{2}} =& \frac{1}{2} (\braket{\eta + e^{i\phi} \psi|\hat{A}|\varphi + e^{i\phi} \psi}) \\
  =& \frac{1}{2}(\braket{\eta|\hat{A}|\eta} + \braket{e^{i\phi} \psi|\hat{A}|e^{i\phi} \psi} + e^{i\phi} \braket{\eta|\hat{A}|\psi} + e^{-i\phi} \underbrace{\braket{\psi|\hat{A}|\eta}}_{\braket{\hat{A}\psi|\eta}}) \\
  =& \frac{1}{2}(\braket{A}_\eta + \braket{A}_\psi) + \Re(e^{i\phi} \braket{\eta|\hat{A}|\psi})
\end{align*}
$$

Thus, whenever $\braket{\eta|\hat{A}|\psi} \neq 0$ the real part of $\braket{\eta|\hat{A}|\psi}$ and of $e^{i\phi}\braket{\eta|\hat{A}|\psi}$ differ.

## Determinate states

The uncertainty of an observable $Q$ is state $\ket{\psi}\in\mathcal{H}$ is defined as

$$
  \Delta_\psi (Q) := \sqrt{\braket{\psi|(\hat{Q} - \braket{Q}_\psi \hat{I})^2|\psi}} = \sqrt{\braket{(\hat{Q} - \braket{Q}\hat{I})^2}}
$$

where $\hat{I}$ is the identity operator. If the uncertainty vanishes, i.e. $\Delta_\psi (Q) = 0$, the observable $Q$ in the state $\ket{\psi}$ is said to have a *sharp* value. This is the case if and only if $\ket{\psi}$ is an eigenvector of $\hat{Q}$, i.e.

$$
  \Delta_\psi (Q) = 0 \iff \hat{Q}\ket{\psi} = \braket{Q}_\psi \ket{\psi}
$$

Since $\hat{Q}$ is Hermitian, its expectation value $\braket{Q}_\psi \in\R$ is real, i.e. $\braket{Q}_\psi = \braket{Q}_\psi^*$. Consequently,

$$
  (\hat{Q} - \braket{Q}_\psi \hat{I})^\dagger = \hat{Q} - \braket{Q}_\psi \hat{I} 
$$

and thus

$$
\begin{align*}
  (\Delta_\psi (Q))^2 =& \braket{\psi|(\hat{Q} - \braket{Q}_\psi \hat{I})^2|\psi} \\
  =& \braket{(\hat{Q} - \braket{Q}_\psi \hat{I})\psi | (\hat{Q} - \braket{Q}_\psi \hat{I})\psi} \\
  =& \Norm{(\hat{Q} - \braket{Q}_\psi \hat{I})\psi}^2
\end{align*}
$$

This shows that

$$
  \Delta_\psi (Q) = 0 \iff \hat{Q}\ket{\psi} = \braket{Q}_\psi \ket{\psi}
$$

A state $\ket{\psi}$ that is an eigenvector of an operator associated with an observable is called an *eigenstate* of that operator.

## Continuous spectrum

Let $\hat{Q}$ be a Hermitian operator on the Hilbert space $\mathcal{H}$ with a continuous spectrum, and let $\ket{q}$ denote its eigenstates. The correspodning observable $Q$ in a quantum system described by the state vector $\ket{\psi}$ can be expanded as 

$$
  \ket{\psi} = \int \psi(q) \ket{q} \;\d q, \; \psi(q) = \braket{q|\psi}
$$

where $\psi(q) = \braket{q|\psi}$ is the wavefunction in the eigenbasis $\set{\ket{q}}$. By Born's rule, the probability of measuring $Q$ and finding the eigenvalue in the interval $(q, q + \d q)$ is given by the square modulus of the wavefunction, i.e. $|\psi(q)|^2 \d q$. Expanding the normalization condition on $\ket{\psi}$, we find

$$
\begin{align*}
  \braket{\psi|\psi} =& \int \braket{\psi|q} \braket{q|\psi} \;\d q \\
  =& \int \psi^* (q) \psi(q) \;\d q \\
  =& \int |\psi(q)|^2 \;\d q = 1
\end{align*}
$$

### Generalized orthonormality condition

Let $\hat{O}$ be a one-dimensional observable with a continuous spectrum, and let $\set{\ket{o}}$ be its eigenbasis. The state vector $\ket{\psi}$ of the system can be expanded as

$$
  \ket{\psi} = \int c(o)\ket{o} \;\d o
$$

where $c(o) = \braket{o|\psi}$ is the projection of $\psi$ onto $\ket{o}$. If $\psi(q) = \ket{q|\psi}$ is a wavefunction in terms of another continuous eigenbasis $\set{\ket{q}}$, the normalization condition requires that

$$
  \int |c(o)|^2 \;\d o = \int |\psi(q)|^2 \;\d q 
$$

Substituting $\psi^* (q) = \braket{\psi|q}$ into the right hand side and applying the completeness relation $\int \ket{q}\bra{q} \;\d q = \hat{I}$ we obtain

$$
\begin{align*}
  \int c^* (o) c(o) \;\d o =& \int \d o \;c^* (o) \left(\int \d q \braket{o|q} \braket{q|\psi} \right) \\
  =& \int \d o\; c^*(o) \left(\int \d q\; \psi(q) \phi_{o}^* (q) \right)
\end{align*}
$$

where $\phi_o (q) = \braket{q|o}$, which yields

$$
  c(o) = \braket{o|\psi} = \int \psi(q) \phi_{o}^* (q) \;\d q
$$

Back-substituting $\psi(q) = \braket{q|\psi}$, we get

$$
\begin{align*}
  c(o) =& \int \d o'\; c(o') \left(\int \d q\; \phi_{o'} (q) \phi_o^* (q) \right) \\
  =& \int \d o'\; c(o') \left(\int \d q\; \braket{o|q} \braket{q|o'} \right) \\
  =& \int c(o') \braket{o|o'} \;\d o' 
\end{align*}
$$

from which it follows that

$$
  \braket{o|o'} = \left(\int \d q\; \phi_{o'} (q) \phi_o^* (q) \right) = \delta(o - o')
$$

## Mixed spectrum

Let $\hat{Q}$ be a Hermitian operator on the Hilbert space $\mathcal{H}$ with both a discrete and a continuous spectrum. In this case, the eigenvalues corresponding to the discrete spectrum are labeled by $q_n$, while the continuous spectrum is parametrized by $q$. Assuming that the continuous spectrum is in the range $q\in(\tilde{q},\infty)$, the projection operators for the discrete are continuous components are given by:

$$
\begin{align*}
  \hat{P}_\text{d} =& \sum_n \ket{q_n} \bra{q_n} \\
  \hat{P}_\text{c} =& \int_{\tilde{q}}^\infty \ket{q} \bra{q} \; \d q
\end{align*}
$$

These projection operators must satisfy the completeness relation 

$$
  \hat{P}_\text{c} + \hat{P}_\text{d} = \hat{I}
$$

where $\hat{I}$ is the identity operator on $\mathcal{H}$. In terms of this eigenbasis, a state vector $\ket{\psi}$ can be expanded as

$$
  \ket{\psi} = \sum_n c(q_n) \ket{q_n} + \int_{\tilde{q}}^\infty \psi(q) \ket{\psi} \; d q
$$

where
- $c(q_n) = \ket{q_n |\psi}$ is the expansion coefficient for the discrete eigenbasis $\set{\ket{q_n}}_n$
- $\psi(q) = \ket{q|\psi}$ is the wavefunction in the continuous eigenbasis $\set{\ket{q}}$

According to Born's rule, the probability of measuring $q_n$ in the discrete spectrum is given by $|c(q_n)|^2$, while the probability of measuring the eigenvalue in the interval $(q, q + \d q)$ is given by $|\psi(q)|^2 \d q$. The normalization condition implies that

$$
  \braket{\psi|\psi} = \sum_n |c(q_n)|^2 + \int_{\tilde{q}}^\infty |\psi(q)|^2 \;\d q = 1
$$

## Compatible observables

Two observables $P$ and $Q$ are compatible if they are simultaneously measurable with arbitrary precision. This means that there exists a common eigenbasis for their corresponding operators $\hat{P}$ and $\hat{Q}$, allowing them to be jointly diagonalized. This condition holds if and only if $\hat{P}$ and $\hat{Q}$ commute. In summary, the following statements are equivalent:
1. $P$ and $Q$ are compatible observables
2. $\hat{P}$ and $\hat{Q}$ have a common eigenbasis
3. $\hat{P}$ and $\hat{Q}$ commute, i.e. $[\hat{P}, \hat{Q}] = 0$

<details>
<summary>Proof</summary>

**(2) $\implies$ (3):**
Assuming $\hat{P}$ and $\hat{Q}$ have a common basis of eigenvectors, $\set{\ket{b_k}}_k$, we have

$$
  \hat{P}\ket{b_k} = p_k \ket{b_k}, \quad \hat{Q} \ket{b_k} = q_k \ket{b_k}
$$

It follows that

$$
\begin{align*}
  \hat{P}\hat{Q}\ket{b_k} = \hat{P} q_k \ket{b_k} = q_k \hat{P} \ket{b_k} = q_k p_k \ket{b_k}
  \hat{Q}\hat{P}\ket{b_k} = \hat{Q} p_k \ket{b_k} = p_k \hat{P} \ket{b_k} = p_k q_k \ket{b_k}
\end{align*}
$$

Since $p_k, q_k \in\mathbb{C}$ are scalars it follows that $\hat{P}\hat{Q} = \hat{Q}\hat{P}$.

**(3) $\implies$ (2):**
We now assume that $\mathbf{P}$ and $\mathbf{Q}$ commute. In a basis $\set{\ket{a_k}}$ we have

$$
\begin{equation*}
\begin{split}
  (\mathbf{P}\mathbf{Q})_{jk} =& \braket{a_j | \hat{P}\hat{Q} | a_k} \\
  =& \sum_\ell \braket{a_j | \hat{P} | a_\ell} \braket{a_\ell | \hat{Q} | a_k} \\
  =& \sum_\ell \mathbf{P}_{k\ell} \mathbf{Q}_{\ell j}
\end{split}
\tag{\label{equation-79}}
\end{equation*}
$$

If $\set{\ket{a_k}}_k$ is an eigenbasis of $\hat{P}$, we can rewrite $\eqref{equation-79}$ as

$$
\begin{align*}
  (\mathbf{P}\mathbf{Q})_{jk} =& \sum_\ell \braket{a_j | \hat{P} | a_\ell} \braket{a_\ell | \hat{Q} | a_k} \\
  =& \sum_\ell p_\ell \delta_{j\ell} \mathbf{Q}_{\ell k} = p_j \mathbf{Q}_{jk}
\end{align*}
$$

Inverting the orders of the operators, we have

$$
\begin{align*}
  (\mathbf{Q}\mathbf{P})_{jk} =& \sum_\ell \braket{a_j | \hat{Q} | a_\ell} \braket{a_\ell | \hat{P} | a_k} \\
  =& \sum_\ell \mathbf{Q}_{j\ell} p_k \delta_{\ell k} = p_k \mathbf{Q}_{jk}
\end{align*}
$$

Since $[\hat{P}, \hat{Q}] = 0$, we must have $(p_j - p_k) \mathbf{Q}_{jk} = 0$. This condition is trivially satisfied for $j = k$. In the non-degenerate case, if $p_k \neq p_j$ for $j \neq k$, it follows that $\mathbf{Q}_{jk} = 0$ for $j \neq k$, or equivalently $\mathbf{Q}_{jk} = \mathbf{Q}_{jj} \delta_{jk}$. This implies that the operator $\hat{Q}$ is diagonal in the eigenbasis of $\hat{P}$, proving the result.

In the degenerate case, where $p_j = p_k$ for $j \neq k$, we can consider the subspace spanned by the eigenvectors corresponding to the degenerate eigenvalues. Since $\hat{Q}$ is Hermitian and commutes with $\hat{P}$, we can diagonalize $\hat{Q}$ within this subspace, where $\hat{P} = p_k \hat{I}$. This shows that $\hat{P}$ and $\hat{Q}$ can be jointly diagonlized, and therefore, they share a common eigenbasis.
</details>

In general, a quantum system can be fully characterized by a set of mutually commuting observables, which collectively determine the eigenbasis describing the system's physical states. Such a set is called a *complete set of commuting observables* (CSCO). 

In the simplest case, an observable has a non-degenerate discrete spectrum, meaning each eigenvalue uniquely corresponds to a single eigenstate. In such cases, the observable itself is sufficient to form a CSCO. However, when the spectrum is degenerate, multiple eigenstates may correspond to the same eigenvalue. In such cases, additional commuting observables are needed to distinguish between the degenerate eigenvectors and uniquely specify the system's state.

For finite-dimensional Hilbert spaces, Schur's lemma guarantees that a complete set of commuting observables always exists. This means that in such systems, it is always possible to find a set of commuting operators whose eigenvalues uniquely determine the system's state. In infinite-dimensional systems, there is no universal guarantee for a CSCO, but in many cases - such as systems with continuous symmetries - there can still be a sufficient set of commuting variables to determine the quantum states.

<MathBox title='Complete set of commuting variables' boxType='definition'>
A set of observables $\mathcal{S} = \set{A, B, C, \dots}$ is a complete set of commuting observables (CSCO) if:
1. All the observables commute by pairs
2. Specifying the eigenvalues of all the operators in the CSCO identifies a unique common eigenvector
</MathBox>

## Uncertainty principle

Two quantum observables $P$ and $Q$ are incompatible if they cannot be simultaneously measurable with arbitrary precision. This implies that there is no common eigenbasis for the corresponding operators $\hat{P}$ and $\hat{Q}$. In this case, measuring one observable disturbs the system's state in such a way that it affects the measurement of the other observable. Incompatibility occurs if $\hat{P}$ and $\hat{Q}$ do not commute.

To quantify the uncertainty of an observable $Q$, we define the operator

$$
  \Delta_\psi \hat{Q} = \hat{Q} - \braket{\hat{Q}}_\psi
$$

as the deviation of $\hat{Q}$ from its expectation value in the state $\ket{\psi}$. The variance $\sigma_Q^2$ of $Q$ in the state $\ket{\psi}$ is given by $\sigma_Q^2 = \langle (\Delta_\psi \hat{Q})^2 \rangle$. Expanding this expression we get

$$
\begin{align*}
  \braket{(\Delta_\psi \hat{Q} )^2} &= \Braket{(\hat{Q} - \langle \hat{Q} \rangle_\psi )^2}_\psi \\
  &= \Braket{\hat{Q}^2 - 2 \braket{\hat{Q}}_\psi \hat{Q} + \braket{\hat{Q}}_\psi^2 }_\psi \\
  &= \braket{\hat{Q}^2}_\psi - \braket{\hat{Q}}_\psi^2 \\
  &= \braket{\psi|\hat{Q}^2|\psi} - \braket{\psi |\hat{Q}|\psi}^2
\end{align*}
$$

For two Hermitian operators $\hat{P}$ and $\hat{Q}$, the generalized uncertainty principle, also known as the Robertson-Schrödinger uncertainty relation, states that

$$
\begin{align*}
  \sigma_P^2 \sigma_Q^2 \geq& \left|\frac{1}{2} \Braket{\{\hat{P},\hat{Q}\}} - \braket{\hat{P}} \braket{\hat{Q}} \right|^2 + \left|\frac{1}{2i}\Braket{[\hat{P},\hat{Q}]} \right|^2 \\
  =& |\operatorname{cov}(\hat{P}, \hat{Q})|^2 + \left|\frac{1}{2}\Braket{[\hat{P},\hat{Q}]} \right|^2
\end{align*}
$$

where $\operatorname{cov}(\hat{P}, \hat{Q})$ is the covariance of $\hat{P}$ and $\hat{Q}$. If $\operatorname{cov}(\hat{P}, \hat{Q}) = 0$, the uncertainty principle reduces to

$$
\begin{equation*}
  \sigma_P \sigma_Q \geq \frac{1}{2} \left|\Braket{[\hat{P},\hat{Q}]} \right| 
\tag{\label{equation-102}}
\end{equation*}
$$

which is known as the Heisenberg-Robertson uncertainty relation.

<details>
<summary>Proof</summary>

Let $\hat{P}$ and $\hat{Q}$ be Hermitian operators and define

$$
\begin{align*}
  \ket{f} :=& \Delta\hat{P}\ket{\psi} = (\hat{P} - \braket{\hat{P}})\ket{\psi} \\
  \ket{g} :=& \Delta\hat{Q}\ket{\psi} = (\hat{Q} - \braket{\hat{Q}})\ket{\psi}
\end{align*}
$$

By Hermiticity of $\hat{P}$ and $\hat{Q}$, it follows that $\braket{\hat{P}}, \braket{\hat{Q}}\in\R$ such that $\Delta\hat{P}$ and $\Delta\hat{Q}$ are also Hermitian. Thus,

$$
  \braket{f|f} = \braket{\psi|\Delta \hat{P}^\dagger \Delta\hat{P}|\psi} = \braket{\psi|(\Delta\hat{P})^2|\psi} = \sigma_P^2
$$

and similarly $\braket{g|g} = \sigma_Q^2$. Furthermore

$$
  \braket{f|g} = \braket{\psi|\Delta\hat{P}^\dagger \Delta\hat{Q}|\psi} = \braket{\psi|\Delta\hat{P} \Delta\hat{Q}|\psi} = \braket{\Delta\hat{P}\Delta\hat{Q}}
$$

To find $\braket{\Delta\hat{P}\Delta\hat{Q}}$ we decompose $\Delta\hat{P}\Delta\hat{Q}$ it into its commutator and anti-commutator:

$$
  \Delta\hat{P}\Delta\hat{Q} = \frac{1}{2}[\Delta\hat{P},\Delta\hat{Q}] + \frac{1}{2}\{\Delta\hat{P},\Delta\hat{Q}\}
$$

By Hermiticity, $[\Delta\hat{P},\Delta\hat{Q}]$ is anti-Hermitian and thus $\Braket{[\Delta\hat{P},\Delta\hat{Q}]}$ is purely imaginary. Meanwhile, $\{\Delta\hat{P},\Delta\hat{Q}\}$ is Hermitian and thus $\Braket{\{\Delta\hat{P},\Delta\hat{Q}\}}$ is real. This implies that $\braket{\Delta\hat{P}\Delta\hat{Q}}\in\mathbb{C}$ is a complex number with modulus given by

$$
  |\braket{\Delta\hat{P}\Delta\hat{Q}}|^2 = \left|\frac{1}{2}[\Delta\hat{P},\Delta\hat{Q}]\right|^2 + \left|\frac{1}{2}\{\Delta\hat{P},\Delta\hat{Q}\}\right|^2
$$

Computing $[\Delta\hat{P},\Delta\hat{Q}]$, we find

$$
\begin{align*}
  [\Delta\hat{P},\Delta\hat{Q}] =& (\hat{P} - \braket{\hat{P}})(\hat{Q} - \braket{\hat{Q}}) - (\hat{Q} - \braket{\hat{Q}})(\hat{P} - \braket{\hat{P}}) \\
  =& \hat{P}\hat{Q} - \braket{\hat{Q}}\hat{P} - \braket{\hat{P}}\hat{Q} + \braket{\hat{Q}}\braket{\hat{P}} \\
  &- \hat{Q}\hat{P} + \braket{\hat{P}}\hat{Q} + \braket{\hat{Q}}\hat{P} - \braket{\hat{P}}\braket{\hat{Q}} \\
  =& \hat{P}\hat{Q} - \hat{Q}\hat{P} = [\hat{P},\hat{Q}]
\end{align*}
$$

Computing $\braket{\{\Delta\hat{P},\hat{Q}\}}$, we find

$$
\begin{align*}
  \Braket{\{\Delta\hat{P},\hat{Q}\}} =& \Braket{(\hat{P} - \braket{\hat{P}})(\hat{Q} - \braket{\hat{Q}}) + (\hat{Q} - \braket{\hat{Q}})(\hat{P} - \braket{\hat{P}})} \\
  =& \left\langle \hat{P}\hat{Q} - \braket{\hat{Q}}\hat{P} - \braket{\hat{P}}\hat{Q} + \braket{\hat{Q}}\braket{\hat{P}} \right. \\
  &\left. +\hat{Q}\hat{P} - \braket{\hat{P}}\hat{Q} - \braket{\hat{Q}}\hat{P} + \braket{\hat{P}}\braket{\hat{Q}} \right\rangle \\
  =& \braket{\hat{P}\hat{Q} + \hat{Q}\hat{P}} - 4\braket{\hat{P}}\braket{\hat{Q}} + 2\braket{\hat{P}}\braket{\hat{Q}} \\
  =& \Braket{\{\hat{P}, \hat{Q}\}} - 2\braket{\hat{P}}\braket{\hat{Q}}
\end{align*}
$$

Combining the results, we obtain

$$
\begin{align*}
  |\braket{\Delta\hat{P}\Delta\hat{Q}}|^2 =& \left|\frac{1}{2}\Braket{[\Delta\hat{P},\Delta\hat{Q}]}\right|^2 + \left|\frac{1}{2}\Braket{\{\Delta\hat{P},\Delta\hat{Q}\}}\right|^2 \\
  =& \left|\frac{1}{2}\Braket{[\hat{P},\hat{Q}]}\right|^2 + \left|\frac{1}{2}\Braket{\{\hat{P},\hat{Q}\}} - \braket{\hat{P}}\braket{\hat{Q}}\right|^2
\end{align*}
$$

Invoking the Cauchy-Schwarz inequality, we get

$$
\begin{align*}
  \braket{f|f}\braket{g|g} \geq& |\braket{f|g}|^2 \\
  \sigma_P^2 \sigma_Q^2 \geq& |\braket{\Delta\hat{P}\Delta\hat{Q}}|^2
\end{align*}
$$

from which it follows that

$$
  \sigma_P^2 \sigma_Q^2 \geq \left|\frac{1}{2}\Braket{[\hat{P},\hat{Q}]}\right|^2 + \left|\frac{1}{2}\Braket{\{\hat{P},\hat{Q}\}} - \braket{\hat{P}}\braket{\hat{Q}}\right|^2
$$
</details>

# Symmetries and transformations

<MathBox title="Ray map" boxType="definition">
Let $\mathcal{H}$ be a Hilbert space. A ray map (or projective symmetry) is a bijection $\hat{T} \mathcal{PH}\to\mathcal{PH}$ that preserves the transition probabilities. That is, for all nonzero, $\ket{\psi} \ket{\phi}\in\mathcal{PH}$

$$
  |\braket{\psi|\phi}| = |\braket{\psi'|\phi'}|
$$

where the images $\psi'$ and $\phi'$ are any nonzero representatives of the rays

$$
  [\psi'] = \hat{T}([\psi]),\quad [\phi'] = \hat{T}([\phi])
$$
</MathBox>

<MathBox title="Wigner's theorem" boxType="theorem" tag="theorem-2">
Let $\mathcal{H}$ be a Hilbert space and let $\hat{T}:\mathcal{PH} \to\mathcal{PH}$ be a bijective ray map. Then there exists a surjective isometry $\hat{U}: \mathcal{H}\to\mathcal{H}$ satisfying one of the following two mutually exclusive conditions
- **Unitary case:** $\hat{U}$ is linear satisfying for all $\ket{\psi}, \ket{\phi}\in\mathcal{H}$
$$
  \braket{\hat{U}\psi|\hat{U}\phi} = \braket{\psi|\phi}
$$
- **Anti-unitary case:** $\hat{U}$ is conjugate-linear satisfying for all $\ket{\psi}, \ket{\phi}\in\mathcal{H}$
$$
  \braket{\hat{U}\psi|\hat{U}\phi} = \braket{\psi|\phi}^* 
$$

In both cases

$$
  \hat{T}([\psi]) = [\hat{U}\psi],\; \forall [\psi] \in\mathcal{PH}
$$

Moreover $\hat{U}$ is unique up to a global phase: if $\hat{U}'$ also implements $\hat{T}$ then $\hat{U}' = e^{i\theta} \hat{U}$ for some $\theta\in\R$.

<details>
<summary>Proof</summary>

**Symmetry transformation of orthonormal bases**

Let $\set{\ket{b_j}}_{j=1}^n$ be an orthonormal basis in $\mathcal{H}$ with $\dim(\mathcal{H}) = n$. For each basis ray $[\ket{b_j}]$, choose a normalized representative $\ket{b'_j} \in\hat{T}([\ket{e_j}])$. Then, by definition of $\hat{T}$

$$
  |\braket{b'_j |b'_k}| = |\braket{b_j |b_k}| = \delta_{jk}
$$

meaning that each pair $\ket{b'_j}, \ket{b'_k}$ is either orthogonal or equal to a phase factor. Without loss of generality, we can fix the phases of $\ket{b'_j}$ such that

$$
  \braket{b'_j |b'_k} = \delta_{jk}
$$

so that $\set{\ket{b'_j}}$ forms an orthonormal basis of $\mathcal{H}$.

**Symmetry transformation of arbitrary vectors**

In terms of the orthonormal basis $\set{\ket{b_j}}$, every vector $\ket{\psi}\in\mathcal{H}$ admits a unique expansion

$$
\begin{equation*}
  \ket{\psi} = \sum_j \alpha_j \ket{b_j},\; \alpha_j = \braket{b_j |\psi}
\tag{\label{equation-184}}
\end{equation*}
$$

Let $\ket{\psi'}$ be a normalized representative of the ray $\hat{T}([\ket{\psi}])$. By definition of $\hat{T}$, we have

$$
  |\braket{b'_j | \psi'}| = |\braket{b_j |\psi}| = |\alpha_j|
$$

Define $a_j = \braket{b'_j | \psi'}$ so that

$$
\begin{equation*}
  |a_j| = |\alpha_j|
\tag{\label{equation-179}}
\end{equation*}
$$

Consider the vector

$$
  \ket{\phi} = \ket{\psi'} - \sum_j a_j \ket{b'_j}
$$

Taking the square norm yields

$$
\begin{align*}
  \norm{\phi}^2 =& \norm{\psi'}^2 - \sum_j |b_j|^2 \\
  =& \norm{\psi}^2 - \sum_j |\alpha_j|^2 = 0
\end{align*}
$$

that is, $\ket{\phi}$ is the zero vector, and we may write

$$
\begin{equation*}
  \ket{\psi'} = \sum_j a_j \ket{b'_j}
\tag{\label{equation-192}}
\end{equation*}
$$

**Symmetry transformation of test vectors**

For distinct indices $j, k \in\set{2,\dots,n}$ with $j \neq k$, define the test vectors

$$
\begin{align*}
  \ket{\psi_{1j}} =& \ket{b_1} + \ket{b_j} \\
  \ket{\psi_{1k}} =& \ket{b_1} + \ket{b_k} \tag{\label{equation-193}} \\
  \ket{\psi_{1jk}} =& \ket{b_1} + \ket{b_j} + \ket{b_k} \tag{\label{equation-197}}
\end{align*}
$$

Applying $\eqref{equation-192}$ and $\eqref{equation-179}$, the symmetry transformation of these vectors can be written (up to overall phase factors) as

$$
\begin{align*}
  \ket{\psi'_{1j}} =& e^{i\delta_{1j}} (\ket{b'_1} + e^{i\eta_{j1}} \ket{b'_j}) \\
  \ket{\psi'_{1k}} =& e^{i\delta_{1k}} (\ket{b'_1} + e^{i\eta_{k1}} \ket{b'_k}) \tag{\label{equation-194}} \\
  \ket{\psi'_{1jk}} =& e^{i\delta_{1jk}} (\ket{b'_1} + e^{i\eta_{jk1}} \ket{e'_j} + e^{i\eta_{k1j}} \ket{e'_k}) \tag{\label{equation-181}}
\end{align*}
$$

By preservation of transition probabilities under $\hat{T}$

$$
\begin{equation*}
  |\braket{\psi'_{1j}|\psi'_{1jk}}| = |\braket{\psi_{1j}|\psi_{1jk}}|
\tag{\label{equation-180}}
\end{equation*}
$$

In the original basis

$$
  \braket{\psi_{1j}|\psi_{1jk}} = \braket{b_1 + b_j | b_1 + b_j + b_k} = 2
$$

In the transformed basis

$$
\begin{align*}
  \braket{\psi'_{1j}|\psi'_{1jk}} =& \braket{e^{-i\delta_{1j}}} (b_1 + e^{-i\eta_{j1}} b_j)| e^{i\delta_{1jk} (b_1 + e^{i\eta_{jk1}} b_j + e^{i\eta_{k1j}} b_k)} \\
  =& e^{-i(\delta_{ij - \delta_{1jk}})} (1 + e^{i \eta_{jk1} - \eta_{j1}})
\end{align*}
$$

Taking moduli and applying $\eqref{equation-180}$, we must have

$$
  |1 + e^{i(\eta_{jk1} - \eta_{j1})}| = 2
$$

which implies

$$
\begin{equation*}
  e^{i\eta_{jk1}} = e^{i\eta_{j1}}
\tag{\label{equation-182}}
\end{equation*}
$$

Thus, the phase factor multiplying $\ket{b'_j}$ in $\eqref{equation-181}$ is independent of $\ket{b_j}$.

An analogous argument using the symmetry transformation equality

$$
  |\braket{\psi'_{1k}|\psi'_{1jk}}| = |\braket{\psi_{1k}|\psi_{1jk}}|
$$

yields

$$
\begin{equation*}
  e^{i\eta_{k1j}} = e^{i\eta_{k1}}
\tag{\label{equation-183}}
\end{equation*}
$$ 

showing that the phase factor multiplying $\ket{b'_k}$ in $\eqref{equation-181}$ is likewise independent of $\ket{b_k}$.

Substituting $\eqref{equation-182}$ and $\eqref{equation-183}$ into $\eqref{equation-181}$, we obtain

$$
  \ket{\psi'_{1jk}} = e^{i\delta_{1jk}} (\ket{b'_1} + e^{i\eta_{j1}} \ket{b'_j} + e^{i\eta_{k1}} \ket{b'_k})
$$

Since the relative phase factors $e^{i\eta_{j1}}$, $e^{i\eta_{k1}}$ are defined with respect $\ket{e'_1}$, we will, for notational simplicity, omit the subscript $1$ in $\eta_{j1}$, $\eta_{k1}$ in the following expressions.

**Phase relations under symmetry transformation**

Assume first that $\alpha_1 \neq 0$ in $\eqref{equation-184}$. By preservation of transition probabilities under $\hat{T}$

$$
\begin{equation*}
  |\braket{\psi'_{1k} |\psi'}| = |\braket{\psi_{1k} |\psi}|
\tag{\label{equation-195}}
\end{equation*}
$$

Then from $\eqref{equation-193}$ and $\eqref{equation-184}$

$$
  \braket{\psi_{1k}|\psi} = \Braket{b_1 + b_k | \sum_{j=1}^n \alpha_j b_j} = \alpha_1 + \alpha_k
$$

and from $\eqref{equation-194}$ and $\eqref{equation-192}$ and applying $\eqref{equation-179}$, we obtain

$$
\begin{align*}
  \braket{\psi'_{1k}|\psi'} = \Braket{e^{-i\delta_{1k}} (b'_1 + e^{-i\eta_k} b'_k)| \sum_{j=1}^n a_j b'_j} = a_1 + e^{i\eta_k}
\end{align*}
$$

Invoking $\eqref{equation-195}$ and dividing by $|a_1| = |\alpha_1|$, we must have

$$
  \left|1 + e^{-i\eta_k} \frac{a_k}{a_1} \right| = \left|1 + \frac{\alpha_k}{\alpha_1} \right|
$$

Expanding the moduli and equating the real parts yields

$$
\begin{equation*}
  \Re\left(e^{-i\eta_k} \frac{a_k}{a_1} \right) = \Re\left(\frac{\alpha_k}{\alpha_1} \right)
\tag{\label{equation-185}}
\end{equation*}
$$

Using again $\eqref{equation-179}$, it follows that

$$
\begin{equation*}
  \left[\Im\left(e^{-i\eta_k} \frac{a_k}{a_1} \right)\right]^2 = \left[\Im\left(\frac{\alpha_k}{\alpha_1} \right) \right]^2
\tag{\label{equation-186}}
\end{equation*}
$$

By preservation of transition probabilities under $\hat{T}$

$$
\begin{equation*}
  |\braket{\psi'_{1jk}|\psi'}| = |\braket{\psi_{1jk}|\psi}|
\tag{\label{equation-196}}
\end{equation*}
$$

From $\eqref{equation-197}$ and $\eqref{equation-184}$

$$
  \braket{\psi_{1jk}|\psi} = \Braket{b_1 + b_j + b_k | \sum_{l=1}^n \alpha_l b_l} = \alpha_1 + \alpha_j + \alpha_k
$$

From $\eqref{equation-181}$ and $\eqref{equation-192}$ and applying $\eqref{equation-179}$

$$
\begin{align*}
  \braket{\psi'_{1jk}|\psi} =& \Braket{e^{-i\delta_{1jk}} (b'_1 + e^{-i\eta_j} b'_j + e^{-i\eta_k} b'_k) | \sum_{l=1}^n a_l b'_k} \\
  =& a_1 + e^{-i\eta_j} a_j + e^{-i\eta_k} a_k
\end{align*}
$$

Applying $\eqref{equation-196}$ and dividing by $|a_1| = |\alpha_1$, we must have

$$
  \left|1 + e^{-i\eta_j} \frac{a_j}{a_1} + e^{-i\eta_j} \frac{a_k}{a_1} \right| = \left|1 + \frac{\alpha_j}{\alpha_1} + \frac{\alpha_k}{\alpha_1} \right|
$$

Together with $\eqref{equation-185}$ and $\eqref{equation-179}$, this equality constrainst the imaginary coefficient ratios to satisfy

$$
\begin{equation*}
  \left[\Im\left(e^{-i\eta_j} \frac{a_j}{a_1} \right) \right] \left[\Im\left(e^{-i\eta_k} \frac{a_k}{a_1} \right) \right] = \left[\Im\left(\frac{\alpha_j}{\alpha_1} \right) \right] \left[\Im\left(\frac{\alpha_k}{\alpha_1} \right) \right]
\tag{\label{equation-187}}
\end{equation*}
$$

Combining this relation with $\eqref{equation-186}$, we distinguish two mutually exclusive possibilities. 

- Case I: Preservation of complex phases

Suppose that for some $k \neq 1$

$$
  \Im\left(e^{i\eta_k} \frac{a_k}{a_1} \right) = \Im\left(\frac{\alpha_k}{\alpha_1} \right)
$$

Then by $\eqref{equation-187}$, the same equality must hold simultaneously for all $j \neq 1$

$$
  \Im\left(e^{-i\eta_j} \frac{a_j}{a_1} \right) = \Im\left(\frac{\alpha_j}{\alpha_1} \right)
$$

Thus, by $\eqref{equation-185}$ we must have for all $j \neq 1$

$$
\begin{equation*}
  e^{-i\eta_j} \frac{a_j}{a_1} = \frac{\alpha_j}{\alpha_1}
\tag{\label{equation-189}}
\end{equation*}
$$

- Case II: Complex conjugation of coefficients

Alternatively, if for some $k\geq 1$

$$
  \Im\left(e^{-i\eta_k} \frac{a_k}{a_1} \right) = -\Im\left(\frac{\alpha_k}{\alpha_1} \right)
$$

then, again by $\eqref{equation-187}$, the same relation holds for all $j \neq 1$

$$
  \Im\left(e^{-i\eta_j} \frac{a_j}{a_1} \right) = -\Im\left(\frac{\alpha_j}{\alpha_1} \right)
$$

Thus, by $\eqref{equation-185}$ we must have for all $j \neq 1$

$$
\begin{equation*}
  e^{-i\eta_j} \frac{a_j}{a_1} = \left(\frac{\alpha_j}{\alpha_1}\right)^* \iff a_k = a_1 e^{i\eta_k} \left(\frac{\alpha_k}{\alpha_1} \right)^*
\tag{\label{equation-191}}
\end{equation*}
$$

- Unified form of the transformation

From $\eqref{equation-189}$ and $\eqref{equation-191}$, the coefficients of the transformed state $\ket{\psi'}$ satisfy one of the two uniform alternatives

$$
  a_k = \begin{cases} 
    a_1 e^{i\eta_k} \frac{\alpha_k}{\alpha_1}
    a_1 e^{i\eta_k} \left(\frac{\alpha_k}{\alpha_1} \right)^*
  \end{cases}
$$

Consequently, under a symmetry transformation $\ket{\psi}$ transforms to

$$
  \ket{\psi'} = \frac{a_1}{\alpha_1^\#} \sum_k \alpha_k^\# e^{i\eta_k} \ket{b'_k}
$$

with $e^{1\eta_1} = 1$ and $\alpha^\#$ denotes either $\alpha$ or else $\alpha*$. The same $\#$ rule for the transformation applies to all coefficients $\alpha_k$ in the expansion of $\ket{\psi}$. 

The case $\alpha_1 = 0$ can be treated analogously by introducing the vector

$$
  \ket{\chi} = \ket{b_1} + \sum_{j\geq 2} \alpha_j \ket{b_j}
$$

Since by definition of $\hat{T}$

$$
  |\braket{b'_j |\psi'}| = |\braket{b_j|\psi}| = |\braket{b_k|\chi}|
$$

we obtain

$$
  a_k = e^{i\eta_k} \alpha_k^\# a_1,\; k \geq 2
$$

where $a_1$ is some phase factor.

In all cases, the state $\ket{\psi}$ takes one of the two forms (up to overall phase factors) under a symmetry transformation

$$
\begin{align*}
  \ket{\psi'} =& \sum_j \alpha_j e^{i\eta_j} \ket{e'_j} \\
  \ket{\psi'} =& \sum_j \alpha_j^* e^{i\eta_j} \ket{e'_j}
\end{align*}
$$

thus defining the corresponding ray transformations. The phases $e^{i\eta_k}$ are independent of the expansion coefficients, and for each $k$, the phase $e^{i\eta_k}$ is defined in terms of the pair of vectors $\ket{e_j}$, $\ket{e_1}$ only. Since the basis vectors $\set{\ket{b_j}}$ are pairwise orthogonal, the relative phases $\exp[i(\eta_j - \eta_j)]$, for $j \neq k$, do not occur in the transformation.

**Consistency of the $\#$ rule**

It remains to establish, that under a symmetry transformation, if a single vector in $\mathcal{H}$ transforms under the $\#$ rule, then every other vector in $\mathcal{H}$ must transform under the same rule. Suppose, for the sake of contradiction, that two given vectors $\ket{\psi}, \ket{\phi} \in\mathcal{H}$ transform according to different $\#$ rules. Write

$$
\begin{align*}
  \ket{\psi} =& \sum_j \alpha_j \ket{e_j} \\
  \ket{\phi} =& \sum_j \beta_j \ket{e_j}
\end{align*}
$$

and assume that $\ket{\psi}$ and $\ket{\phi}$ transforms unitarily and anti-unitarily, respectively, under $\hat{T}$, i.e.

$$
\begin{align*}
  \ket{\psi'} =& \sum_j \alpha_j e^{i\eta_j} \ket{e'_j} \\
  \ket{\phi'} =& \sum_j \beta_j^* e^{i\eta_k} \ket{e'_k}
\end{align*}
$$

By definition of $\hat{T}$

$$
  |\braket{\psi'|\phi'}| = |\braket{\psi|\phi}|
$$

and expanding both sides gives the condition

$$
\begin{equation*}
  \sum_{j,k} \Im(\alpha_j \alpha_k^*) \Im(\beta_j \beta_k^*) = 0
\tag{\label{equation-199}}
\end{equation*}
$$

We now analyze all possible configurations of coeffecients that could satisfy this equality. In each case, we show that the assumption of mixed $\#$ rules leads to a contradiction

- Case 1: Existence of a nontrivial pair $(j, k)$

Suppose there exists at least one distinct pair $(j,k)$ with $j\neq k$ such that

$$
\begin{align*}
  \Im(\alpha_j \alpha_k^*) \neq& 0 \tag{\label{equation-188}} \\
  \Im(\beta_j \beta_k^*) \neq& 0 \tag{\label{equation-198}}
\end{align*}
$$

Define the vector

$$
  \ket{\chi} = \frac{1}{\sqrt{2}}(\ket{b_j} - i\ket{b_k}) := \sum_l \gamma_l \ket{b_l}
$$

for which $\Im(\gamma_j \gamma_k^*) = 1/2$. If $\ket{\chi}$ transforms like $\ket{\phi}$ we obtain

$$
  \Im(\alpha_j \alpha_k^*) \Im(\gamma_j \gamma_k^*) = 0
$$

which contradicts $\eqref{equation-188}$. Similarly, if $\ket{\chi}$ transforms like $\ket{\psi}$ we obtain a contradiction with $\eqref{equation-198}$. Hence, $\ket{\psi}$ and $\ket{\phi}$ must transform according to the same $\#$ rule.

- Case 2: No such a pair, but existence of a nontrivial triplet $(j, k, l)$

Assume there exists a triplet of distinct indices $j, k, l$, all unequal, such that

$$
\begin{align*}
  \Im(\alpha_j \alpha_k^*) \neq 0,\quad& \Im(\alpha_j \alpha_l^*) = 0 \\
  \Im(\beta_j \beta_k^*) = 0,\quad& \Im(\beta_j \beta_l^*) \neq 0
\end{align*}
$$

Note that if either (or both) of $\Im(\alpha_j \alpha_l^*)$ and $\Im(\beta_j \beta_k^*)$ are not zero, we would retrieve Case 1. 

Define the vector

$$
  \ket{\xi} = \frac{1}{\sqrt{3}} (\ket{b_j} -i\ket{b_k} - i\ket{b_l}) := \sum_i \gamma_i \ket{b_i}
$$

for which
- $\Im(\gamma_j \gamma_k^*) = \Im(\gamma_j \gamma_l^*) = 1/3$
- $\Im(\gamma_k \gamma_l^*) \neq 0$

If $\ket{\xi}$ transforms according to either rule of $\ket{\psi}$ or that of $\ket{\phi}$, then $\eqref{equation-199}$ again leads to a contradiction, since $\Im(\alpha_j \alpha_k^*) \neq 0$ and $\Im(\beta_j \beta_l^*) \neq 0$. Hence, $\ket{\psi}$ and $\ket{\phi}$ must follow the same $\#$ rule.

- Case 3: No such a triplet, but existence of a quadruplet $(j, k, l, m)$

Suppose there exists distinct indices $j, k, l, m$, all unequal, satisfying

$$
\begin{align*}
  \Im(\alpha_j \alpha_k^*) \neq 0,\quad& \Im(\alpha_j \alpha_m^*) = 0 \\
  \Im(\alpha_k \alpha_l^*) \neq 0,\quad& \Im(\alpha_l \alpha_m^*) = 0 \\
  \Im(\beta_j \beta_k^*) \neq 0,\quad& \Im(\beta_j \beta_m^*) = 0 \\
  \Im(\beta_k \beta_l^*) \neq 0,\quad& \Im(\beta_l \beta_m^*) = 0
\end{align*}
$$

Define the vector

$$
  \ket{\eta} = \frac{1}{\sqrt{4}}(\ket{b_j} - i\ket{b_k} + \ket{b_l} - i\ket{b_m}) := \sum_i \gamma_i \ket{b_i}
$$

and note that

$$
\begin{align*}
  \Im(\gamma_j \gamma_k^*) =& \Im(\gamma_j \gamma_m^*) \\
  =& \Im(\gamma_l \gamma_m^*) = \Im(\gamma_l \gamma_k^*) \\
  =& \frac{1}{4}
\end{align*}
$$

and

$$
  \Im(\gamma_j \gamma_j^*) = \Im(\gamma_k \gamma_m^*) = 0
$$

Substituting into $\eqref{equation-199}$, again yields a contradiction, therefore the same transformation rule must hold for $\ket{\psi}$ and $\ket{\phi}$.

- Case 4: All pairwise imaginary parts of $\alpha_j \alpha_k^*$ vanish

Suppose $\Im(\alpha_j \alpha_k^*) = 0$ for all distinct pairs $(j, k)$ with $j \neq k$. Then either
1. $\Im(\alpha_k) = 0$ for all $k$, in which case $\alpha_k = \alpha_k^*$ and $\ket{\psi}$ transforms the same way as $\ket{\phi}$, up to an overall phase. 
2. $\Im(\alpha_j) \neq 0$ for at least one $j$, in which case $\Im(\alpha_j \alpha_k^*) = 0$ implies

$$
  \alpha_k = \alpha_k^* \left(\frac{\alpha_j}{\alpha_j^*}\right)
$$

since $\alpha_j / \alpha_j^*$ is a pure phase, all coefficient are related by a common phase. Thus $\ket{\psi}$ and $\ket{\phi}$ must transform consistently.

- Case 5: All pairwise imaginary parts of $\beta_j \beta_k^*$ vanish

This case is analogous to Case 4 by reversing the roles of $\ket{\phi}$ and $\ket{\psi}$.

**Conclusion**

We have established that, for each index $k$, there exists a real phase factor $\eta_k \in\R$ such that

$$
\begin{equation*}
  e^{i\eta_k} \ket{b'_k} = \hat{U} \ket{b_k}
\tag{\label{equation-200}}
\end{equation*}
$$

where $\hat{U}$ denotes the operator implementing the symmetry transformation on $\mathcal{H}$.

For any vector $\ket{\psi} = \sum_k \alpha_k \ket{b_k} \in\mathcal{H}$ we have by construction

$$
  \hat{U} \ket{psi} = \sum_k \alpha_k \hat{U} \ket{b_k}
$$

in the case of a unitary transformation, or else

$$
  \hat{U} \ket{\psi} = \sum_k \alpha_k^* \hat{U} \ket{b_k}
$$

in the case of an anti-unitary transformation. Hence

$$
  \ket{\psi'} = \hat{U}\ket{\psi},\; \forall \ket{\psi}\in\mathcal{H}
$$

For any two vectors $\ket{\psi} = \sum_k \alpha_k \ket{b_k} \in\mathcal{H}$ and $\ket{\phi} = \sum_k \beta_k \ket{b_k}\in\mathcal{H}$, we have

$$
  \ket{\hat{U}\psi|\hat{U}\phi} = \sum_k \alpha_k^* \beta_k = \braket{\psi|\phi}
$$

in the unitary case, and

$$
  \braket{\hat{U}\psi|\hat{U}\phi} = \sum_k \alpha_k \beta_k^* = \braket{\psi|\phi}^* = \braket{\phi|\psi}
$$

in the antiunitary case. Thus, in both cases, the absolute value of the inner product is preserved

$$
  |\braket{\hat{U}\ket{\psi}|\hat{U}\phi}| = |\braket{\psi|\phi}|
$$

Finally, for $\alpha, \beta \in\mathbb{F}$ consider any linear combination 

$$
  \alpha\ket{\psi} + \beta\ket{\phi} = \sum_k (\alpha \alpha_k + \beta \beta_k) \ket{b_k}
$$

Under the symmetry transformation, this vector transforms in the unitary case to

$$
\begin{equation*}
  (\alpha\ket{\psi} + \beta\ket{\phi})' = \sum_k (\alpha \alpha_k + \beta \beta_k) e^{i\eta_k} \ket{b'_k}
\tag{\label{equation-201}}
\end{equation*}
$$

or in the anti-unitary case to

$$
\begin{equation*}
  (\alpha(\ket{\psi} + \beta\ket{\phi}))' = \sum_k (\alpha^* \alpha_k^* + \beta^* \beta_k^*) e^{i\eta_k} \ket{b'_k}
\tag{\label{equation-202}}
\end{equation*}
$$

both expressions holding up to an overall phase factor. Using $\eqref{equation-200}$, the right-hand side of $\eqref{equation-201}$ in the unitary case is given by

$$
  \alpha\hat{U}\ket{\psi} + \beta\hat{U}\ket{\phi}  
$$

and the right-hand side of $\eqref{equation-202}$ in the anti-unitary case is given by

$$
  \alpha^* \hat{U}\ket{\psi} + \beta^* \hat{U}\ket{\phi}
$$

Thus, identifying the transformed vector $(\alpha\ket{\psi} + \beta\ket{\phi})'$ with $\hat{U}(\alpha\ket{\psi} + \beta\ket{\phi})$ we deduce that

$$
\begin{align*}
  \hat{U}(\alpha\ket{\psi} + \beta\ket{\phi}) =& \alpha\hat{U}\ket{\psi} + \beta\hat{U}\ket{\phi} \tag{unitary case} \\
  \hat{U}(\alpha\ket{\psi} + \beta\ket{\phi}) =& \alpha^* \hat{U}\ket{\psi} + \beta^* \hat{U}\ket{\phi} \tag{anti-unitary case}
\end{align*}
$$

showing that $\hat{U}$ is linear in the unitary case, and conjugate-linear in the antiunitary case.
</details>
</MathBox>

## Galilean spacetime coordinate transformations

Let $F$ be an inertial Cartesian frame with spacetime coordinates $(\mathbf{x}, t)$ and consider another Cartesian frame $F'$ obtained from $F$ by 
- a proper (counterclockwise) rotation $\mathbf{R} = (R^i{}_j) \in \operatorname{SO}(3)$
- a spatial translation $\mathbf{a} = (a^i) \in\R^3$
- a uniform relative velocity $\mathbf{v} = (v^i) \in\R^3$ (boost velocity)

together with a constant time offset $\tau\in\R$. Then the spacetime coordinates $(\mathbf{x}', t')$ of a point in $F'$ corresponding to $(\mathbf{x}, t)$ in $F$ are related by the Galilean transformation

$$
\begin{align*}
  {x'}^i =& R^i{}_j x^j - a^j - v^j t \\
  t' =& t - \tau
\end{align*}
$$

where Einstein summation over repeated indices is implied. Thus, a general Galilean transformation is parametrised by the quadruple $(\tau, \mathbf{a}, \mathbf{v}, \mathbf{R})$. The inverse transformation is obtained by using $\mathbf{R}^{-1} = \mathbf{R}^\top$ and $t = t' + \tau$


$$
\begin{align*}
  x^i =& R^i{}_j{}^\top ({x'}^j + a^j + v^j (t' + \tau)) \\
  =& R^j{}_i ({x'}^j + a^j + v^j (t' + \tau))
\end{align*}
$$

If $F'$ is rotated relative to $F$ by an angle $\varphi \in\R$ about the unitvector $\mathbf{n} \in\R^3$, the rotation matrix $\mathbf{R}$ is given by Rodrigues' formula

$$
  \mathbf{R}(\varphi, \mathbf{n}) = \cos(\varphi) \mathbf{I}_3 + (1 - \cos(\varphi)) \mathbf{n}\cdot\mathbf{n}^\top + \sin(\varphi) [\mathbf{n}]_\times
$$

Here $[\mathbf{n}]_\times$ defines the skew-symmetric cross-product given by $[\mathbf{n}]_\times \mathbf{x} = \mathbf{n} \times \mathbf{x}$. In terms of the Levi-Civita symbol $\varepsilon_{ijk}$, the component form can be expressed as

$$
  ([\mathbf{n}]_\times)_{ik} = \varepsilon_{ijk} n^j
$$

In component form, Rodrigues' formula reads

$$
  R^i{}_j (\varphi, \mathbf{n}) = \cos(\varphi) \delta^i{}_k + [\cos(\varphi) - 1] n^i n_k - \sin(\varphi) \varepsilon^i{}_{jk} n^j
$$

### Infinitesimal Galilean transformation

In particular, we consider an infinitesimal rotation by and angle $\delta\varphi$ about a unit axis $\mathbf{n}\in\R^3$ and introduce the infinitesimal rotation vector

$$
  \delta\boldsymbol{\omega} = \mathbf{n} \delta\varphi
$$

To second order in $\delta\varphi$, the rotation matrix $\mathbf{R}$ can be written as

$$
  \mathbf{R} = \mathbf{I}_3 + \mathbf{A} + \mathbf{B} + O(\norm{\delta\boldsymbol{\omega}}^3)
$$

where

$$
\begin{equation*}
\begin{split}
  \mathbf{A} =& [\delta\boldsymbol{\omega}]_\times \in\mathfrak{so}(3) \\
  A^i{}_k =& -\varepsilon^i{}_{jk} \delta\omega^j
\end{split}
\tag{\label{equation-204}}
\end{equation*}
$$

The matrices $\mathbf{A}$ and $\mathbf{B}$ satisfy

$$
\begin{align*}
  \mathbf{A}^\top =& -\mathbf{A} \\
  \mathbf{B}^\top =& \mathbf{B} = \frac{\mathbf{A}^2}{2}
\end{align*}
$$

The orthogonality condition $\mathbf{R}^\top \mathbf{R} = \mathbf{I}_3$ holds to second order in $\norm{\delta\boldsymbol{\omega}}$, and from this, the inverse of $\mathbf{R}$ is given by

$$
  \mathbf{R}^{-1} = \mathbf{I}_3 - \mathbf{A} + \mathbf{B} + O(\norm{\delta\boldsymbol{\omega}}^3)
$$

For infinitesimal first order transformations with parameters $\delta\mathbf{a}$, $\delta\mathbf{v}$, $\delta\operatorname{\omega}$, $\delta\operatorname{\tau}$ the Galilean transformations reduce to

$$
\begin{align*}
  \mathbf{x}' =& \mathbf{x} - \delta\mathbf{a} - \delta\mathbf{v} t - \delta\mathbf{\omega} \times\mathbf{x} \\
  t' =& t - \delta\tau
\end{align*}
$$

The corresponding infinitesimal coordinate variations are given by

$$
\begin{align*}
  \delta\mathbf{x} =& \mathbf{x} - \mathbf{x}' = \delta\mathbf{a} + \delta\mathbf{v}t + \delta\operatorname{\omega} \times\mathbf{x} \tag{\label{equation-213}} \\
  \delta t =& t - t' = \delta\tau
\end{align*}
$$

### Exponential representations of rotations

To find an exponential representation of the rotation matrix $\mathbf{R}$, we introduce a basis of infinitesimal rotation generator $\set{\mathbf{M}^j}_{j=1}^3$ with matrix elements

$$
  [\mathbf{M}^j]^{ik} = i\varepsilon^{ijk},\; i,k = 1,2,3
$$

Each $\mathbf{M}^j$ is a Hermitian, purely imaginary, skew-symmetric matrix representing the generator of rotation about the $j$-axis, and satisfies

$$
\begin{align*}
  [\mathbf{n}\cdot\mathbf{M}]^{ik} =& i\varepsilon^{ijk} n^j \\
  [(\mathbf{n} \cdot\mathbf{M})^2]^{ik} =& \delta^{ik} - n^i n^k \\
  (\mathbf{n}\cdot\mathbf{M})^3 =& \mathbf{n}\cdot\mathbf{M}
\end{align*}
$$

Using these relations the matrix $\mathbf{R}$ can be refactored as

$$
  \mathbf{R} = \mathbf{I}_3 + i\mathbf{n}\cdot\mathbf{M} \sin(\varphi) + (\mathbf{n}\cdot\mathbf{M})^2 (\cos(\varphi) - 1)
$$

Differentiating with respect to $\varphi$ yields the differential equation

$$
  \frac{\d\mathbf{R}}{\d\varphi} = (i\mathbf{n}\cdot\mathbf{M})\mathbf{R}
$$

with boundary condition $\mathbf{R}(0, \mathbf{n}) = \mathbf{I}_3$. The unique solution is therefore

$$
\begin{equation*}
  \mathbf{R} e^{i\varphi \mathbf{n}\cdot\mathbf{M}}
\tag{\label{equation-257}}
\end{equation*}
$$

With $\boldsymbol{\omega} = \varphi\mathbf{n}$ this becomes

$$
  \mathbf{R} = e^{i\boldsymbol{\omega}\cdot\mathbf{M}}
$$

The matrices $M^j$, satisfy the commutation relations

$$
  [\mathbf{M}^i, \mathbf{M}^j] = i\varphi^{ijk} \mathbf{M}^k
$$

and are explicitly given by

$$
\begin{align*}
  \mathbf{M}^1 =& i \left[\begin{smallmatrix} 0 & 0 & 0 \\ 0 & 0 & -1 \\ 0 & 1 & 0 \end{smallmatrix} \right] \\
  \mathbf{M}^2 =& i \left[\begin{smallmatrix} 0 & 0 & 1 \\ 0 & 0 & 0 \\ -1 & 0 & 0 \end{smallmatrix} \right] \\
  \mathbf{M}^3 =& i \left[\begin{smallmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 0 \end{smallmatrix} \right] \\
\end{align*}
$$

which satisfy

$$
\begin{align*}
  (M^j)^\dagger =& M^j \\
  (M^j)^\top =& -M^j \\
  \mathbf{M}^2 =& 2\mathbf{I}_3 \\
  \operatorname{tr}(\mathbf{n}\cdot\mathbf{M}) =& 0
\end{align*}
$$

### Operator identity for finite rotations

<LatexFigure width={50} src='/fig/rotation_configuration.svg' alt=''
  caption='Rotation of a vector $\mathbf{x}$ clockwise by an angle $\varphi$ about a unit vector $\unitvec{n}$. This is equivalent to rotating the coordinate system counter-clockwise about $\unitvec{n}$, while keeping $\mathbf{x}$ fixed.'
>
```latex
\documentclass[tikz, border=5pt]{standalone}
\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{3d, arrows.meta}

\newcommand{\sphericalcoord}[3]{({#1*sin(#2)*sin(#3)}, {#1*cos(#2)}, {#1*sin(#2)*cos(#3)})}

\def\r{5}
\def\phi{45}
\def\theta{30}
\def\alpha{60}

\pgfmathsetmacro{\px}{\r * sin(\theta) * sin(\phi)}
\pgfmathsetmacro{\py}{\r * cos(\theta)}
\pgfmathsetmacro{\pz}{\r * sin(\theta) * cos(\phi)}

\begin{document}
\begin{tikzpicture}[every node/.style={font=\scriptsize}]

  \draw[-Stealth] (0, {\r * cos(\theta)},0) -- (0, \r + 1, 0) node[above]{$\hat{\mathbf{n}}$};
  \draw[-Stealth, green] (0,0,0) -- (0, {\r * cos(\theta)}, 0) node[midway, above, sloped]{$(\mathbf{x} \cdot \hat{\mathbf{n}}) \hat{\mathbf{n}}$};

  \node at (0, -0.5) {$\mathbf{h} = [\mathbf{x} - (\mathbf{x}\cdot\hat{\mathbf{n}})\hat{\mathbf{n}}] \cos(\varphi) + \mathbf{x} \times\hat{\mathbf{n}} \sin(\varphi)$};

  \begin{scope}[
      plane origin={(0,\py,0)},
      plane x={(\px,\py,\pz)},
      plane y={(-\pz,\py,\px)},
      canvas is plane
    ]
    \draw[-Stealth, red] (0,0) -- (0,1) node[left]{$\mathbf{x}\times\hat{\mathbf{n}}$};
    \draw[red] (0.1,0) -- (0.1, 0.1) -- (0, 0.1);
  \end{scope}

  \begin{scope}[canvas is zx plane at y=\r * cos(\theta)]
    \draw[dashed] (0,0) circle [radius=\r * sin(\theta)];
    \draw[-Stealth] (0,0) -- (\phi:{\r * sin(\theta)}) node[above right, xshift=-5pt, rotate=20]{$\mathbf{x} - (\mathbf{x}\cdot\hat{\mathbf{n}})\hat{\mathbf{n}}$};
    \draw[-Stealth] (0,0) -- ({\phi - \alpha}:{\r * sin(\theta)}) node[above, yshift=2pt]{$\mathbf{h}$};
    \draw[-Stealth] (\phi:{0.5 * \r * sin(\theta)}) arc (\phi:{\phi - \alpha}:{0.5 * \r * sin(\theta)}) node[midway, below]{$\varphi$};
  \end{scope}

  \draw[-Stealth, thick, blue] (0,0,0) -- \sphericalcoord{\r}{\theta}{\phi} node[below right]{$\mathbf{x}$};
  \draw[-Stealth, thick, blue] (0,0,0) -- \sphericalcoord{\r}{\theta}{\phi - \alpha} node[below left]{$\mathbf{x}'$};

\end{tikzpicture}
\end{document}
```
</LatexFigure>

We now derive an operator identity connecting the coordinate-scape generator of rotations with the matrix representation of the rotation group $\operatorname{SO}(3)$. Define the rotated vector

$$
  \mathbf{x}' (\varphi) = (\mathbf{x}\cdot\mathbf{n})\mathbf{n} + [\mathbf{x} - (\mathbf{x}\cdot\mathbf{n})\mathbf{n}] \cos(\varphi) + \mathbf{x}\times\mathbf{n} \sin(\varphi)
$$

Then $\mathbf{x}'$ satisfy the differential equation

$$
\begin{equation*}
  \frac{\d}{\d\varphi} \mathbf{x}' = -\mathbf{n}\times\mathbf{x}',\; \mathbf{x}' (0) = \mathbf{x}
\tag{\label{equation-203}}
\end{equation*}
$$

which expresses the infinitesimal generator of rotations as the cross product with $-\mathbf{n}$.

We now introduce the operator

$$
  \mathbf{A}(\varphi) = \exp[-\varphi\mathbf{n}\cdot(\mathbf{x} \times\nabla)]\mathbf{x} \exp[\varphi\mathbf{n}\cdot(\mathbf{x}\times\nabla)]
$$

Differentiating with respect to $\varphi$, and using the operator identity

$$
  \frac{\d}{\d\varphi} (e^{-\varphi\hat{B}} \mathbf{x} e^{\varphi\hat{B}}) = -e^{-\varphi\hat{B}} [\hat{B},\mathbf{x}] e^{\varphi\hat{B}}
$$

with $\hat{B} = \mathbf{n}\cdot(\mathbf{x}\times\nabla)$, we arrive at

$$
  \frac{\d\mathbf{A}}{\d\varphi} = -[\mathbf{n}\cdot(\mathbf{n} \times\nabla), \mathbf{A}(\varphi)]
$$

Using the commutator relation $[\nabla^i, x^j] = \delta^{ij}$ we find that

$$
\begin{align*}
  [\mathbf{n}\cdot(\mathbf{x}\times\nabla), x^l] =& \varepsilon^{ljk} n^j x^k \\
  =& -(\mathbf{n} \times\mathbf{x})^l
\end{align*}
$$

which leads to the differential equation

$$
  \frac{\d}{\d\varphi} \mathbf{A}(\varphi) = -\mathbf{n}\times\mathbf{A}(\varphi),\; \mathbf{A}(0) = \mathbf{x}
$$

Since this equation is identical in form to $\eqref{equation-203}$, it follows by uniqueness of solution that

$$
  \mathbf{A}(\varphi) = \mathbf{x}' (\varphi) = \mathbf{R}(\varphi, \mathbf{n}) \mathbf{x}
$$

Note that the operator $\mathbf{n}\cdot(\mathbf{x}\times\nabla)$ acts on $\mathbf{x}$ in the same way as $i\mathbf{n}\cdot\mathbf{M}$

$$
  (\boldsymbol{\omega} \cdot \mathbf{Mx})^l = i\omega^j \varepsilon^{ljk} x^k = -(\boldsymbol{\omega}\times\mathbf{x})^l
$$

Thus, the exponential of the differential operator reproduces the same finite rotation as the exponential of the corrsponding matrix generator, giving the operator identity

$$
\begin{equation*}
  \exp[-\boldsymbol{\omega}\cdot(\mathbf{x}\times\nabla)]\mathbf{x} \exp[\boldsymbol{\omega} \cdot(\mathbf{x}\times\nabla)] = \exp[i\boldsymbol{\omega}\cdot\mathbf{M}] \mathbf{x}
\tag{\label{equation-258}}
\end{equation*}
$$

### Successive Galilean transformations

Applying two successive Galilean transformations $g = (\tau, \mathbf{a}, \mathbf{v}, \mathbf{R})$ and $g' = (\tau', \mathbf{a}', \mathbf{v}', \mathbf{R}')$ results in

$$
\begin{align*}
  \mathbf{x}'' =& \mathbf{R}' \mathbf{x}' - \mathbf{a}' - \mathbf{v}' t' \\
  =& \mathbf{R}' (\mathbf{Rx} - \mathbf{a} - \mathbf{v}t) - \mathbf{a}' - \mathbf{v}' (t - \tau) \\
  =& (\mathbf{R}' \mathbf{R})\mathbf{x} - (\mathbf{R}' \mathbf{a} + \mathbf{a}' - \mathbf{v}' \tau) - (\mathbf{R}' \mathbf{v} + \mathbf{v}')t \\
  t'' =& t' - \tau' = t - (\tau + \tau')
\end{align*}
$$

Thus the compose parameters $g'' = g' \circ g$ are

$$
\begin{align*}
  \tau'' =& \tau + \tau' \\
  \mathbf{R}'' =& \mathbf{R}' \mathbf{R} \\
  \mathbf{v}'' =& \mathbf{R}' \mathbf{v} + \mathbf{v}' \\
  \mathbf{a}'' =& \mathbf{R}' \mathbf{a} + \mathbf{a}' - \mathbf{v}' \tau
\end{align*}
$$

Since the $g''$ are of the same form $(\tau'', \mathbf{a}'', \mathbf{v}'', \mathbf{R}'')$, it follows that the set of Galilean parameters closes under composition. The set also satisfies the group axioms

1. **Identity element:** The identity transformation is 

$$
\begin{equation*}
  e = (0, 0, 0, \mathbf{I}_3)
\tag{\label{equation-205}}
\end{equation*}
$$

since it maps $(t, \mathbf{x}) \mapsto (t, \mathbf{x})$.

2. **Inverse:** Given $g = (\tau, \mathbf{a}, \mathbf{v}, \mathbf{R})$ we seek $g^{-1} = (\tau^{-1}, \mathbf{a}^{-1}, \mathbf{v}^{-1}, \mathbf{R}^{-1})$ such that $g^{-1} \circ g = e$. From the composition rules

$$
\begin{align*}
  \tau^{-1} + \tau = 0 \implies& \tau^{-1} = -\tau \\
  \mathbf{R}^{-1} \mathbf{R} = \mathbf{I}_3 \implies& \mathbf{R}^{-1} = \mathbf{R}^{-1} \\
  \mathbf{v}^{-1} + \mathbf{R}^{-1} \mathbf{v} = \mathbf{0} \implies& \mathbf{v}^{-1} = -\mathbf{R}^{-1} \mathbf{v} \\
  \mathbf{a}^{-1} + \mathbf{R}^{-1} \mathbf{a} - \mathbf{v}^{-1} \tau = \mathbf{0} \implies& \mathbf{a}^{-1} = -\mathbf{R}^{-1} \mathbf{a} + \mathbf{v}^{-1} \tau
\end{align*}
$$

Substituting $\mathbf{v}^{-1} = -\mathbf{R}^{-1} \mathbf{v}$ gives the compact form

$$
  g^{-1} = (-\tau, -\mathbf{R}^{-1} (\mathbf{a} + \mathbf{v}\tau), -\mathbf{R}^{-1} \mathbf{v}, \mathbf{R}^{-1})
$$

4. **Associativity:** For $g_j =(\tau_j, \mathbf{a}_j, \mathbf{v}_j, \mathbf{R}_j)$ for $j=1,2,3$ we have

$$
\begin{align*}
  &(\tau_3, \mathbf{a}_3, \mathbf{v}_3, \mathbf{R}_3)[(\tau_2, \mathbf{a}_2, \mathbf{v}_2, \mathbf{R}_2)(\tau_1, \mathbf{a}_1, \mathbf{v}_1, \mathbf{R}_1)] \\
  =& [(\tau_3, \mathbf{a}_3, \mathbf{v}_3, \mathbf{R}_3)(\tau_2, \mathbf{a}_2, \mathbf{v}_2, \mathbf{R}_2)](\tau_1, \mathbf{a}_1, \mathbf{v}_1, \mathbf{R}_1) \\
\end{align*}
$$

showing that $g_3 (g_2 \circ g_1) = (g_3 \circ g_2) \circ g_1$.

Thus the set of all such quadruples with the composition law is a group $G$, called the Galilei group.

A closed path (group commutator) built from two group elements $g_1, g_2 \in G$ is

$$
\begin{equation*}
  [g_2, g_1] = g_2^{-1} g_1^{-1} g_2 g_1
\tag{\label{equation-208}}
\end{equation*}
$$

With $g_1 = (\tau_1, \mathbf{a}_1, \mathbf{v}_1, \mathbf{R}_1)$ and $g_2 = (\tau_2, \mathbf{a}_2, \mathbf{v}_2, \mathbf{R}_2)$, the components of $[g_1, g_2]$ are given by

$$
\begin{align*}
  \tau_{[g_2, g_1]} =& 0 \\
  \mathbf{a}_{[g_2, g_1]} =& -\mathbf{R}_2^{-1} [\mathbf{a}_2 + \mathbf{v}_2 \tau_2 + \mathbf{R}^{-1} (\mathbf{a}_1 - \mathbf{a}_2 - \mathbf{R}_2 \mathbf{a}_1 + \mathbf{v}_2 \tau_1 - \mathbf{v}_1 \tau_2) - \mathbf{v}_2 \tau_2] \\
  \mathbf{v}_{[g_2, g_1]} =& -\mathbf{R}_2^{-1} [\mathbf{v}_2 + \mathbf{R}_1^{-1} (\mathbf{v}_1 - \mathbf{v}_2 - \mathbf{R}_2 \mathbf{v}_1)] \\
  \mathbf{R}_{[g_2, g_1]} =& \mathbf{R}_2^{-1} \mathbf{R}_1^{-1} \mathbf{R}_2 \mathbf{R}_1
\end{align*}
$$

The corresponding infinitesimal parameters are given by

$$
\begin{align*}
  \delta\tau =& 0 \\
  \delta\mathbf{a} =& \mathbf{A}_2 \delta\mathbf{a}_1 - \mathbf{A}_1 \delta\mathbf{a}_2 + \delta\mathbf{v}_1 \delta\tau_2 - \delta\mathbf{v}_2 \delta\tau_1 \\
  \delta\mathbf{v} =& \mathbf{A}_2 \delta\mathbf{v}_1 - \mathbf{A}_1 \delta\mathbf{v}_2 \\
  \delta(\mathbf{R} - \mathbf{I}_3) =& \mathbf{A}_2 \mathbf{A}_1 - \mathbf{A}_1 \mathbf{A}_2 = [\mathbf{A}_2, \mathbf{A}_1]
\end{align*}
$$

where $\mathbf{A}_j \in\mathfrak{so}(3)$ for $j = 1,2$ is defined in $\eqref{equation-204}$. In particular

$$
\begin{align*}
  \delta\mathbf{a} =& -(\delta\boldsymbol{w}_2 \times \delta\mathbf{a}_1 - \delta\boldsymbol{\omega}_1 \times \delta\mathbf{a}_2) + \delta\mathbf{v}_1 \delta\tau_2 - \delta\mathbf{v}_2 \delta\tau_1 \\
  \delta\mathbf{v} =& (\delta\boldsymbol{\omega}_1 \times \delta\mathbf{v}_2 - \delta\boldsymbol{\omega}_2 \times\delta\mathbf{v}_1) \\
  \delta(\mathbf{R} - \mathbf{I}_3) =& -\varepsilon^i{}_j{}^k \delta\boldsymbol{\omega}^j
\end{align*}
$$

and

$$
  \delta\boldsymbol{\omega} = \delta\boldsymbol{\omega}_1 \times \delta\boldsymbol{\omega}_2
$$

Hence under the closed path transformation, we have transformations $\mathbf{x} \to\mathbf{x}_f$, $t \to t_f = t$, leading to the infinitesimal expressions

$$
\begin{align*}
  \delta\mathbf{x} =& \mathbf{x} - \mathbf{x}_f = \delta\mathbf{a} + \delta\mathbf{v}t + \delta\boldsymbol{\omega} \times\mathbf{x} \\
  \delta t =& t - t_f = 0
\end{align*}
$$

## Quantum Galilean transformations

The set of Galilean transformations includes the identity transformation $e$ as defined in $\eqref{equation-205}$. This identity can be obtained as a limiting case of an arbitrary Galilean transformation $g = (\tau, \mathbf{a}, \mathbf{v}, \mathbf{R})$ when the parameters approach
- $\tau\to 0$
- $\mathbf{a}\to\mathbf{0}$
- $\mathbf{v}\to\mathbf{0}$
- $\mathbf{R}\to\mathbf{I}_3$

In other words, the Galilean group is topologically connected in a neighbourhood of the identity; any transformation can be continuously deformed into $e$ by letting these parameters tend to zero.

By Wigner's theorem (Theorem $\ref{theorem-2}$), every symmetry transformation that preserve transition probabilities in quantum physics is represented on the Hilber space $\mathcal{H}$ by either a unitary or an anti-unitary operator. Since the Galilean transformations are continuously connected to the identity, and the identity must be represented by a unitary operator, it follows by continuity that all Galilean transformations are represented by unitary operators. Thus, under a Galilean transformation, a quantum state $\ket{\psi}\in\mathcal{H}$ transforms as

$$
\begin{equation*}
  \ket{\psi'} = \hat{U}(g) \ket{\psi}
\tag{\label{equation-215}}
\end{equation*}
$$

where $\hat{U}$ is unitary. This ensures that transition amplitude $\braket{\phi|\psi}$ are invariant, i.e.

$$
  \braket{\phi'|\psi'} = \braket{\phi|\psi}
$$

so that inner products, and hence all physical probabilities, are preserved.

For systems with non-zero spins, $\ket{\psi}$ carries internal degrees of freedom and must be treated as a multi-component object, transforming under some finite-dimensional representation of the Galilean group. In this case, invariance of transition amplitudes requires

$$
  \sum_a \Braket{{\phi'}^a | {\psi'}^a} = \sum_b \braket{\phi^b | \psi^b}
$$

where the indices $a$ and $b$ label spin or internal components. In the coordinate representation, the invariance of a scalar wavefunction under pure space translations and Galilean boots, without rotations, implies

$$
  \braket{\mathbf{x}'|\psi'} = \braket{\mathbf{x}|\psi},\; \ket{\mathbf{x}'} = \ket{\mathbf{x}}\hat{U}^\dagger
$$

Thus, the transformed wavefunction satisfies

$$
\begin{equation*}
  \psi' (\mathbf{x}') = \psi(\mathbf{x})
\tag{\label{equation-206}}
\end{equation*}
$$

which expresses the scalar character of $\psi$ user such transformations.

For spin-zero systems, $\eqref{equation-206}$ holds under the full Galilean group, including rotations. However, for systems with nonzero spin, this simple scalar realtion does not hold under rotations. For example, for spin one, where $\psi(\mathbf{x})$ is a vector field, the transformed components ${\psi'}^j (\mathbf{x}')$ are related to the original components $\psi^i (\mathbf{x})$ by a rotation matrix

$$
  \psi'_j (\mathbf{x}') = \mathbf{R}^j{}_i \psi^i (\mathbf{x})
$$

In the general case, the transformation law for a multi-component wavefunction takes the form

$$
  \psi'_a (\mathbf{x}') = A^a{}_b (g) \psi^b (\mathbf{x})
$$

where $\mathbf{A}(g) = [\mathbf{A}^{ab} (g)]$ is a matrix representation of the rotational (or spin) part of the Galilean group, acting on the internal spin indices.

Since the Galilean transformations form a connected Lie group whose elements can be continuously deformed into the identity, an infinitesimal transformation can be represented by a unitary operator of the form

$$
\begin{equation*}
  \hat{U} = \hat{I} + \frac{i}{\hbar}\hat{G}
\tag{\label{equation-207}}
\end{equation*}
$$

where the operator $\hat{G}$ is Hermitian ($\hat{G}^\dagger = \hat{G}$) and depends linearly on the infinitesimal group parameters $\delta\tau$, $\delta\mathbf{a}$, $\delta\mathbf{v}$ $\delta\boldsymbol{\omega}$. By construction $\hat{G}\to 0$ as all infinitesimal parameters tend to zero. The prefactor $i$ ensures that $\hat{U}$ remains unitary to first order in the parameters. The factor $1/\hbar$ ensures dimensional consistency of the operator parameters in comparison with classical analogues.

Consider two successive Galilean transformations represented by unitary operators $\hat{U}_1$ and $\hat{U}_2$. The unitary operator corresponding to the overall closed path in $\eqref{equation-208}$ is given by

$$
  \hat{U} = \hat{U}_2^\dagger \hat{U}_1^\dagger \hat{U}_2 \hat{U}_1
$$

For infinitesimal transformations, the right-hand side is given by

$$
  \hat{U}_j = \hat{I} + \frac{i}{\hbar}\hat{G}_j + O(\delta^2),\; j=1,2
$$

where $\hat{G}_j$ are first order in their respective infinitesimal parameters. Substituting and expanding into second order yields

$$
\begin{align*}
  \hat{U} =& \left(\hat{I} - \frac{i}{\hbar} \hat{G}_2 \right)\left(\hat{I} - \frac{i}{\hbar} \hat{G}_1 \right)\left(\hat{I} + \frac{i}{\hbar} \hat{G}_2 \right) \left(\hat{I} + \frac{i}{\hbar} \hat{G}_1 \right) + O(\delta^3)
\end{align*}
$$

All second-order terms in the infinitesimal parameters cancel except for the commutator, leading to

$$
\begin{equation*}
  \hat{G} = \frac{1}{i\hbar} [\hat{G}_1, \hat{G}_2]
\tag{\label{equation-209}}
\end{equation*}
$$

The most general structure of $\hat{G}$ in $\eqref{equation-209}$ can be written as a linear combination of the generators of the Galilean group

$$
\begin{equation*}
  \hat{G} = \delta\mathbf{a} \cdot \unitvec{P} + \delta\mathbf{v}\cdot \unitvec{N} - \delta\tau \hat{H} + \delta\boldsymbol{\omega} \cdot \unitvec{J} + \delta\phi \hat{I}
\tag{\label{equation-210}}
\end{equation*}
$$

where each term corresponds to an infinitesimal transformation parameter and its associated generator:
- $\unitvec{P}$ generates space translations
- $\unitvec{N}$ generates uniform motion
- $\hat{H}$ generates time translations
- $\unitvec{J}$ generates space rotations
- $\hat{I}$ contributes to an overall phase through $\delta\phi$

The operator $\hat{G}$ vanishes as $\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega} \to 0$, provided $\delta\phi\to 0$ as well, ensuring that $\hat{U}\to\hat{I}$ in this limit. Similarly, the infinitesimal operators $\hat{G}_1$ and $\hat{G}_2$ entering the commutator in $\eqref{equation-209}$ have the general form

$$
\begin{equation*}
  \hat{G}_j = \delta\mathbf{a}_j \cdot \unitvec{P} + \delta\mathbf{v}_j \cdot \unitvec{N} - \delta\tau_j \hat{H} + \delta\boldsymbol{\omega} \cdot\mathbf{J},\; j = 1,2
\tag{\label{equation-211}}
\end{equation*}
$$

Any additive multiple of the identity operator in $\hat{G}_j$ contributes only a phase factor to $\hat{U}_j$ and therefore cancels in the commutator $[\hat{G}_1, \hat{G}_2]$. Thus, the scalar coefficient $\delta\phi$ associated with $\hat{I}$ must be antisymmetric under the in the interchange $1 \leftrightarrow 2$, and must be constructed from rotationally invariant bilinear forms of the infinitesimal parameters $\delta\mathbf{a}_j$, $\delta\mathbf{v}_j$ and $\delta\boldsymbol{\omega}_j$ for $j = 1,2$. The most general structure of $\delta\phi$ is then

$$
\begin{equation*}
\begin{split}
  \delta\phi =& M(\delta\mathbf{a}_1 \cdot \delta\mathbf{v}_2 - \delta\mathbf{a}_2 \cdot \delta\mathbf{v}_1) + B(\delta\boldsymbol{\omega}_1 \cdot \delta\mathbf{v}_2 - \delta\boldsymbol{\omega}_2 \cdot \delta\mathbf{v}_1) \\
  &+ E(\delta\boldsymbol{\omega}_1 \cdot \delta\mathbf{a}_2 - \delta\boldsymbol{\omega}_2 \cdot\delta\mathbf{a}_1)
\end{split}
\tag{\label{equation-212}}
\end{equation*}
$$

where the constants $M$, $B$ and $E$ represent possible central extension coefficients associated with the mixed commutators of the generators.

Table $\ref{table-1}$ summarizes the commutation relations of the Galilean generators, obtained by comparing the coefficients of corresponding infinitesimal parameters in $\eqref{equation-209}$, $\eqref{equation-211}$ and $\eqref{equation-212}$.

<TableFigure caption="Commutation relations of the generators of the Galilean transformations as obtained from $\eqref{equation-209}$ upon comparison of the appropriate coefficient-parameters defining the transformations" tag="table-1">
| Coefficient | Resulting commutator |
| --- | --- |
| $\delta a_1^i \delta a_2^j$ | $[\hat{P}^i, \hat{P}^j] = 0$ |
| $(\delta a_1^i \delta\tau_2 - \delta a_2^j \delta\tau_1)$ | $[\hat{H}, \hat{P}^i] = 0$ |
| $(\delta v_1^i \delta\tau_2 - \delta v_2^j \delta\tau_1)$ | $[\hat{H}, \hat{N}^i] = i\hbar \hat{P}^i$ |
| $\delta \omega_1^i \delta \omega_2^j$ | $[J^i, J^j] = i\hbar\varepsilon^{ijk} J^k$ |
| $(\delta a_1^i \delta v_2^j - \delta a_2^j \delta v_1^j)$ | $[\hat{P}^i, \hat{N}^j] = i\hbar M \delta^{ij}$ |
| $(\delta a_1^i \delta \omega_2^j - \delta a_2^j \delta \omega_1^j)$ | $[\hat{P}^i, \hat{J}^j] = i\hbar (\varepsilon^{ijk} \hat{P}^k - E\delta^{ij})$ |
| $(\delta \omega_1^i \delta v_2^j - \delta \omega_2^j \delta v_1^j)$ | $[\hat{N}^i, \hat{J}^j] = i\hbar (\varepsilon^{ijk} \hat{N}^k - B delta^{ij})$ |
| $(\delta \omega_1^i \delta \tau_2^j - \delta \omega_2^j \delta \tau_1^j)$ | $[\hat{H}, \hat{J}^i] = 0$ |
| $\delta v_1^i \delta v_2^j$ | $[\hat{N}^i, \hat{N}^j] = 0$ |
</TableFigure>

From the commutator $[\hat{P}^i, \hat{J}^j] = i\hbar \varepsilon^{ijk} \hat{P}^k$, it follows that the constant $E$ in $\eqref{equation-212}$ must vanish, since


$$
\begin{equation*}
  E = -\frac{1}{6\hbar^2} \varepsilon^{ijk} [\hat{J}^k, [\hat{P}^i, \hat{J}^j]] = 0
\tag{\label{equation-244}}
\end{equation*}
$$

Likewise, the commutator $[\hat{N}^i, \hat{J}^j] = i\hbar\varepsilon^{ijk} \hat{N}^k$ implies that $B = 0$. Hence, only the constant $M$ remains as a nontrivial central extension parameter in $\eqref{equation-212}$. This coefficient corresponds physically to the mass of the system, characterizing the central charge in the Galilean algebra

$$
  [\hat{P}^i, \hat{N}^j] = i\hbar M\delta^{ij}
$$

In the Heisenberg picture, Galilean transformations act on observables rather than on states. If a state $\ket{\psi}\in\mathcal{H}$ transforms unitarily according to $\eqref{equation-215}$, then invariance of expectation values $\braket{\psi'|\hat{A}|\psi'} = \braket{\psi|\hat{A}'|\psi}$ requires the observable $A$ to transform as

$$
  \hat{A}' = \hat{U}^\dagger \hat{A} \hat{U}
$$

From $\eqref{equation-207}$, the infinitesimal transformation of $A$ is given by

$$
  \delta\hat{A} = \hat{A} - \hat{A}' = \frac{1}{i\hbar} [\hat{A}, \hat{G}]
$$

Using the infinitesimal generators in $\eqref{equation-210}$ and $\eqref{equation-211}$, we obtain the Heisenberg picture variation of any observable

$$
\begin{equation*}
\begin{split}
  i\hbar\delta\hat{A} =& \delta a^j [\hat{A}, \hat{P}^j] + \delta v^j [\hat{A}, \hat{N}^j] \\
  &- \delta\tau [\hat{A}, \hat{H}] + \delta\omega^j [\hat{A}, \hat{J}^j]
\end{split}
\tag{\label{equation-214}}
\end{equation*}
$$

### Position operator

To identify the position operator within the unitary representation of the Galilei group, consider the operator

$$
\begin{equation*}
  \unitvec{Q} := \frac{1}{M} (t\unitvec{P} - \unitvec{N})
\tag{\label{equation-251}}
\end{equation*}
$$

For an infinitesimal Galilean transformation with $\delta\tau = 0$, applying the commutation relations of the Galilei algebra (Table $\ref{table-1}$) to $\eqref{equation-214}$ yields

$$
\begin{equation*}
  \delta\unitvec{Q} = \delta\mathbf{a} + \delta\mathbf{v}t + \delta\boldsymbol{\omega} \times \unitvec{Q}
\tag{\label{equation-252}}
\end{equation*}
$$

This is precisely the transformation law for the classical position vector defined in $\eqref{equation-213}$. Hence we identify $\unitvec{Q}$ with the position operator $\unitvec{X}$. From the commutation relations of the Galilei algebra (Table $\ref{table-1}$), we obtain the following commutation relations associated with $\unitvec{X}$

$$
\begin{align*}
  [\hat{X}^i, \hat{X}^j] =& 0 \tag{\label{equation-226}} \\
  [\hat{X}^i, \hat{J}^j] =& i\hbar\varepsilon^{ijk} \hat{X}^k \tag{\label{equation-230}} \\
  [\hat{X}^i, \hat{P}^j] =& i\hbar\delta^{ij} \tag{\label{equation-222}} \\
  [\hat{H}, \hat{X}^i] =& -\frac{i\hbar}{M} \hat{P}^i \tag{\label{equation-216}}
\end{align*}
$$

These commutation relations are the defining algebraic conditions characterizing $\unitvec{X}$ as the nonrelativistic position operator.

### Time evolution

Consider now a pure time translation of the position operator $\unitvec{X}$, i.e.

$$
  \delta\tau \neq 0,\quad \delta\mathbf{a} = \delta\mathbf{v} = \delta\boldsymbol{\omega} = \mathbf{0}
$$

In this case, $\eqref{equation-214}$ reduces to

$$
\begin{equation*}
\begin{split}
  i\hbar\delta\hat{X}^i =& -\delta\tau [\hat{X}^i, \hat{H}] \\
  \underbrace{=}_{\eqref{equation-216}}& -i\hbar\delta\tau \frac{\hat{P}^i}{M}
\end{split}
\tag{\label{equation-219}}
\end{equation*}
$$

Under a time shift, the spatial variation is

$$
\begin{align*}
  \delta\hat{X}^i (t) =& \hat{X}^i (t) - {\hat{X}'}^i (t) \\
  =& \hat{X}^i (t) - {\hat{X}}^i (t' + \delta t)
\end{align*}
$$ 

with $\unitvec{X}' (t') = \unitvec{X}(t)$. Dividing $\eqref{equation-219}$ with $\delta\tau$ taking the limit $\delta\tau\to 0$, we obtain the Heisenberg equation of motion

$$
\begin{equation*}
  \dot{\hat{X}}^i (t) = \frac{\hat{P}^i}{M}
\tag{\label{equation-217}}
\end{equation*}
$$

Thus $\unitvec{P}$ acts as the generator of spatial translations and $M$ as the inertial mass. From Table $\ref{table-1}$ we deduce the commutator identity

$$
\begin{align*}
  \left[\frac{\unitvec{P}^2}{2M}, \hat{X}^i \right] =& -i\hbar \frac{\hat{P}^i}{M} \\
  =& [\hat{H}, \hat{X}^i]
\end{align*}
$$

from which it follows that

$$
  \left[\hat{H} - \frac{\unitvec{P}^2}{M}, \hat{X}^i \right] = 0
$$

Since $[\hat{P}^i, \hat{P}^j] = 0$ and $[\hat{H}, \hat{P}^i] = 0$ (cf. Table $\ref{table-1}$), the operator

$$
  \hat{H}_\text{I} := \hat{H} - \frac{\unitvec{P}^2}{M}
$$

commutes with both $\unitvec{X}$ and $\unitvec{P}$. Thus, the operator $\hat{H}$ decomposes as

$$
\begin{equation*}
  \hat{H} = \frac{\unitvec{P}^2}{2M} + \hat{H}_\text{I}
\tag{\label{equation-218}}
\end{equation*}
$$

where the interaction term $\hat{H}_\text{I}$ satisfies

$$
\begin{align*}
  [\hat{H}_\text{I}, \hat{P}^i] =& 0 \tag{\label{equation-242}} \\
  [\hat{H}_\text{I}, \hat{X}^i] =& 0 \tag{\label{equation-243}}
\end{align*}
$$

Equation $\eqref{equation-217}$ and $\eqref{equation-218}$ uniquely identify
- $\unitvec{P}$ as the momentum operator
- $M$ as the mass
- $\hat{H}$ as the total Hamiltonian operator

Thus the physical content of nonrelativistic quantum mechanics emerges naturally from the unitary representation theory of the Galilei group.

### Infinitesimal generators

Given a one-parameter unitary group $\set{\hat{U}(\epsilon)}_{\epsilon\in\R}$ that satisfies $\hat{U}(0) = \hat{I}$, Stone's theorem (Theorem $\ref{theorem-3}$) ensures the existence of a self-adjoint generator $\hat{G}$ such that $\hat{U}(\epsilon) = \exp(i\epsilon\hat{G}/\hbar)$. Expanding $\hat{U}$ to first-order yields

$$
\begin{equation*}
  \hat{U}(\epsilon) = \hat{I} + \frac{i}{\hbar} \epsilon\hat{G} + O(\epsilon^2)
\tag{\label{equation-231}}
\end{equation*}
$$

From $\eqref{equation-210}$ an infinitesimal Galilean transformation can be represented by the unitary operator

$$
\begin{equation*}
  \hat{U}(\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega}) = \hat{I} + \frac{i}{\hbar}(\delta\mathbf{a}\cdot\unitvec{P} + \delta\mathbf{v}\cdot\unitvec{N} - \delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\unitvec{J}) + O(\norm{\delta})
\tag{\label{equation-305}}
\end{equation*}
$$

We use this to study the action of translations, momentum shifts, and rotations on operators and state vectors.

**Infinitesimal spatial translations**

An infinitesimal translation by a numerical quantity $\delta\mathbf{a}$ is represented by the unitary operator

$$
\begin{equation*}
  \hat{U}(\delta\mathbf{a}\cdot\unitvec{P}) = \hat{I} + \frac{i}{\hbar} \delta\mathbf{a} \cdot\unitvec{P}
\tag{\label{equation-233}}
\end{equation*}
$$

Applying $\hat{U}$ to the position operator $\unitvec{X}$ adjointly and using the commutator $\eqref{equation-222}$ leads to

$$
  \hat{U}^\dagger (\delta\mathbf{a}\cdot\unitvec{P}) \unitvec{X} \unitvec{U}(\delta\mathbf{a}\cdot\unitvec{P}) = \unitvec{X} - \delta\mathbf{a}
$$

This shows that the momentum operator $\unitvec{P}$ is the generator of spatial translations.

**Infinitesimal momentum shifts**

An infinitesimal shift of momentum by a numerical quantity $\delta\mathbf{p}$ is represented by the unitary operator

$$
\begin{equation*}
  \hat{U}(-\delta\mathbf{p} \cdot\unitvec{X}) = \unitvec{I} - \frac{i}{\hbar} \delta\mathbf{p}\cdot\unitvec{X}
\tag{\label{equation-234}}
\end{equation*}
$$

Applying $\hat{U}$ to $\unitvec{P}$ adjointly and using the commutator $\eqref{equation-222}$ yields

$$
  \hat{U}^\dagger (-\delta\mathbf{p} \cdot\unitvec{X}) \unitvec{P} \hat{U} (-\delta\mathbf{p}\cdot\unitvec{X}) = \unitvec{P} - \delta\mathbf{p}
$$

Thus the position operator $\unitvec{X}$ generates momentum displacements.

**Infinitesimal rotations**

A rotation by an infinitesimal angle $\delta\phi$ about a unit vector $\unitsym{n}$ with $\delta\boldsymbol{\omega} = \unitsym{n} \delta\phi$, is represented by the unitary operator

$$
\begin{equation*}
  \hat{U}(\delta\boldsymbol{\omega} \cdot\unitvec{J}) = \hat{I} + \frac{i}{\hbar} \delta\boldsymbol{\omega} \cdot\unitvec{J}
\tag{\label{equation-235}}
\end{equation*}
$$

Applying $\hat{U}$ to the position vector $unitvec{X}$ and using the commutator $\eqref{equation-230}$, we obtain

$$
  \hat{U}^\dagger (\delta\boldsymbol{\omega} \cdot\unitvec{J}) \unitvec{X} \hat{U} (\delta\boldsymbol{\omega}\cdot\unitvec{J}) = \unitvec{X} - \delta\boldsymbol{\omega} \times\unitvec{X}
$$

Thus $\unitvec{J}$, which is identified with the angular momentum operator, generates spatial rotations.

### Limit of finite transformations from infinitesimal generators

A finite Galilean transformation with parameter $\lambda$ can be obtained by composing $N$ infinitesimal transformations of size $\epsilon = \lambda/N$ represented by the unitary operator $\hat{U}$ given in $\eqref{equation-231}$. In the limit $N\to\infty$, the Lie-Trotter formula guarantees that

$$
\begin{equation*}
  \lim_{N\to\infty} \left(\hat{U}\left(\frac{\lambda}{N} \hat{G} \right)\right)^N = \exp\left(\frac{i}{\hbar} \lambda\hat{G} \right)
\tag{\label{equation-232}}
\end{equation*}
$$

Thus, the finite transformation associated with the one-parameter subgroup generated by $\hat{G}$ is given by the unitary operator $\hat{U}(\lambda) = \exp(i\lambda\hat{G}/\hbar)$ obtained as the continuum limit of repeated infinitesimal transformations.

**Finite spatial translations**

The generator of spatial rotations is the momentum operator $\unitvec{P}$. A finite translation by $\delta\mathbf{a}$ is represented by the unitary operator in $\eqref{equation-233}$. For a finite translation $\mathbf{a}$, then $\eqref{equation-232}$ with $\delta\mathbf{a} = \mathbf{a}/N$ yields

$$
\begin{equation*}
  \lim_{N\to\infty} \left(\hat{U} \left(\frac{\mathbf{a}}{N} \cdot\unitvec{P} \right) \right)^N = \exp\left(\frac{i}{\hbar} \mathbf{a}\cdot\mathbf{P} \right)
\tag{\label{equation-236}}
\end{equation*}
$$

Thus under a spatial translation $\mathbf{a}$, a state vector $\ket{\psi}\in\mathcal{H}$ transforms as

$$
  \ket{\psi} \mapsto \exp\left(\frac{i}{\hbar} \mathbf{a}\cdot\mathbf{P} \right)\ket{\psi}
$$

** Finite momentum shifts**

The generator of momentum shifts is the position operator $\unitvec{X}$. An infinitesimal momentum shift by $\delta\mathbf{p}$ is represented by the unitary operator in $\eqref{equation-234}$. For a finite momentum shift $\mathbf{p}$, then $\eqref{equation-232}$ with $\delta\mathbf{p} = \mathbf{p}/N$ gives

$$
  \lim_{N\to\infty} \left(\hat{U}\left(-\frac{\mathbf{p}}{N}\cdot\unitvec{X} \right) \right)^N = \exp\left(-\frac{i}{\hbar} \mathbf{p}\cdot\unitvec{X} \right)
$$

Thus the finite momentum shift of a state vector $\ket{\psi}\in\mathcal{H}$ is

$$
  \ket{\psi} \mapsto \exp\left(\frac{i}{\hbar} \mathbf{p}\cdot\mathbf{X} \right)\ket{\psi}
$$

**Finite rotations**

The generator of rotations is the angular momentum operator $\unitvec{J}$. An infinitesimal rotation by $\delta\boldsymbol{\omega}$ is represented by the unitary operator in $\eqref{equation-235}$. For a finite rotation by angle $\phi$ about $\unitsym{n}$, set $\operatorname{\omega} = \phi\unitsym{n}$ and $\delta\boldsymbol{\omega} = \boldsymbol{\omega}/N$. Then by $\eqref{equation-232}$

$$
\begin{equation*}
  \left(\hat{U}\left(-\frac{\delta\boldsymbol{\omega}}{N}\cdot\unitvec{J} \right) \right)^N \xrightarrow{N\to\infty} \exp\left(\frac{i}{\hbar} \boldsymbol{\omega}\cdot\unitvec{J} \right)
\tag{\label{equation-237}}
\end{equation*}
$$

Thus under a counterclockwise rotation by an angle $\phi$ about a unit vector $\unitsym{n}$, a state vector $\ket{\psi}\in\mathcal{H}$ transforms as

$$
\begin{equation*}
  \ket{\psi} \to\exp\left(\frac{i}{\hbar} \varphi\unitsym{n}\cdot \unitvec{J} \right) \ket{\psi}:= \ket{\psi'}
\tag{\label{equation-256}}
\end{equation*}
$$

### Explicit representations

**Momentum operator in the $\unitvec{X}$-representation**

Consider an infinitesimal spatial translation by $\delta\mathbf{a}$, represented by a unitary operator $\hat{U}$. Unitarity requires preservation of inner products

$$
  \braket{\mathbf{x}'|\psi'} = \braket{\mathbf{x}|\psi}
$$

where

$$
  \ket{\psi'} = \hat{U}\ket{\psi},\quad \bra{\mathbf{x}'} = \bra{\mathbf{x} - \delta\mathbf{a}}
$$

Consequently, we have

$$
  \braket{\mathbf{x} - \delta\mathbf{a}|\hat{U}\psi} = \braket{\mathbf{x}|\psi}
$$

or, in the wavefunction representation

$$
  (\hat{U}\psi)(\mathbf{x}) = \psi(\mathbf{x} + \delta\mathbf{a})
$$

A first-order Taylor expansion of $\psi$ about $\mathbf{x}$ yields

$$
  (\hat{U}\psi)(\mathbf{x}) = \psi(\mathbf{x}) + \delta\mathbf{a} \cdot\nabla\psi(\mathbf{x}) + O(|\delta\mathbf{a}|^2)
$$

Since this holds for all sufficiently regular $\psi$, we infer that $\hat{U}$ can be expanded as

$$
\begin{equation*}
  \hat{U} = \hat{I} + \delta\mathbf{a}\cdot\nabla
\tag{\label{equation-227}}
\end{equation*}
$$

Comparing this with $\eqref{equation-233}$ leads to the following representation for the momentum operator

$$
\begin{equation*}
  \unitvec{P} = -i\hbar\nabla
\tag{\label{equation-228}}
\end{equation*}
$$

**Position operator in the $\unitvec{P}$-representation**

Consider an infinitesimal momentum shift $\delta\mathbf{p}$ represented by a unitary operator $\hat{U}$. Invariance under momentum shifts implies that

$$
  \braket{\mathbf{p}'|\psi'} = \braket{\mathbf{p}|\psi}
$$

where 

$$
  \ket{\psi'} = \hat{U}\ket{psi},\quad mathbf{p}' = \mathbf{p} - \delta\mathbf{p}
$$

Consequently, in the wavefunction representation

$$
  (\hat{U}\psi)(\mathbf{p}) = \psi(\mathbf{p} + \delta\mathbf{p})
$$ 

A first-order Taylor expansion of $\psi$ about $\mathbf{p}$, gives

$$
  (\hat{U}\psi)(\mathbf{p}) = \psi(\mathbf{x}) + \delta\mathbf{p} \cdot\nabla + O(|\delta\mathbf{p}|^2)
$$

from which we infer the operator expansion

$$
  \hat{U} = \hat{I} + \delta\mathbf{p}\cdot\nabla_\mathbf{p}
$$

Comparing this with $\eqref{equation-233}$, we arrive at the following representation for the position operator

$$
  \unitvec{X} = i\hbar\nabla_\mathbf{p}
$$

**Transformation function**

The resolution of the identity in the momentum representation is

$$
\begin{equation*}
  \hat{I} = \frac{1}{(2\pi\hbar)^3} \int \ket{\mathbf{p}}\bra{\mathbf{p}} \;\d^3 \mathbf{p}
\tag{\label{equation-241}}
\end{equation*}
$$

The transformation function $\braket{\mathbf{x}|\mathbf{p}}$ from the momentum representation to the position representation is found by inserting the completeness relation $\eqref{equation-241}$ into $\braket{\mathbf{x}|\psi}$

$$
\begin{equation*}
  \braket{\mathbf{x}|\psi} = \frac{1}{(2\pi\hbar)^3} \int \braket{\mathbf{x}|\mathbf{p}}\braket{\mathbf{p}|\psi}
\tag{\label{equation-221}}
\end{equation*}
$$

We consider infinitesimal shifts by numerical factors $\delta\mathbf{x}$, $\delta\mathbf{p}$: 
- $\mathbf{x}\to\mathbf{x} - \delta\mathbf{x}$
- $\mathbf{p} \to \mathbf{p} - \delta\mathbf{p}$ 

provided through unitary operators explicitly given by

$$
\begin{align*}
  \bra{\mathbf{x} - \delta\mathbf{x}} =& \bra{\mathbf{x}} \left(\hat{I} - \frac{i}{\hbar} \delta\mathbf{x}\cdot\unitvec{P} \right)
  \ket{\mathbf{p} - \delta\mathbf{p}} =& \left(\hat{I} - \frac{i}{\hbar} \delta\mathbf{p}\cdot\unitvec{X} \right) \ket{\mathbf{p}}
\end{align*}
$$

The formal identifications

$$
\begin{align*}
  \unitvec{p}\ket{\mathbf{p}} =& \mathbf{p}\ket{\mathbf{p}} \\
  \bra{\mathbf{x}}\unitvec{X} =& \mathbf{x}\bra{\mathbf{x}}
\end{align*}
$$

then lead for infinitesimal numericals $\delta\mathbf{x}$ and $\delta\mathbf{p}$ to

$$
\begin{align*}
  \delta\braket{\mathbf{x}|\mathbf{p}} =& \braket{\mathbf{x}|\mathbf{p}} - \braket{\mathbf{x} - \delta\mathbf{x}|\mathbf{p} - \delta\mathbf{p}} \\
  =& \frac{i}{\hbar} \braket{\mathbf{x}|(\delta\mathbf{x} \cdot\unitvec{P} + \delta\mathbf{p}\cdot\unitvec{X})|\mathbf{p}} \\
  =& \frac{i}{\hbar} (\delta\mathbf{x}\cdot\mathbf{p} + \delta\mathbf{p}\cdot\mathbf{x})\braket{\mathbf{x}|\mathbf{p}} \\
  =& \frac{i}{\hbar} \braket{\mathbf{x}|\mathbf{p}} \delta(\mathbf{x}\cdot\mathbf{p})
\end{align*}
$$

and upon integration to

$$
\begin{equation*}
  \braket{\mathbf{x}|\mathbf{p}} = \exp\left(\frac{i}{\hbar} \mathbf{x}\cdot\mathbf{p} \right)
\tag{\label{equation-238}}
\end{equation*}
$$

where the integration constant has been set equal to one by adopting the normalization condition

$$
\begin{equation*}
  \frac{1}{(2\pi\hbar)^3} \int \braket{\mathbf{x}|\mathbf{p}}\braket{\mathbf{p}|\mathbf{p}'} \d^3 \mathbf{p}  = \delta^3 (\mathbf{x} - \mathbf{x}')
\tag{\label{equation-239}}
\end{equation*}
$$

Inserting $\eqref{equation-238}$ into $\eqref{equation-221}$ leads to the Fourier transform

$$
  \psi(\mathbf{x}) = \frac{1}{(2\pi\hbar)^3} \int e^{i\mathbf{x}\cdot\mathbf{p}/\hbar} \psi(\mathbf{p}) \d^3 \mathbf{p}
$$

as a physical transformation from the $\mathbf{p}$-representation to the $\mathbf{x}$-description. The inverse transform from the $\mathbf{x}$-representation to the $\mathbf{p}$-representation similarly follows to be given by

$$
  \psi(\mathbf{p}) = \int e^{-i\mathbf{x}\cdot\mathbf{p}/\hbar} \psi(\mathbf{x}) \;\d^3 \mathbf{x}
$$

The resolution of the identity in the $\mathbf{x}$-representation can be written as

$$
\begin{equation*}
  \hat{I} = \int \ket{\mathbf{x}}\bra{\mathbf{x}} \;\d^3 \mathbf{x}
\tag{\label{equation-240}}
\end{equation*}
$$

with the normalization condition $\eqref{equation-239}$ implying $\braket{\mathbf{x}'|\mathbf{x}} = \delta^3 (\mathbf{x}' - \mathbf{x})$. From $\eqref{equation-238}$ and $\eqref{equation-240}$, we then have the following normalization condition for momenta

$$
  \braket{\mathbf{p}'|\mathbf{p}} = (2\pi\hbar)^3 \delta^3 (\mathbf{p}' - \mathbf{p})
$$

### Translation symmetry and momentum conservation

From $\eqref{equation-236}$, space translations are represented by the unitary operator

$$
  \hat{U}(\mathbf{a}) = \exp\left(\frac{i}{\hbar}\mathbf{a}\cdot\unitvec{P} \right)
$$

Invariance under space translations implies $[\unitvec{P}, \hat{H}] = 0$, which identifies $\hat{U}$ as a symmetry transformation. This implies that $\unitvec{P}(t)$ is time-independent in the Heisenberg picure

$$
  \unitvec{P}(t) = e^{i\hat{H}/\hbar} \unitvec{P} e^{-i\hat{H}/\hbar} = \unitvec{P}
$$

Consequently, the expectation value of momentum in any state $\ket{\psi}\in\mathcal{H}$ conserved

$$
  \braket{\psi|\unitvec{P}(t)|\psi} = \braket{\psi|\unitvec{P}|\psi}
$$

Thus, the conservation of momentum follows from the invariance of the system under continuous space translations.

### Rotational symmetry and angular momentum conservation

From $\eqref{equation-237}$, rotations of the coordinate system are implemented by the unitary operator

$$
  \hat{U} = \exp\left(\frac{i}{\hbar} \phi\unitsym{n}\cdot\mathbf{J} \right)
$$

As a symmetry operation it follows that $[\unitvec{J}, \hat{H}] = 0$. Consequently, $\unitvec{J}(t)$ is time independent in the Heisenberg picture

$$
  \unitvec{J}(t) = e^{i\hat{H}/\hbar} \unitvec{J} e^{-i\hat{H}/\hbar} = \unitvec{J}
$$

This implies that the expectation value of momentum in any state $\ket{\psi}\in\mathcal{H}$ conserved

$$
  \braket{\psi|\unitvec{P}(t)|\psi} = \braket{\psi|\unitvec{P}|\psi}
$$

Rotational invariance of the Hamiltonian therefore implies the conservation of angular momentum.

### Heisenberg's equations of motion

Using $\eqref{equation-214}$, we can derive the equations of motions for $\unitvec{X}(t)$ and $\unitvec{P}(t)$ under pure time translations. Settting the infinitesimal parameters $\delta\mathbf{a} = \delta\mathbf{v} = \delta\boldsymbol{\omega} = \mathbf{0}$, the infinitesimal hange of the position operator reduces to

$$
\begin{align*}
  \delta\unitvec{X}(t) =& \unitvec{X}(t) - \unitvec{X}' (t) \\
  =& \unitvec{X}(t) - \unitvec{X}' (t' + \delta\tau) \\
  =& \frac{i}{\hbar} [\unitvec{X}(t), \hat{H}] \delta\tau =& 
\end{align*}
$$

Recognizing that $\unitvec{X}(t) = \unitvec{X}'(t')$ and dividing both sides by $\delta\tau$ results in the Heisenberg equation of motion for the position operator

$$
\begin{equation*}
  i\hbar \frac{\d}{\d t}\unitvec{X}(t) = [\unitvec{X}(t), \hat{H}]
\tag{\label{equation-223}}
\end{equation*}
$$

Similarly, the corresponding equation for the momentum operator is

$$
\begin{equation*}
  i\hbar\dot{\unitvec{P}}(t) = [\unitvec{P}(t), \hat{H}]
\tag{\label{equation-224}}
\end{equation*}
$$

### Many-particle systems

Consider a system of $n$ particles with masses $m_1,\dots,m_n$ and associated positions operators $\unitvec{X}_1,\dots,\unitvec{X}_n$, and define the center of mass position operator

$$
\begin{equation*}
  \unitvec{X} = \sum_\alpha \frac{m_\alpha}{M} \unitvec{X}_\alpha
\tag{\label{equation-225}}
\end{equation*}
$$

where $M = \sum_\alpha m_\alpha$ is the total mass of the system. Invariance under an infinitesimal spatial translation $\delta\mathbf{a}$ implies

$$
  \braket{\mathbf{x}'_1,\dots,\mathbf{x}'_n|\psi'} = \braket{\mathbf{x}_1,\dots,\mathbf{x}_n|\psi}
$$

where $\ket{\psi'} = \hat{U}\ket{\psi}$ and $\mathbf{x}'_\alpha = \mathbf{x}_\alpha - \delta\mathbf{a}$. Equivalently

$$
  \braket{\mathbf{x}_1,\dots,\mathbf{x}_n|\hat{U}\psi} = \braket{\mathbf{x}_1 + \delta\mathbf{a},\dots,\mathbf{x}_n + \delta\mathbf{a}|\psi}
$$

or, in the wavefunction representation

$$
  (\hat{U}\psi)(\mathbf{x}_1,\dots,\mathbf{x}_n) = \psi(\mathbf{x}_1 + \delta\mathbf{a},\dots,\mathbf{x}_n + \delta\mathbf{a})
$$

Expanding $\psi$ to first order in $\delta\mathbf{a}$ yields

$$
  (\hat{U}\psi)(\mathbf{x}_1,\dots,\mathbf{x}_n) = \left(\hat{I} + \delta\mathbf{a}\cdot\sum_\alpha \nabla_\alpha \right) \psi(\mathbf{x}_1,\dots,\mathbf{x}_n)
$$

From $\eqref{equation-227}$ and $\eqref{equation-228}$, we can introduce the total momentum operator

$$
  \unitvec{P} = \sum_\alpha \mathbf{P}_\alpha
$$

with 

$$
\begin{equation*}
  \unitvec{P}_\alpha = -i\hbar\nabla_\alpha
\tag{\label{equation-229}}
\end{equation*}
$$ 

denoting the momentum operator associated with the $\alpha$th particle as expected. A property consistent with $\eqref{equation-226}$ and $\eqref{equation-225}$ is that the operators $\mathbf{X}_\alpha$, associated with different particles commute as well

$$
  [\hat{X}_\alpha^i, \hat{X}_\beta^j] = 0
$$

From $\eqref{equation-229}$ we also get the commutation relations $[\hat{X}_\alpha^i, \hat{P}_\beta^i] = i\hbar\delta^{ij} \delta_{\alpha\beta}$ and $[\hat{P}_\alpha^i, \hat{P}_\beta^j] = 0$.

### Time-evolution

The negative sign for the time-translation operator in the infinitesimal generator $\eqref{equation-211}$ is fixed by consistency of the Galilei algebra and by the physical identification of the kinetic term in the Hamiltonian. Specifically, replacing the term $-\delta\tau_j \hat{H}$ with $+\delta\tau_j \hat{H}$ in $\eqref{equation-211}$, the commutator $[\hat{H}, \hat{N}^j]$ acquires the opposite sign, yielding $-i\hbar\hat{P}^i$ instead of $i\hbar\hat{P}^i$. This in turn would have forced the Hamiltonian $\hat{H}$ in $\eqref{equation-218}$ to be of the form 

$$
  \hat{H} = -(\unitvec{P}^2/2M + \hat{H}'_\text{I})
$$ 

where $\hat{H}'_\text{I}$ is some operator which satisfies $\eqref{equation-242}$ and $\eqref{equation-243}$. That is, the kinetic energy would become negative definite, which is physically unacceptable. Thus physical consistency fixes the sign in the generator of time translations.

From $\eqref{equation-231}$ the corresponding unitary transformation for an infinitesimal time translation $t \mapsto t - \delta\tau$ is

$$
\begin{equation*}
  \hat{U} (-\delta\tau\hat{H}) = \hat{I} - \frac{i}{\hbar} \delta\tau\hat{H}
\tag{\label{equation-303}}
\end{equation*}
$$

with $\hat{H}$ denoting the Hamiltonian of the system with the general form $\eqref{equation-211}$. To obtain the unitary operator for a finite time translation by $\tau$ we write $\delta\tau = \tau/N$. Then by $\eqref{equation-232}$

$$
  \lim_{N\to\infty} \left(\hat{U}\left(\frac{\tau}{N} \hat{H} \right) \right)^N = \exp\left(-\frac{i}{\hbar} \tau\hat{H} \right)
$$

Let $\ket{\psi_t}$ denote a state determined at time $t$ in the frame $F$. For infinitesimal $\delta\tau$ this state is given by $\ket{\psi'_t}$ in $F'$

$$
  \ket{\psi'_t} = \left(\hat{I} - \frac{i}{\hbar} \delta\tau\hat{H} \right) \ket{\psi_t}
$$

For pure time translations, the frames $F$ and $F'$ differ only by the synchronization of their clocks; they represent the same physical frame, but with the time coordinate in $F'$ shift by $-\delta\tau$. Physically, $\ket{\psi'_t}$ is identified with the state $\ket{\psi_{t + \delta\tau}}$. Thus

$$
  \ket{\psi_{t + \delta\tau}} = \left(\hat{I} - \frac{i}{\hbar} \delta\tau\hat{H} \right) \ket{\psi_t}
$$

Subtracting $\ket{\psi_t}$ from both sides gives

$$
  \ket{\psi_{t + \delta\tau}} - \ket{\psi_t} = -\frac{i}{\hbar}\delta\tau\hat{H} \ket{\psi_t}
$$

Dividing by $\delta\tau$ and taking the limit $\delta\tau \to 0$ yields the Schrödinger equation

$$
  i\hbar \frac{\partial}{\partial t} \ket{\psi_t} = \hat{H} \ket{\psi_t}
$$

In particular, by setting $\ket{\psi_0} := \ket{\psi}$ for $t = 0$, integration of the Schrödinger equation gives

$$
  \ket{\psi_t} = e^{-it\hat{H}/\hbar} \ket{\psi}
$$

which is the standard unitary time-evolution of states under a time-independent Hamiltonian.

### Time as an operator

In quantum physics, time is a parameter and is not promoted to an operator. To see this, suppose that $\hat{t}$ denotes the corresponding time operator. Then for $\delta\mathbf{a} = \delta\mathbf{v} = \delta\boldsymbol{\omega} = 0$, and numerical $\delta\tau \neq 0$, then $\eqref{equation-214}$ implies that

$$
  i\hbar\delta\hat{t} = -\delta\tau [\hat{t}, \hat{H}]
$$

which upon comparison with $\eqref{equation-244}$ leads to

$$
  [\hat{t}, \hat{H}] = -i\hbar
$$

This then implies that for any real numerical $E$

$$
\begin{equation*}
  \exp\left(\frac{i}{\hbar} E\hat{t}\right) \hat{H} \exp\left(-\frac{i}{\hbar} E\hat{t} \right) = \hat{H} + \hat{E}
\tag{\label{equation-245}}
\end{equation*}
$$

Now let $\lambda_0 \in\sigma(\hat{H})$ be in the spectrum of $\hat{H}$. Whether $\lambda_0$ is in the discrete or in the continuous spectrum, given any $\epsilon > 0$, we can find vector $\ket{\psi_\epsilon}$ such that

$$
  \norm{(\hat{H} - \lambda_0)\psi_\epsilon} < \epsilon
$$

Upon setting $\ket{\phi_\epsilon} = \exp(iE\hat{t}/\hbar) \ket{\psi_\epsilon}$, this implies that

$$
  \Norm{\left[\exp\left(\frac{i}{\hbar} E\hat{t} \right) \hat{H} \exp\left(-\frac{i}{\hbar} E\hat{t} \right) - \lambda_0 \right] \phi} < \epsilon
$$

or from $\eqref{equation-245}$ that

$$
  \norm{[\hat{H} - (\lambda_0 - E)] \phi_\epsilon} < \epsilon
$$

That is, $\lambda_0 - E$ is also in the spectrum of $\hat{H}$ for all $E$. We can choose $E$, in particular, an arbitrarily large positive number implying that $\hat{H}$ is unbounded from below, which is a physically unacceptable property of a Hamiltonian and for the stability of the system in question. Hence, time is to be treated as a parameter and not as an operator.

### Construction of Hamiltonians

To construct the Hamiltonian, consider a system of $n$ particles with masses $m_\alpha$, associated position and momentum operators $\unitvec{X}_\alpha$ and $\unitvec{P}_\alpha$, respectively, where $\alpha = 1,\dots,n$. The operators $\unitvec{X}_\alpha$ and $\unitvec{P}_\alpha$ associated with different particles commute.

With $\unitvec{X}$ representing the position of the whole system, that is of the center of mass position operator, $\unitvec{P}$ its total momentum and $M$ the total mass

$$
\begin{align*}
  \unitvec{X} =& \sum_\alpha \frac{m_\alpha}{M} \unitvec{X}_\alpha \\
  \unitvec{P} =& \sum_\alpha \unitvec{P}_\alpha \\
  M =& \sum_\alpha m_\alpha
\end{align*}
$$

These operators satisfy the following commutation relations of various combinations of the particles operators

$$
\begin{align*}
  [(\hat{X}_\alpha^i - \hat{X}_\beta^i) \hat{P}^j] =& \sum_\rho ([\hat{X}_\alpha^i, \hat{P}_\rho^j] - [\hat{X}_\beta^i, \hat{P}_\rho^j]) \\
  [(\hat{X}_\alpha^i - \hat{X}_\beta^i) \hat{X}^j] =& \sum_\rho \frac{m_\rho}{M} [(\hat{X}_\alpha^i, \hat{X}_\beta^i), \hat{X}_\rho^j] = 0 \\
  [(\hat{X}_\alpha^i - \hat{X}^i) \hat{P}^j] =& \sum_\rho [\hat{X}_\alpha^i, \hat{P}_\rho^i] - i\hbar\delta^{ij} = 0 \\
  [(\hat{X}_\alpha - \hat{X}^i), \hat{X}^j] =& 0 \\
  [(\hat{P}_\alpha^i - \hat{P}_\beta^i), \hat{P}^j] =& 0 \\
  [(\hat{P}_\alpha^i - \hat{P}_\beta^i) \hat{X}^j] =& \sum_\rho \frac{m_\rho}{M} ([\hat{P}_\alpha^i, \hat{X}_\rho^j] - [\hat{P}_\beta^j , \hat{X}_\rho^j] \\
  =& -\frac{i\hbar}{M} (m_\alpha - m_\beta) \delta^{ij} \\
  [(\hat{P}_\alpha^i - \frac{m_\alpha}{M} \hat{P}^i), \hat{P}^j] =& 0 \\
  [(\hat{P}_\alpha^i - \frac{m_\alpha}{M} \hat{P}^i), \hat{X}^j] =& \left(-i\hbar \frac{m_\alpha}{M} + i\hbar\frac{m_\alpha}{M} \right) \delta^{ij} = 0
\end{align*}
$$

From Galilean invariance and the above commutation relations, the interaction Hamiltonian $\hat{H}_\text{I}$ as given in $\eqref{equation-218}$ can depend only on operators invariant under uniform translations and boost, i.e.
- relative positions: $\unitvec{X}_\alpha - \unitvec{X}_\beta$
- position displacements from the centre of mass: $\unitvec{X}_\alpha - \unitvec{X}$
- internal momenta: $\unitvec{P}_\alpha - (m_\alpha / M) \unitvec{P}$

That is, for a very large class of Hamiltonians, we can choose

$$
\begin{equation*}
  \hat{H} = \frac{\unitvec{P}^2}{2M} + \sum_\alpha^n \frac{(\unitvec{P}_\alpha - \frac{m_\alpha}{M} \unitvec{P})^2}{2m_\alpha} + \hat{V}
\tag{\label{equation-246}}
\end{equation*}
$$

where the interaction operator $\hat{V}$ is any function of the allowed invariants

$$
\begin{equation*}
  \hat{V} = \sum_{\alpha\neq\beta}^n \hat{V}_{\alpha\beta} (\unitvec{X}_\alpha - \unitvec{X}_\beta) + \sum_\alpha^n \hat{V}_\alpha (\unitvec{X}_\alpha - \unitvec{X})
\tag{\label{equation-247}}
\end{equation*}
$$

The internal kintic term can be expanded as

$$
\begin{align*}
  \sum_\alpha^n \frac{(\unitvec{P}_\alpha - \frac{m_\alpha}{m}\unitvec{P})^2}{2m_\alpha} =& \sum_\alpha^n \frac{\unitvec{P}_\alpha^2}{2m_\alpha} - \frac{1}{M} \mathbf{P} \cdot \sum_\alpha^n \mathbf{P}_\alpha + \frac{\mathbf{P}^2}{2M} \\
  =& \sum_\alpha^n \frac{\unitvec{P}_\alpha^2}{2m_\alpha} - \frac{\unitvec{P}^2}{2M} \tag{\label{equation-248}}
\end{align*}
$$

Substituting this into $\eqref{equation-246}$ effectively eliminates the center of mass motion from $\hat{H}$, resulting in

$$
  \hat{H} = \sum_\alpha^n \frac{\unitvec{P}_\alpha^2}{2m_\alpha} + V
$$

The Hamiltonian term

$$
  \hat{H}' = \sum_\alpha^n \frac{(\unitvec{P}_\alpha - \frac{m_\alpha}{m}\unitvec{P})^2}{2m_\alpha} + V
$$

represents the intrinsic energy because it only depends on internal coordinates and momenta and consequently commutes with translations generated by $\unitvec{P}$.

### Decompositions into clusters of particles

We consider a system of $n$ particles interacting via two-body potentials of the form given by the first term in $\eqref{equation-247}$. Suppose that the set of particles is partitioned into $k$ disjoint clusters, with cluster $\alpha$ containing $n_\alpha$ particles. Thus

$$
  n = \sum_{\alpha=1}^k n_\alpha
$$

Such decompositions arise naturally for systems that evolve into well-separated groups of clusters. In multi-particle scattering, for example, the final state of the process can produce localized clusters that retain non-negligible internal interactions, but are widely separated so that inter-cluster interactions become negligible. Each cluster therefore behaves as an approximately independent composite system.

Particles in cluster $\alpha$ have position operators

$$
  \set{\unitvec{x}_{\alpha 1}, \dots, \unitvec{x}_{\alpha n_\alpha}}
$$

and masses

$$
  \set{m_{\alpha 1},\dots,m_{\alpha n_\alpha}}
$$

Define the cluster mass

$$
  M_\alpha = \sum_{\beta=1}^{n_\alpha} m_{\alpha\beta},\; \alpha=1,\dots,k
$$

and the cluster centre-of-mass position

$$
  \unitvec{R}_\alpha = \frac{1}{M_\alpha} \sum_{\beta=1}^{n_\alpha} m_{\alpha\beta} \unitvec{x}_{\alpha\beta}
$$

The total mass and total the centre-of-mass position of the entire system are

$$
\begin{align*}
  \unitvec{R} =& \frac{1}{M} \sum_{\alpha=1}^k M_\alpha \unitvec{R}_\alpha \\
  M =& \sum_{\alpha=1}^k M_\alpha
\end{align*}
$$

For each cluster, define the cluster momentum

$$
  \unitvec{P}_{\alpha\cdot} := \sum_{\beta=1}^{n_\alpha} \unitvec{p}_{\alpha\beta}
$$

and for the whole system

$$
  \unitvec{P} := \sum_{\alpha=1}^k \unitvec{P}_\alpha
$$

The internal momenta within cluster $\alpha$ satisfy

$$
  \sum_{\beta=1}^{n_\alpha} \left(\unitvec{p}_{\alpha\beta} - \frac{m_{\alpha\beta}}{M_\alpha} \unitvec{P}_{\alpha\cdot} \right) = \mathbf{0}
$$

which reflects the fact that only $n_\alpha - 1$ internal momenta are independent.

The total Hamiltonian can be decomposed as

$$
\begin{align*}
  \hat{H} =& \frac{\unitvec{P}^2}{2M} + \sum_{\alpha=1}^k \sum_{\beta=1}^{n_\alpha} \frac{(\unitvec{p}_{\alpha\beta} - \frac{m_{\alpha\beta}}{M_\alpha} \unitvec{P}_{\alpha\cdot})^2}{2m_{\alpha\beta}} \\
  &+ \sum_{\alpha=1}^k \frac{(\unitvec{P}_{\alpha\cdot} - \frac{M_\alpha}{M}\unitvec{P})^2}{2M_\alpha} + \hat{V}_E + \hat{V}_A
\end{align*}
$$

where 
- $\hat{V}_A$ is the intra-cluster potential defined by
$$
  \hat{V}_A = \sum_{\alpha=1}^k \sum_{\beta\neq\gamma}^{n_\alpha} V_{\alpha\beta\gamma}(\unitvec{x}_{\alpha\beta} - \unitvec{x}_{\alpha\gamma})
$$

- $\hat{V}_E$ is the inter-cluster potential defined by
$$
  \hat{V}_E = \sum_{\alpha=1}^k \sum_{\substack{\beta=1 \\ \beta\neq\alpha}}^k \sum_{\gamma=1}^{n_\alpha} \sum_{\rho=1}^{n_\beta} V_{\alpha\beta\gamma\rho} (\unitvec{x}_{\alpha\gamma - \unitvec{x}_{\beta\rho}})
$$

In exact analogy with $\eqref{equation-248}$, the internal kinetic energy of cluster $\alpha$ can be expanded as

$$
  \sum_{\beta=1}^{n_\alpha} \frac{(\unitvec{P}_{\alpha\beta} - \frac{m_{\alpha\beta}}{M_\alpha}\unitvec{P}_\alpha)^2}{2m_{\alpha\beta}} = \sum_{\beta=1}^k \frac{\unitvec{P}_\alpha^2}{2M_\alpha} - \frac{\unitvec{P}^2}{2M}
$$

which removes the centre-of-mass kinetic energy of cluster $\alpha$. Similarly, the relative kinetic energies of clusters as composite particles satisfy

$$
  \sum_{\alpha=1}^k \frac{(\unitvec{P}_{\alpha\cdot} - \frac{M_\alpha}{M} \unitvec{P})^2}{2M_\alpha} = \sum_{\alpha=1}^k \frac{\unitvec{P}_{\alpha\cdot}^2}{2M_\alpha} - \frac{\unitvec{P}^2}{2M}
$$

which separates the total centre-of-mass kinetic energy of the entire system. To simplify notation we can introduce relative coordinates. For each cluster $\alpha$, we can define $(n_\alpha - 1)$ independent relative coordinates

$$
  \unitvec{r}_{\alpha\beta} := \unitvec{x}_{\alpha\beta} - \unitvec{x}_{\alpha n_\alpha},\; \beta=1,\dots,n_\alpha -1
$$

We can also define $k-1$ relative cluster coordines

$$
  \unitsym{\eta}_\alpha = \unitvec{R}_\alpha - \unitvec{R}_k,\; \alpha=1,\dots,k-1
$$

which describe the motion of cluster centers of mass relative to another.

### Parity

A parity tranformation (or spatial inversion) is implemented by a unitary operator $\hat{\Pi}$. Geometrically, $\hat{Pi}$ acts on spatial points by reflection through the origin, i.e.

$$
  \mathbf{x} \mapsto \mathbf{x}' := -\mathbf{x}
$$

and consequently sends and oriented right-handed coordinate frame into a left-handed one. Under spatial inversions, polar vectors reverse sign, whereas axial vectors and scalar remain invariant. Thus, the infinitesimal Galilean parameters $(\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})$ transform under parity as

$$
  (\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega}) \overset{\hat{P}}{\mapsto} (-\delta\mathbf{a}, -\delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})
$$

Applying a spatial inversion to the infinitesimal Galilean coordinate transformations $\eqref{equation-213}$ yields

$$
\begin{align*}
  (\delta\mathbf{x})' =& -\delta\mathbf{a} - \delta\mathbf{v}t - \delta\boldsymbol{\omega} \times\mathbf{v} \\
  \delta t =& \delta\tau
\end{align*}
$$

<details>
<summary>Proof</summary>

To establish the unitarity of $\hat{\Pi}$, consider first a pure time translation $\delta\tau$ with $\delta\mathbf{a} = \delta\mathbf{v} = \delta\boldsymbol{\omega} = \mathbf{0}$. A spatial inversion followed by a time shift $\delta\tau$ and a time shift $\delta\tau$ followed by a spatial inversion are equivalent as spacetime transformations i.e.

$$
\begin{align*}
  (\mathbf{x}, t) \overset{\Pi}{\mapsto} (-\mathbf{x}, t) \overset{T(\delta)}{\mapsto} (-\mathbf{x}, t + \delta\tau) \\
  (\mathbf{x}, t) \overset{\T(\delta\tau)}{\mapsto} (\mathbf{x}, t + \delta\tau) \overset{\Pi}{\mapsto} (-\mathbf{x}, t + \delta\tau)
\end{align*}
$$

so that the two sequences map $(\mathbf{x}, t) \mapsto (-\mathbf{x}, t + \delta\tau)$. Since these two compositions represent the same physical operation, Wigner's theorem implies that the corresponding operators must be equal up an overall phase factor. In terms of infinitesimal time evolution operator given $\eqref{equation-303}$, we must have

$$
  \left(\hat{I} - \frac{i}{\hbar} \delta\tau\hat{H}) \hat{\Pi} = \hat{\Pi}\left(\hat{I} - \frac{i}{\hbar} \delta\tau (\hat{H} + c\hat{I}) \right)
$$

up to a phase factor specified by an additional structure $(1/\hbar)\delta\varphi\hat{I}$, with $\delta\varphi = -c\delta\tau$ for $c\in\R$. Expanding this to leading order in $\delta\tau$, we obtain

$$
  i\hat{H}\hat{\Pi} = \hat{\Pi}i(\hat{H} + c\hat{I})
$$

If $\hat{\Pi}$ were anti-unitary, i.e. conjugating numerical coefficients including $i\mapsto -i$, the above relation would instead give

$$
\begin{equation*}
  \hat{H}\hat{\Pi} = -\hat{\Pi}(\hat{H} + c\hat{I})
\tag{\label{equation-304}}
\end{equation*}
$$

or equivalently, by applying $\hat{P}^{-1}$ from the left

$$
  \hat{\Pi}^{-1} \hat{H}\hat{\Pi} = -(\hat{H} + c\hat{I})
$$

Let $\ket{\psi}$ be an eigenstate of $\hat{H}$ with eigenvalue $E \geq 0$. Substituing $\hat{H}\ket{\psi} = E\ket{\psi}$ into $\eqref{equation-304}$, we get

$$
  \hat{H}(\hat{\Pi}\ket{\psi}) = -(E + c)(\hat{\Pi}\ket{\psi})
$$

Thus, for any eigenvalue $E$ arbitrarily large, there exists a corresponding eigenvalue $-(E + c)$. Since $E$ can be made arbitrarily large, the spectrum of $\hat{H}$ would be unbounded from below. This is physically unacceptable because the Hamiltonian is unbounded from above, even for a free particle. The latter argument can be made more rigorous by stating that for any $\epsilon > 0$

$$
  \norm{(\hat{H} - E)\psi_\epsilon} < \epsilon
$$

if and only if

$$
  \norm{[\hat{H} + (E + c)]\hat{P}\psi_\varepsilon} < \varepsilon
$$

implying the unboundedness of the spectrum of $\hat{H}$ from below for arbitrarily large non-negative $E$. That is, $\hat{P}$ must be unitary. By a similar argument, it also follows that $\hat{T}$ must be an anti-unitary operator.
</details>

Since the operation consisting of a spatial reflection, followed by an infinitesimal Galilean transformation, specified by the parameters $(\delta\mathbf{a},\delta\mathbf{v},\delta\tau,\delta\boldsymbol{\omega})$ is equivalent to first performing the infinitesimal changes $(-\delta\mathbf{a}, -\delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})$, and then a spatial reflection, we infer that

Since parity is represented by unitary operators, it acts on a transformation by conjugation. This implies that applying a spatial inversion followed by an infinitesimal Galilean transformation specified by $(\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})$ is equivalent, up to a global phase, to perfoming the reflected Galilean transformation first and then applying parity. Conjugating the infinitesimal Galilean transformation representation $\eqref{equation-305}$ by $\hat{\Pi}$ therefore yields

$$
\begin{align*}
  &\left(\hat{I} + \frac{i}{\hbar} (\delta\mathbf{a}\cdot\unitvec{P} + \delta\mathbf{v}\cdot\unitvec{N} - \delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\unitvec{J}) \right)\hat{\Pi} \\
  =& \hat{P} \left(\hat{I} + \frac{i}{\hbar}(-\delta\mathbf{a}\cdot\unitvec{\Pi} - \delta\mathbf{v}\cdot\unitvec{N} - \delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\mathbf{J}) \right)
\end{align*}
$$

where we have omitted the phase contribution $(1/\hbar)\delta\varphi\hat{I}$, which has no effect on commutation or anticommutation relations. Expanding both sides and using the unitarity of $\hat{P}$ we have

$$
\begin{align*}
  0 =& \delta a_i (\hat{P}_i \hat{\Pi} + \hat{\Pi}\hat{P}_i) \\
  &+ \delta v_i (\hat{N}_i \hat{\Pi} + \hat{\Pi}) \\
  &- \delta\tau(\hat{H}\hat{\Pi} - \hat{\Pi}\hat{H}) \\
  &+ \delta\omega_i (\hat{J}_i \hat{\Pi} - \hat{\Pi}\hat{J}_i)
\end{align*}
$$

Because the components $(\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})$ are independent, each coeffecient must vanish separately. This leads to the following commutation and anti-commutation relations

$$
\begin{align*}
  \hat{\Pi}\hat{H}\hat{\Pi}^{-1} = \hat{H} \iff& [\hat{H}, \hat{\Pi}] = 0 \\
  \hat{\Pi}\unitvec{J}\hat{\Pi}^{-1} = \unitvec{J} \iff& [\unitvec{J}, \hat{\Pi}] = \mathbf{0} \tag{\label{equatoin-288}} \\
  \hat{\Pi}\unitvec{P}\hat{\Pi}^{-1} = -\unitvec{P} \iff& \{\unitvec{P}, \hat{\Pi}\} = \mathbf{0} \tag{\label{equation-249}} \\
  \hat{\Pi}\unitvec{N}\hat{\Pi}^{-1} = -\unitvec{N} \iff& \{\unitvec{N}, \hat{\Pi}\} = \mathbf{0} \tag{\label{equation-250}}
\end{align*}
$$

From $\eqref{equation-249}$, $\eqref{equation-250}$ and $\eqref{equation-251}$ it follows that

$$
  \unitvec{X}\hat{\Pi} + \hat{\Pi}\unitvec{X} = \mathbf{0}
$$

If parity is not a symmetry transformation, the Hamiltonian is constructed such that $\hat{H}\hat{P} - \hat{P}\hat{H} \neq 0$.

### Time reversal

Time reversal is implemented by an anit-unitary operator $\hat{T}$. The infinitesimal Galilean transformations in $\eqref{equation-213}$ followed by a reversal of the time translation $t - \delta\tau \mapsto -t + \delta\tau$ give

$$
\begin{align*}
  (\delta\mathbf{x})' =& \delta\mathbf{a} + \delta\mathbf{v} t + \delta\boldsymbol{\omega}\times\mathbf{x} \\
  (\delta\tau)' =& -\delta\tau
\end{align*}
$$

where $\delta\mathbf{v} \mapsto -\delta\mathbf{v}$ and $\delta\boldsymbol{\omega}\mapsto\delta\boldsymbol{\omega}$ under the reversal of the direction of time flow. We note the invariance of the product $\delta\mathbf{v}t$.

By using the identification of the position operator in $\eqref{equation-251}$, the infinitesimal Galilean transformation, at a given time $t$, can be expressed as

$$
  \hat{I} + \frac{i}{\hbar}[(\delta\mathbf{a} + t\delta\mathbf{v})\cdot\unitvec{P} - M\delta\mathbf{v}\cdot\unitvec{X} - \delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\unitvec{J}]
$$

Since the operation of time reversal followed by an infinitesimal Galilean transformation specified by $(\delta\mathbf{a}, \delta\mathbf{v}, \delta\tau, \delta\boldsymbol{\omega})$ at a given time $t$ is equivalent to an infinitesimal Galilean transformation specified by $(\delta\mathbf{a}, -\delta\mathbf{v}, -\delta\tau, \delta\boldsymbol{\omega})$, at time $-t$ followed by a time reversal, we obtain

$$
\begin{align*}
  &\left(\hat{I} + \frac{i}{\hbar}[(\delta\mathbf{a} + t\delta\mathbf{v})\cdot\unitvec{P} - M\delta\mathbf{v}\cdot\unitvec{X} - \delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\unitvec{J}] \right)\hat{T} \\
  =& \hat{T}\left(\hat{I} + \frac{i}{\hbar}[(\delta\mathbf{a} + t\delta\mathbf{v})\cdot\unitvec{P} + M\delta\tau\hat{H} + \delta\boldsymbol{\omega}\cdot\unitvec{J}] \right)
\end{align*}
$$

where we have omitted a phase factor contribution. Using the anti-unitarity of $\hat{T}$, we derived the following commutation and anti-commutation relations

$$
\begin{align*}
  \hat{T}\hat{H}\hat{T}^{-1} = \hat{H} \iff& [\hat{H}, \hat{T}] = 0 \tag{\label{equation-290}} \\
  \hat{T}\unitvec{J}\hat{T}^{-1} = -\unitvec{J} \iff& \{\unitvec{J}, \hat{T}\} = \mathbf{0} \tag{\label{equation-282}} \\
  \hat{T}\unitvec{P}\hat{T}^{-1} = -\unitvec{P} \iff& \{\unitvec{P}, \hat{T}\} = \mathbf{0}
\end{align*}
$$

and

$$
  (t\unitvec{P} - M \unitvec{X})\hat{T} + \hat{T}(t\unitvec{P} + M\unitvec{X}) = \mathbf{0}
$$

where $\hat{T}$ does not operator on $t$. The latter two equations give

$$
  \hat{T}\unitvec{X}\hat{T}^{-1} = \unitvec{X} \iff [\unitvec{X}, \hat{T}] = \mathbf{0}
$$

### Supersymmetry

The closed path Galilean transformations lead to a basic commutation/anti-commutation relations of the supersymmetry generator and of the Hamiltonian. Together with the time variable $t$, as a c-number, we introduce anti-commuting c-number variables $\theta$ and $\theta^*$ having the following transformations

$$
\begin{equation*}
\begin{split}
  t \mapsto& t - \tau + i\xi^* \theta - i\theta^* \xi = \bar{t} \\
  \theta \mapsto& \theta + \xi = \bar{\theta},\; \bar{\theta}^* = \theta^* + \xi^*
\end{split}
\tag{\label{equation-299}}
\end{equation*}
$$

where by anti-commuting c-numbers $\theta, \theta^*$ we mean

$$
\begin{align*}
  \{\theta, \theta\} =& 0 \\
  \{\theta^*, \theta^* \} =& 0 \\
  \{\theta, \theta^* \} =& 0
\end{align*}
$$

where $\{\hat{A}, \hat{B}\} := \hat{A}\hat{B} + \hat{B}\hat{A}$ is the anti-commutator. This implies that $(\theta)^2 = 0$ and $(\theta^*)^2 = 0$ and the variables $\theta$ and $\bar{\theta}$ are referred to as Grassmann variables.

As before $\tau$ is a c-number. On the other hand, $\theta, \theta^*, \xi, \xi^*, \bar{\xi}, \bar{\xi}^*, \dots$ anti-commute  with each other but commute with $t, \tau, \bar{\tau}, \dots$. For a subsequent transformation to $\eqref{equation-299}$ we have

$$
\begin{align*}
  \bar{\bar{t}} =& \bar{t} - \bar{\tau} + i\bar{\xi}^* \bar{\theta} - i\bar{\theta}^* \bar{\xi} \\
  \bar{\bar{\theta}} =& \bar{\theta} + \bar{\xi}
\end{align*}
$$

and similarly for $\bar{\bar{\theta}}$, or

$$
\begin{equation*}
\begin{split}
  \bar{\bar{t}} =& t - (\tau + \bar{\tau} - i\bar{\xi}^* \xi + i\xi^* \bar{\xi}) + i(\xi^* + \bar{\xi}^*)\theta - i\theta^* (\xi + \bar{\xi}) \\
  \bar{\bar{\theta}} =& \theta + (\xi + \bar{\xi})
\end{split}
\tag{\label{equation-300}}
\end{equation*}
$$

The transformations in $\eqref{equation-299}$ can be specified by the pair $(\tau,\xi)$, which for simplicity of notation we have supressed the entry $\xi^*$. From $\eqref{equation-299}$ and $\eqref{equation-300}$ we have the following group properties

1.
$$
\begin{align*}
  (\tau_2, \xi_2)(\tau_1, \xi_1) = (\tau_1 + \tau_2 - i\xi_2^* \xi_1 + i\xi_1^* \xi_2, \xi_1 + \xi_2)
\end{align*}
$$

2. For the identity element $e = (0, 0)$
3. The inverse is given by $(\tau,\xi)^{-1} = (-\tau, -\xi)$ as is easily checked that $(-\tau, -\xi)(\tau, \xi) = (0,0)$.
4. **Associativity:**
$$
  (\tau_3, \xi_3)[(\tau_2, \xi_2)(\tau_1, \xi_1)] = [(\tau_3, \xi_3)(\tau_2, \xi_2)](\tau_1, \xi_1)
$$

We consider successive transformations following a closed path given

$$
  (\tau_2, \xi_2)^{-1} (\tau_1, \xi_1)^{-1} (\tau_2, \xi_2)(\tau_1, \xi_1)
$$

The group properties above the lead to the following rule associated with the closed path

$$
  (\tau_2, \xi_2)^{-1} (\tau_1, \xi_1)^{-1} (\tau_2, \xi_2)(\tau_1, \xi_1) = (\tau,\xi)
$$

where

$$
\begin{align*}
  \tau =& -2i\xi_2^* \xi_1 + 2i\xi_1^* \xi_2 \\
  \xi =& 0
\end{align*}
$$

Since the above transformations are connected with the identity, the corresponding transformations in the vector space of physical states is represented by unitary transformations. For infinitesimal transformations, we can write for the overall transformation

$$
  \hat{U} = \hat{I} + \frac{i}{\hbar}\hat{G} + \cdots
$$

where $\hat{G} = -\delta\tau\hat{H} + i\delta\xi^* \hat{Q} - i\hat{Q}^\dagger \delta\xi$ and

$$
\begin{align*}
  \hat{U}_j =& \hat{I} + \frac{i}{\hbar}\hat{G}_j + \cdots \\
  \hat{G}_j =& -\delta\tau_j \hat{H} + i\delta\xi_j^* \hat{Q} - i\hat{Q}^\dagger \delta\xi_j
\end{align*}
$$

for $j=1,2$ and where $\hat{Q}, \hat{Q}^\dagger$ are generators of supersymmetric transformations. Upon writing

$$
\begin{equation*}
  \hat{U} = \hat{U}_2^{-1} \hat{U}_1^{-1} \hat{U}_2 \hat{U}_1
\tag{\label{equation-301}}
\end{equation*}
$$

we have the identity

$$
  \hat{G} = \frac{i}{\hbar} [\hat{G}_1, \hat{G}_2]
$$

and from $\eqref{equation-300}$

$$
\begin{equation*}
\begin{split}
  \delta\tau =& -2i\delta\xi_2^* \delta\xi_1 + 2i\delta\xi_1^* \delta\xi_2 \\
  \delta\xi =& 0
\end{split}
\tag{\label{equation-302}}
\end{equation*}
$$

$\delta\xi_1$, $\delta\xi_1^*$, $\delta\xi_2$, $\delta\xi_2^*$ anti-commute with $\hat{Q}$ and $\hat{Q}^\dagger$ and anti-commute with each other. However, $\delta\xi$, $\delta\xi_1^*$, $\delta\xi_2$, $\delta\xi_2^*$ commute with $\delta\tau_1$, $\delta\tau_2$ and $\hat{H}$. The commutator of $\eqref{equation-301}$ is worked out to be

$$
\begin{align*}
  [\hat{G}_1, \hat{G}_2] =& (i\delta\tau_2 \delta\xi_1^* - i\delta\tau_1 \delta\xi_2^*)[\hat{H}, \hat{Q}] \\
  &+ (i\delta\tau_1 \delta\xi_2 - i\delta\tau_2 \delta\xi_1)[\hat{Q}^\dagger, \hat{H}] \\
  &+ (\delta\xi_1^* \delta\xi_2^*)\{\hat{Q}, \hat{Q}\} \\
  &+ (\delta\xi_1 \delta\xi_2)\{\hat{Q}^\dagger, \hat{Q}^\dagger \} \\
  &+ (\delta\xi_1^* \delta\xi_2 - \delta\xi_2^* \delta\xi_1)\{\hat{Q}, \hat{Q}^\dagger \}
\end{align*}
$$

which from $\eqref{equation-300}$ and $\eqref{equation-302}$ yields to

$$
\begin{align*}
  [\hat{H}, \hat{Q}] =& 0 \\
  [\hat{H}, \hat{Q}^\dagger] =& 0 \\
  \{\hat{Q}, \hat{Q}\} =& 0 \iff (\hat{Q})^2 = 0 \\
  \{\hat{Q}^\dagger, \hat{Q}^\dagger\} =& 0 \iff (\hat{Q}^\dagger)^2 = 0
\end{align*}
$$

and

$$
  \hat{H} = \frac{1}{2\hbar} \{\hat{Q}, \hat{Q}^\dagger\}
$$

# Operators

## Angular momentum

From the commutation relations in Table $\ref{table-1}$ and $\eqref{equation-230}$ the change in the total angular momentum operator $\unitvec{J}$ under infinitesimal Galilean transformations is given by

$$
\begin{equation*}
  \delta\unitvec{J} = (\delta\mathbf{a} + t\delta\mathbf{v})\times\unitvec{P} - M\delta\mathbf{v}\times\unitvec{X} + \delta\boldsymbol{\omega}\times\unitvec{J}
\tag{\label{equation-253}}
\end{equation*}
$$

On the other hand, using $\eqref{equation-252}$ and $\eqref{equation-219}$

$$
  \delta\unitvec{X} = (\delta\mathbf{a} + t\delta\mathbf{v}) + \delta\boldsymbol{\omega} \times\unitvec{X} - \delta\tau\frac{\unitvec{P}}{M}
$$

and from $\eqref{equation-214}$ and Table $\ref{table-1}$

$$
  \delta\unitvec{P} = M\delta\mathbf{v} + \delta\boldsymbol{\omega}\times\unitvec{P}
$$

Applying the Leibniz rule on the latter two equations or directly from $\eqref{equation-214}$, we obtain the transformation law for the operator $\unitvec{L} := \unitvec{X}\times\unitvec{P}$

$$
\begin{equation*}
  \delta(\unitvec{X}\times\unitvec{P}) = (\delta\mathbf{a}+t\delta\mathbf{v}) \times\unitvec{P} - M\delta\mathbf{v}\times\unitvec{X} + \delta\boldsymbol{\omega}\times(\unitvec{X}\times\unitvec{P})
\tag{\label{equation-254}}
\end{equation*}
$$

which satisfies the same commutation relations in Table $\ref{table-1}$ and in $\eqref{equation-230}$ as $\unitvec{J}$. Comparing $\eqref{equation-253}$ with $\eqref{equation-254}$ we conclude that $\unitvec{J}$ has the general form

$$
\begin{equation*}
  \unitvec{J} = (\unitvec{X}\times\unitvec{P}) + \unitvec{S}
\tag{\label{equation-262}}
\end{equation*}
$$

The operator $\unitvec{L}$ denotes the orbital angular momentum, while $\unitvec{S}$ represents spin or internal angular momentum. The spin $\unitvec{S}$ is a translational independent contribution of $\unitvec{J}$ and satisfies the commutation relations

$$
\begin{align*}
  [\hat{P}^i, \hat{S}^j] =& 0 \\
  [\hat{X}^i, \hat{S}^j] =& 0 \\
  [\hat{H}, \hat{S}^i] =& 0 \\
  [\hat{S}^j, \hat{S}^j] =& i\varepsilon^{ijk} \hat{S}^k \\
  [\hat{L}^i, \hat{S}^j] =& 0 \tag{\label{equation-263}}
\end{align*}
$$

A Galilean scalar field $\psi(\mathbf{x})$ under a rotation of the coordinate system is defined by 

$$
  \psi'(\hat{R}\mathbf{x}) = \psi(\mathbf{x})
$$

or by

$$
\begin{equation*}
  \psi'(\mathbf{x}) = \psi(R^{-1} \mathbf{x})
\tag{\label{equation-255}}
\end{equation*}
$$

Upon using $\eqref{equation-256}$, $\eqref{equation-257}$ and $\eqref{equation-258}$, we obtain from $\eqref{equation-255}$

$$
  \left[\exp\left(\frac{i}{\hbar} \boldsymbol{\omega}\cdot\unitvec{J} \right)\psi\right](\mathbf{x}) = \exp[\boldsymbol{\omega}\cdot(\mathbf{x}\times\nabla)]\psi(\mathbf{x})
$$

where we also used that $\hat{R}^\top = \hat{R}^\dagger = \hat{R}^{-1}$. This results in the representation

$$
  \unitvec{J} = \mathbf{x}\times(-i\hbar\nabla)
$$

and $\unitvec{S} = \mathbf{0}$ reflecting the spin $0$ character of a scalar field.

A Galilean vector field $\boldsymbol{\Phi}(\mathbf{x})$ under the rotation of the coordinate system, is defined by

$$
  {\Phi'}^i (\hat{R}\mathbf{x}) =& R^{ij} \Phi^j (\mathbf{x})
$$

or by

$$
\begin{equation*}
  {\Phi'}^i (\mathbf{x}) = R^{ij} \Phi^j (\hat{R}^{-1} \mathbf{x})
\tag{\label{equation-259}}
\end{equation*}
$$

The presence of the matrix $(R^{ij})$ implies the invariance of an amplitude under a rotation of the coordinate system

$$
  \sum_{i=1}^3 \braket{{\phi'}^i|{\psi'}^i} = \sum_{i=1}^3 \braket{\Phi^i|\psi^i}
$$

where we have used $\eqref{equation-}$ and $\eqref{equation-}$ for the evaluation of the Jacobian of the transformation which is equal to one. From $\eqref{equation-257}$ and $\eqref{equation-258}$, we have for $\eqref{equation-259}$

$$
  \boldsymbol{\Phi}' (\mathbf{x}) = \exp\left(\frac{i}{\hbar} \boldsymbol{\omega}\cdot(\mathbf{x} \times(-i\hbar\nabla)) + \hbar\mathbf{M} \right) \boldsymbol{\Phi}(\mathbf{x})
$$

leading to the representation

$$
  \unitvec{J} = \mathbf{x}\times(-i\hbar\nabla) + \hbar\mathbf{M}
$$

and hence to $\unitvec{S} = \hbar\mathbf{M}$ where $\mathbf{M}$ are the generators of $\hat{R}$. In particular

$$
  \unitvec{S}^2 = 2\hbar\hat{I}
$$

For a system of $n$ particles, the total angular momentum is given by the operator

$$
\begin{equation*}
  \unitvec{J} = \sum_{\alpha=1}^n (\unitvec{X}_\alpha \times\unitvec{P}_\alpha + \unitvec{S}_\alpha)
\tag{\label{equation-260}}
\end{equation*}
$$

We can rewrite $\unitvec{J}$ in the form

$$
  \unitvec{J} = \unitvec{X} \times\unitvec{P} + \sum_{\alpha=1}^n [(\unitvec{X}_\alpha - \unitvec{X})\times\unitvec{P}_\alpha + \unitvec{S}_\alpha]
$$

On the other hand since

$$
  \sum_{\alpha=1}^n \frac{m_\alpha}{M} (\unitvec{X}_\alpha - \unitvec{X}) = 0
$$

and hence

$$
  \sum_{\alpha=1}^n \frac{m_\alpha}{M} (\unitvec{X}_\alpha - \unitvec{X}) \times\unitvec{P} = \mathbf{0}
$$

we can finally rewrite $\eqref{equation-260}$ as

$$
  \unitvec{J} = \unitvec{X}\times\unitvec{P} + \sum_{\alpha=1}^n \left[(\unitvec{X}_\alpha - \unitvec{X}) \times \left(\unitvec{P}_\alpha - \frac{m_\alpha}{M} \unitvec{P} \right) + \unitvec{S}_\alpha \right]
$$

This leads to the following expression for the total internal angular momentum $\unitvec{S}$ of the system of particles as one composite object made up of the $n$ particles

$$
\begin{equation*}
  \unitvec{S} = \sum_{\alpha=1}^n \left[ (\unitvec{X}_\alpha - \unitvec{X}) \times \left(\unitvec{P}_\alpha - \frac{m_\alpha}{M} \unitvec{P} \right) + \unitvec{S}_\alpha \right]
\tag{\label{equation-261}}
\end{equation*}
$$

where
- $\unitvec{X}_\alpha - \unitvec{X}$ is the operator for the position of the $\alpha$th particle relative to the center of mass
- $\unitvec{P}_\alpha - m_\alpha\unitvec{P}/M$ is the operator of its momentum as determined in the center of mass

The first term in the summand in $\eqref{equation-261}$ represents the orbital angular momentum operator of the $\alpha$th particle in the center of mass system. The internal angular momentum $\unitvec{S}$ in $\eqref{equation-261}$ is the total angular momentum of the system of particles relative to the center of mass. It follows from $\eqref{equation-261}$ that

$$
\begin{align*}
  [\hat{P}^i, \hat{S}^j] =& 0 \\
  [\hat{X}^i, \hat{S}^j] =& 0
\end{align*}
$$

Consider the decomposition of $\unitvec{J}$ in $\eqref{equation-260}$ into $k\neq 1$ clusters composed of $n_1,\dots,n_k$ particles. In this case it is more convenient to introduce the operators $\unitvec{X}_{\alpha\beta}$, $\unitvec{P}_{\alpha\beta}$, $\unitvec{X}_{\alpha\cdot}$, $\unitvec{X}$, $\unitvec{P}_{\alpha\cdot}$ and $\unitvec{P}$ where

$$
\begin{align*}
  \unitvec{X}_{\alpha\cdot} =& \sum_{\beta=1}^{n_\alpha} \frac{m_{\alpha\beta}}{M_\alpha} \unitvec{X}_{\alpha\beta} \\
  \unitvec{X} =& \sum_{\alpha=1}^k \frac{M_\alpha}{M} \unitvec{X}_\alpha
\end{align*}
$$

denoting, respectively, the position operator associated with the center of mass of the $\alpha$th cluser, and the position operator of the center of mass of $k$ clusters with the latter coinciding with the center of mass ofthe $\sum_{\alpha=1}^k n_\alpha$ particles.

Suppose $\unitvec{S}_{\alpha\beta}$ denotes the spin of the $\beta$th particle in the $\alpha$th cluster. Then

$$
  \unitvec{J} = \sum_{\alpha=1}^k \sum_{\beta=1}^{n_\alpha} (\unitvec{X}_{\alpha\beta} \times\unitvec{P}_{\alpha\beta} + \unitvec{S}_{\alpha\beta})
$$

can be rewritten as

$$
\begin{align*}
  \unitvec{J} =& \unitvec{X}\times\unitvec{P} \\
  &+ \sum_{\alpha=1}^k \left[(\unitvec{X}_{\alpha\cdot} - \unitvec{X})\times\left(\unitvec{P}_\alpha - \frac{M_\alpha}{M} \unitvec{P} \right) + \unitvec{S}_{(\alpha)} \right]
\end{align*}
$$

where

$$
  \unitvec{S}_{(\alpha)} = \sum_{\beta=1}^{n_\alpha} \left[(\unitvec{X}_{\alpha\beta} - \unitvec{X}_{\alpha\cdot}) \times \left(\unitvec{P}_{\alpha\beta} - \frac{m_{\alpha\beta}}{M} \unitvec{P}_\alpha \right) + \unitvec{S}_{\alpha\beta} \right]
$$

is the total internal angular momentum of the $\alpha$th cluster as a composite object made up of $n_\alpha$ particles. The following commutation relations again hold true

$$
\begin{align*}
  [\hat{P}_{\alpha\cdot}^i, \hat{S}_{(\alpha)}^j] =& 0 \\
  [\hat{X}_{\alpha\cdot}^i, \hat{S}_{(\alpha)}^j] =& 0
\end{align*}
$$

Also, for $i,j = 1,2,3$

$$
\begin{align*}
  [\hat{P}^i, \hat{S}_{(\alpha)}^j] =& 0 \\
  [\hat{X}^i, \hat{S}_{(\alpha)}^j] =& 0
\end{align*}
$$

Finally, we note from the transformation law $\eqref{equation-256}$ of a state $\ket{\psi}$ under a coordinate rotation is

$$
  \psi'(\mathbf{x}) = \left(e^{i\varphi\unitsym{n}\cdot\unitvec{J}/\hbar} \psi\right)(\mathbf{x})
$$

and from $\eqref{equation-262}$, $\eqref{equation-263}$ and $\eqref{equation-258}$

$$
  \psi'(\mathbf{x}') = \left(e^{i\varphi\unitsym{n}\cdot\unitvec{J}/\hbar} \psi\right)(\mathbf{x})
$$

where $\mathbf{x}' = \hat{R}\mathbf{x}$. Note that the argument of $\psi'$ is $\mathbf{x}$ when the right-hand side of the equation of its transformation law involves $\unitvec{J}$, while it is $\mathbf{x}'$, when it involves only spin $\unitvec{S}$.

### Orbital angular momentum

### Spin

### Spinors

A spinor field of rank $k$, denoted $\psi^{a_1 \dots a_k} (\mathbf{x})$, depending on $k$ indices $a_1,\dots,a_k$ each taking the possible values $\set{1,2}$, has the following transformation law under a coordinate rotation by an angle $\varphi$ about $\unitsym{n}$:

$$
\begin{equation*}
  {\psi'}^{a_1 \dots a_k} (\mathbf{x}') = (e^{i\varphi\unitsym{n}\cdot\boldsymbol{\sigma}/2})^{a_1 b_1} \cdots (e^{i\varphi\unitsym{n}\cdot\boldsymbol{\sigma}/2})_{a_k b_k} \psi^{b_1 \dots b_k} (\mathbf{x})
\tag{\label{equation-270}}
\end{equation*}
$$

where a summation over the repeated indices $b_1,\dots,b_k$ is understood, and $\mathbf{x}' = \hat{R}\mathbf{x}$. Here $\boldsymbol{\sigma}$ are the Pauli matrices.

To describe arbitrary spins, we are interested in symmetric spinors of rank $k$. That is, spinors $\psi^{a_1 \dots a_k} (\mathbf{x})$ which are completely symmetric in the indices $a_1,\dots,a_k$.

The matrix $\exp(i\varphi\unitsym{n}\cdot\boldsymbol{\sigma}/2)$ can be rewritten in the simple form

$$
  \mathbf{I} \cos\left(\frac{\varphi}{2} \right) + i(\unitsym{n}\cdot\boldsymbol{\sigma}) \sin\left(\frac{\varphi}{2}\right)
$$

To see this, note that

$$
\begin{align*}
  &\frac{\d}{\d\varphi} \left(\mathbf{I}_2 \cos\left(\frac{\varphi}{2} \right) + i(\unitsym{n}\cdot\boldsymbol{\sigma}) \sin\left(\frac{\varphi}{2}\right)\right)
  &= \frac{i}{2} \unitsym{n}\cdot\boldsymbol{\sigma} \left(\mathbf{I}_2 \cos\left(\frac{\varphi}{2} + i(\unitsym{n}\cdot\boldsymbol{\sigma})\sin\left(\frac{\varphi}{2} \right) \right) \right)
\end{align*}
$$

where we have used the identity $\sigma_i \sigma_j = \delta^{ij} + i\varphi^{ijk} \sigma_k$. Integrating gives

$$
\begin{equation*}
  e^{i\varphi\unitsym{n}\cdot\boldsymbol{\sigma}/2} = \mathbf{I} \cos\left(\frac{\varphi}{2} \right) + i(\unitsym{n}\cdot\boldsymbol{\sigma}) \sin\left(\frac{\varphi}{2} \right)
\tag{\label{equation-268}}
\end{equation*}
$$

with the boundary condition

$$
  e^{i\varphi\unitsym{n}\cdot\boldsymbol{\sigma}}|_{\varphi=0} = \mathbf{I}
$$

As the indices $a_1,\dots,a_k$ take on the values $\set{1,2}$, a completely symmetric spinor $\psi^{a_1 \dots a_k} (\mathbf{x})$ define $(k + 1)$ function which we denote by $\psi_0 (\mathbf{x}), \dots, \psi_k (\mathbf{x})$ and, in particular, we can choose

$$
\begin{align*}
  \psi^{11\dots 11}(\mathbf{x}) =:& \psi_k (\mathbf{x}) \\
  \psi^{22\dots 22}(\mathbf{x}) =:& \psi_0 (\mathbf{x})
\end{align*}
$$

For arbitrary $a_1, \dots, a_k$ taking the values $\set{1,2}$, we can expand $\psi^{a_1 \dotss a_k}(\mathbf{x})$ in terms of these functions. Let $j$ of the indices $a_1, \dots, a_k$ take on the value $1$ and the $(k - j)$ remaining of them take on the value $2$. We introduce the orthonormal set consisting of the objects

$$
\begin{equation*}
  C^{a_1 \dots a_k} (j) = \frac{1}{\sqrt{k!j!(k-j)!}} ({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)_\sigma
\tag{\label{equation-264}}
\end{equation*}
$$

where the subscript $\sigma$ stands for a summation over all permutations of $\set{a_1,\dots,a_k}$. The orthonormality property reads

$$
\begin{equation*}
  \sum_{a_1,\dots,a_k=1,2} C^{a_1 \dots a_k} (j) C^{a_1 \dots a_k} (j') = \delta_{jj'}
\tag{\label{equation-266}}
\end{equation*}
$$

The orthogonality property for $j \neq j'$ is obvious since the number of ones (and hence also the number of twos) will be different in this case. The overall normalization factor in $\eqref{equation-264}$ arises in the following manner. Out of the $k$ permutations of $\set{a_1,\dots,a_k}$, then $j!(k-j)!$ are redundant. Thus, we can write

$$
\begin{align*}
  &({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)_\sigma \\
  =& j!(k-j)! ({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)'_\sigma
\end{align*}
$$

where $({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)'_\sigma$ stands for a summation over all non-redundant permutations. The latter will consist of exactly $C_j^k := k!/j!(k-j)!$ orthonormal terms, i.e.

$$
\begin{align*}
  &\sum_{a_1,\dots,a_k=1,2} ({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)_\sigma \\
  &\times ({\delta^{a_1}}^1 \dots {\delta^{a_1}}^2 \dots {\delta^{a_k}}^2)_\sigma \\
  =& (j!(k-j)!)^2 C_j^k = k!j!(k-j)!
\end{align*}
$$

Hence, we can write

$$
\begin{equation*}
  \psi^{a_1 \dots a_k} (\mathbf{x}) = \sum_{j=0}^k C^{a_1 \dots a_k} (j) \psi_j (\mathbf{x})
\tag{\label{equation-265}}
\end{equation*}
$$

with, in particular

$$
\begin{align*}
  C^{a_1 \dots a_k} (k) =& {\delta^{a_1}}^1 \dots {\delta^{a_k}}^1 \\
  \psi^{a_1 \dots a_k} (0) =& {\delta^{a_1}}^2 \dots {\delta^{a_2}}^2
\end{align*}
$$

The structures $C^{a_1 \dots a_k} (k)$ in $\eqref{equation-264}$ can rewritten in a more convenient form as follows. We introduce two indepedendent variables $g_1$ and $g_2$. Then it is not difficult to see that $\eqref{equation-264}$ can be rewritten in the the equivalent form

$$
\begin{equation*}
  C^{a_1 \dots a_k} (j) = \frac{1}{\sqrt{k!j!(k - j)!}} \frac{\partial}{\partial g_{a_1}}\cdots \frac{\partial}{\partial g_{a_k}} (g_1)^j (g_2)^{k-j}
\tag{\label{equation-271}}
\end{equation*}
$$

At this stage, it is more convenient to introduce the parameters $s$ and $m_s$ defined by

$$
\begin{equation*}
\begin{split}
  k =& 2s,\; k\in\N_+ \\
  m_s =& j - s,\; j=0,1,\dots,j
\begin{split}
\tag{\label{equation-272}}
\end{equation*}
$$

Thus $s$ and $m_s$ take the possible values

$$
  s =& \frac{1}{2},1,\frac{3}{2},2,\dots \\
  m_s =& -s, -s+1,\dots,s-1,s
$$

We can then rewrite $\eqref{equation-265}$ as 

$$
\begin{equation*}
  \psi^{a_1 \dots a_{2s}} = \sum_{m_s=-s}^s C^{a_1 \dots a_{2s}} (s + m_s) \psi(\mathbf{x}, m_s)
\tag{\label{equation-267}}
\end{equation*}
$$

where $\psi(\mathbf{x}, m_s) = \psi_{s+m_s} (\mathbf{x})$ in a coordinate description.

The unitarity of $\psi(\mathbf{x}, m_s)$ follows from the orthogonality condition $\eqref{equation-266}$ 

$$
\begin{align*}
  &\sum_{a_1,\dots,a_{2s}=1,2} \int (\psi^{a_1 \dots a_{2s}} (\mathbf{x}))^\dagger \phi^{a_1 \dots a_{2s}} (\mathbf{x})\;\d^3 \mathbf{x} \\
  =& \sum_{m_s = -s}^{s} \psi^* (\mathbf{x}, m_s) \phi(\mathbf{x}, m_s)\;\d^3 \mathbf{x}
\end{align*}
$$

and, in particular

$$
\begin{equation*}
\begin{split}
  1 =& \sum_{a_1,\dots,a_{2s}=1,2} \norm{\psi^{a_1 \dots a_{2s}}}^2 \\
  =& \sum_{m_s = -s}¨s |\psi(\mathbf{x}, m_s)|^2
\end{split}
\tag{\label{equation-276}}
\end{equation*}
$$

when normalized to one. More generally, we can write instead of $\eqref{equation-267}$

$$
\begin{equation*}
  \psi^{a_1 \dots a_{2s}} = \sum_{m=-s}^s C^{a_1 \dots a_{2s}} (s + m_s) \psi(m_s)
\tag{\label{equation-269}}
\end{equation*}
$$

The matrix in $\eqref{equation-268}$ is worked out to be, using $\eqref{equation-}$ in the process

$$
\begin{equation*}
  \mathbf{A} := e^{i\varphi\cdot\unitsym{n}\cdot\boldsymbol{\sigma}/\hbar} = \begin{bmatrix}
    \cos\left(\varphi/2 \right) + in^3 \sin(\varphi/2) & i(n^1 - in^2) \sin(\varphi/2) \\
    i(n^1 + in^2) \sin(\varphi/2) & \cos(\varphi/2) - in^3 \sin(\varphi/2)
  \end{bmatrix}
\tag{\label{equation-275}}
\end{equation*}
$$

where $\unitsym{n} = (n^1, n^2, n^3)$. The inverse of $\mathbf{A}$ is obtained by replacing $\varphi$ with $-\varphi$

$$
  \mathbf{A}^{-1} = \begin{bmatrix}
    \cos\left(\varphi/2 \right) - in^3 \sin(\varphi/2) & -i(n^1 - in^2) \sin(\varphi/2) \\
    -i(n^1 + in^2) \sin(\varphi/2) & \cos(\varphi/2) + in^3 \sin(\varphi/2)
  \end{bmatrix}
$$

The transformation $\mathbf{A}^{a_1 b_1} \dots \mathbf{A}^{a_{2s} b_{2s}} \psi^{b_1 \dots b_{2s}}$ corresponding to the righ-hand side of $\eqref{equation-269}$ can be explicitly carried out. To this end, we introduce two new variables $h_1$ and $h_2$ defined by

$$
  h_a = g_b [\mathbf{A}^{-1}]^{ba}
$$

leading to

$$
\begin{align*}
  [\mathbf{A}]^{ab} \frac{\partial}{\partial g_b} =& \frac{\partial}{\partial h_a} \\
  g_a =& h_b [\mathbf{A}]^{ba}
\end{align*}
$$

Accordingly, from $\eqref{equation-270}$, $\eqref{equation-271}$, $\eqref{equation-272}$ and $\eqref{equation-269}$, we have

$$
\begin{equation*}
\begin{split}
  &[\mathbf{A}]^{a_1 b_1} \dots [\mathbf{A}]^{a_{2s} b_{2s}} \psi^{b_1 \dots b_{2s}} = \sum_{m_s = -s}^s \left(\frac{1}{\sqrt{(2s)!(s + m_s)! (s - m_s)!}} \right. \\
  &\times \left. \frac{\partial}{\partial h_{a_1}} \cdots \frac{\partial}{\partial h_{a_{2s}}} (h_b [\mathbf{A}]^{b_1})^{s + m_s} (h_c [\mathbf{A}]^{c2})^{s-m_s} \psi(m_s) \right)
\end{split}
\tag{\label{equation-273}}
\end{equation*}
$$

Applying the binomial expansion, we have

$$
\begin{align*}
  (h_c [\mathbf{A}]^{b1})^{s + m_s} =& (h_1 [\mathbf{A}]^{11} + h_2 [\mathbf{A}]^{21})^{s + m_s} \\
  (h_c [\mathbf{A}]^{c2})^{s - m_s} =& (h_1 [\mathbf{A}]^{12} + h_2 [\mathbf{A}]^{22})^{s - m_s}
\end{align*}
$$

the right-hand side of $\eqref{equation-273}$ can be rewritten as

$$
  \sum_{m_s = -s}^s C^{a_1 \dots a_{2s}} (s + m_s) \tilde{\psi}(m_s)
$$

where

$$
\begin{equation*}
\begin{split}
  \tilde{\psi} =& \sum_{q, m'_s} \frac{\sqrt{(s + m_s)!(s - m_s)!(s + m'_s)!(s - m'_s)!}}{(s + m_s - q)!(m'_s - m_s + q)!q'!(s - m'_s - q)!} \\
  &\times ([\mathbf{A}]^{11})^{s + m_s - q} ([\mathbf{A}]^{21})^{m'_s - m_s + q} ([\mathbf{A}]^{12})^q ([\mathbf{A}]^{22})^{s - m'_s - q} \psi(m'_s)
\end{split}
\tag{\label{equation-274}}
\end{equation*}
$$

giving the transformation law for $\psi(m_s)$, and the $q$-sum is over all non-negative integers $q$ for which the arguments of the factorials involving $q$ are non-negative integers. Upon writing $\psi(m_s) = \braket{s, m_s|\psi}$ the spin operator $\unitvec{S}$ id defined through

$$
\begin{equation*}
  \braket{s, m_s|\tilde{\psi}} = \braket{s, m_s|e^{i\varphi\unitsym{n}\cdot\unitvec{S}/\hbar}|\psi}
\tag{\label{equation-277}}
\end{equation*}
$$

which from $\eqref{equation-274}$ gives

$$
\begin{equation*}
\begin{split}
  &\bra{s, m_s}e^{i\varphi\unitsym{n}\cdot\unitvec{S}}} = \sum_{q, m'_s} \frac{\sqrt{(s + m_s)!(s - m_s)!(s + m'_s)!(s - m'_s)}}{(s + m_s - q)!(m'_s - m_s + q)!(s - m'_s - q)!} \\
  &\times ([\mathbf{A}]^{11})^{s + m_s - q} ([\mathbf{A}]^{21})^{m'_s - m_s + q} ([\mathbf{A}]^{12})^q ([\mathbf{A}]^{22})^{s - m'_s - q} \bra{s, m'_s}
\end{split}
\tag{\label{equation-278}}
\end{equation*}
$$

Differentiating with respect to $\varphi$ using the expression for the matrix elements $[\mathbf{A}]^{ab}$ in $\eqref{equation-275}$, and setting $\varphi = 0$ we obtain

$$
\begin{align*}
  \bra \unitsym{n}\cdot\unitvec{S} =& (n^1 + in^2) \frac{\hbar}{2} \sqrt{(s - m_s)(s + m_s + 1)} \bra{s, m_s + 1} \\
  &+ (n^1 - in^2) \frac{\hbar}{2} \sqrt{(s + m_s)(s - m_s + 1)} \bra{s, m_s - 1} \\
  &+ n^3 \hbar m_s \bra{s, m_s}
\end{align*}
$$

Thus, in particular

$$
\begin{equation*}
\begin{split}
  \hat{S}^1 \ket{s, m_s} =& \frac{\hbar}{2} \sqrt{(s - m)(s + m + 1)}\ket{s, m_s + 1} \\
  &+ \frac{\hbar}{2} \sqrt{(s + m_s)(s - m_s + 1)}\ket{s, m_s - 1} \\
  \hat{S}^2 \ket{s, m_s} =& -i\frac{\hbar}{2} \sqrt{(s - m_s)(s + m_s + 1)}\ket{s, m_s + 1} \\
  &+ i\frac{\hbar}{2}\sqrt{(s + m_s)(s - m_s + 1)}\ket{s, m_s - 1} \\
  \hat{S}^3 \ket{s, m_s} =& \hbar m\ket{s, m_s}
\end{split}
\tag{\label{equation-280}}
\end{equation*}
$$

Upon applying the operators $\hat{S}^j$ for $j = 1,2$ to the equations above, we obtain

$$
\begin{align*}
  \unitvec{S}^2 \ket{s, m_s} =& \hbar^2 s(s + 1) \ket{s, m_s} \\
  [\hat{S}^j, \hat{S}^k] \ket{s, m_s} =& i\hbar\varepsilon^{jkl} \hat{S}^k \ket{s, m_s}
\end{align*}
$$

which leads to

$$
\begin{align*}
  \hbar(m_s - m'_s) \braket{s', m'_s|s, m_s} =& 0 \\
  \hbar^2 [s(s + 1) - s'(s' + 1)]\braket{s', m'_s|s, m_s} =& 0
\end{align*}
$$

establishing the orthogonality of the eigenstates $\ket{s, m_s}$, i.e.

$$
  \braket{s', m'_s|s, m_s} = \delta_{s', s} \delta_{m'_s, m_s}
$$

With the normalization condition in $\eqref{equation-276}$, then $\psi(\mathbf{x}, m_s)$ denotes the wavefunction of a particle of spin $s$. In a matrix notation $\psi(\mathbf{x}) = (\psi(\mathbf{x}, s), \dots, \psi(\mathbf{x}, -s))^\top$, we have from $\eqref{equation-275}$, $\eqref{equation-267}$, $\eqref{equation-274}$ and $\eqref{equation-277}$, the transformation law in $\eqref{equation-}$ with the matrix elements of $\exp(i\varphi\unitsym{n}\cdot\unitvec{S}/\hbar)$ as directly obtained from $\eqref{equation-278}$ that

$$
\begin{equation*}
\begin{split}
  &\braket{s, m_s|e^{i\varphi\unitsym{n}\cdot\unitvec{S}}|s', m'_s} \\
  =& \delta_{ss'} \sum_q \frac{\sqrt{(s + m_s)!(s - m_s)!(s + m'_s)!(s - m'_s)!}}{(s + m_s - q)!(m'_s - m_s + q)!q'!(s - m'_s - q)!} \\
  &\times ([\mathbf{A}]^{11})^{s + m_s - q} ([\mathbf{A}]^{21})^{m'_s - m_s + q} ([\mathbf{A}]^{12})^q ([\mathbf{A}]^{22})^{s - m'_s - q}
\end{split}
\tag{\label{equation-279}}
\end{equation*}
$$

where the sum is over all non-negative $q$ such that the arguments of the factorials are non-negative integers.

For example, for $\unitsym{n} = (0, 1, 0)$ we have from $\eqref{equation-275}$ and $\eqref{equation-279}$

$$
\begin{align*}
  &\braket{s, m_s|e^{i\varphi\hat{S}^2 /\hbar}|s', m'_s} \\
  =& \delta_{ss'} \sum_q \frac{\sqrt{s + m_s}!(s - m_s)!(s + m'_s)!(s - m_s)!}{(s + m_s - q)!(m'_s - m_s + q)!q'!(s - m'_s - q)!} \\
  &\times (-1)^{m'_s - m_s + q} \cos\left(\frac{\varphi}{2} \right)^{2s - 2q + m_s -m'_s} \sin\left(\frac{\varphi}{2} \right)^{2q + m'_s - m_s}
\end{align*}
$$

For spin $s = 1/2$

$$
\begin{equation*}
  \psi^a (\mathbf{x}) = \sum_{m_s = -s}^s C^a \left(\frac{1}{2} + m_s \right) \psi(\mathbf{x}, m_s),\; a=1,2
\tag{\label{equation-281}}
\end{equation*}
$$

with $C^a (1) = \delta^{a1}$ and $C^a (0) = \delta^{a2}$. and the spin matrix is from $\eqref{equation-280}$

$$
\begin{equation*}
  \unitvec{S} = \frac{\hbar}{2} \boldsymbol{\sigma}
\tag{\label{equation-283}}
\end{equation*}
$$

From $\eqref{equation-281}$ the spinor can be written in the column matrix form

$$
  \psi(\mathbf{x}) = \left[\begin{smallmatrix} 1 \\ 0 \end{smallmatrix} \psi(\mathbf{x}, 1/2) + \left[\begin{smallmatrix} 0 \\ 1 \end{smallmatrix}\right] \psi(\mathbf{x}, -1/2)
$$

For spin $s = 1$,

$$
  \psi^{a_1 a_2} (\mathbf{x}) = \sum_{m=-1,0,1}^s C^{a_1 a_2} (1 + m_s) \psi(\mathbf{x}, m_s)
$$

and from $\eqref{equation-}$ or $\eqref{equation-}$

$$
\begin{align*}
  C^{a_1 a_2} (1 + 1) =& \delta^{a_1 1} \delta{a_2 1} \\
  C^{a_1 a_2} (1 + 0) =& \frac{1}{\sqrt{2}} (\delta^{a_1 1} \delta^{a_2 2} + \delta^{a_1 2} \delta^{a_2 1}) \\
  C^{a_a a_2} (1 - 1) =& \delta^{a_1 2} \delta^{a_2 2}
\end{align*}
$$

and the spin $\unitvec{S}$ has the components

$$
\begin{align*}
  \hat{S}^1 =& \frac{\hbar}{\sqrt{2}} \left[\begin{smallmatrix} 0 & 1 & 0 \\ 1 & 0 & 1 \\ 0 & 1 & 0 \end{smallmatrix}\right] \\
  \hat{S}^2 =& i\frac{\hbar}{\sqrt{2}} \left[\begin{smallmatrix} 0 & -1 & 0 \\ 1 & 0 & -1 \\ 0 & 1 & 0 \end{smallmatrix}\right]
  \hat{S}^3 =& \hbar \left[\begin{smallmatrix} 1 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & -1 \end{smallmatrix}\right]
\end{align*}
$$

#### Rotation of a spinor by $2\pi$ radians

With $\varphi = 2\pi$ in $\eqref{equation-268}$ we obtain

$$
  \exp\left(i\frac{2\pi}{2}\unitsym{n}\cdot\boldsymbol{\sigma} \right) = \mathbf{I} \cos(\pi) + i(\unitsym{n}\cdot\boldsymbol{\sigma}) \sin(\pi) = -\mathbf{I}
$$

Hence, $\eqref{equation-275}$ with $k = 2s$ leads to

$$
  {\psi'}^^{a_1 \dots a_{2s}} (\mathbf{x}) = (-1)^{2s} \psi^{a_1 \dots a_{2s}} (\mathbf{x})
$$

establishing the relative change which results under a $2\pi$ rotation for half integer $s$. Only through a rotation by integer multiples of $4\pi$ a $+1$ phase is obtained for half-odd integral spins. For the matrix element $\eqref{equation-}$ we also have

$$
  \braket{s, m_s|e^{i2\pi\unitsym{n}\cdot\unitvec{S}/\hbar}|s', m'_s} = (-1)^{2s} \delta_{ss'} \delta_{m_s m'_s}
$$

and hence also for the wavefunction

$$
  \psi'(\mathbf{x}, m_s) = (-1)^{2s} \psi(\mathbf{x}, m_s)
$$

#### Time reversal and parity transformation

We next consider the time reversal operation for arbitrary spins. Consider first the case for spin $1/2$. In a vector space generated by $2\times 2$ matrices, the most general expression for the time reversal operator $\hat{T}$ for spin $1/2$ is

$$
  \hat{T} = (\mathbf{I}_2 a + ib\unitsym{n}\cdot\boldsymbol{\sigma})\hat{K}
$$

expanded in terms of the complete set of $2\times 2$ matrices, $\set{\mathbf{I}_2, \boldsymbol{\sigma}}$ where $a, b\in\mathbb{C}$ are complex numbers, $\unitsym{n}\in\R^2$ is a unitvector and $\hat{K}$ is the complex conjugation operator to ensure, the anti-unitary nature of $\hat{T}$. The latter must satisfy the anti-commutation relation in $\eqref{equation-282}$ with spin operator $\unitvec{S}$ in $\eqref{equation-283}$. That is, we must have

$$
  (\mathbf{I}_2 a + ib\unitvec{n}\cdot\boldsymbol{\sigma})\sigma^{j*} + \sigma^j (\mathbf{I}_2 a + ib\unitsym{n}\cdot\boldsymbol{\sigma}) = 0,\; j=1,2,3
$$

which holds for $a = 0$ and $\unitsym{n} = (0,1,0)$, i.e.

$$
\begin{equation*}
  \hat{T} = ib \boldsymbol{\sigma}_2 \hat{K}
\tag{\label{equation-284}}
\end{equation*}
$$

The anti-unitary nature of $\hat{T}$ then implies that $|b|^2 = 1$, where we note the reality of the matrix $(i\boldsymbol{\sigma}_2)$. That is, up to an overall phase factor $b$, which we define for a basic spin $1/2$ state to be one, $\eqref{equation-284}$ gives

$$
  \hat{T} = (i\boldsymbol{\sigma}_2)\hat{K}
$$

For two successive time reversals, we obtain

$$
  \hat{T}^2 = -1
$$

A spinor then transforms as

$$
\begin{equation*}
  {\psi'}^a (\mathbf{x}) = \hat{K}[i\boldsymbol{\sigma}_2]^{ab}
\tag{\label{equation-285}}
\end{equation*}
$$

under time reversal. Using the identity

$$
\begin{equation*}
  [i\boldsymbol{\sigma}_2]^{ab} = \delta^{a1} \delta^{b2} - \delta^{a2} \delta^{b1}
\tag{\label{equation-286}}
\end{equation*}
$$

we obtain from $\eqref{equation-281}$, the following transformation law of a spin $1/2$ wavefunction

$$
\begin{align*}
  \psi(\mathbf{x}, 1/2) \mapsto& \psi^* (\mathbf{x}, -1/2) \\
  \psi(\mathbf{x}, -1/2) \mapsto& -\psi^* (\mathbf{x}, 1/2)
\end{align*}
$$

causing a spin flip.

For an arbitrary spin $s$, we define from $\eqref{equation-285}$, the following transformation law under time reversal

$$
\begin{equation*}
  {\psi'}^{a_1 \dots a_{2s}} (\mathbf{x}) = \hat{K} [i\boldsymbol{\sigma}_2]^{a_1 b_1} \cdots [i\boldsymbol{\sigma}_2]^{a_{2s} b_{2s}} \psi^{b_1 \dots b_{2s}} (\mathbf{x})
\tag{\label{equation-287}}
\end{equation*}
$$

where an overall complex conjugation operation is retained to ensure the anti-unitary nature of the time reversal operation.

To see how a wavefunction $\psi(\mathbf{x}, m_s)$ transforms under time reversal, it is easily proved from $\eqref{equation-271}$ and $\eqref{equation-286}$ that

$$
\begin{align*}
  &[i\boldsymbol{\sigma}_2]^{a_1 b_1} \cdots [i\boldsymbol{i}\boldsymbol{\sigma}_2]^{a_{2s} b_{2s}} C^{b_1 \dots b_{2s}} (s + m_s) \\
  =& (-1)^{s + m_s} C^{a_1 \dots a_{2s}} (s - m_s) \psi^* (\mathbf{x}, m_s)
\end{align*}
$$

Thus

$$
\begin{align*}
  {\psi'}^{a_1 \dots a_{2s}} (\mathbf{x}) =& \sum_{m_s = -s}^s (-1)^{s + m_s} C^{a_1 \dots a_{2s}} (s - m_s) \psi^* (\mathbf{x}, m_s) \\
  =& \sum_{m_s = -s}^s C^{a_1 \dots c_{2s}} (s + m_s) \psi' (\mathbf{x}, m_s)
\end{align*}
$$

where

$$
  \psi' (\mathbf{x}, m_s) = (-1)^{s - m_s} \psi^* (\mathbf{x}, -m)
$$

gving the transformation law $\psi(\mathbf{x}, m_s) \mapsto \psi' (\mathbf{x}, m_s)$. From $\eqref{equation-287}$ and $\eqref{equation-286}$ we have

$$
  \hat{T}^2 = (-1)^{2s} \hat{I}
$$

the parity operator is similarly treated, using now the commutation relation in $\eqref{equation-288}$ and we can infer that

$$
  {\psi'}^a (\mathbf{x}) = \xi\psi^a (-\mathbf{x})
$$

where $\xi$ is a phase factor, and a similar expression for a spinor of ranke $k$ then also follows.

An important consequene of time reversal as a symmetry operation arises from the following consideration. Upon mulitplying the Schödinger equation

$$
  i\hbar\frac{\partial}{\partial t} \ket{\psi} = \hat{H}\ket{\psi}
$$

from the left by $\hat{T}$, we can rewrite the resulting equation as

$$
\begin{equation*}
  -i\hbar\frac{\partial}{\partial t} (\hat{T}\ket{\psi}) = \hat{H}_T (\hat{T}\ket{\psi})
\tag{\label{equation-289}}
\end{equation*}
$$

where $\hat{H}_T = \hat{T}\hat{H}\hat{T}^{-1}$ and we have used the complex conjugation nature of $\hat{T}$ in $\eqref{equation-281}$ replacing $i$ by $-i$ in $\eqref{equation-289}$. For time reversal as a symmetry operation, $\eqref{equation-290}$ implies that

$$
  \hat{T}\hat{H}\hat{T}^{-1} = \hat{H}
$$

#### Kramers degeneracy

For time reversal as a symmetry operator for which $\hat{T}^2 = -1$ each eigenvalue of $\hat{H}$ is at least two-fold degenerate. This result easily follows by noting that

$$
  \hat{H}\ket{\psi} = E\ket{\psi}
$$

implies, from $\eqref{equation-}$, that $\hat{T}\ket{\psi}$ is an eigenstate of $\hat{H}$ with the same eigenvalue $E$. Asl ofrom the chain of equalities

$$
\begin{align*}
  \braket{\hat{T}\psi|\psi} =& \braket{\hat{T}\hat{T}\psi|\hat{T}\psi}^* \\
  =& -\braket{\psi|\hat{T}\psi}^* = -\braket{\hat{T}\psi|\psi}
\end{align*}
$$

we note that $\hat{T}\ket{\psi}$ and $\ket{\psi}$ are orthogonal and are independent eigenstates of $\hat{H}$. This type of degeneracy is referred to as Kramers degeneracy. For example, for the simple hydrogen atom, each energy level is at least two-fold degenerate due to the electron spin.

### Transformation rule of a spin of rank on under a coordinate rotation

We are interested in the transformation rule of spiner under a coordinate rotation. To introduce spinors with this in mind, we define for each point labelled by $\mathbf{x}\in\R^3$, a complex $2\times 2$ matrix

$$
\begin{equation*}
  \mathbf{X} := \mathbf{x}\cdot\boldsymbol{\sigma} = \begin{bmatrix} x^3 & x^1 - ix^2 \\ x^1 + ix^2 & -x^3 \end{bmatrix}
\tag{\label{equation-297}}
\end{equation*}
$$

where $\boldsymbol{\sigma}$ are the Pauli matrices. From the identity $\eqref{equation-}$, we can solve for $\mathbf{x}$ in terms of $\mathbf{X}$

$$
  \mathbf{x} = \frac{1}{2}\operatorname{tr}(\boldsymbol{\sigma} \mathbf{X})
$$

We consider the transformations $\mathbf{X} \mapsto \mathbf{X}'$ defined by 

$$
\begin{equation*}
  \mathbf{X}' = \mathbf{AXA}^\dagger = \mathbf{x}' \cdot\boldsymbol{\sigma}
\tag{\label{equation-291}}
\end{equation*}
$$

where $\mathbf{x}'$ is given by

$$
  {x'}^i = R^{ij} (\varphi,\unitsym{n}) x^j
$$

for all $2\times 2$ complex matrices $\mathbf{A}(\varphi, \unitsym{n})$, corresponding to coordinate rotations by angles $\set{\phi}$ about unit vectors $\set{\unitsym{n}}$. We note that $\det(\mathbf{X}) = -\mathbf{x}\cdot\mathbf{x}$ implying from $\eqref{equation-291}$ and the fact that $\mathbf{x}' \cdot\mathbf{x}' = \mathbf{x} \cdot\mathbf{x}$, the invariance property $\det(\mathbf{X}) = \det(\mathbf{X}')$ under a coordinate rotation, which also follows directly from the unitary condition of the matrices in $\eqref{equation-291}$. For a subsequent coordinate rotation

$$
  {x''}^i = R^{ij} (\varphi', \unitsym{n}') {x'}^j
$$

with

$$
\begin{equation*}
  \mathbf{X}'' =& \mathbf{A}' \mathbf{X}' {\mathbf{A}'}^\dagger \\
  =& (\mathbf{A}' \mathbf{A}) \mathbf{X} (\mathbf{A}' \mathbf{A})^\dagger =: \mathbf{x}'' \cdot\boldsymbol{\sigma}
\end{equation*}
$$

Since the product of unitary operators defines a unitary operator, the set of all such transformations in $\eqref{equation-291}$ forms a group. The most general structure of a $2\times 2$ complex matrix $\mathbf{A}$ is given by

$$
\begin{equation*}
  \mathbf{A} = \mathbf{I}_2 a + i\mathbf{b} \cdot\boldsymbol{\sigma}
\tag{\label{equation-292}}
\end{equation*}
$$

giving

$$
  \mathbf{A}^\dagger \mathbf{A} = |a|^2 + \mathbf{b}\cdot\mathbf{b}^* + i(b^{*i} b^j \varepsilon^{ijk} - b^{*k} a + a^* b^k) \boldsymbol{\sigma}_k
$$

Unitarity then implies that

$$
\begin{align*}
  |a|^2 + \mathbf{b}\cdot\mathbf{b}^* =& 1 \tag{\label{equation-293} \\
  b^{*i} b^j \varepsilon^{ijk} - b^{*k} a + a^* b^k =& 0
\end{align*}
$$

On the other hand, $\eqref{equation-291}$ and $\eqref{equation-292}$ lead to the equality

$$
\begin{align*}
  &(|a|^2 - \mathbf{b}\cdot\mathbf{b}^*)\boldsymbol{\sigma}_j + (b^{j*} \mathbf{b}\cdot\boldsymbol{\sigma} + b^j \mathbf{b}^* \cdot\boldsymbol{\sigma}) - (ab^{*i} + a^* b^i)\varepsilon^{ijk} \boldsymbol{\sigma}_k \\
  =& \cos(\varphi)\boldsymbol{\sigma}_j + n^j \unitsym{n}\cdot\boldsymbol{\sigma} (1 - \cos(\varphi)) - n^i \sin(\varphi) \varepsilon^{ijk} \boldsymbol{\sigma}_k
\end{align*}
$$

where we made use of $\eqref{equation-}$. Multiplying by $\boldsymbol{\sigma}_j$, we obtain

$$
\begin{align*}
  3|a|^2 - \mathbf{b}\cdot\mathbf{b}^* =& 2\cos(\varphi) + 1 \tag{\label{equation-294}} \\
  a\mathbf{b}^* \cdot\boldsymbol{\sigma} + a^* \mathbf{b}\cdot\boldsymbol{\sigma} =& \unitsym{n}\cdot\boldsymbol{\sigma} \sin(\varphi)
\end{align*}
$$

Equations $\eqref{equation-293}$ and $\eqref{equation-271}$ then imply that

$$
\begin{align*}
  a =& e^{i\delta} \cos(\varphi/2) \tag{\label{equation-295}} \\
  b^j =& e^{i\delta_j} n^j \sin(\varphi/2) \tag{\label{equation-296}}
\end{align*}
$$

where $\delta$, $\delta_j \in\R$ are real. On the other hand, $\eqref{equation-294}$ is equivalent to the conditions

$$
  ab^{*j} + a^* b^j = n^j \sin(\varphi)
$$

which from $\eqref{equation-295}$ and $\eqref{equation-296}$ imply that $\cos(\delta - \delta_j) = 1$ for $j=1,2,3$ and hence that

$$
  b^j = e^{i\delta} b^j \sin(\varphi/2)
$$

Accordingly, a rotation by an angle $\varphi$ about a unit vector $\unitsym{n}$ induces the transformation $\mathbf{X}\mapsto\mathbf{X}'$ where $\mathbf{X}$ and $\mathbf{X}'$ are, respectively, defined in $\eqref{equation-291}$ and $\erqef{equation-297}$, with the matrix $\mathbf{A}$, up to an overall phase factor which by convention we set equal to one, is given by

$$
\begin{equation*}
  \mathbf{A} = \mathbf{I} \cos(\varphi/2) + i\unitsym{n}\cdot\boldsymbol{\sigma} \sin(\varphi/2)
\tag{\label{equation-298}}
\end{equation*}
$$

It is readily checked that $\det(\mathbf{A}) = 1$. Conversely, it is easily show that the set of all transformations $\mathbf{X}\mapsto\mathbf{X}'$ with $\mathbf{X}' = \mathbf{BXB}^\dagger$ for any $2\times 2$ complex unitary matrices $\mathbf{B}$ of determinant one each one induces a coordinate rotation. With $\mathbf{B}$ having the general structure as give on the right-hand side of $\eqref{equation-292}$, then $\det(\mathbf{B}) = 1$ implies that

$$
  a^2 + \mathbf{b}\cdot\mathbf{b} = 1
$$

This together with the unitarity condition in $\eqref{equation-293}$ imply that $a$ and $\mathbf{b}$ are real and can be parametrized as in $\eqref{equation-295}$ and $\eqref{equation-296}$ with $e^{i\delta} := 1$. Equation $\eqref{equation-294}$ is the automatically satisfied. The matrices $\mathbf{A}$ in $\eqref{equation-298}$ operate on two-dimensional objects

$$
  \psi = \begin{bmatrix} \psi^1 \\ \psi^2 \end{bmatrix}
$$

referred to as spinors of rank $1$, guaranteeing the invariance property of the inner product

$$
  \sum{a=1,2} {\psi'}^{*a} {\psi'}^a = \sum_{a=1,2} \psi^{*a} \psi^a
$$

under a coordinate rotation, where

$$
  {\psi'}^a = [\mathbf{A}]^{ab} \psi^b
$$

This equation provides the rule of transformation of a spinor of rank $1$ under a coordinate rotation by an angle $\varphi$ about a unit vector $\unitsym{n}$. The equivalent exponential form $\mathbf{A}$ is given by

$$
  \mathbf{A} = \exp\left(i\frac{\varphi}{2}\unitsym{n}\cdot\boldsymbol{\sigma}\right)
$$

# Time evolution

## Schrödinger equation

The time evolution of a state vector $\ket{\psi}$ is given by the Schrödinger equation

$$
\begin{equation*}
  i\hbar \frac{\partial}{\partial t}\ket{\psi} = \hat{H} \ket{\psi} 
\tag{\label{equation-98}}
\end{equation*}
$$

If $\ket{\psi}$ can be expanded in a continuous eigenbasis $\ket{q}$ as

$$
  \ket{\psi} = \int \psi(q,t)\ket{q} \;\d q, \; \psi(q,t) = \braket{q|\psi}
$$

then taking the scalar product of both sides of the Schrödinger equation with $\ket{q}$ gives

$$
\begin{align*}
  \Braket{q|i\hbar \frac{\partial}{\partial t}|\psi(t)} =& \braket{q|\hat{H}|\psi} \\
  i\hbar \frac{\partial}{\partial t} \psi(q, t) =& \braket{q|\hat{H}|\psi}
\end{align*}
$$

If $\hat{H}$ has eigenstates $\ket{q}$, then

$$
  \braket{q|\hat{H}|\psi} = \hat{H}\psi(q,t)
$$

This leads to the Schrödinger equation for the wavefunction $\psi(q,t)$ in the eigenbasis of $\hat{q}$:

$$
  i\hbar \frac{\partial}{\partial t} \psi(q, t) = \hat{H} \psi(q, t)
$$

### Derivation of the Schödinger equation

In general, an evolution equation must conform to the fundamental principles of quantum mechanics. We begin by assuming that the evolution of the state vector is deterministic. This implies that the state at a given time $t_0$ is sufficient to determine the state at any later time. 

Next, we note that the evolution equation can only contain the first time derivative of the state vector. If it were of higher order, the solution would require knowledge of the higher time derivatives of the state at $t_0$, violating the requirement that the state vector encodes all the information about the quantum system.

The superposition principle tells that any linear combination of states must also be a solution to the evolution equation. Consequently, the equation must be linear and homogenous. The most general form of such an equation is

$$
  \frac{\partial}{\partial t} \ket{\psi} = \hat{Q}\ket{\psi}
$$

where $\hat{Q}$ is a linear operator to be determined.

The equation implies that $\hat{Q}$ must correspond to the generator of time translations, or equivalently, to a quantity conserved under time translations. We know from classical mechanics that the generator of time translations is the energy of the system, represented by the Hamiltonian. By the correspondence principle, we deduce that the operator $\hat{Q}$ is a function of the Hamiltonian operator $\hat{H}$:

$$
  \frac{\partial}{\partial t} \ket{\psi} = f(\hat{H})\ket{\psi}
$$

Next, we consider a composite system made of two subsystems with Hamiltonians $\hat{H}_1$ and $\hat{H}_2$, respectively. Since total Hamiltonian is $\hat{H} = \hat{H}_1 + \hat{H}_2$, we require that $f$ must be linear, i.e.

$$
  f(\hat{H}_1 + \hat{H}_2) = f(\hat{H}_1) + f(\hat{H}_2) 
$$

The only form that satisfies this in the most general case is

$$
  f(\hat{H}) = a\hat{H}
$$

where $a \in\mathbb{C}$ is a complex constant with dimension of inverse action. To determine $a$, we use the fact that the normalization condition $\braket{\psi|\psi} = 1$ is preserved during time evolution. Thus, the time derivative of $\braket{\psi|\psi}$ must vanish:

$$
\begin{equation*}
  \frac{\partial}{\partial t} \braket{\psi|\psi} = \frac{\partial\bra{\psi}}{\partial t} \ket{\psi} + \bra{\psi} \frac{\partial\ket{\psi}}{\partial t} = 0 
\tag{\label{equation-80}}
\end{equation*}
$$

Taking the Hermitian adjoint of $\frac{\partial}{\partial t}\ket{\psi} = a\hat{H}\ket{\psi}$ and noting that $\hat{H}$ is Hermitian, we find

$$
  \frac{\partial}{\partial t} \bra{\psi} = \bra{\psi} a^* \hat{H}
$$

Substuting this into $\eqref{equation-80}$, we obtain

$$
  \Braket{\psi|(a^* \hat{H} + a\hat{H})|\psi} = 0
$$

For this to hold for any $\ket{\psi}$, we require $a^* = -a$, meaning that $a$ is purely imaginary. Since $a$ has the dimension of inverse action, it must be proportional to $\hbar$. If we choose $1/a = i\hbar$, we retrieve the Schrödinger equation:

$$
  i\hbar \frac{\partial}{\partial t}\ket{\psi} = \hat{H} \ket{\psi}
$$

### Time symmetry

The Schrödinger equation is invariant under time reversal transformations $t \mapsto -t$, provided we also exchange kets with bras, i.e. $\ket{\psi} \to \bra{\psi}$. Taking the Hermitian conjugate of the Schrödinger equation $\eqref{equation-98}$ yields

$$
  -i\hbar\frac{\partial}{\partial t} \bra{\psi} = \bra{\psi}\hat{H}
$$

or equivalently

$$
  i\hbar\frac{\partial}{\partial(-t)} \bra{\psi} = \bra{\psi}\hat{H}
$$

### Preservation of probability

The Schrödinger equation preserves the Born rule if $\hat{H}$ is Hermitian. To prove this, note that probility is conserved, if the norm of $\ket{\psi}$ remains constant over time

$$
  \frac{\d}{\d t} \braket{\psi(t)|\psi(t)} = 0
$$

Applying the product rule to the left-hand side gives

$$
  \frac{\d}{\d t} \braket{\psi|\psi} = \frac{\d}{\d t}(\bra{\psi})\ket{\psi} + \ket{\psi} \frac{\d}{\d t}(\ket{\psi})
$$

Taking the Hermitian adjoint of the equation yields

$$
  -i\hbar\frac{\d}{\d t}\bra{\psi(t)} = \bra{\psi(t)}\hat{H}^\dagger 
$$

Substituting the Schrödinger equation and its conjugate gives

$$
\begin{align*}
  \frac{\d}{\d t} \braket{\psi|\psi} =& \left(-\frac{i}{\hbar}\bra{\psi}\hat{H}^\dagger \right)\ket{\psi} + \bra{\psi}\left(\frac{i}{\hbar}\hat{H}\ket{\psi} \right) \\
  =& \frac{i}{\hbar}\left(\braket{\psi|\hat{H}|\psi} - \braket{\psi|\hat{H}^\dagger|\psi} \right) = 0
\end{align*}
$$

This expression vanishes if and only if $\braket{\psi|\hat{H}|\psi} = \braket{\psi|\hat{H}^\dagger|\psi}$. Since this must hold for any arbitrary state $\ket{\psi(t)}$, it follows that $\hat{H} = \hat{H}^\dagger$.

### Stationary states

If the Hamiltonian operator has a time-independent potential, the solution to the Schrödinger equation is obtained by integrating $\eqref{equation-98}$, giving

$$
  \ket{\psi(t)} = e^{-i\hat{H}t/\hbar} \ket{\psi(0)}
$$

where $\ket{\psi(0)}$ is the state vector at time $t_0 = 0$. If the initial state vector is an eigenstate of the Hamiltonian, i.e.

$$
  \hat{H} \ket{\psi(0)} = E\ket{\psi(0)}
$$

where $E$ is the corresponding eigenvalue of $\hat{H}$, then the action of the operator $e^{i\hat{H}t/\hbar}$ on the state vector $\ket{\psi(0)}$ becomes trivial. In this case, the state vector at time $t$ is simply

$$
  \ket{\psi(t)} = e^{-iEt/\hbar} \ket{\psi(0)}
$$

Consequently, an energy eigenstate does not evolve with time since the phase factor $e^{-iEt/\hbar}$ is irrelevant for the physical state. In order to find a time-evolved state vector $\ket{\psi(t)}$, we first need to solve the eigenvalue equation for the Hamiltonian, called the time-independent Schrödinger equation. In the case of a discrete spectrum, this reads

$$
  \hat{H}\ket{\psi_n} = E_n \ket{\psi_n}
$$

where $\ket{\psi_n}$ are the stationary states and $E_n$ are the corresponding eigenvalues, representing the energy levels of the system. Next, we expand the intial state vector $\ket{\psi(0)}$ in terms of the basis $\set{\ket{\psi_n}}$ by determining the complex coefficients $c_n^(0)$ such that

$$
  \ket{\psi(0)} = \sum_n c_n^{(0)} \ket{\psi_n}
$$

The time-evolved state is the given by

$$
  \ket{\psi(t)} = \sum_n e^{-iE_nt/\hbar} c_n^{(0)} \ket{\psi_n}
$$

For a continuous spectrum, the eigenvalue equation becomes

$$
  \hat{H}\ket{\psi_E} = E\ket{\psi_E}
$$

and the expansion of $\ket{\psi(0)}$ onto the continuous basis $\ket{\psi_E}$ is 

$$
  \ket{\psi(0)} = \int c^{(0)} (E) \ket{\psi_E} \;\d E
$$

The time-evolved state is then

$$
  \ket{\psi(t)} = \int e^{-iEt/\hbar} c^{(0)} (E) \ket{\psi_E} \;\d E
$$

Taking the expectation value of $\hat{H}$ with respect to an initial eigenstate $\ket{\psi(0)}$, we get

$$
\begin{align*}
  \braket{\hat{H}}_\psi =& \braket{\psi|\hat{H}|\psi} = E\underbrace{\braket{\psi|\psi}}_{=1} = E
\end{align*}
$$

Since

$$
  \hat{H}^2 \ket{\psi} = \hat{H}(\hat{H}\ket{\psi}) = \hat{H}(E\ket{\psi}) = E(\hat{H}\ket{\psi}) = E^2 \ket{\psi}
$$

it follows that $\braket{\hat{H}^2} = E^2$. Thus, the variance of $H$ is

$$
  \sigma_H^2 = \braket{H^2} - \braket{H}^2 = E^2 - E^2 = 0
$$

showing that the total energy is a determinate state.

#### Wavefunction formulation

In terms of a wavefunction $\psi(x,t)$, the Schrödinger equation for a time-independent potential can be solved by separation of variables. Assuming a wavefunction of the form $\Psi(\mathbf{x},t) = \psi(\mathbf{x})\phi(t)$ with partial derivatives

$$
  \frac{\partial\Psi}{\partial t} = \psi \frac{\d\phi}{\d t}, \quad \nabla^2 \Psi = (\nabla^2 \psi) \phi
$$

the Schrödinger equation reads

$$
\begin{align*}
  i\hbar \psi \frac{\d\phi}{\partial t} =& -\frac{\hbar^2}{2m} (\nabla^2 \psi)\phi + V\psi\phi \\
  i\hbar \frac{1}{\phi} \frac{\d\phi}{\d t} =& -\frac{\hbar^2}{2m} \frac{1}{\psi} \nabla^2 \psi + V
\end{align*}
$$

The equation holds if both sides equal a separation constant, which in this case corresponds with the systems total energy $E$. This results in the temporal equation

$$
  \frac{\d\phi}{\d t} = -\frac{iE}{\hbar} \phi
$$

and the spatial equation

$$
\begin{align*}
  -\frac{\hbar^2}{2m} \nabla^2 \psi + V\psi =& E\psi \\
  \hat{H}\psi =& E\psi 
\end{align*}
$$

which is called the time-independent Schrödinger equation. The temporal equation has general solution

$$
  \phi(t) = C e^{-iEt/\hbar}
$$

Absorbing the normalization constant $C$ into $\psi$, the wavefunction becomes

$$
  \Psi(\mathbf{x}, t) = \psi(\mathbf{x}) e^{-iEt/\hbar}
$$

Although $\Psi$ depends on $t$, the probability density

$$
  |\Psi(\mathbf{x},t)|^2 = \Psi^* \Psi = \psi^* e^{iEt/\hbar} \psi e^{-iEt/\hbar} = |\psi(x)|^2
$$

is time-independent.

### Degenerate eigenvalues

Energy eigenstate can be degenerate, in which case two or more eigenstates share the same eigenvalue. A neccessary and sufficient condition for energy degeneracy is that an observable $\hat{Q}$ commutes with the Hamiltonian, and is not the identity operator. Specifically, if

$$
  [\hat{H}, \hat{Q}] = 0
$$

and $\hat{Q}$ is not a function of $\hat{H}$ alone, then

$$
  \hat{H}\hat{Q} \ket{\psi_j} = \hat{Q}\hat{H}\ket{\psi_j} = E_j \hat{Q} \ket{\psi_j}
$$

which shows that $\hat{Q}\ket{\psi_j}$ is an eigenvector of $\hat{H}$ with eigenvalue $E_j$. Moreover, $\hat{Q}\ket{\psi_j}$ cannot be proportional to $\ket{\psi_j}$. In other words, it cannot be written as $\hat{Q}\ket{\psi_j} = f(E_j) \ket{\psi_j}$, where $f(E_j)$ is a function of the $j$-th energy eigenvalue. If this were the case, $\hat{Q}$ would be equal to $f(\hat{H})$, which contradicts the assumptions that $\hat{Q}$ is not a function of $\hat{H}$.

Let us prove that degeneracy implies commutativity in the case of a discrete spectrum. If degeneracy exists, the whole Hilbert space $\mathcal{H}$ can always be partitioned into subspaces $\mathcal{H}_k$ for $k\in\N_+$, each of which is associated with a constant energy eigenvalue $E_k$. In this case, we can write

$$
  \mathcal{H} = \bigoplus_k \mathcal{H}_k
$$

For any $\ket{\varphi}\in\mathcal{H}_k$, we have

$$
  \hat{H}\ket{\varphi} = E_k \ket{\varphi}
$$

Thus, within each subspace $\mathcal{H}_k$, the Hamiltonian $\hat{H}_k$ acts as multiple of the identity, i.e. $\hat{H}_k = E_k \hat{I}$. The dimension of $\mathcal{H}_k$ is equal to the degeneracy of the eigenvalue $E_k$. Next, we can define a Hermitian operator $\hat{Q}$

$$
  \hat{Q} = \bigotimes_n \hat{Q}_n
$$

where $\hat{Q}_k$ is an arbitrary operator acting within $\mathcal{H}_k$. Furthermore, since $\hat{H}_k = E_k \hat{I}$, it follows that $[\hat{Q}_k, \hat{H}_k] = 0$. This implies that $\hat{Q}$ commutes with $\hat{H}$, i.e. $[\hat{Q},\hat{H}] = 0$.

## Time evolution operator

A time evolution operator $\hat{U}$ translates a state vector $\ket{\psi(t)}$ from time $t_a$ to $t_b$ by

$$
  \hat{U}(t_b,t_a)\ket{\psi(t_a)} = \ket{\psi(t_b)}
$$

with the initial condition $\hat{U}(t_a, t_a) = \hat{I}$.

If the Hamiltonian is time-independent, the time evolution operator is obtainable from the Schrödinger equation

$$
  i\hbar\frac{\partial}{\partial t_b}(\hat{U}(t_b,t_a)\ket{\psi(t_a)}) = \hat{H}\hat{U}(t_b,t_a)\ket{\psi(t_a)} 
$$

Since $\ket{\psi(t_a)}$ is indepedent of $t_b$, we can factor it out from the partial time derivative

$$
  i\hbar\frac{\partial\hat{U}(t_b,t_a)}{\partial t_b}\ket{\psi(t_a)} = \hat{H}\hat{U}(t_b,t_a)\ket{\psi(t_a)} 
$$

This equation must hold for any initial state $\ket{\psi(t_a)}$ giving a first-order differential equation for $\hat{U}(t_b,t_a)$

$$
  i\hbar\frac{\partial\hat{U}(t_b,t_a)}{\partial t_b} = \hat{H}\hat{U}(t_b,t_a)
$$

with solution

$$
  \hat{U}(t_b,t_a) = e^{i\hat{H}(t_a - t_b)/\hbar}
$$

Its inverse is obtained by interchanging the order of $t_a$ and $t_b$

$$
  \hat{U}^{-1}(t_b,t_a) = e^{-i\hat{H}(t_a - t_b)/\hbar}
$$

Since $\hat{H}$ is Hermitian, $\hat{U}$ is unitary because

$$
\begin{equation*}
\begin{split}
  \hat{U}^\dagger (t_b,t_a) =& e^{i(t_b - t_a)\hat{H}^\dagger /\hbar} \\
  =& e^{i(t_b - t_a)\hat{H} /\hbar} \\
  =& \hat{U}^{-1}(t_b,t_a)
\end{split}
\tag{\label{equation-6}}
\end{equation*}
$$

If the Hamiltonian depends explicitly on time, the time evolution operator can be found iteratively. The time interval $[t_a, t_b]$ with $t_a < t_b$ is partitioned into $N + 1$ subintervals of length $\epsilon = (t_b - t_a)/(N + 1)$, such that $t_n = t_a + n\epsilon$ for $n=0,\dots,N+1$. Schrödinger's equation approximates the time evolution at each step $\epsilon$

$$
\begin{align*}
  \ket{\psi(t_a + \epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + \epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a)} \\
  \ket{\psi(t_a + 2\epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + 2\epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a + \epsilon)} \\
  \vdots& \\
  \ket{\psi(t_a + (N+1)\epsilon)} \approx& \left(1 - \frac{i}{\hbar} \int_{t_a}^{t_a + (N+1)\epsilon} \hat{H}(t)\;\d t \right)\ket{\psi(t_a + N\epsilon)} 
\end{align*}
$$

Combining the equations, the time evolution operator is approximated as

$$
  \hat{U}(t_b, t_a) \approx \prod_{n=0}^{N} \left(\int_{t_n}^{t_{n+1}} \hat{H}(t'_{n+1})\;\d t'_{n+1} \right)
$$

Expanding the product and taking the limit $N\to\infty$ gives the series

$$
\begin{align*}
  \hat{U}(t_b, t_a) =& \hat{I} - \frac{1}{\hbar} \int_{t_a}^{t_b} \d t'_1 \;\hat{H}(t'_1) \\
  &+ \left(\frac{-i}{\hbar}\right) \int_{t_a}^{t_b} \d t'_n \int_{t_a}^{t_n} \d t'_{n-1} \cdots \int_{t_a}^{t'_2} \d t'_1 \;\hat{H}(t'_n)\hat{H}(t'_{n-1})\cdots\hat{H}(t'_1)
\end{align*}
$$

known as the *Neumann-Liouville expansion* or *Dyson series*. Note that each integral has the time arguments in the Hamilton operators ordered causally since the operators are ordered descending in time. It is useful to introduce a time-ordering operator $\hat{T}_+$, which when applied to an arbitrary product of operators

$$
  \hat{O}_n (t_n) \cdots\hat{O}_1 (t_1)
$$

reorders the times successively, i.e.

$$
  \hat{T}_+ (\hat{O}_n (t_n)c\dots\hat{O}_1 (t_1)) := \hat{O}_{i_n} (t_{i_n})\cdots\hat{O}_{i_1} (t_{i_1})
$$

where $\set{t_{i_n},\dots,t_{i_1}}$ is a permutation of $\set{t_n,\dots,t_1}$ relabeled in the causal order, so that

$$
  t_{i_n} \geq t_{i_{n-1}} \geq\cdots\geq t_{i_1}
$$

With this operator, the Neumann-Liouville expansion can be written more compactly. Consider the third term of the series

$$
\begin{equation*}
  \int_{t_a}^{t_b} \d t_2 \int_{t_a}^{t_2} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1)
\tag{\label{equation-1}}
\end{equation*}
$$

The integration covers the triangle above the diagonal in the square $t_1, t_2 \in [t_a, t_b]$ in the $(t_1, t_2)$-plane. Comparing this the with the remaining integral over the lower triangle

$$
\begin{equation*}
  \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1)
\tag{\label{equation-2}}
\end{equation*}
$$

we see that the two expressions coincide except for the order of the operators. Applying the time-ordering operator to $\eqref{equation-2}$, gives

$$
  \hat{T}_+ \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1)
$$

which is equal to $\eqref{equation-1}$ because $\eqref{equation-2}$ can be rewritten as

$$
\begin{equation*}
  \int_{t_a}^{t_b} \d t_2 \int_{t_2}^{t_b} \d t_1 \; \hat{H}(t_1)\hat{H}(t_2) = \int_{t_a}^{t_b} \d t_1 \int_{t_a}^{t_1} \d t_2 \; \hat{H}(t_1)\hat{H}(t_2) 
\tag{\label{equation-3}}
\end{equation*}
$$

where the order of integration is changed in the last step. Apart from the dummy integration variables $t_2 \leftrightarrow t_1$, the double integral $\eqref{equation-3}$ coincides with $\eqref{equation-1}$. Since the time arguments are properly ordered, the time-ordering operator can be applied to $\eqref{equation-1}$ to give

$$
  \frac{1}{2}\hat{T}_+ \int_{t_a}^{t_b} \d t_2 \int_{t_a}^{t_b} \d t_1 \; \hat{H}(t_2)\hat{H}(t_1) = \frac{1}{2}\hat{T}_+ \left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^2
$$

Similarly, we may rewrite the $n$-th order term of the Neumann-Liouville expansion as

$$
\begin{align*}
  &\frac{1}{n!} \hat{T}_+ \int_{t_a}^{t_b} \d t_n \int_{t_a}^{t_b} \d t_{n-1} \cdots \int_{t_a}^{t_b} \d t_1 \; \hat{H}(t_n)\hat{H}(t_{n-1})\cdots\hat{H}(t_1) \\
  =& \frac{1}{n!} \hat{T}_+ \left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^n 
\end{align*}
$$

The time evolution operator $\hat{U}(t_b, t_a)$ has therefore the series expansion

$$
\begin{align*}
  \hat{U}(t_b, t_a) = \sum_{n=0}^\infty \frac{1}{n!}\left(\frac{-i}{\hbar}\right)^n \hat{T}_+ \left(\int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)^n
\end{align*}
$$

which we recognize as the power series expansion of the exponential, giving

$$
\begin{equation*}
  \hat{U}(t_b, t_a) = \hat{T}_+ \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)
\tag{\label{equation-5}}
\end{equation*}
$$

Note that a small variation $\delta\hat{H}(t)$ of $\hat{H}(t)$ changes $\hat{U}(t_b, t_a)$ by

$$
\begin{align*}
  \delta\hat{U}(t_b, t_a) =& -\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{T}_+ \exp\left(-\frac{i}{h} \int_{t'}^{t_b} \hat{H}(t)\; \d t \right) \delta\hat{H}(t') \hat{T}_+ \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t'} \hat{H}(t)\;\d t \right)\; \d t'\\
  =& -\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{U}(t_b, t') \delta\hat{H} (t') \hat{U}(t', t_a)\; \d t'
\end{align*}
$$

### Properties of the time evolution operator

#### Fundamental composition law

If two time translation are performed successively, the corresponding operators $\hat{U}$ are related by

$$
\begin{equation*}
  \hat{U}(t_c, t_a) = \hat{U}(t_c, t_b)\hat{U}(t_b, t_a),\; t_b \in(t_a, t_c)
\tag{\label{equation-4}}
\end{equation*}
$$

This composition law makes the operators $\hat{U}$ a representation of the Abelian group of time translations. For time-independent Hamiltonians the composition law $\eqref{equation-4}$ is trivial. In the general case with $\hat{U}(t_b, t_a)$ given by $\eqref{equation-5}$, the composition law follows from the additivity rule of the exponential

$$
\begin{align*}
  &\hat{T}_+ \exp\left(-\frac{i}{\hbar} \int_{t'}^{t_b} \hat{H}(t)\;\d t \right)\hat{T}_+ \exp\left(\int_{t_a}^{t'} \hat{H} (t) \;\d t \right) \\
  =& \hat{T}_+ \left[\exp\left(-\frac{i}{\hbar} \int_{t'}^{t_b} \hat{H}(t)\;\d t \right) \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t'} \hat{H}(t)\;\d t \right) \right] \\
  =& \hat{T}_+ \exp\left(-\frac{i}{\hbar} \left[ \int_{t'}^{t_b} \hat{H}(t)\;\d t + \int_{t_a}^{t'} \hat{H}(t)\;\d t \right]\right) \\
  =& \hat{T}_t \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t)\;\d t \right)
\end{align*}
$$

#### Unitarity (time reversal)

The inverse of the time evolution operator $\hat{U}(t_b, t_a)$ is obtained by interchanging the order of $t_a$ and $t_b$, which gives its anticasual form, i.e.

$$
  \hat{U}(t_b, t_a) = \hat{U}(t_a, t_b)^{-1}
$$

<details>
<summary>Proof</summary>

The time-reversal invertibility of $\hat{U}(t_b, t_a)$ follows by setting $t_b = t_a$ in $\eqref{equation-4}$ resulting in

$$
  \hat{I} = \hat{U}(t_a, t_a) = \hat{U}(t_a, t_b) \hat{U}(t_b, t_a)
$$

so that

$$
  \hat{U}(t_b, t_a)^{-1} = \hat{U}(t_a, t_b)
$$
</details>

This implies that $\hat{U}$ is unitary. The unitarity was already established for time-independent Hamiltonians in $\eqref{equation-6}$. In the general case, a direct solution of the Schrödinger equation shows that the operator $\hat{U}(t_b, t_a)$ for $t_b < t_a$ has a representation just like $\eqref{equation-5}$, except for a reversed time order of its argument, written as

$$
  \hat{U}(t_b, t_a) = \hat{\bar{T}} \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}(t) \;\d t \right)
$$

where $\hat{T}_-$ denotes the time-antiordering operator, which is the adjoint of $\hat{T}_+$

$$
  \left[\hat{T}_+ \left(\hat{O}_1 (t_1)\cdots \hat{O}_n (t_n) \right) \right]^\dagger = \hat{T}_- \left(\hat{O}_n^\dagger (t_n)\cdots \hat{O}_1^\dagger (t_1) \right)
$$

The adjoint of $\hat{U}$ then becomes

$$
\begin{align*}
  \hat{U}^\dagger (t_b, t_a) =& \left[\hat{T}_+ \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H} (t) \;\d t \right)\right]^\dagger \\
  =& \hat{T}_- \exp\left(\frac{i}{\hbar} \int_{t_a}^{t_b} \hat{H}^\dagger (t) \;\d t \right) \\
  =& \hat{T}_+ \exp\left(-\frac{i}{\hbar} \int_{t_b}^{t_a} \hat{H} (t) \;\d t \right) \\
  =& \hat{U}(t_a, t_b) = \hat{U}^{-1} (t_b, t_a)
\end{align*}
$$

#### Transition amplitudes

The transition amplitude between an initial state $\ket{\phi}$ at time $t_a$ and a final state $\ket{\psi}$ at time $t_b$ is given by $\braket{\psi|\hat{U}(t_b, t_a)|\phi}$. Taking the complex congujate of the expectation value we obtain

$$
  \left(\braket{\psi|\hat{U}(t_b, t_a)|\phi}\right)^* = \braket{\phi|\hat{U}(t_a, t_b)|\psi}
$$

which represents the probability amplitude for evolving $\ket{\psi}$ backward from $t_b$ to $t_a$. In this context, kets may viewed as input states and bras as output states of a unitary evolution. 

In particular, the amplitude $\braket{\psi|\hat{U}(t_b, t_a)|\psi}$ is the autocorrelation amplitude, giving the overlap of the evolved state with the initial state. Its squared modulus

$$
  C(t_b, t_a) = |\braket{\psi|\hat{U}(t_b, t_a)|\psi}|^2
$$

is the autocorrelation function, which measures the probability that the state $\ket{\psi}$ remains unchanged under time evolution.

#### Time evolution for $\hat{U}(t_b, t_a)$

Since the time-evolution operator $\hat{U}(t_b, t_a)$ gives the relation between arbitrary wavefunctions at different times

$$
  \ket{\psi(t_b)} = \hat{U}(t_b, t_a) \ket{\psi(t_a)}
$$

the Schrödinger equation implies that the operator $\hat{U}(t_a, t_b)$ satisfies

$$
\begin{equation*}
\begin{split}
  i\hbar\frac{\partial}{\partial t} \hat{U}(t, t_a) =& \hat{H}\hat{U}(t, t_a) \\
  i\hbar\frac{\partial}{\partial t} \hat{U}^{-1} (t, t_a) =& -\hat{U}(t, t_a)^{-1} \hat{H}
\end{split}
\tag{\label{equation-8}}
\end{equation*}
$$

with the initial condition $\hat{U}(t_a, t_a) = 1$.

### Green's function

If the Hamiltonian admits a discrete spectrum, the elements of the time-evolution matrix can be written as

$$
  \Braket{k|e^{-i\hat{H}(t - t_0)/\hbar}|j} = i G(j, t_0; k, t)
$$

here $\ket{j}$ and $\ket{k}$ are state vectors, and $G$ denotes the Green's function. 

For a wavefunction in position space, we can derive an analogous expression by multiplying the time-independent Schrödinger equation

$$
  \ket{\psi(t')} = e^{-i\hat{H}(t' - t)/\hbar}\ket{\psi(t)}
$$

with the position bra $\bra{\mathbf{r}'}$ and use the completeness relation $\hat{I} = \int \ket{\mathbf{r}}\bra{\mathbf{r}} \;\d\mathbf{r}$. This gives

$$
  \psi(\mathbf{r}',t) = i\int G(\mathbf{r}', t'; \mathbf{r}, t) \psi(\mathbf{r}, t) \;\d\mathbf{r}
$$

This equation reflects an instance of Huygens' principle: if the wwave function $\psi(\mathbf{r},t)$ is known at a time $t$, it can be determined at any later time $t'$ by considering each point $\mathbf{r}$ at time $t$ is a source of waves propagating outward. The amplitude of the wave arriving at point $\mathbf{r}'$ at time $t'$ from the point $\mathbf{r}$ is proportional to the original wave amplitude $\psi(\mathbf{r},t)$, with proportionality constant given by $iG(\mathbf{r}', t'; \mathbf{r}, t)$.

Green's functions are related to the resolvent of the Hamiltonian as the latter is the Fourier transform of the relative unitary operator, i.e.

$$
  \hat{R}_{\hat{H}}(\eta) = i \int_0^\infty e^{-\eta\tau} e^{-i\hat{H}\tau/\hbar} \;\d\tau
$$

where $\tau = t' - t$. For a linear operator $\hat{Q}$ on the Hilbert space $\mathcal{H}$, the resolvent $\hat{R}_{\hat{Q}}(\eta)$ is the operator-valued function

$$
  \hat{R}_{\hat{Q}}(\eta) = (\hat{Q} - \eta)^{-1s}
$$

which is defined for all complex values of $\eta$ where $(\hat{Q} - \eta)^{-1}$ exists. For the case of the Hamiltonian, we can use the projectors $\hat{P}_j$ onto the eigenvalues $E_j$ of $\hat{H}$. This gives the relation:

$$
  \hat{R}_{\hat{H}} (\eta) \hat{P}_j = \frac{\hat{P}_j}{E_j - \eta}
$$

This allows us to interpret the projectors $\hat{P}_j$ as the residues of the closed contour $f_j$ in the complex plane, enclosing the point $E_j$ on the real axis of the complex plane, i.e.

$$
  \hat{P}_j = \frac{1}{2\pi i} \oint_{f_j} \hat{R}_{\hat{H}} (\eta) \;\d\eta
$$

For the continuous part of the spectrum, we have

$$
  \hat{P}(\Delta j) = \frac{1}{2\pi i} \oint_{f(\Delta j)} \hat{R}_{\hat{H}} (\eta) \;\d\eta
$$

where $\hat{P}(\Delta j)$ is a projector on a small interval around the continuous eigenvalue $E_j$. 

In the case of a free particle, the Hamiltonian has a pure continuous spectrum in the iterval $[0,\infty)$. The resolvent of the free particle Hamiltonian $\hat{H}_0$ is

$$
  \hat{R}_{\hat{H}_0} (\eta) = \frac{1}{\hat{H}_0 - \eta}
$$

which is defined for all $\eta$ outside the spectrum. This resolvent is a bounded operator on the entire Hilbert space when $\Re(\eta) < 0$ or $\Im(\eta) \neq 0$, i.e. when the argument of $\eta$ is within the open interval $(0,2\pi)$. Using Green's functions, the evolution of a free particle in space and time takes the form

$$
  \psi(\mathbf{r}', t') = i\int G_0 (\mathbf{r}', t'; \mathbf{r}, t) \psi(\mathbf{r},t) \;\d\mathbf{r}
$$

for $t' > t$ and for all values $0 < \eta < 2\pi$. Here $G_0$ is called the free Green's function and its explicit expression is

$$
  G_0 (\mathbf{r}', t'; \mathbf{r}, t) = -i\left(\frac{m}{2\pi i \hbar(t' - t)} \right)^{3/2} \exp\left( i\frac{m|\mathbf{r}' - \mathbf{r}|^2}{2\hbar (t' - t)} \right)
$$

## Propagator

The matrix elements of the time evolution operator in the localized basis states $\set{\ket{\mathbf{x}}}_{\mathbf{x}\in\R^3}$ defines a function

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) := \braket{\mathbf{x}_b|\hat{U}(t_b,t_a)|\mathbf{x}_a}
$$

called the *propagator* of a quantum system. The propagator gives an alternate representation for the wavefunction of a quantum particle. In the position basis $\set{\ket{\mathbf{x}}}_{\mathbf{x}\in\R^3}$, the completeness relation gives

$$
  \int_{\R^3} \ket{\mathbf{x}}\bra{\mathbf{x}}\;\d^3 x = 1
$$

The time evolution of a state vector $\ket{\psi(t)}$ from $t=0$ to $t$ can be written as

$$
\begin{align*}
  \ket{\psi(t)} =& \hat{U}(t,0)\ket{\psi(0)} = \int_{\R^3} \hat{U}(t,0) \ket{\mathbf{y}}\braket{\mathbf{y}|\psi(0)}\; \d^3 y \\
  =& \int_{\R^3} \hat{U}(t,0)\ket{\mathbf{y}} \psi(\mathbf{y}, 0)\;\d^3 y
\end{align*}
$$

The wavefunction $\psi(\mathbf{x},t) = \braket{\mathbf{x}|\psi(t)}$ thus takes the form

$$
\begin{align*}
  \psi(\mathbf{x},t) =& \braket{\mathbf{x}|\psi(t)} = \int_{\R^3} \braket{\mathbf{x}|\hat{U}(t,0)|\mathbf{y}}\psi(\mathbf{y},0)\; d^3 y \\
  =& \int_{\R^3} (\mathbf{x},0|\mathbf{y},t)\psi(\mathbf{y}, 0)\; \d^3 y
\end{align*}
$$

We can recover the time evolution operator from the propagator by

$$
  \hat{U}(t) = \int (\mathbf{x},0|\mathbf{y},t) \ket{\mathbf{x}}\bra{\mathbf{y}}\; \d^3 x\;\d^3 y
$$

The propagator and the time evolution operator both completely describe the behaviour a the system. One can intuitively think of the propagator $K(\mathbf{x}_a, t_a \mathbf{x}_b; t_b)$, as the probability amplitude for a particle to travel from $\mathbf{x}_a$ to $\mathbf{x}_b$ in time $t_b - t_a$ with $t_b > t_a$. The propagator is therefore also referred to as *time evolution amplitude*.

From the operator equations $\eqref{equation-8}$, the propagator satisfies the Schrödinger equation

$$
  i\hbar \frac{\partial}{\partial t_b} (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) = H(-i\hbar\nabla_{\mathbf{x}_b}, \mathbf{x}_b,t_b) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)
$$

When dealing with non-relativistic particles, it is customary to introduce a casual/retarded time evolution operator

$$
  \hat{U}_R (t_b,t_a) = \begin{cases}
    \hat{U}(t_b,t_a),\quad& t_b \geq t_a \\
    0,\quad& t_b < t_a
  \end{cases}
$$

and the associated casual/retarded time evolution amplitude

$$
  (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)_R := \braket{\mathbf{x}|\hat{U}_R (t_b,t_a)|\mathbf{y}}
$$

The retarded time evolution operator can be expressed in terms of the Heaviside step function

$$
  \Theta(t) := \begin{cases}
    1,\quad& t > 0 \\
    0,\quad& t \leq 0
  \end{cases}
$$

giving

$$
\begin{align*}
  \hat{U}_R (t_b,t_a) =& \Theta(t_b - t_a) \hat{U}(t_b, t_a) \\
  (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)_R =& \Theta(t_b - t_a) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b)
\end{align*}
$$

Note that the derivative of the Heaviside function is given by Dirac's delta function, i.e.  $\frac{\d}{\d t}\Theta(t) = \delta(t)$. In terms of the Heaviside function, the retarded propagator satisfies the Schrödinger equations

$$
  \left[H_R(-i\hbar\nabla_{\mathbf{x}_b},\mathbf{x}_b,t_b) - i\hbar\frac{\partial}{\partial t_b}\right] (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) = -i\hbar \delta(t_b - t_a) \delta(\mathbf{x}_b - \mathbf{x}_a)
$$

The nonzero right-hand side arises from the extra term

$$
\begin{align*}
  -i\hbar \left(\frac{\partial}{\partial t_b}\Theta(t_b - t_a)\right) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) =& -i\hbar\delta(t_b - t_a) (\mathbf{x}_a,t_a|\mathbf{x}_b,t_b) \\
  =& -i\hbar (\mathbf{x}_a,t_a|\mathbf{x}_b,t_a)
\end{align*}
$$

and the initial condition $K(\mathbf{x}_a,t_a;\mathbf{x}_b,t_a) = \braket{\mathbf{x}_b|\mathbf{x}_a}$ since $\hat{U}(t_a, t_a) = 1$.

If the Hamiltonian does not depend on time, the propagator depends only on the time difference $t = t_b - t_a$. The retarded propagator vanishes for $t < 0$. This property leads to a class of functions $f(t)$ with a characteristic Fourier transform of the form

$$
  \tilde{f}(E) = \int_0^\infty f(t) e^{iEt/\hbar} \;\d t
$$

which is analytic in the upper half of the complex energy plane. This analyticity property is necessary and sufficient to produce a factor $\Theta(t)$ in the inverse Fourier transform

$$
  f(t) = \frac{1}{2\pi\hbar} \int_{-\infty}^\infty \tilde{f}(E) e^{-iEt/\hbar}\;\d E 
$$

For $t < 0$, the contour integration may be closed by an infinite semicircle in the upper half-plane at no extra cost. Since the contour encloses no singularities, it can be contracted to a point, yielding $f(t) = 0$.

### Fixed-energy amplitude

The *fixed-energy amplitude* of a quantum system is defined by the Fourier transform of the retarded time evolution amplitude

$$
\begin{equation*}
\begin{split}
  (\mathbf{x}_b,\mathbf{x}_a)_E =& \int_{-\infty}^\infty e^{iE(t_b - t_a)/\hbar} (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a)_R \;\d t_b \\
  =& \int_{t_a}^\infty e^{iE(t_b - t_a)/\hbar} (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) \;\d t_b
\end{split}
\tag{\label{equation-11}}
\end{equation*}
$$

If the Hamiltonian is time-independent, the propagator takes the form

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \braket{\mathbf{x}_b|e^{-i\hat{H}(t_b - t_a)/\hbar}|\mathbf{x}_a}
$$

In this case, the fixed-energy amplitudes are matrix element

$$
  (\mathbf{x}_b,\mathbf{x}_a)_E = \braket{\mathbf{x}_b |\hat{R}(E)|\mathbf{x}_a}
$$

of the *resolvent operator*

$$
  \hat{R}(E) = \frac{i\hbar}{E - \hat{H} + i\eta}
$$

which is the Fourier transform of the retarded time evolution operator

$$
\begin{align*}
  \hat{R}(E) =& \int_{-\infty}^\infty e^{iE(t_b - t_a)/\hbar} \hat{U}_R (t_b, t_a)\;\d t_b \\
  =& \int_{t_a}^\infty e^{iE(t_b - t_a)/\hbar} \hat{U}(t_b, t_a) \;\d t_0
\end{align*}
$$

If $\hat{H}$ has a discrete spectrum $\sigma(\hat{H}) = \Set{E_n}_{n\in\N}$ with corresponding eigenstates $\set{\ket{\psi_n}}_{n\in\N}$, the propagator has the following spectral representation

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) e^{-iE_n (t_b - t_a)/\hbar}
$$

where $\psi_n (\mathbf{x}) = \braket{\mathbf{x}|n}$ is the wavefunction associated with the eigenstate $\ket{\psi_n}$. Applying the Fourier transform $\eqref{equation-11}$, we obtain the fixed-energy amplitude

$$
\begin{equation*}
\begin{split}
  (\mathbf{x}_b|\mathbf{x}_a)_E =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) R_n (E) \\
  =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) R_n (E) \frac{i\hbar}{E - E_n + i\eta}
\end{split}
\tag{\label{equation-12}}
\end{equation*}
$$

The time evolution amplitude is recovered by the inverse Fourier transform

$$
  (\mathbf{x}_b,t_b|\mathbf{x}_a,t_a) = \frac{1}{2\pi\hbar}\int_{-\infty}^\infty e^{-iE(t_b - t_a)/\hbar} (\mathbf{x}_a|\mathbf{x}_b)_E \;\d E
$$

The small $i\eta$-shift in the energy $E$ in $\eqref{equation-12}$ can be thought of as being attached to each of the energies $E_n$, which are thus placed by an infinitesimal piece below the real energy axis. This makes the exponential behaviour of the wavefunctions slighty damped, vanishing at infinite time, i.e. $e^{-i(E_n - i\eta)t/\hbar} \xrightarrow{t\to\infty} 0$.

If the eigenstates are nondegenerate, the residues at the poles of $\eqref{equation-12}$ render directly the products of eigenfunctions (barring degeneracies, which must be discussed separately). For a system with a continuum of energy eigenvalues, there is a cut in the complex energy plane which may be thought of as a closely spaced sequence of poles. In general, the wavefunctions are recovered from the discontinuity of the amplitudes $(\mathbf{x}_b|\mathbf{x}_a)_E$ across the cut, using the formula

$$
\begin{align*}
  \operatorname{disc}\left(\frac{i\hbar}{E - E_n}\right) =& \frac{i\hbar}{E - E_n + i\eta} - \frac{i\hbar}{E - E_n - i\eta} \\
  =& 2\pi\hbar\delta(E - E_n)
\end{align*}
$$

This follows from Sochocki's formula, valid inside integrals over $E$

$$
  \frac{1}{E - E_n \pm i\eta} = \frac{\mathcal{P}}{E - E_n} \mp i\pi\delta(E - E_n)
$$

where $\mathcal{P}$ indicates that the principal value of the integral has to be taken.

The energy integral over the discontinuity of the fixed-energy amplitude $\eqref{equation-12}$ reproduces the completeness relation taken between the local states $\bar{\mathbf{x}_b}$ and $\ket{\mathbf{x}_a}$

$$
\begin{equation*}
\begin{split}
  \int_{-\infty}^\infty \frac{\d E}{2\pi\hbar} \operatorname{disc}(\mathbf{x}_b|\mathbf{x}_a)_E =& \sum_{n\in\sigma(\hat{H})} \psi_n (\mathbf{x}_b) \psi_n^* (\mathbf{x}_a) \\
  =& \braket{\mathbf{x}_b|\mathbf{x}_a} = \delta^(3) (\mathbf{x}_b - \mathbf{x}_a)
\end{split}
\tag{\label{equation-13}}
\end{equation*}
$$

The completeness relation reflects the following property of the resolvent operator

$$
  \int_{-\infty}^\infty \frac{\d E}{2\pi\hbar} \operatorname{disc}\left(\hat{R}(E)\right) = \hat{I}
$$

If the system also possesses a continuous spectrum, the completeness relation has the form

$$
  \sum_{n\in\sigma(\hat{H})} \ket{\psi_n}\bra{\psi_n} + \int \ket{\psi_\nu}\bra{\psi_\nu}\;\d\nu = 1
$$

The continuum causes a branch cut along in the complex energy plan, such that $\eqref{equation-13}$ also includes an integral over the discontinuity along the cut.

## Time-evolution pictures

### Heisenberg picture

The Heisenberg picture offers an alternate formulation of quantum mechanics that is more closely related to classical mechanics than the Schrödinger picture. In the Heisenberg picture, the time dependence is entirely transferred from the state vector to the observable.

In the Schrödinger picture the expectation value of an arbitrary observable $\hat{O}$ is given by

$$
  {}_\text{S}\braket{\psi(t)|\hat{O}^\text{S}|\psi(t)}_\text{S}
$$

Applying the time evolution operator $\hat{U}_t$, this expectation value can be written as

$$
\begin{equation*}
\begin{split}
  {}_\text{S}\braket{\psi(t)|\hat{O}^\text{S}|\psi(t)}_\text{S} =& {}_\text{S}\braket{\psi(0)|\hat{U}_t^\dagger \hat{O}^\text{S} \hat{U}_t|\psi(0)}_\text{S} \\
  =& {}_\text{H}\braket{\psi|\hat{O}^\text{H} (t)|\psi}_\text{H}
\end{split}
\tag{\label{equation-99}}
\end{equation*}
$$

where $\ket{\psi}_\text{H} = \ket{\psi(0)}_\text{S}$ is the state vector in the Heisenberg picture, and $\hat{O}^\text{H} (t) = \hat{U}_t^\dagger \hat{O}^\text{S} \hat{U}_t$ is the time-dependent observable in the Heisenberg picture. Since the transformation from the Schrödinger to the Heisenberg picture is unitary, the Hamiltonian is invariant, i.e.

$$
  \hat{H}^\text{H} = \hat{H}^\text{S} = \hat{H}
$$

To find the equation of motion for an observable, we take the time derivative of $\eqref{equation-99}$:

$$
\begin{align*}
  &\frac{\d}{\d t} \left({}_\text{S}\braket{\psi(t)|\hat{U}_t^\dagger \hat{O}^\text{S} \hat{U}_t|\psi(t)}_\text{S} \right) \\
  =& {}_\text{S}\Braket{\psi(0)|\left(\frac{i}{\hbar}\hat{H}\hat{U}_t^\dagger \hat{O}^\text{S} \hat{U}_t - \frac{i}{\hbar}\hat{U}_t^\dagger \hat{O}^\text{S} \hat{U}_t \hat{H} + \hat{U}_t^\dagger \frac{\partial\hat{O}^\text{S}}{\partial t} \hat{U}_t \right)|\psi(0)}_\text{S} \\
  =& {}_\text{H} \Braket{\psi|\left(\frac{i}{\hbar}[\hat{H},\hat{O}^\text{H}] + \frac{\partial}{\partial t} \hat{O}^\text{H} (t) \right)|\psi}_\text{H}
\end{align*}
$$

Since the expectation value of an observable is idependent of the time-evolution picture, this must equal the time derivative of the expectation value in the Heisenberg picture, i.e.

$$
  \frac{\d}{\d t} {}_\text{H}\braket{\psi|\hat{O}^\text{H} (t)|\psi}_\text{H}
$$

Thus, we obtain the Heisenberg equation of motion

$$
  i\hbar \frac{\d}{\d t} \hat{O}^\text{H} (t) = i\hbar \frac{\partial}{\partial t} \hat{O}^\text{H} (t) + [\hat{O}^\text{H}, \hat{H}]
$$

If the operator $\hat{O}$ does not explicitly depend on time in the Schrödinger picture, this simplifies to

$$
\begin{equation*}
  i\hbar \frac{\d}{\d t} \hat{O}^\text{H} (t) = [\hat{O}^\text{H} (t), \hat{H}]
\tag{\label{equation-104}}
\end{equation*}
$$

which is the Heisenberg equation. This equation shows that an observable that does not explicitly on time and commutes with the Hamiltonian is a conserved quantity, or a constant of motion. 

In Hamiltonian mechanics, an observable function $O(\mathbf{p}(t), \mathbf{x}(t), t)$, satisfies the equation of motion

$$
\begin{align*}
  \frac{\d O}{\d t} =& \nabla_\mathbf{p} H \cdot\nabla_\mathbf{x} O - \nabla_\mathbf{p} O \cdot\nabla_\mathbf{x} H + \frac{\partial O}{\partial t} \\
  =& \{H, O\} + \frac{\partial O}{\partial t}
\end{align*}
$$

If $O$ is time-independent, this reduces to

$$
  \frac{\d O}{\d t} = \{H, O\}
$$

This shows that the Heisenberg equation can be retrived by the substitution

$$
  \{H,O\} \to \frac{1}{i\hbar}[\hat{H},\hat{O}]
$$

This can be seen as a formal rule for transitioning from classical to quantum mechanics. Specifically, in classical mechanics, if the Poisson bracket between a classical variable and the Hamiltonian is zero, this variable is conserved. Similarly, the Heisenberg evolution is formally analogous to classical time evolution. In fact, in classical mechanics, there is no direct analogue to the Schrödinger evolution. More accurately, the classical time evolution coincides with the "Heisenberg evolution" in quantum mechanics, since in classical mechanics, the state is simply a set of properties, and thus it itself can be considered an observable.

In terms of expectation values, the Heisenberg equation of motion becomes

$$
\begin{equation*}
  i\hbar \frac{\d}{\d t} \Braket{\hat{O}^\text{H} (t)} = i\hbar \Braket{\frac{\partial}{\partial t} \hat{O}^\text{H} (t)} + \Braket{[\hat{O}^\text{H}, \hat{H}]}
\tag{\label{equation-105}}
\end{equation*}
$$

### Dirac's interaction picture

Dirac's interaction picture is an intermediate representation between the Heisenberg and Schrödinger pictures, where both the state vectors and the operators carry part of the time dependence of observables. The interaction picture is formed by splitting the Hamiltonian operator in the Schrödinger picture into two contributions

$$
  \hat{H} = \hat{H}_0 + \hat{V}
$$

where $\hat{H}_0$ is the unperturbed Hamiltonian, whose eigenvalues satisfy the time-independent Schrödinger equation, and $\hat{V}$ is a (possibly time-dependent) interaction potential which perturbs these solutions.

To transition to the interaction picture, we remove the time evolution associated with the unperturbed Hamiltionian and the define the transformed state as

$$
\begin{equation*}
  \ket{\psi(t)}_\text{I} = \hat{U}_{H_0, t}^\dagger \ket{\psi(t)}_\text{S}
\tag{\label{equation-100}}
\end{equation*}
$$

where the unitary operator

$$
  \hat{U}_{H_0, t}^\dagger = e^{i\hat{H}_0 t/\hbar}
$$

accounts for the free evolution generated by $\hat{H}_0$. In order to establish the corresponding transformation for observables, we apply $\hat{U}_{H_0, t}^\dagger$ to the expectation value of an arbitrary observable $\hat{Q}$:

$$
\begin{align*}
  {}_\text{S} \braket{\psi(t)|\hat{Q}^\text{S}|\psi(t)}_\text{S} =& {}_\text{I} \braket{\psi(t)|\hat{U}_{H_0, t}^\dagger \hat{Q}^\text{S} \hat{U}_{H_0, t}|\psi(t)}_\text{I} \\
  =& {}_\text{I} \braket{\psi(t)|\hat{Q}^\text{I} (t)|\psi(t)}_\text{I}
\end{align*}
$$

This relation implies that the observable in the interaction picture is obtained from its counterpart in the Schrödinger picture by the unitary transformation

$$
\begin{equation*}
  \hat{Q}^\text{I} (t) = \hat{U}_{H_0, t}^\dagger \hat{Q}^\text{S} \hat{U}_{H_0, t}
\tag{\label{equation-101}}
\end{equation*}
$$

It follows that the free part of the Hamiltonian is invariant under the transformation to the interaction picture, i.e.

$$
  \hat{H}_0^\text{I} = \hat{H}_0^\text{S} = \hat{H}_0
$$

whereas in the Heisenberg picture, the transformation generally modifies $\hat{H}_0^\text{I}$:

$$
  \hat{H}_0^\text{H} = \hat{U}_t^\dagger \hat{H}_0 \hat{U}_t
$$

Differentiating $\eqref{equation-100}$, we obtain the evolution equation for the state in the Dirac picture:

$$
  i\hbar \frac{\d}{\d t} \ket{\psi(t)}_\text{I} = \hat{V}^\text{I} (t) \ket{\psi(t)}_\text{I}
$$

where the interaction Hamiltonian in the interaction picture is given by

$$
  \hat{V}^\text{I} = e^{i\hat{H}_0 t/\hbar} \hat{H}_\text{I} e^{-i\hat{H}_0 t/\hbar}
$$

Similarly, differentiating $\eqref{equation-101}$, we obtain the equation of motion for the observable in the Dirac picture:

$$
  i\hbar \frac{\d}{\d t} \hat{Q}^\text{I} (t) = i\hbar \frac{\partial}{\partial t} \hat{Q}^\text{I} (t) + [\hat{Q}^\text{I} (t), \hat{H}_0]
$$

where the partial time derivative transforms as

$$
  \frac{\partial}{\partial t} \hat{Q}^\text{I} (t) = \hat{U}_{H_0, t}^\dagger \left( \frac{\partial}{\partial t} \hat{Q}^\text{S} \right) \hat{U}_{H_0, t}
$$

#### Perturbed equation of motion

In the interaction picture, state vectors evolve according to

$$
  \ket{\psi (t_b)}_\text{I} = \hat{U}_\text{I} (t_b, t_a) \ket{\psi (t_a)}_\text{I}
$$

where $\hat{U}_\text{I}$ is the time evolution operator given by

$$
\begin{equation*}
  \hat{U}_\text{I} (t_b, t_a) = e^{i\hat{H}_0 t_b /\hbar} e^{-i\hat{H}(t_b - t_a)/\hbar} e^{-i \hat{H}_0 t_a /\hbar}
\tag{\label{equation-10}}
\end{equation*}
$$

If $\hat{V} = 0$, the states $\ket{\psi (t_b)}_\text{I}$ are time-independent and coincide with the Heisenberg states of the operator $\hat{H}_0$. The operator $\hat{U}_\text{I} (t_b, t_a)$ satisfies the equation of motion

$$
  i\hbar\frac{\partial}{\partial t_b} \hat{U}_\text{I} (t_b, t_a) = \hat{V}_\text{I} (t_b) \hat{U}_\text{I} (t_b, t_a)
$$

where $\hat{V}_\text{I} = e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar}$ is the potential in the interaction picture. This differential equation can be turned into an integral equation

$$
\begin{align*}
  \hat{U}_\text{I} (t_b, t_a) =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} \hat{V}_\text{I} \hat{U}_\text{I} (t, t_a)\;\d t \\
  =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar} \hat{U}_\text{I} (t, t_a)\;\d t
\end{align*}
$$

This equation can be iterated to find a perturbation expansion for the operator $\hat{U}_\text{I} (t_b, t_a)$ in powers of the interaction potential

$$
\begin{align*}
  \hat{U}_\text{I} (t_b, t_a) =& 1 - \frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar} \\
  &+ \left(-\frac{i}{\hbar}\right)^2 \int_{t_a}^{t_b} \d t \int_{t_a}^t \d t' e^{i\hat{H}_0 t/\hbar}\hat{V}e^{-i\hat{H}_0 (t - t')/\hbar} \hat{V} e^{-i\hat{H}_0 t'/\hbar} + \cdots
\end{align*}
$$

Inserting $\eqref{equation-10}$ on the left-hand side and multiplying the equation from the left by $e^{-i\hat{H}_0 t_b/\hbar}$ and from the right by $e^{i\hat{H}_0 t_a/\hbar}$, this can be rewritten as

$$
\begin{align*}
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} =& e^{-i\hat{H}_0 (t_b - t_a)/\hbar} - \frac{i}{\hbar}\int_{t_a}^{t_b} \d t e^{-i\hat{H}_0 (t_b - t)/\hbar} \hat{V} e^{-i\hat{H}_0 (t-t_a)/\hbar} \\
  &+ \left(-\frac{i}{\hbar}\right)^2 \int_{t_a}^{t_b} \d t \int_{t_a}^t \d t' e^{i\hat{H}_0 (t_b - t)/\hbar}\hat{V}e^{-i\hat{H}_0 (t - t')/\hbar} \hat{V} e^{-i\hat{H}_0 (t' - t_a)/\hbar} + \cdots
\end{align*}
$$

This expansion is recognized as the recursive solution of the integral equation

$$
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} = e^{-i\hat{H}_0 (t_b - t_a)/\hbar} - \frac{i}{\hbar}\int_{t_a}^{t_b} e^{-i\hat{H}_0 (t_b - t)/\hbar} \hat{V} e^{-i\hat{H}_0 (t-t_a)/\hbar} \;\d t
$$

In terms of a time-ordering operator $\hat{T}$, the expansion can also be written as

$$
  e^{-i\hat{H}_0 (t_b - t_a)/\hbar} = e^{-i\hat{H}_0 t_b/\hbar} \hat{T} \exp\left(-\frac{i}{\hbar} \int_{t_a}^{t_b} e^{i\hat{H}_0 t/\hbar} \hat{V} e^{-i\hat{H}_0 t/\hbar}\;\d t\right)e^{i\hat{H}t_a/\hbar}
$$

which can be represented as a mathematical operator formula

$$
  e^{T(\hat{A} + \hat{B})} = \hat{T}\exp\left(\int_0^T e^{(T - t)\hat{A}} \hat{B} e^{t\hat{A}} \; \d t \right) = e^{T\hat{A}}\hat{T} \exp\left(\int_0^T e^{-t\hat{A}} \hat{B} e^{t\hat{A}} \;\d t \right)
$$

Due to the time-ordering operator, the right-hand side cannot be evaluated using Lie's expansion formula (Hadamard's lemma). Instead, the proper formulation requires the use Campbell-Baker-Hausdorff expansion.

## Time-derivatives of observables

The most natural way to define the time derivative $\hat{\dot{Q}}$ of a quantum mechanical observable $\hat{Q}$ in the Schrödinger picture is to assume that its expectation value $\braket{\hat{\dot{Q}}}$ is equal to the time derivative of the expectation value of $\hat{Q}$, i.e.

$$
  {}_\text{S} \braket{\psi|\hat{\dot{Q}}^\text{S}|\psi}_\text{S} = \frac{\d}{\d t} \left({}_\text{S} \braket{\psi|\hat{Q}^\text{S}|\psi}_\text{S} \right)
$$

Appying the Schrödinger equation and its Hermitian adjoint to the right-hand side, we obtain

$$
\begin{align*}
  \frac{\d}{\d t} \left({}_\text{S} \braket{\psi|\hat{Q}^\text{S}|\psi}_\text{S} \right) =& {}_\text{S} \Braket{\psi|\left(\frac{i}{\hbar} \hat{H}\hat{Q}^\text{S} - \frac{i}{\hbar} \hat{Q}^\text{S} \hat{H} + \frac{\partial}{\partial t} \hat{Q}^\text{S} \right)|\psi} \\
  =& {}_\text{S} \Braket{\psi|\left(\frac{i}{\hbar}[\hat{H}, \hat{Q}] + \frac{\partial}{\partial t} \hat{Q}^\text{S} \right)|\psi}
\end{align*}
$$

Hence,

$$
\begin{equation*}
  \braket{\hat{\dot{Q}}} = \frac{i}{\hbar} \braket{[\hat{H},\hat{Q}]} + \Braket{\frac{\partial}{\partial t} \hat{Q}}
\tag{\label{equation-81}}
\end{equation*}
$$

which is known as Ehrenfest's theorem.

# Density operator

In the most general sense, quantum systems can exist in mixed states, which include pure states as a special case. A quantum system is described by a mixed state when it is in one of a set of possible states $\set{\ket{\psi_j}}$, each occuring with probability $p_j$. Unlike a pure state, which represents a coherent quantum superposition, a mixed state represents a statistical ensemble of quantum states. This contrasts with a pure state $\ket{\psi} = \sum_j \sqrt{p_j} \ket{\psi_j}$, where the quantum system exists in a coherent superposition of the $\ket{\psi_j}$. In this case, the system is described entirely by $\ket{\psi}$, rather than by a statistical mixture of the $\ket{\psi_j}$.

A mixed state is represented by a density operator (or density matrix) $\hat{\rho}$ on a Hilbert space $\mathcal{H}$, which satisfies the properties
1. **Hermiticity:** $\hat{\rho}^\dagger = \hat{\rho}$
2. **Positive semidefiniteness:** $\braket{\psi|\hat{\rho}|\psi} \geq 0$ for all $\ket{\psi}\in\mathcal{H}$
3. **Unit trace:** $\operatorname{tr}(\hat{\rho}) = 1$

The set of all density operators on $\mathcal{H}$ is denoted $\mathcal{D}(\mathcal{H})$, that is

$$
  \mathcal{D}(\mathcal{H}) := \set{\hat{\rho}\in\mathcal{L}(\mathcal{H}) | \hat{\rho}^\dagger = \hat{\rho}, \hat{\rho}\geq 0, \operatorname{tr}(\hat{\rho}) = 1}
$$

and is a convex set.

<details>
<summary>Details</summary>


Convexity of $\mathcal{D}(\mathcal{H})$ means that for every $\hat{\rho}_1, \hat{\rho}_2 \in\mathcal{D}(\mathcal{H})$ and $u\in[0,1]\subset\R$, we have

$$
  u\hat{\rho}_1 + (1 - u)\hat{\rho}_2 \in \mathcal{D}(\mathcal{H})
$$

Since $\hat{\rho}_1$ and $\hat{\rho}_2$ are Hermitian it follows that

$$
  \left(u\hat{\rho}_1 + (1 - u)\hat{\rho}\right)^\dagger = u\hat{\rho}_1^\dagger + (1 - u)\hat{\rho}_2^\dagger = u\hat{\rho}_1 + (1 - u)\hat{\rho}_2
$$

Since $\hat{\rho}_1$ and $\hat{\rho}_2$ are positive semi-definite, it follows that for every $\ket{\psi}\in\mathcal{H}$

$$
  \braket{\psi|u\hat{\rho}_1 + (1 - u)\hat{\rho}_2|\psi} = u\underbrace{\braket{\psi|\hat{\rho}_1|\psi}}_{\geq 0} + (1 - u)\underbrace{\braket{\psi|\hat{\rho}_2|\psi}} \geq 0 
$$

Since $\hat{\rho}_1$ and $\hat{\rho}_2$ have unit trace, it follows that

$$
  \operatorname{tr}\left(u\hat{\rho}_1 + (1 - u)\hat{\rho}_2 \right) = u\underbrace{\operatorname{tr}(\hat{\rho}_1)}_{=1} + (1- u) \underbrace{\boldsymbol{tr}(\hat{\rho}_2)}_{=1} = 1
$$

This verifies that $u\hat{\rho}_1 + (1 - u)\hat{\rho}_2 \in \mathcal{D}(\mathcal{H})$.
</details>

If $\hat{U}\in\mathcal{U}(\mathcal{H})$ is a unitary operator, then $\hat{U}\hat{\rho}\hat{U}\in\mathcal{D}(\mathcal{H})$ is a density operator.

<details>
<summary>Proof</summary>

Since $\hat{\rho}^\dagger = \hat{\rho}$, we have

$$
  (\hat{U}\hat{\rho}\hat{U}^\dagger)^\dagger = (\hat{U}^\dagger)^\dagger \hat{\rho}^\dagger \hat{U}^\dagger = \hat{U}\hat{\rho}\hat{U}
$$

Since $\braket{\psi|\hat{\rho}|\psi} \geq 0$, we have

$$
  \braket{\psi|\hat{U}\hat{\rho}\hat{U}^\dagger|\psi} = \braket{\hat{U}^\dagger \psi|\hat{\rho}\hat{U}^\dagger \psi} \geq 0
$$

Since $\operatorname{tr}(\hat{\rho}) = 1$ and using the commutativity of trace, we have

$$
  \operatorname{tr}(\hat{U}\hat{\rho}\hat{U}^\dagger) = \operatorname{tr}(\hat{U}^\dagger \hat{U} \rho) = \operatorname{tr}(\hat{\rho}) = 1
$$

Hence, $\hat{U}\hat{\rho}\hat{U}^\dagger \in\mathcal{D}(\mathcal{H})$.
</details>

Let $\set{\ket{\psi_j}}$ be an orthonormal basis of a Hilbert space $\mathcal{H}$. Since a density operator $\rho$ is Hermitian, it admits a diagonal spectral decomposition

$$
  \hat{\rho} = \sum_j p_j \ket{\psi_j} \bra{\psi_j} = \sum_j p_j \hat{P}_{\psi_j}
$$

where $p_j$ are the eigenvalues of $\hat{\rho}$ and $\hat{P}_{\psi_j}$ are the associated rank-one projectors. The density operator satisfies:
1. **Probability conditions:** $p_j \geq 0$ and $\sum_j p_j = 1$
2. **Positivity constraint:** $0 \leq \hat{\rho}^2 \leq \hat{\rho}$
3. **Operator norm bound:** $\norm{\rho}\leq 1$

<details>
<summary>Proof</summary>

**(1):** Since $\hat{\rho}$ is Hermitian, its eigenvalues $p_j$ are real. By the positivity of $\hat{\rho}$, we have for any $\ket{\psi}\in\mathcal{H}$

$$
  0 \leq \braket{\psi|\hat{\rho}|\psi} = \sum_j p_j \braket{\psi|\psi_j} \braket{\psi_j|\psi} = \sum_j p_j |\braket{\psi_j|\psi}|^2
$$

Since $\operatorname{tr}(\rho) = 1$, we have

$$
\begin{align*}
  1 =& \operatorname{tr}(\hat{\rho}) = \sum_k \braket{\psi_k|\hat{\rho}|\psi_k} \\
  =& \sum_{k,j} p_j \underbrace{\braket{\psi_k|\psi_j}}_{=\delta_{kj}} \underbrace{\braket{\psi_j|\psi_k}}_{=\delta_{jk}} \\
  =& \sum_k p_k
\end{align*}
$$

**(2):** The positivity of $\hat{\rho}^2$ follows from the fact that for any $\ket{\psi}\in\mathcal{H}$

$$
\begin{align*}
  \braket{\psi|\hat{\rho}^2|\psi} =& \braket{\hat{\rho}^\dagger \psi|\hat{\rho} \psi} \\
  =& \braket{\hat{\rho}\psi|\hat{\rho}\psi} = \norm{\hat{\rho}\ket{\psi}}^2 \geq 0
\end{align*}
$$

Since $0 \leq p_j \leq 1$, it follows that $p_j^2 \leq p_j$ and

$$
\begin{align*}
  \hat{\rho}^2 =& \left(\sum_j p_j \ket{\psi_j} \bra{\psi_j} \right)^2 \\
  =& \sum_{j,k} p_j p_k \ket{\psi_j} \underbrace{\braket{\psi_j|\psi_k}}_{=\delta_{jk}} \bra{\psi_k} \\
  =& \sum_j p_j^2 \ket{\psi_j} \bra{\psi_j}
\end{align*}
$$

and thus for any $\ket{\psi}\in\mathcal{H}$

$$
\begin{align*}
  \braket{\psi|\hat{\rho} - \hat{\rho}^2|\psi} =& \bra{\psi} \sum_j (p_j - p_j^2) \ket{\psi_j}\braket{\psi_j|\psi} \\
  =& \sum_j (p_j - p_j^2) \braket{\psi|\psi_j}\braket{\psi_j|\psi} \\
  =& \sum_j \underbrace{(p_j - p_j^2)}_{\geq 0} \underbrace{|\braket{\psi_j|\psi}|^2}_{\geq 0} \geq 0
\end{align*}
$$

Hence, $0 \leq \hat{\rho}^2 \leq \rho$.

**(3):** From **(2)** it follows that

$$
\begin{align*}
  \norm{\hat{\rho}}^2 =& \braket{\hat{\rho}|\hat{\rho}} = \braket{\hat{\rho}^\dagger \psi|\hat{\rho}\psi} \\
  =& \braket{\psi|\hat{\rho}^2|\psi} = \braket{\psi|\hat{\rho}|\psi} \\
  \leq& \norm{\psi}\cdot\norm{\hat{\rho} \psi}
\end{align*}
$$

which implies

$$
  \frac{\norm{\hat{\rho}\ket{\psi}}}{\norm{\psi}} \leq 1 \implies \norm{\hat{\rho}} \leq 1
$$
</details>

If $\set{\ket{\psi_j}}_j$ is an orthonormal basis on $\mathcal{H}$, the density matrix is defined as

$$
\begin{align*}
  \hat{\rho} =& \sum_j \sum_k \ket{\psi_j}\braket{\psi_j|\hat{\rho}|\psi_k}\bra{\psi_k} \\
  =& \sum_{j,k} \boldsymbol{\rho}_{jk} \ket{\psi_j}\bra{\psi_k}
\end{align*}
$$

where $\boldsymbol{\rho}_{jk} = \braket{\psi_j|\hat{\rho}|\psi_k}$ are the matrix elements of $\hat{\rho}$. This definition utilizes the fact that

$$
  \sum_j \ket{\psi_j}\bra{\psi_k} = \hat{I} \left(\sum_k \ket{\psi_k}\bra{\psi_k} \right)
$$

In a mixture described by $\hat{\rho} = \sum_j p_j \ket{\psi_j} \bra{\psi_j}$ the relative phases of the $\ket{\psi_j}$ are not physically observable. This is because for $\phi_j \in\R$, we have

$$
\begin{align*}
  \sum_j p_j \ket{e^{i\phi_j} \psi_j} \bra{e^{i\phi_j} \psi_j} =& \sum_j p_j e^{-i\phi_j} e^{i\phi_j} \ket{\psi_j} \bra{\psi_j} \\
  =& \sum_j p_j \ket{\psi_j} \bra{\psi_j} = \hat{\rho}
\end{align*}
$$

showing that the states $e^{i\phi_j} \ket{\psi_j}$ generate the same mixture as the $\ket{\phi_j}$.

<MathBox title='' boxType='proposition'>
Let $\mathcal{H}$ be a finite-dimensional Hilbert space and $\hat{\rho}\in\mathcal{D}(\mathcal{H})$ be a density operator with diagonal form

$$
  \hat{\rho} = \sum_{i=1}^n p_j \ket{\psi_j} \bra{\psi_j}
$$

where $p_j \in (0,1]$ for $j\in\set{1,\dots,n}$ with $n \leq \dim(\mathcal{H})$ are the nonzero eigenvalues of $\hat{\rho}$ and $\set{\ket{\psi_j}}_{j=1}^{\dim(\mathcal{H})}$ is an orthonormal eigenbasis. For $m\leq\dim(\mathcal{H})$, suppose we have normalized states $\set{\ket{\varphi_i}}_{i=1}^m \subset\mathcal{H}$ and probabilities $q_i \in (0,1]$ such that $\sum_{j=1}^m q_i = 1$. Then,

$$
  \hat{\rho} = \sum_{j=1}^m q_i \ket{\varphi_i} \bra{\varphi_i}
$$

if and only if $m \geq n$ and there is a unitary matrix $\mathbf{U} \in\mathrm{U}(m)$ such that

$$
  \sqrt{q_i} \ket{\varphi_i} = \sum_{j=1}^n \mathbf{U}_{ij} \sqrt{p_j} \ket{\psi_j}, \; i \in\set{1,\dots,m}
$$

<details>
<summary>Proof</summary>

**($\implies$):**

Since $\set{\ket{\psi_j}}_{j=1}^n$ is an orthonormal eigenbasis, the range of $\hat{\rho}$ has dimension

$$
  \dim[\operatorname{ran}(\hat{\rho})] = \dim\left(\operatorname{span}\set{ket{\psi_j}}_{j=1}^n \right) = n
$$

On the other hand, $\hat{\rho}[\mathcal{H}] \subseteq \operatorname{span}\set{\ket{\psi_i}}_{i=1}^m$ such that

$$
  \dim[\operatorname{ran}(\hat{\rho})] \leq \dim\left(\operatorname{span}\set{ket{\varphi_i}}_{i=1}^n \right) \leq m
$$

and it follows that $n \leq m$. By assumption, the eigenvectors of $\hat{\rho}$ for the eigenvalue $0$ are given by $\ket{\psi_k}$, where $k \in \set{n+1,\dots,\dim(\mathcal{H})}$. They satisfy

$$
  0 = \braket{\psi_k | \psi_k} = \sum_{i=1}^m q_i |\braket{\psi_k|\varphi_i}|^2
$$

which implies $\braket{\psi_k|\varphi_i} = 0$ for all $k\in\set{n+1,\dots,\dim(\mathcal{H})}$ and $i\in\set{1,\dots,m}$. We can thus expand $\ket{\varphi_i}$ as

$$
  \ket{\varphi_i} = \sum_{k=1}^{\dim(\mathcal{H})} \braket{\psi_k|\varphi_i} \ket{\psi_k} = \sum_{k=1}^n \braket{\psi_k | \varphi_i} \ket{\psi_k}
$$

Since $\hat{\rho}$ is unchanged under either decomposition, we must have

$$
  \sum_{j=1}^n p_j \ket{\varphi_j} \bra{\varphi_j} = \sum_{i=1}^m q_i \ket{\varphi_i} \bra{\varphi_i}
$$

Next, we define the $m\times n$ matrix $\mathbf{V}\in\mathcal{M}_{m,n} (\mathbf{C})$ by

$$
  \mathbf{V}_{ij} = \sqrt{\frac{q_i}{p_j}} \braket{\psi_j|\varphi_i}
$$

for $i\in\set{1,\dots,m}$ and $j\in\set{1,\dots,n}$ such that

$$
  \sum_{j=1}^n \mathbf{V}_{ij} \sqrt{p_j} \ket{\psi_j} = \sum_{j=1}^n \sqrt{q_i} \braket{\psi_j|\varphi_i} \ket{\psi_j} = \sqrt{q_i} \ket{\varphi_i}
$$

We proceed to show that we can extend $\mathbf{V}\in\mathcal{M}_{m,n} (\mathbb{C})$ to a unitary $m\times m$ matrix $\mathbf{U}$. For this, we first note that

$$
  \mathbf{V}_{ji}^\dagger = \mathbf{V}_{ij}^* = \sqrt{\frac{q_i}{p_j}} \braket{\psi_j|\varphi_i}^* = \sqrt{\frac{q_i}{p_j}} \braket{\varphi_i|\psi_j}
$$

and thus for $i,j\in\set{1,\dots,n}$

$$
\begin{align*}
  \sum_{i=1}^m \mathbf{V}_{ji}^\dagger \mathbf{V}_{ik} =& \frac{1}{\sqrt{p_j p_k}} \sum_{i=1}^m q_i \braket{\psi_j|\varphi_i} \braket{\varphi_i|\psi_k} \\
  =& \frac{1}{\sqrt{p_j p_k}} \braket{\psi_j |\hat{\rho}|\psi_k} \\
  =& \frac{1}{\sqrt{p_j p_k}} \bra{\psi_j} \sum_{l=1}^n p_l \ket{\psi_l} \braket{\psi_l|\psi_k} \\
  =& \sum_{l=1}^n \frac{p_l \delta_{jl} \delta_{lk}}{\sqrt{p_j p_k}} = \delta_{jk}
\end{align*}
$$

We have specified $\mathbf{V} \in\mathcal{M}_{m,n} (\mathbb{C})$, where $n\leq m$, such that $\mathbf{V}^\dagger \mathbf{V} = \mathbf{I}_n$. This means that the $n$ column vectors of $\mathbf{V}$ viewed as vectors in $\mathbb{C}^m$ are mutually orthogonal and normalized to $1$. Applying the Gram-Schmidt orthogonalization procedure, we can add $m - n$ orthonormal columns vectors such that all $m$ column vectors of the resulting $m\times m$ matrix $\mathbf{U}$ form a basis in $\mathbb{C}^m$. By this procedure, we extend $\mathbf{V}$ to form a unitary matrix $\mathbf{U} \in\mathrm{U}(m)$ such that $\mathbf{U}_{ij} = \mathbf{V}_{ij}$ for $j\in\set{1,\dots,n}$.

**($\impliedby$):**

Let $m \geq n$ and $\mathbf{U} \in\mathrm{U}(m)$ be a unitary matrix such that for $j\in\set{1,\dots,m}$

$$
  \sqrt{q_i} \ket{\varphi_i} = \sum_{j=1}^n \mathbf{U}_{ij} \sqrt{p_j} \ket{\psi_j}
$$

This implies

$$
\begin{align*}
  \sum_{i=1}^m q_i \ket{\varphi_i} \bra{\varphi_i} =& \sum_{j=1}^m q_i \left(\frac{1}{\sqrt{q_i}} \sum_{j=1}^n \mathbf{U}_{ij} \sqrt{p_j} \ket{\psi_j} \right) \left(\frac{1}{\sqrt{q_i}} \sum_{k=1}^n \mathbf{U}_{ik}^* \sqrt{p_k} \ket{\psi_k} \right) \\
  =& \sum_{j,k=1}^n \sqrt{p_j p_k} \left(\sum_{i=1}^m \mathbf{U}_{ki}^\dagger \mathbf{U}_{ij} \right) \ket{\psi_j} \bra{\psi_k} \\
  =& \sum_{j,k=1}^n \sqrt{p_j p_k} \underbrace{(\mathbf{U}^\dagger \mathbf{U})_{ij}}_{=\delta_{ij}} \ket{\psi_j} \bra{\psi_k} \\
  =& \sum_{j=1}^n p_j \ket{\psi_j} \bra{\psi_j} = \hat{\rho}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Qubit' boxType='example'>
A two-state quantum system is known as a qubit. It is represented by a two-dimensional Hilbert space. An arbitrary mixed state for a qubit can be written as a linear combination

$$
  \rho = \frac{1}{2} \begin{bmatrix} 
    1 + r_z & r_x - i r_y \\
    r_x + i r_y & 1 - r_z 
  \end{bmatrix} = \frac{1}{2} (1 + \mathbf{r}\cdot\boldsymbol{\sigma})
$$

where $\mathbf{r} = (r_x, r_y, r_z)$ is a Bloch vector and $\boldsymbol{\sigma}$ are the Pauli matrices. The density matrix $\rho$ represents a pure state if and only if $\rVert\mathbf{r}\rVert = 1$. For a mixed state we have $\norm{\mathbf{r}} < 1$.

<details>
<summary>Proof</summary>

Since $\rho\in\mathcal{M}_2 (\mathbb{C})$ is a complex $2\times 2$ matrix, it can be written as a linear combination

$$
\begin{align*}
  \rho =& c_0 I_2 + c_x \sigma_x + c_y \sigma_y + c_z \sigma_z = c_0 I_2 + \mathbf{c}\cdot\boldsymbol{\sigma} \\
  =& \begin{bmatrix}
    c_0 + c_z & c_x - i c_y \\
    c_x + i c_y & c_0 - c_z
  \end{bmatrix}
\end{align*}
$$

By Hermiticity, the diagonal elements of $\rho$ are real, while the off-diagonal elements are complex conjugates. Since $\operatorname{tr}(\rho) = 1$, it follows that

$$
  1 = (c_0 + c_z) + (c_0 + c_z) = 2c_0 \iff c_0 = \frac{1}{2}
$$

Since $\rho$ is semi-definite, its determinant is positive 

$$
  \det(\rho) = c_0^2 - c_z^2 - |c_x + ic_y|^2 = c_0^2 - c_x^2 - c_y^2 - c_z^2 \geq 0
$$

This implies that

$$
  \norm{ \mathbf{c} } \leq |c_0| = \frac{1}{2}
$$

Writing $\mathbf{r} = \frac{1}{2}\mathbf{c}$, we get that

$$
  \rho = \frac{1}{2} (I_2 + \mathbf{r}\cdot\boldsymbol{\sigma})
$$

with $\norm{ \mathbf{r} } \leq 1$.

If $\rho$ describes a pure state, then $\rho^2 = \rho$. Calculating $\rho^2$ yields

$$
\begin{align*}
  \rho^2 =& \frac{1}{4}[I_2 + 2\mathbf{r}\cdot\boldsymbol{\sigma} + (\mathbf{r}\cdot\boldsymbol{\sigma})^2] \\
  =& \frac{1}{4}(I_2 + 2\mathbf{r}\cdot\boldsymbol{\sigma} + \mathbf{r}^2 I_2) \\
  =& \frac{1}{4}[(1 + \mathbf{r}^2) I_2 + 2\mathbf{r}\cdot\boldsymbol{\sigma}] \\
\end{align*}
$$

where we have used the fact that $\sigma_i \sigma_j = \delta_{ij} I_2 + i\epsilon_{ijk} \sigma_k$. We see that $\rho^2 = \rho$ if and only if $\mathbf{r}^2 = \norm{\mathbf{r}}^2 = 1$.
</details>
</MathBox>

## Density operator for pure states

A pure state $\ket{\psi}\in\mathcal{H}$ can be represented by the rank-one projector $\hat{P}_\psi = \ket{\psi}\bra{\psi}$. Since $\operatorname{tr}(\hat{P}_\psi) = 1$ and $\hat{P}_\psi^2 = \hat{P}_\psi$, pure states can be viewed as a special case of mixed states with density operator

$$
  \hat{\rho}_\psi := \hat{P}_\psi = \ket{\psi}\bra{\psi}
$$

Thus, the density operator formalism generalizes the description of quantum states, encompassing both pure states and statistical mixtures.

<details>
<summary>Details</summary>

To show that the density operator for a pure state $\ket{\psi}\in\mathcal{H}$ given by $\rho_\psi = \ket{\psi}\bra{\psi}$ satisfies the quantum postulates for mixed states, we verify the following properties.

**Expectation value**

Consider an observable $A$ with spectral decomposition

$$
  \hat{A} = \sum_j \lambda_j \ket{e_j} \bra{e_j} 
$$

where $\set{\lambda}_j$ are the eigenvalues of $\hat{A}$ and $\set{\ket{e_j}}$ is an orthonormal basis of $\mathcal{H}$. The expectation value of $\hat{A}$ in the state $\hat{\rho}_\psi$ is

$$
\begin{align*}
  \braket{A}_{\rho_\psi} =& \operatorname{tr}(\rho_\psi \hat{A}) = \operatorname{tr}(\ket{\psi}\braket{\psi|\hat{A}}) \\
  =& \operatorname{tr}\left(\ket{\psi}\bra{\psi} \sum_j \lambda_j \ket{e_j} \bra{e_j} \right) \\
  =& \sum_j \lambda_j \operatorname{tr}(\ket{\psi}\braket{\psi|e_j}\bra{e_j}) \\
  =& \sum_{j,k} \lambda_j \braket{e_j|\psi}\braket{\psi|e_j}\underbrace{\braket{e_j|e_k}}_{=\delta_{jk}} \\
  =& \sum_j \lambda_j \braket{\psi|e_j} \braket{e_j|\psi} \\
  =& \braket{\psi} \sum_j \lambda_j \ket{e_j} \braket{e_j|\psi} \\
  =& \braket{\psi|\hat{A}|\psi} = \braket{\hat{A}}_\psi
\end{align*}
$$

**Measurement probability**

The probability of measuring an eigenvalue $\lambda$ associated with the projector $\hat{P}_\lambda$ is given by

$$
\begin{align*}
  \Pr_{\rho_\psi} (\lambda) =& \operatorname{tr}(\hat{\rho}\hat{P}_\lambda) = \operatorname{tr}(\ket{\psi}\bra{\psi}\hat{P}_\lambda) \\
  =& \operatorname{tr}(\ket{\psi}\bra{\psi}\hat{P}_\lambda^2) = \operatorname{tr}(\hat{P}_\lambda \ket{\psi}\braket{\psi|\hat{P}_\lambda}) \\
  =& \sum_j \braket{e_j|\hat{P}_\lambda|\psi} \braket{\psi|\hat{P}_\lambda|e_k} \\
  =& \sum_j \braket{e_j|\hat{P}_\lambda|\psi} \braket{\hat{P}_\lambda \psi|e_j} \\
  =& \braket{\hat{P}_\lambda \psi} \underbrace{\sum_j \ket{e_j} \braket{e_j|\hat{P}_\lambda|\psi}}_{=\hat{P}_\lambda \ket{\psi}} \\
  =& \braket{\hat{P}_\lambda \psi| \hat{P}_\lambda \psi} = \norm{\hat{P}_\lambda \ket{\psi}}^2 = \Pr_\psi (\lambda) 
\end{align*}
$$

**Projection**

If a measurement of an observable $A$ yields the eigenvalue $\lambda$, the post-measurement state is given by the normalized projection of $\rho_\psi$:

$$
\begin{align*}
  \frac{\hat{P}_\lambda \hat{\rho}_\psi \hat{P}_\lambda}{\operatorname{tr}(\hat{\rho}_\psi \hat{P}_\lambda)} =& \frac{\hat{P}_\lambda \ket{\psi}\bra{\psi} \hat{P}_\lambda}{\norm{\hat{P}_\lambda \ket{\psi}}^2} = \frac{\hat{P}_\lambda \ket{\psi}\bra{\psi} \hat{P}_\lambda^\dagger}{\norm{\hat{P}_\lambda \ket{\psi}}^2} \\
  =& \frac{\hat{P}_\lambda \ket{\psi} \bra{\hat{P}_\lambda \psi}}{\norm{\hat{P}_\lambda \ket{\psi}}^2} = \frac{\hat{P}_\lambda \ket{\psi}}{\norm{\hat{P}_\lambda \ket{\psi}}} \frac{\bra{\hat{P}_\lambda \psi}}{\norm{\hat{P}_\lambda \ket{\psi}}} \\
  =& \hat{\rho}_{\hat{P}_\lambda \ket{\psi} / \norm{\hat{P}_\lambda \ket{\psi}}}
\end{align*}
$$

Thus, $\frac{\hat{P}_\lambda \hat{\rho}_\psi \hat{P}_\lambda}{\operatorname{tr}(\hat{\rho}_\psi \hat{P}_\lambda)}$ os the density operator of the pure state $\hat{\rho}_{\hat{P}_\lambda \ket{\psi} / \norm{\hat{P}_\lambda \ket{\psi}}}$.

**Time evolution**

Let $\hat{\rho} (t_0) = \rho_{\psi(t_0)} = \ket{\psi(t_0)}\bra{\psi(t_0)}$ be the initial state and $\hat{\rho}(t)$ be the state at time $t$. If the system evolves unitarily under a propagator $\hat{U} (t, t_0)$, the time evolution of $\hat{\rho}$ is

$$
\begin{align*}
  \hat{\rho}(t) =& \hat{U}(t, t_0) \hat{\rho} (t_0) \hat{U}^\dagger (t, t_0) \\
  =& \hat{U}(t, t_0) \ket{\psi(t_0)} \bra{\psi(t_0)} \hat{U}^\dagger (t, t_0) \\
  =& \ket{\hat{U}(t, t_0) \psi(t_0)} \bra{\hat{U}(t, t_0) \psi(t_0)} \\
  =& \hat{\rho}_{\hat{U}(t, t_0)\ket{\psi(t_0)}} \\
  =& \rho_\psi (t)
\end{align*}
$$
</details>

A density operator $\hat{\rho}$ describes a pure state if and only it is a projector, i.e. $\hat{\rho}^2 = \hat{\rho} = \ket{\psi}\bra{\psi}$ for some normalized $\ket{\psi}\in\mathcal{H}$ with $\norm{\psi} = 1$.

<details>
<summary>Proof</summary>

**($\implies$): If $\hat{\rho}$ describes a pure state, then $\hat{\rho}^2 = \hat{\rho}$**

By definition, a pure state is represented by a rank-one density operator $\hat{\rho} = \ket{\psi}\bra{\psi}$ for $\ket{\psi}\in\mathcal{H}$. If $\set{\ket{e_j}}$ is an orthonormal basis of $\mathcal{H}$, then since $\operatorname{tr}(\hat{\rho}) = 1$, we have

$$
\begin{align*}
  1 =& \operatorname{tr}(\hat{\rho}) = \operatorname{tr}(\ket{\psi}\bra{\psi}) \\
  =& \sum_j |\braket{e_j|\psi}|^2 = \norm{\psi}^2
\end{align*}
$$

verifying that $\ket{\psi}$ is normalized. It follows that

$$
  \hat{\rho}^2 = \ket{\psi}\underbrace{\braket{\psi|\psi}}_{=\norm{\psi}^2}\bra{\psi} = \ket{\psi}\bra{\psi} = \hat{\rho}
$$

**($\impliedby$): If $\hat{\rho}$ satisfies $\hat{\rho}^2 = \hat{\rho}$, it is a pure state**

Since $\hat{\rho}$ is a density operator, it admits a spectral decomposition in an orthonormal basis $\set{\ket{\psi_j}}$

$$
  \hat{\rho} = \sum_j p_j \ket{\psi_j} \bra{\psi_j}
$$

where $p_j \geq 0$ are real eigenvalues summing to $1$. Calculating $\hat{\rho}^2$, we obtain

$$
\begin{align*}
  \hat{\rho}^2 =& \left(\sum_j p_j \ket{\psi_j} \bra{\psi_j} \right) \left(\sum_k p_k \ket{\psi_k} \bra{\psi_k} \right) \\
  =& \sum_{j,k} p_j p_k \ket{\psi_j} \underbrace{\braket{\psi_j|\psi_k}}_{=\delta_{jk}} \bra{\psi_k} \\
  =& \sum_j p_j^2 \ket{\psi_j} \bra{\psi_j} 
\end{align*}
$$

Using idempotency, $\hat{\rho}^2 = \hat{\rho}$, we find that $p_j^2 = p_j$. Taking the expectation of $\hat{\rho}^2 - \hat{\rho}$ in $\ket{\psi_k} \in\mathcal{H}$, we get

$$
\begin{align*}
  0 =& \braket{\psi_k|\hat{\rho}^2 - \hat{\rho}|\psi_k} \\
  =& \bra{\psi_k} \sum_j (p_j^2 - p_j) \ket{\psi_j} \underbrace{\braket{\psi_j|\psi_k}}_{=\delta_{jk}} \\
  =& p_k^2 - p_k = p_k (p_k - 1)
\end{align*}
$$

Consequently, $p_j = 1$ or $p_j = 0$ for each $j$. Since $\sum_j p_j = 1$, exactly one $p_j$ is equal to $1$, while all others are $0$. If $\check{\jmath}$ is the index where $p_j = 1$, then

$$
  \hat{\rho} = \ket{\psi_{\check{\jmath}}}\bra{\psi_{\check{\jmath}}}
$$

describes a pure state.
</details>

A density operator $\hat{\rho}$ describe a true mixture if and only if $\hat{\rho}^2 < \hat{\rho}$. This means that mixed states satisfy $\hat{\rho}^2 \neq \hat{\rho}$.

<details>
<summary>Proof</summary>

We prove the statement by contraposition, showing that $\hat{\rho}^2 = \hat{\rho}$ if and only if there exists $\ket{\psi}\in\mathcal{H}$ such that for every Hermitian operator $\hat{A}\in\mathcal{B}(\mathcal{H})$, we have $\braket{A}_\psi = \braket{A}_\rho$. 

**($\implies$): If $\hat{\rho}^2 = \hat{\rho}$, then $\hat{\rho}$ represents a pure state**

Consider an orthonormal basis $\set{\ket{e_j}}$ in $\mathcal{H}$ and let $\ket{\psi}\in\mathcal{H}$ be such that $\hat{\rho} = \ket{\psi}\bra{\psi}$. Expanding $\ket{\psi}$ as

$$
  \ket{\psi} = \sum_j \ket{e_j} \braket{e_j|\psi}
$$

the expectation value of an Hermitian operator $\mathcal{A}\in\mathcal{B}(\mathcal{H})$ is

$$
\begin{align*}
  \braket{A}_\rho =& \operatorname{tr}(\hat{\rho}\hat{A}) = \sum_j \braket{e_j}\ket{\psi}\braket{\psi|\hat{A}|e_j} \\
  =& \Braket{\psi|\hat{A}| \sum_j \braket{e_j|\psi} e_j} = \braket{\psi|\hat{A}|\psi} \\
  =& \braket{A}_\psi
\end{align*}
$$

Hence, $\hat{\rho}$ is indistinguishable from the pure state $\ket{\psi}$.

**($\impliedby$): If $\braket{A}_\rho = \braket{A}_\psi$, then $\hat{\rho}^2 = \hat{\rho}$**

Suppose $\hat{\rho}$ has the form

$$
  \hat{\rho} = \sum_{j_1, j_2} \rho_{j_1 j_2} \ket{e_{j_1}} \bra{e_{j_2}}
$$

If there exists a state $\ket{\psi} = \sum_j \psi_j \ket{e_j}\in\mathcal{H}$ is such that $\braket{A}_\rho = \braket{A}_\psi$ for all Hermitian operators $\hat{A}\in\mathcal{B}(\mathcal{H})$, then

$$
\begin{align*}
  \braket{A}_\rho =& \operatorname{tr}(\hat{\rho}\hat{A}) = \sum_j \braket{e_j|\hat{\rho}\hat{A}|e_j} \\
  =& \sum_j \ket{e_j} \sum_{j_1, j_2} \rho_{j_1, j_2} \ket{e_{j_1}} \braket{e_{j_2} |\hat{A}| e_{j_1}} \\
  =& \sum_{j_1, j_2} \hat{\rho}_{j_1, j_2} \sum_j \underbrace{\braket{e_j | e_{j_1}}}_{\delta_{j j_1}} A_{j_2 j} \\
  =& \sum_{j_1, j_2} \rho_{j_1, j_2} A_{j_2 j_1}
\end{align*}
$$

and

$$
\begin{align*}
  \braket{A}_\psi =& \braket{\psi|\hat{A}|\psi} = \Braket{\sum_{j_2} \psi_{j_2} e_{j_2}|\hat{A}| \sum_{j_1} \psi_{j_1} e_{j_1}} \\
  =& \sum_{j_1, j_2} \psi_{j_2}^* \psi_{j_1} \braket{e_{j_2}|\hat{A}|e_{j_1}} \\
  =& \sum_{j_1, j_2} \psi_{j_2}^* \psi_{j_1} A_{j_2 j_1}
\end{align*}
$$

Since $\braket{A}_\psi = \braket{A}_\psi$ for all $\hat{A}$, the matrix elements of $\hat{\rho}$ must be of the form $\rho_{j_1 j_2} = \psi_{j_1} \psi_{j_2}^*$. Consequently,

$$
  \hat{\rho} = \sum_{j_1,j_2} \psi_{j_1} \psi_{j_2}^* \ket{e_{j_1}} \bra{e_{j_2}} = \ket{\psi}\bra{\psi}
$$

which is equivalent to $\hat{\rho}^2 = \hat{\rho}$.
</details>

## Measurement

<MathBox title="Gleason's theorem" boxType='theorem'>
Let $\mathcal{H}$ be a Hilbert space with finite dimension $\dim(\mathcal{H}) \geq 3$. Any map $\Pr$ that assigns probabilities to the orthogonal projections of $\mathcal{H}$ and satisfies

- $\Pr(\hat{0}) = 0$
- $\Pr(\hat{I}) = 1$
- $\hat{P}_1 \hat{P}_2 = 0 \implies \Pr(\hat{P}_1 + \hat{P}_2) = \Pr(\hat{P}_1) + \Pr(\hat{P}_2)$ for any orthogonal projections $\hat{P}_1, \hat{P}_2$ 

must be of the form

$$
  \Pr (\hat{P}) = \operatorname{tr}(\hat{\rho}\hat{P})
$$

where $\hat{\rho}$ is a unique positive semidefinite, Hermitian operator $\hat{\rho}$ with $\operatorname{tr}(\hat{\rho}) = 1$.
</MathBox>

In terms of a density operator $\hat{\rho}$, the expectation value of an observable $\hat{Q}$ is defined as

$$
\begin{equation*}
  \braket{\hat{Q}}_\rho = \operatorname{tr}(\hat{\rho} \hat{Q})
\tag{\label{equation-96}}
\end{equation*}
$$

The probability that a measurement of $\hat{Q} = \sum_j \lambda_j \ket{q_j} \bra{q_j}$ yields an eigenvalue $\lambda_j$ corresponding to the eigenstate $\ket{q_j}$ is given by

$$
\begin{align*}
  \Pr_\rho (\lambda) =& \braket{P_{q_j}}_\rho = \operatorname{tr}(\rho \hat{P}_{q_j}) \\
  =& \operatorname{tr}(\hat{\rho}\ket{q_j}\bra{q_j}) \\
  =& \sum_{k,l} p_j \braket{q_l|\psi_k} \braket{\psi_k|q_j} \underbrace{\braket{q_j|q_l}}_{\delta_{jl}} \\
  =& \sum_k p_k |\braket{e_j|\psi_k}|^2 
\end{align*}
$$

If the system is in a pure state, $\hat{\rho} = \ket{\psi}\bra{\psi}$, the probability of measuring the eigenvalue $\lambda_j$ of $Q$ is

$$
\begin{align*}
  \braket{P_{q_j}}_{\rho_\psi} =& \operatorname{tr}(\hat{\rho}_\psi \hat{P}_{q_j}) = \operatorname{tr}(\ket{\psi}\braket{\psi|q_j}\bra{q_j}) \\
  =& \sum_k \braket{q_k|\psi} \braket{\psi|q_j}\underbrace{\braket{q_j|q_k}}_{=\delta_{jk}} \\
  =& |\braket{q_j|\psi}|^2
\end{align*}
$$

The expectation value of $Q$ in this case is

$$
\begin{align*}
  \braket{Q}_{\rho_\psi} =& \operatorname{tr}(\hat{\rho}_\psi \hat{Q}) \\
  =& \sum_{j,k} \braket{q_k|\psi}\braket{\psi|q_j}\lambda_j \underbrace{\braket{q_j|q_k}}_{=\delta_{jk}} \\
  =& \sum_j \lambda_j |\braket{q_j|\psi}|^2 
\end{align*}
$$

For a pure state $\ket{\psi}$, the expectation value can be written

$$
  \braket{\hat{Q}}_\psi = \sum_j \braket{q_j | \hat{\rho} \hat{Q} | q_j} = \sum_j \braket{q_j | \psi} \braket{\psi|\hat{Q}|q_j}
$$

Let $\set{\ket{\psi_j}}_{j\in I\subset\N}$ be an orthonormal basis of a Hilbert space $\mathcal{H}$. If the density operator is $\hat{\rho} = \sum_{j\in I} p_j \ket{\psi_j} \bra{\psi_j}$ and the state $\ket{\psi}\in\mathcal{H}$ is given by 

$$
  \ket{\psi} = \sum_{j\in I} \sqrt{p_j} \ket{\psi_j}
$$

then for any observable $Q$, the expectation value is

$$
  \braket{Q}_\psi = \braket{Q}_\rho + \sum_{j,k\in I:j\neq k} \sqrt{p_j p_k} \braket{\psi_j|\hat{Q}|\psi_k}
$$

<details>
<summary>Proof</summary>

The expectation value of $Q$ in terms of $\hat{\rho}$ is

$$
\begin{align*}
  \braket{Q}_\rho =& \operatorname{tr}(\hat{\rho}\hat{Q}) = \operatorname{tr}\left(\sum_j p_j \ket{\psi_j} \bra{\psi_j} \right) \\
  =& \sum_j p_j \operatorname{tr}(\ket{\psi_j} \bra{\psi_j}\hat{Q}) \\
  =& \sum_j p_j \sum_k \underbrace{\braket{\psi_k|\psi_j}}_{=\delta_{jk}} \braket{\psi_j|\hat{Q}|\psi_k} \\
  =& \sum_j p_j \braket{\psi_j|\hat{Q}|\psi_j}
\end{align*}
$$

and thus

$$
\begin{align*}
  \braket{Q}_\psi =& \braket{\psi|\hat{Q}|\psi} = \Braket{\sum_j \sqrt{p_j}\psi_j|\hat{Q}|\sum_k \sqrt{p_k} \psi_k} \\
  =& \sum_{j,k} \sqrt{p_j p_k} \braket{\psi_j|\hat{Q}|\psi_k} \\
  =& \sum_j p_j \braket{\psi_j|\hat{Q}|\psi_j} + \sum_{j\neq k} \sqrt{p_j p_k} \braket{\psi_j|\hat{Q}|\psi_k} \\
  =& \braket{Q}_\rho + \sum_{j\neq k} \sqrt{p_j p_k} \braket{\psi_j|\hat{Q}|\psi_k}
\end{align*}
$$
</details>

## Time-evolution

For a state $\ket{\psi(t)}$, the density matrix can be written as $\hat{\rho}(t) = \ket{\psi(t)} \bra{\psi(t)}$. For a pure state under unitary evolution, the time derivative of the density matrix is

$$
\begin{align*}
  \frac{\d\hat{\rho}}{\d t} =& \frac{\hat{H}}{i\hbar} \ket{\psi(t)} \bra{\psi(t)} + \ket{\psi(t)} \bra{\psi(t)} \frac{\hat{H}}{-i\hbar} \\
  =& \frac{i}{\hbar} \left(\hat{\rho}\hat{H} - \hat{H}\hat{\rho} \right) = \frac{i}{\hbar} [\hat{\rho}, \hat{H}]
\end{align*}
$$

or, equivalently

$$
  i\hbar\frac{\d\hat{\rho}}{\d t} = [\hat{H}, \hat{\rho}]
$$

This is the von Neumann equation, which describes the evolution of the density matrix for pure states under Schrödinger evolution. It shows that pure states evolve into pure states in this framework.

To express this evolution in the Heisenberg picture, we use the fact that the state in the Schrödinger picture is related to the state in the Heisenberg picture by $\ket{\psi(t)}_\text{S} = \hat{U}_t \ket{\psi(0)}_\text{S}$, where $\hat{U}_t$ is the time evolution operator. Thus, the density matrix in the Schrödinger picture at time $t$ can be written

$$
  \hat{\rho}_\text{S} (t) = \hat{U}_t \ket{\psi}_\text{H} \bra{\psi}_\text{H} \hat{U}_t^\dagger = \hat{U}_t \hat{\rho}_\text{H} \hat{U}_t^\dagger
$$

In the Heisenberg picture, the density matrix evolves as

$$
  \hat{\rho}_\text{H} = \hat{U}_t^\dagger \hat{\rho}_\text{S} \hat{U}_t = \hat{\rho}_\text{S} (0)
$$

In the Dirac interaction picture, the density matrix evolves as

$$
  \hat{\rho}_\text{I} = \hat{U}_{H_0, t}^\dagger \hat{\rho}_\text{S} \hat{U}_{H_0, t}
$$

where $\hat{U}_{H_0, t}$ is the evolution operator in the interaction picture corresponding to the free Hamiltonian $\hat{H}_0$.

## Pure random mixtures

Let $\mathcal{H}$ be a finite-dimensional Hilbert space with $\dim(\mathcal{H}) = n$ and let $\set{\ket{\Phi_j}}_{j=1}^n \subset\mathcal{H}$ be a collection of normalized states. A pure random mixture (or random coherent superposition) is a normalized vector

$$
  \ket{\Phi_\boldsymbol{\alpha}} = \sum_{j=1}^n \alpha_j \ket{\Phi_j}
$$

with complex coefficients $\alpha_j = r_j e^{i\delta_j}$ where

$$
\begin{equation*}
  \sum_{j=1}^n r_j^2 = 1
\tag{\label{equation-149}}
\end{equation*}
$$

For a fixed realization $\boldsymbol{\alpha} = (a_j)_{j=1}^n$, the expectation value of an observable $\hat{Q}$ in the state $\ket{\Phi_\boldsymbol{\alpha}}$ is

$$
\begin{align*}
  \braket{\hat{Q}}|_\boldsymbol{\alpha} =& \braket{\Phi_\boldsymbol{\alpha}|\hat{Q}|\Phi_\boldsymbol{\alpha}} \\
  =& \sum_{j,k=1}^n \alpha_j^* \alpha_k \braket{\Phi_j|\hat{Q}|\Phi_k}
  =& \sum_{j,k=1}^n r_j r_k e^{-i\gamma_{jk}} \braket{\Phi_j |\hat{Q}|\Phi_k}\; \gamma_jk = \delta_j - \delta_k
\end{align*}
$$

Let $f(r_1,\dots,r_n,\gamma_{12},\dots,\gamma_{n-1, n})$ denote the probability density describing the statistical distribution of $\boldsymbol{\alpha}$. To obtain the expectation value of $\hat{Q}$ over all fluctuation of the coefficients $r_j r_k e^{-i\gamma_{jk}}$, we have to average $\braket{\hat{Q}}$ the density $f$. Define the expectation values

$$
  w_{jk} := \mathbb{E}_f [r_j r_k e^{-i\gamma_{jk}}]
$$

Accordingly, the overall expectation of the observable $\hat{Q}$ is given by

$$
\begin{equation*}
  \braket{Q} = \sum_{j,k=1}^n w_{jk} \braket{\Phi_j |\hat{Q}|\Phi_k}
\tag{\label{equation-150}}
\end{equation*}
$$

The matrix $\boldsymbol{w} = [w_{jk}]$ is Hermitian, since

$$
  w_{jk}^* = \mathbb{E}_f [r_j r_k e^{i\gamma_{jk}}] = w_{kj}
$$

Moreover, from the normalization contraint $\eqref{equation-148}$ it follows that

$$
  \operatorname{tr}(\mathbf{w}) = \sum_j w_{jj} = \mathbb{E}_f \left[\sum_j r_j^2 \right] = 1
$$

Since $\boldsymbol{w}$ is Hermitian and positive semidefinite, there exists a unitary matrix $\mathbf{U}$ such that

$$
  \mathbf{U}^\dagger \mathbf{wU} = \operatorname{diag}[w_1, \dots, w_n]
$$

where

$$
  \sum_{j=1}^n w_j = 1,\; w_j \geq 0
$$

Define new orthonormal state 

$$
  \ket{\psi_j} := \sum_{k=1}^n U_{kj}^* \ket{\Phi_k}
$$

Then $\eqref{equation-150}$ can be rewritten in the diagonal basis as

$$
  \braket{\hat{Q}} = \sum_{j=1}^n w_j \braket{\psi_j |\hat{Q}|\psi_j}
$$

Hence, the random mixture behaves statistically as a mixed state

$$
\begin{equation*}
  \hat{\rho} = \sum_{j=1}^n w_j \ket{\psi_j} \bra{\psi_j}
\tag{\label{equation-151}}
\end{equation*}
$$

For a completely random system, where the probability density $f$ is uniform, the random phases $\gamma_{jk}$ are uniformly distributed on $[0, 2\pi)$, and the amplitudes $r_j$ are statistically equivalent. In this case, the phase averages $(j < k)$ are given by

$$
  \frac{1}{2\pi} \int_0^{2\pi} e^{-i\gamma_{jk}} \d\gamma_{jk} = \delta_{jk}
$$

and by symmetry

$$
  \mathbb{E}_f [r_j^2] = \frac{1}{n}
$$

under the constraint $\eqref{equation-149}$. Thus $w_{jk} = \delta_{jk}/n$ so that the density operator $\eqref{equation-151}$ reduces to

$$
  \hat{\rho} = \frac{1}{n} \sum_{j=1}^n \ket{\Phi_j} \bra{\Phi_k} = \frac{1}{n} \hat{I}
$$

and the expectation value becomes

$$
  \braket{\hat{Q}} = \operatorname{tr}(\hat{rho}\hat{Q}) = \frac{1}{n} \sum_{j=1}^n \braket{\psi_j |\hat{Q}|\psi_j} = \frac{1}{n} \operatorname{tr}(\hat{Q})
$$

Thus, a completely randomized ensemble corresponds to the maximally mixed state

$$
  \hat{\rho} = \frac{1}{n} \hat{I}
$$

# Composite systems

The quantum state space of composite system formed of $n\in\N_+$ sub-systems $\mathcal{H}_{A_j}$ for $j\in\set{1,\dots,n}$ is given by the Hilbert tensor product

$$
  \bigotimes_{j=1}^n \mathcal{H}_{A_j}
$$

States of the composite system are generally represented by density operators $\hat{\rho}$ on $\bigotimes_{j=1}^n \mathcal{H}_{A_j}$, which take the form

$$
  \hat{\rho} = \sum_{j\in I} p_j \ket{\Psi_j} \bra{\Psi_j}
$$

where $\set{\ket{\Psi_j}}_{j\in I}$ is an orthonormal basis of $\bigotimes_{j=1}^n \mathcal{H}_{A_j}$.

<MathBox title='Alice and Bob' boxType='remark'>
For a bipartite quantum system $\mathcal{H}_A \otimes \mathcal{H}_B$, it is common to refer to subsystem $A$ as *Alice* and subsystem $B$ as *Bob* for notational convenience.
</MathBox>

## Pure states of bipartite systems

Consider a bipartite system $\mathcal{H}_A \otimes \mathcal{H}_B$ with a density operator $\hat{\rho}\in\mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B)$ describing its state. Measurement of an observable on subsystem $A$, represented by the operator $\hat{M}_A$, corresponds to measuring the composite system with the operator $\hat{M}_A \otimes \hat{I}_B$. Similarly, measurements on subsystem $B$ are represented by operators of the form $\hat{I}_A \otimes \hat{M}_B$. 

For a pure state of the composite system

$$
  \ket{\Psi} = \sum_{a,b} \Psi_{ab} \ket{e_a} \otimes \ket{f_b} \in\mathcal{H}_A \otimes \mathcal{H}_B
$$

where $\set{\ket{e_a}}$ and $\set{\ket{f_b}}$ are orthonormal bases of $\mathcal{H}_A$ and $\mathcal{H}_B$, respectively, the expectation value of the observable $M_A$ on subsystem $A$ is given by

$$
\begin{align*}
  \braket{\hat{M}_A \otimes \hat{I}_B}_\Psi =& \braket{\Psi|\hat{M}_A \otimes \hat{I}|\Psi} \\
  =& \sum_{a_1, b_1} \sum_{a_2, b_2} \Psi_{a_2 b_2}^* \Psi_{a_1 b_1} \braket{e_{a_2} \otimes f_{b_2}|\hat{M}_A|e_{a_1} \otimes f_{b_1}} \\
  =& \sum_{a_1, b_1} \sum_{a_2, b_2} \Psi_{a_2 b_2}^* \Psi_{a_1 b_1} \braket{e_{a_2}|\hat{M}_A|e_{a_1}} \underbrace{\braket{f_{b_1}|f_{b_2}}}_{=\delta_{b_1, b_2}} \\
  =& \sum_{a_2, a_1, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \braket{e_{a_2}|\hat{M}_A|e_{a_1}}
\end{align*}
$$

This expectation value remains unchanged if subsystem $A$ were in the mixed state:

$$
  \hat{\rho}_A (\Psi) := \sum_{a_2, a_1, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \ket{e_{a_1}} \bra{e_{a_2}}
$$

For observables of the form $\hat{M}_A$, the state $\hat{\rho}_A (\psi)$ reproduces the expectation values of $\hat{M}_A \otimes \hat{I}_B$ in the composite state $\ket{\Psi}$. Computing the expectation of $M_A$ with respect to $\hat{\rho}_A (\Psi)$ gives

$$
\begin{align*}
  \braket{\hat{M}_A}_{\rho_A (\Psi)} =& \operatorname{tr}(\hat{\rho}_A (\Psi) \hat{M}_A) \\
  =& \sum_a \braket{e_a|\hat{\rho_A} (\Psi) \hat{M}_A e_a} \\
  =& \sum_{a, a_1, a_2, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \underbrace{\braket{e_a|e_{a_1}}}_{\delta_{a,a_1}} \braket{e_{a_2}|\hat{M}_A|e_a} \\
  =& \sum_{a_1, a_2, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \braket{e_{a_2}|\hat{M}_A|e_{a_1}} \\
  =& \braket{\hat{M}_A \otimes \hat{I}}_\Psi
\end{align*}
$$

Every measurement performed on subsystem $A$, which is a part of a composite system in state $\ket{\Psi}$, suggests that subsystem $A$ is in the mixed state $\hat{\rho}_A (\Psi)$. This means that if the composite system is in the pure state $\ket{\Psi}\in\mathcal{H}_A \otimes\mathcal{H}_B$, described by the density operator $\hat{\rho} = \ket{\Psi}\bra{\Psi}$ on $\mathcal{H}_A \otimes \mathcal{H}_B$, then the reduced state of subsystem $A$ is given by

$$
  \hat{\rho}_A (\Psi) = \sum_{a_1, a_2, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \ket{e_{a_1}}\bra{e_{a_2}}
$$

Similarly, for subsystem $B$, the expectation values of observables $\hat{M}_B$ in the pure state $\ket{\Psi}$ are given

$$
  \braket{\hat{I}_A \otimes \hat{M}_B} = \sum_{b_1, b_2, a} \Psi_{ab_1} \Psi_{ab_2}^* \braket{f_{b_2}|\hat{M}_B|f_{b_1}}
$$

where the reduced density operator for subsystem $B$ is

$$
  \hat{\rho}_B (\Psi) = \sum_{b_1, b_2, a} \Psi_{ab_2}^* \Psi_{ab_1} \ket{f_{b_1}} \bra{f_{b_2}} 
$$

which satisfies

$$
  \braket{\hat{M}_B}_{\rho_B (\Psi)} = \braket{\hat{I}_A \otimes \hat{M}_B}_\Psi
$$

<details>
<summary>Details</summary>

We verify that $\hat{\rho}_A (\Psi)$ has all properties of a density operator.

**Hermiticity:** Taking the Hemitian adjoint of $\hat{\rho}_A (\Psi)$ gives
$$
\begin{align*}
  \hat{\rho}_A^\dagger (\Psi) =& \sum_{a_1, a_2, b} (\Psi_{a_2 b}^*)^* \Psi_{a_1 b}^* \underbrace{(\ket{e_{a_1}}\bra{e_{a_2}})^\dagger}_{=\ket{e_{a_2}}\bra{e_{a_1}}} \\
  =& \sum_{a_1, a_2, b} \Psi_{a_1 b}^* \Psi_{a_2 b} \ket{e_{a_2}} \bra{e_{a_1}} \\
  =& \hat{\rho}_A (\Psi)
\end{align*}
$$

showing that $\hat{\rho}_A (\Psi)$ is Hermitian.

**Positive semi-definiteness:** For any $\varphi\in \mathcal{H}_A \otimes \mathcal{H}_B$, we have

$$
\begin{align*}
  \braket{\varphi|\hat{\rho}_A (\Psi)|\varphi} =& \sum_{a_1, a_2, b} \Psi_{a_2 b}^* \Psi_{a_1 b} \braket{\varphi|e_{a_1}} \braket{e_{a_2}|\varphi} \\
  =& \sum_b \left(\sum_{a_1} \Psi_{a_1 b} \braket{\varphi|e_{a_1}}\right)\left(\sum_{a_2} \Psi_{a_2 b} \braket{\varphi|e_{a_2}} \right)^* \\
  =& \sum_b \left| \sum_a \Psi_{ab} \braket{\varphi|e_a} \right|^2 \geq 0
\end{align*}
$$

**Unit trace:** Taking the trace of $\hat{\rho}_A (\Psi)$ gives

$$
\begin{align*}
  \operatorname{tr}(\hat{\rho}_A (\Psi)) =& \sum_{a_3, a_1, a_2, b} \Psi_{a_2}^* \Psi_{a_1 b} \braket{e_{a_3}|e_{a_1}} \braket{e_{a_2}|e_{a_3}} \\
  =& \sum_{a,b} |\Psi_{ab}|^2 = \norm{\Psi}^2 = 1
\end{align*}
$$
</details>

## Mixed states of bipartite systems
Consider a bipartite system $\mathcal{H}_A \otimes \mathcal{H}_B$ and let $\hat{\rho}\in\mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B)$ be a density operator describing the state of the system. The reduced density operator $\hat{\rho}_A (\hat{\rho})$ on $\mathcal{H}_A$, which describes the state if the subsystem $A$ alone is observed, is given by the partial trace

$$
  \operatorname{\rho}_A (\hat{\rho}) := \operatorname{tr}_B (\hat{\rho})
$$

For any observable $\hat{M}_A$ in $A$, the density operator $\hat{\rho}_A (\hat{\rho})$ satisifes

$$
  \braket{\hat{M}_A}_{\hat{\rho}_A (\hat{\rho})} = \braket{\hat{M}_A \otimes \hat{I}_B}_{\hat{\rho}}
$$

<details>
<summary>Details</summary>

$$
\begin{align*}
  \braket{\hat{M}_A \otimes \hat{I}_B}_{\hat{\rho}} =& \operatorname{tr}\left((\hat{M}_A \otimes \hat{I}_B)\hat{\rho} \right) \\
  =& \operatorname{tr}\left(\hat{M}_A \operatorname{tr}_B (\hat{\rho}) \right) \\
  =& \operatorname{tr}\left(\hat{M}_A \hat{\rho}_A (\rho) \right) \\
  =& \braket{\hat{M}_A \otimes \hat{I}_B}_{\hat{\rho}}
\end{align*}
$$
</details>

If $\boldsymbol{\rho}_{a_1 b_1, a_2 b_2}$ is the matrix of $\hat{\rho}$ in the orthonormal basis $\set{\ket{e_a \otimes f_b}}$ in $\mathcal{H}_A \otimes \mathcal{H}_B$, then the matrix of $\hat{\rho}_A (\hat{\rho})$ in the orthonormal basis $\set{\ket{e_a}} \subset\mathcal{H}_A$ is given by

$$
  \boldsymbol{\rho}_A (\hat{\rho})_{a_1 a_2} = \sum_b \boldsymbol{\rho}_{a_1 b, a_2 b}
$$

<details>
<summary>Details</summary>

We verify that $\hat{\rho}_A (\hat{\rho})$ has all properties of a density operator.

**Hermiticity:** To prove that $\hat{\rho}_A (\hat{\rho})$ is Hemitian, it suffices to show $\boldsymbol{\rho}_A^\dagger (\hat{\rho})_{a_1 a_2} = \boldsymbol{\rho}_A (\hat{\rho})_{a_1 a_2}$ in an arbitrary orthonormal basis $\set{\ket{e_a}} \subset\mathcal{H}_A$

$$
\begin{align*}
  \boldsymbol{\rho}_A^\dagger {\hat{\rho}}_{a_1 a_2} =& \boldsymbol{\rho}_A^* (\hat{\rho})_{a_1 a_2} = \left(\sum_b \boldsymbol{\rho}_{a_2 b, a_1 b} \right)^* \\
  =& \sum_b \boldsymbol{\rho}_{a_2 b, a_1 b}^* = \sum_b \boldsymbol{\rho}_{a_1 b, a_2 b} \\
  =& \boldsymbol{\rho}_A (\hat{\rho})_{a_1 a_2}
\end{align*}
$$

**Positive semi-definiteness:** Let $\set{\ket{f_b}}$ be an orthonormal basis of $\mathcal{H}_B$ and $\ket{\varphi}\in\mathcal{H}_A$ be arbitrary. Since $\hat{\rho} \geq 0$, it follows that

$$
\begin{align*}
  \braket{\varphi|\hat{\rho}_A (\hat{\rho})|\varphi} =& \sum_{a_1, a_2} \boldsymbol{\varphi}_{a_1}^* \boldsymbol{\rho}_A (\hat{\rho})_{a_1, a_2} \boldsymbol{\varphi}_{a_2} \\
  =& \sum_{a_1, a_2} \boldsymbol{\varphi_{a_1}}^* \sum_b \boldsymbol{\rho}_{a_1 b, a_2 b} \boldsymbol{\varphi}_{a_2} \\
  =& \sum_{a_1, a_2, b} \boldsymbol{\varphi}_{a_1}^* \boldsymbol{\rho}_{a_1 b, a_2 b} \boldsymbol{\varphi}_{a_2} \\
  =& \sum_b \braket{\varphi\otimes f_b|\hat{\rho}|\varphi\otimes f_b} \geq 0
\end{align*}
$$

**Unit trace:** Since $\boldsymbol{tr}(\hat{\rho}) = 1$, it follows that

$$
\begin{align*}
  \operatorname{tr}\left(\hat{\rho}_A (\hat{\rho}) \right) =& \sum_a \boldsymbol{\rho}_A (\hat{\rho})_{aa} \\
  =& \sum_a \sum_b \boldsymbol{\rho}_{ab, ab} = \operatorname{tr}(\hat{\rho}) = 1
\end{align*}
$$
</details>

Similarly, the reduced density operator $\hat{\rho}_B (\hat{\rho})$ on $\mathcal{H}_B$ is given by the partial trace

$$
  \hat{\rho}_B (\hat{\rho}) := \operatorname{tr}_A (\hat{\rho}) 
$$

For any observable $\hat{M}_B$ in $A$, the density operator $\hat{\rho}_B (\hat{\rho})$ satisifes

$$
  \braket{\hat{M}_B}_{\hat{\rho}_B (\hat{\rho})} = \braket{\hat{I}_A \otimes \hat{M}_B}_{\hat{\rho}}
$$

If $\boldsymbol{\rho}_{a_1 b_1, a_2 b_2}$ is the matrix of $\hat{\rho}$ in the orthonormal basis $\set{\ket{e_a \otimes f_b}}$ in $\mathcal{H}_A \otimes \mathcal{H}_B$, then the matrix of $\hat{\rho}_B (\hat{\rho})$ in the orthonormal basis $\set{\ket{f_b}}\subset\mathcal{H}_B$ is given by

$$
  \boldsymbol{\rho}_B (\hat{\rho})_{b_1 b_2} = \sum_a \boldsymbol{\rho}_{a b_1, a b_2}
$$

## Schmidt decomposition of pure states

Schmidt decomposition provides a way to express a pure states $\ket{\Psi}\in\mathcal{H}_A \otimes\mathcal{H}_B$ in terms of the eigenvectors of the reduced density operators. Let

$$
  \ket{\Psi} = \sum_{a,b} \Psi_{a,b} \ket{e_a \otimes f_b}
$$

be a pure state in the composite Hilbert space $\mathcal{H}_A \otimes \mathcal{H}_B$ and let

$$
  \hat{\rho}_A (\Psi) = \sum_{a_1, a_2, b} \Psi_{a_1 b} \Psi_{a_2 b}^* \ket{e_{a_1}} \bra{e_{a_2}}
$$

be the corresponding reduced density operator for subsystem $A$. Since $\hat{\rho}_A (\Psi)$ is a Hermitian and positive operator on $\mathcal{H}_A$, there exists an orthonormal basis $\set{\ket{\tilde{e}_a}}$ in $\mathcal{H}_A$ consisting of eigenvector of $\hat{\rho}_A (\Psi)$ such that

$$
  \hat{\rho}^A (\Psi) = \sum_{a} q_a \ket{\tilde{e}_a} \bra{\tilde{e}_a}
$$

where $q_a \geq 0$ are the eigenvalues. The othornormal bases $\set{\ket{\tilde{e}_a}}$ and $\set{\ket{\tilde{e}_a}}$ are related by a unitary operator $\hat{U}\in\mathcal{U}(\mathcal{H}_A)$

$$
  \ket{\tilde{e}_a} = \hat{U}\ket{e_a} = \sum_{a_1} \ket{e_{a_1}} \underbrace{\braket{e_{a_1}|\hat{U}|e_a}}_{=\mathbf{U}_{a_1 a}}
$$

Defining the transformed coefficients

$$
  \tilde{\Psi}_{ab} := \sum_{a_1} \mathbf{U}_{a a_1} \Psi_{a_1 b}
$$

we find

$$
  \ket{\Psi} = \sum_{a, b} \tilde{\Psi}_{ab} \ket{\tilde{e}_a \otimes f_b}
$$

This imples that the reduced density matrix takes the form

$$
  \hat{\rho}_A (\Psi) = \sum_{a_1, a_2, b} \tilde{\Psi}_{a_1 b} \tilde{\Psi}_{a_2 b}^* \ket{\tilde{e}_{a_1}} \bra{\tilde{e}_{a_2}}
$$

By comparing the eigenvalue coefficients of $\hat{\rho}_A (\Psi)$, we deduce that

$$
  \sum_b \tilde{\Psi}_{a_1 b} \Psi_{a_2 b}^* = \delta_{a_1 a_2} q_{a_2}
$$

In particular,

$$
  q_a = 0 \iff \Psi_{ab}^* = 0, \; \forall b
$$

For $q_a > 0$ we define the vectors

$$
  \ket{\tilde{f}_a} := \frac{1}{\sqrt{q_a}} \sum_b \tilde{\Psi}_{ab} \ket{f_b} \in\mathcal{H}_B
$$

The set $\set{\ket{\tilde{f}_a}}$ forms an orthonormal basis in $\mathcal{H}_B$ since

$$
\begin{align*}
  \braket{\tilde{f}_{a_1}|\tilde{f}_{a_2}} =& \frac{1}{\sqrt{q_{a_1} q_{a_2}}} \sum_{b_1, b_2} \tilde{\Psi}_{a_1 b_1}^* \tilde{\Psi}_{a_2 b_2} \underbrace{\braket{f_{b_1}|f_{b_2}}}_{\delta_{b_1 b_2}} \\
  =& \frac{1}{\sqrt{q_{a_1} q_{a_2}}} \sum_b \tilde{\Psi}_{a_1 b}^* \tilde{\Psi}_{a_2 b} \\
  =& \delta_{a_1 a_2}
\end{align*}
$$

Thus, we obtain

$$
\begin{align*}
  \ket{\Psi} =& \sum_{a,b} \tilde{\Psi}_{ab} \ket{\tilde{e}_a \otimes f_b} \\
  =& \sum_{q_a \neq 0} \ket{\tilde{e}_a} \otimes \underbrace{\sum_{b} \tilde{\Psi}_{ab} \ket{f_b}}_{=\sqrt{q_a}\ket{f_b}} + \sum_{q_a = 0} \sum_b \underbrace{\tilde{\Psi}_{ab}}_{=0} \ket{\tilde{e}_a \otimes f_b} \\
  =& \sum_{q_a \neq 0} \sqrt{q_a} \ket{\tilde{e}_a \otimes \tilde{f}_b}
\end{align*}
$$

which is the Schmidt decomposition

$$
  \ket{\Psi} = \sum_a \sqrt{q_a} \ket{\tilde{e}_a \otimes \tilde{f}_a}
$$

The orthonormal bases $\set{\ket{\tilde{e}_a}}$ and $\set{\ket{\tilde{f}_b}}$ depend on $\ket{\Psi}$. In terms of the Schmidt decomposition, the reduced density operators can be written as

$$
\begin{align*}
  \hat{\rho}_A (\Psi) =& \sum_a q_a \ket{\tilde{e}_a} \bra{\tilde{e}_a}
  \hat{\rho}_B (\Psi) =& \sum_{b} q_b \ket{\tilde{f}_b} \bra{\tilde{f}_b}
\end{align*}
$$

The Schmidt bases $\set{\ket{\tilde{e}_a}}$ and $\set{\ket{\tilde{f}_b}}$ are unique only if all nonzero eigenvalues of $\hat{\rho}_A (\Psi)$ (or equivalently, $\hat{\rho}_B (\Psi)$) are non-degenerate. If a nonzero eigenvalue $q_{\bar{a}} \neq 0$ of $\hat{\rho}_A (\Psi)$ has degeneracy $d_{\bar{a}} > 1$, then the corresponding eigenspace allows for an arbitrary choice of orthonormal basis. For $k\in\set{1,\dots,d_{\bar{a}}}$ let $\ket{\tilde{e}_{\bar{a}, k}}$ be the eigenvectors associated with $q_{\bar{a}}$. Then

$$
\begin{align*}
  \hat{\rho}_A (\Psi) =& \sum_{a \neq \bar{a}} q_a \ket{\tilde{e}_a} \bra{\tilde{e}_a} + q_{\bar{a}} \sum_{k=1}^{d_{\bar{a}}} \ket{\tilde{e_{\bar{a}, k}}} \bra{\tilde{e}_{\bar{a}, k}} \\
  =& \sum_{a \neq \bar{a}} q_a \ket{\tilde{e}_a} \bar{\tilde{e}_a} + q_{\bar{a}} \sum_{k=1}^{d_{\bar{a}}} {\ket{\tilde{\tilde{e}}}_{\bar{a}, k}} \bra{\tilde{\tilde{e}}_{\bar{a}, k}}
\end{align*}
$$

with

$$
  {\ket{\tilde{\tilde{e}}}_{\bar{a}, k}} = \sum_{l = 1}^{d_{\bar{a}}} \mathbf{U}_{kl}^{\bar{a}} \ket{\tilde{e}_{\bar{a},l}}
$$

where $\mathbf{U}_{kl}^{\bar{a}}$ is the matrix of an arbitrary unitary transformation in the eigenspace for $q_{\bar{a}}$. This shows that $\ket{\Psi}$ has the following equivalent Schmidt decompositions 

$$
\begin{align*}
  \ket{\Psi} =& \sum_{a \neq \bar{a}} \sqrt{q_a} \ket{\tilde{e}_a \otimes \tilde{f}_b} + \sqrt{q_{\bar{a}}} \sum_{k=1}^{d_{\bar{a}}} \ket{\tilde{e}_a \otimes \tilde{f}_b} \\
  =& \sum_{a \neq \bar{a}} q_a \ket{\tilde{e}_a \otimes \tilde{f}_b} + q_{\bar{a}} \sum_{k=1}^{d_{\bar{a}}} \ket{\tilde{\tilde{e}}_a \otimes \tilde{\tilde{f}}_b}
\end{align*}
$$

# Entanglement

A state $\hat{\rho}\in\mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B)$ in a composite system $\mathcal{H}_A \otimes \mathcal{H}_B$ is *separable* with respect to the subsystems $\mathcal{H}_A$ and $\mathcal{H}_B$ if there exists states $\hat{\rho}_j^{(A)} \in\mathcal{D}(\mathcal{H}_A)$ and $\hat{\rho}_j^B \in\mathcal{D}(\mathcal{H}_B)$ for $I\subset\N_+$, along with real numbers $p_j > 0$ satisfying $\sum_{j\in I} p_j = 1$, such that

$$
  \hat{\rho} = \sum_{j\in I} p_j \hat{\rho}_j \hat{\rho}_j^{(A)} \otimes \hat{\rho}_j^{(B)}
$$

Separable states are also known as *product-states*. States that cannot be written in this form are *entangled*. A pure state $\ket{A}$ in the tensor product of identical Hilbert spaces $\mathcal{H}_A$ is *maximally intangled* if

$$
  \hat{\rho}_A (\Psi) = \lambda\hat{I}, \; 0 < \lambda < 1
$$

<details>
<summary>Details</summary>

To verify that the tensor product of two density matrices is itself a valid density matrix, consider $\hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)$ and $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$. We need to check that $\hat{\rho}_A \otimes \hat{\rho}_B \in\mathcal{D}(\mathcal{H}_A \otimes\mathcal{H}_B)$, which requires that it is Hermitian, positive semi-definite, and has unit trace.

**Hermiticity:** Since $\hat{\rho}_A$ and $\hat{\rho}_B$ are Hermitian then so is $\hat{\rho}_A \otimes\hat{\rho}_B$. 


**Positivity:** In order to show the positivity of $\hat{\rho}_A \otimes \hat{\rho}_B$ note first that

$$
\begin{align*}
  \hat{\rho}_A \otimes \hat{\rho}_B =& (\hat{\rho}_A \otimes\hat{I}_B)(\hat{I}\otimes\hat{\rho}_B) \\
  =& (\hat{I}_A \otimes\hat{\rho}_B)(\hat{\rho}_A \otimes\hat{I}_B)
\end{align*}
$$

where also

$$
  (\hat{\rho}_A \otimes\hat{I}_B)^\dagger = \hat{\rho}_A \otimes\hat{I}_B, \quad (\hat{I}_A \otimes\hat{\rho}_B)^\dagger = \hat{I}_A \otimes\hat{\rho}_B
$$

Both $\hat{\rho}_A \otimes\hat{I}_B$ and $\hat{I}_A \otimes\hat{\rho}_B$ are positive because for an arbitrary vector

$$
  \ket{\Psi} = \sum_{a,b} \Psi_{ab} \ket{e_a} \otimes\ket{f_b} \in\mathcal{H}_A \otimes\mathcal{H}_B
$$

and positivity of $\hat{\rho}_A$ we find that

$$
\begin{align*}
  \braket{\Psi|\hat{\rho}_A \otimes\hat{I}_B|\Psi} =& \sum_{a_1 a_2, b_1 b_2} \Psi_{a_1 b_1}^* \Psi_{a_2 b_2} \Braket{e_{a_1} \otimes f_{b_1}|\hat{\rho}_A \otimes\hat{I}_B|e_{a_2} \otimes f_{b_2}} \\
  =& \sum_{a_1 a_2, b_1 b_2} \Psi_{a_1 b_1}^* \Psi_{a_2 b_2} \braket{e_{a_1}|\hat{\rho}_A|e_{a_2}} \underbrace{\braket{f_{b_1}|f_{b_2}}}_{=\delta_{b_1 b_2}} \\
  =& \sum_{a_1 a_2, b} \Psi_{a_1 b}^* \Psi_{a_2 b} \braket{e_{a_1}|\hat{\rho}_A|e_{a_2}} \\
  =& \sum_b \Braket{\sum_{a_1} \Psi_{a_1 b} e_{a_1}|\hat{\rho}_A| \sum_{a_2} \Psi_{a_2 b} e_{a_2}} \\
  =& \sum_b \braket{\psi_b |\hat{\rho}_A|\psi_b} \geq 0
\end{align*}
$$

Similarly, by positivity of $\hat{\rho}_B$ we find that

$$
\begin{align*}
  \braket{\Psi|\hat{I}_A \otimes\hat{\rho}_B|\Psi} =& \sum_{a_1 a_2, b_1 b_2} \Psi_{a_1 b_1}^* \Psi_{a_2 b_2} \Braket{e_{a_1} \otimes f_{b_1}|\hat{I}_A \otimes\hat{P}_B|e_{a_2} \otimes f_{b_2}} \\
  =& \sum_{a_1 a_2, b_1 b_2} \Psi_{a_1 b_1}^* \Psi_{a_2 b_2} \underbrace{\braket{e_{a_1}|e_{a_2}}}_{=\delta_{a_1 a_2}} \braket{f_{b_1}|\hat{\rho}_B|f_{b_2}} \\
  =& \sum_{a, b_1 b_2} \Psi_{a b_1}^* \Psi_{a b_2} \braket{f_{b_1}|\hat{\rho}_B|f_{b_2}} \\
  =& \sum_a \Braket{\sum_{b_1} \Psi_{a b_1} f_{b_1}|\hat{\rho}_B| \sum_{b_2} \Psi_{a b_2} f_{b_2}} \\
  =& \sum_a \braket{\psi_a |\hat{\rho}_B|\psi_a} \geq 0
\end{align*}
$$

Since $\hat{\rho}_A \otimes\hat{I}_B$ and $\hat{I}_A \otimes\hat{\rho}_B$ commute, and are Hermitian and posite, it follows that for every pair $\hat{\rho}_A \otimes\hat{I}_B$, $\hat{I}_A \otimes\hat{\rho}_B$ there exists an orthonormal basis $\ket{e_a \otimes f_b}$ in which both are diagonal, i.e.

$$
\begin{align*}
  \hat{\rho}_A \otimes\hat{I}_B =& \sum_{a,b} \lambda_{a,b}^{(A)} \ket{e_a \otimes f_b} \bra{e_a \otimes f_b} \\
  \hat{I}_A \otimes\hat{\rho}_B =& \sum_{a,b} \lambda_{a,b}^{(B)} \ket{e_a \otimes f_b} \bra{e_a \otimes f_b}
\end{align*}
$$

where due to positivity we also have $\lambda_{a,b}^{(A)} \geq 0$ and $\lambda_{a,b}^{(B)} \geq 0$, so that

$$
  \hat{\rho}_A \otimes \hat{\rho}_B = \sum_{a,b} \lambda_{a,b}^{(A)} \lambda_{a,b}^{(B)} \ket{e_a \otimes f_b} \bra{e_a \otimes f_b}
$$

and since $\lambda_{a,b}^{(A)}\lambda_{a,b}^{(B)} \geq 0$, it follows that $\hat{\rho}_A \otimes\hat{\rho}_B$ is positive.

**Unit trace:** Since $\hat{\rho}_A$ and $\hat{\rho}_B$ have unit trace, it follows that

$$
  \operatorname{tr}(\hat{\rho}_A \otimes\hat{\rho}_B) = \operatorname{tr}(\hat{\rho}_A)\operatorname{tr}(\hat{\rho}_B) = 1
$$
</details>

<MathBox title='Separability criterion for pure states' boxType='theorem' tag='theorem-1'>
A pure state $\ket{\psi}\in\mathcal{H}_A \otimes\mathcal{H}_B$ is separable if and only if there exists pure states $\ket{\varphi}\in\mathcal{H}_A$ and $\ket{\psi}\in\mathcal{H}_B$ such that

$$
\begin{equation*}
  \ket{\Psi} = \ket{\varphi}\otimes\ket{\psi}
\tag{\label{equation-113}}
\end{equation*}
$$

Otherwise, $\ket{\psi}$ is entangled.

<details>
<summary>Proof</summary>

**Sufficiency**

First we show that $\eqref{equation-113}$ is sufficient for separability. Suppose we have $\ket{\Psi} = \ket{\varphi}\otimes\ket{\psi} \in\mathcal{H}_A \otimes\mathcal{H}_B$. Then it follows that

$$
\begin{align*}
  \hat{\rho}(\Psi) =& \ket{\Psi}\bra{\Psi} = \ket{\varphi\otimes\psi}\bra{\varphi\otimes\psi} \\
  =& \ket{\psi}\bra{\psi} \otimes\ket{\varphi}\bra{\varphi}
\end{align*}
$$

Setting $\hat{\rho}^A = \ket{\varphi}\bra{\varphi}$ and $\hat{\rho}^B = \ket{\psi}\bra{\psi}$, we see that $\eqref{equation-113}$ holds.

**Necessity**
To show that $\eqref{equation-113}$ is also necessary, let $\hat{\rho}$ be a pure separable state. Then its density matrix $\hat{\rho} = \ket{\Psi}\bra{\Psi}$ must be of the form

$$
  \hat{\rho} = \sum_{j\in I} p_j \hat{\rho}_j^{(A)} \otimes \hat{\rho}_j^{(B)}, \; I\subset\N_+
$$

where $p_j > 0$ with $\sum_{j\in I} p_j = 1$, and $\hat{\rho}_j^{(A)}\in\mathcal{D}(\mathcal{H}_A)$, $\hat{\rho}_j^{(B)}\in\mathcal{D}(\mathcal{H}_B)$.

We show that there exists $\ket{\varphi}\in\mathcal{H}_A$ and $\ket{\psi}\in\mathcal{H}_B$ such that $\ket{\Psi} = \ket{\varphi}\otimes\ket{\psi}$. For all $j\in I$ we set

$$
  \hat{\rho}_j = \hat{\rho}_j^{(A)} \otimes\hat{\rho}_j^{(B)} \in\mathcal{D}(\mathcal{H}_A \otimes\mathcal{H}_B)
$$

which define density operators in $\mathcal{H}_A \otimes \mathcal{H}_B$. From properties of density operators, there exists $p_{j,k}\in (0,1]$ for every $j\in I$ with $k \in I_j \subset \N_+$ satisfying $\sum_{k\in I_j} p_{j,k} = 1$, and an orthonormal basis $\set{\ket{\Omega_{j,k}}}_{k=1}^{\dim(\mathcal{H}_A \otimes\mathcal{H}_B)}$ of $\mathcal{H}_A \otimes \mathcal{H}_B$ such that

$$
\begin{equation*}
  \hat{\rho}_j = \sum_{k\in I_j} p_{j,k} \ket{\Omega_{j,k}} \bra{\Omega_{j,k}}
\tag{\label{equation-114}}
\end{equation*}
$$

We extend $\ket{\Psi}$ to another orthonormal basis $\set{\ket{\Psi}, \ket{\Psi_l}}_{l=1}^{\dim(\mathcal{H}_A \otimes\mathcal{H}_B) - 1}$ of $\mathcal{H}_A \otimes\mathcal{H}_B$. It follows that

$$
  0 = |\braket{\Psi_l|\Psi}|^2 = \braket{\Psi_l|\hat{\rho}|\Psi_l} = \sum_{j\in I} p_j \braket{\Psi_l|\hat{\rho}_j|\Psi_l}
$$

and since $p_j > 0$, we must have $\braket{\Psi_l|\hat{\rho}_j|\Psi_l} = 0$ for all $j\in I$ and $l\in\set{1,dots,\dim(\mathcal{H}_A \otimes \mathcal{H}_B) - 1}$. Together with $\eqref{equation-114}$ this implies

$$
  \sum_{k\in I_j} p_{j,k} |\braket{\Psi_l |\Omega_{j,k}}|^2 = 0
$$

and thus, again because $p_{j,k} > 0$ for all $l\in\set{1,\dots,\dim(\mathcal{H}_A \otimes \mathcal{H}_B - 1)}$, $j\in I$ and $k\in I_j$, we have

$$
  \braket{\Psi|\Omega_{j,k}} = 0
$$

Thus, for every $j\in I$ and $k\in I_j$ the basis vector $\ket{\Omega_{j,k}}$ is orthogonal to all $\ket{\Psi_l}$. Consequently, every $\ket{\Psi_{j,k}}$ is in the ray of $\ket{\Psi}$ and there exist $\alpha_{j,k} \in\R$ such that

$$
  \ket{\Omega_{j,k}} = e^{i\alpha_{j,k}} \ket{\Psi}
$$

This implies

$$
\begin{align*}
  \hat{\rho}_j^{(A)} \otimes\hat{\rho}_j^{(B)} =& \hat{\rho}_j = \sum_{k \in I_j} p_{j,k} e^{i\alpha_{j,k}} \ket{\Psi}\bra{\Psi} e^{-i\alpha_{j,k}} \\
  =& \underbrace{\sum_{k\in I_j} p_{j,k}}_{=1} \ket{\Psi}\bra{Psi} = \ket{\Psi}\bra{\Psi} \\
  =& \hat{\rho}
\end{align*}
$$

and thus there are $\hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)$ and $\hat{\rho}_B \in\mathcal{H}_B$ such that for all $j\in I$

$$
  \hat{\rho}_j = \hat{\rho}_A \otimes\hat{\rho}_B = \hat{\rho}
$$

Using the Schmidt decomposition, we can find $q_a \in (0,1]$ and orthonormal bases $\set{e_a}_{a=1}^{\dim(\mathcal{H}_A)}$ and $\set{f_b}_{b=1}^{\dim(\mathcal{H}_B)}$ such that we can write

$$
\begin{equation*}
  \ket{\Psi} = \sum_a \sqrt{q_a} \ket{e_a} \otimes\ket{f_b}
\tag{\label{equation-115}}
\end{equation*}
$$

This implies

$$
\begin{align*}
  \hat{\rho}_A \otimes\hat{\rho}_B =& \hat{\rho} = \ket{\Psi}\bra{\Psi} \\
  =& \sum_{a,b} \sqrt{q_a q_b} \ket{e_a}\bra{e_a} \otimes \ket{f_b} \bra{f_b}
\end{align*}
$$

such that in the orthonormal basis $\set{\ket{e_a}\otimes\ket{f_b}}$ of $\mathcal{H}_A \otimes\mathcal{H}_B$ we see that $\hat{\rho}$ has the matrix

$$
\begin{align*}
  \boldsymbol{\rho}_{a_1 a_2}^{(A)} \boldsymbol{\rho}_{b_1 b_2}^{(B)} = \mathbf{\rho}_{a_1 b_1, a_2 b_2} \\
  =& \sqrt{q_{a_1} q_{a_2}} \delta_{a_1 b_1} \delta_{a_2 b_2}
\end{align*}
$$

From this it follows that

$$
\begin{equation*}
\begin{split}
  \hat{\rho}_A =& \operatorname{tr}_B (\hat{\rho}) = \sum_a q_a \ket{e_a}\bra{e_a} \\
  \hat{\rho}_B =& \operatorname{tr}_A (\hat{\rho}) = \sum_b q_b \ket{f_b}\bra{f_b}
\end{split}
\tag{\label{equation-118}}
\end{equation*}
$$

Now, by unit trace of $\hat{\rho}$

$$
\begin{align*}
  1 =& \operatorname{tr}(\hat{\rho}) = \operatorname{tr}(\hat{\rho}^2) \\
  =& \operatorname{tr}(\hat{\rho}_A^2 \otimes \hat{\rho}_B^2) \\
  =& \sum_{c, d} \braket{e_c \otimes f_d |\sum_{a,b} q_a^2 q_b^2 \ket{e_a \otimes f_b} \bra{e_a \otimes f_b} | e_c \otimes f_d} \\
  =& \sum_{a, b, c, d} q_a^2 q_b^2 \delta_{ca} \delta_{db} = \sum_{a,b} q_a^2 q_b^2 \\
  =& \left(\sum_a q_a^2 \right)^2 \tag{\label{equation-116}}
\end{align*}
$$

where $q_a \in [0,1]$ for all $a$. On the other hand, it follows from $\eqref{equation-115}$ that

$$
\begin{equation*}
  \sum_a q_a = \norm{\Psi} = 1
\tag{\label{equation-117}}
\end{equation*}
$$

Together, $\eqref{equation-116}$ and $\eqref{equation-117}$ imply that there can be only on $\bar{a} = 1$ with $q_{\bar{a}} = 1$ and else $q_a = 0$ for all $a \neq \bar{a}$ must hold. Consequently, $\eqref{equation-118}$ becomes

$$
  \hat{\rho}_A = \ket{e_{\bar{a}}} \bra{e_{\bar{a}}}, \quad \hat{\rho}_B = \ket{f_{\bar{a}}}\bra{f_{\bar{a}}}
$$

and $\eqref{equation-115}$ implies $\ket{\Psi} = \ket{e_{\bar{a}}}\otimes\ket{f_{\bar{a}}}$.
</details>
</MathBox>

<MathBox title='Separability criterion for pure states' boxType='theorem'>
A pure state $\ket{\Psi}\in\mathcal{H}_A \otimes\mathcal{H}_B$ is separable if and only if $\hat{\rho}_X (\Psi)$ is pure for all $X\in\set{A,B}$. Or, equivalently, $\ket{\Psi}$ is entangled if and only if $\hat{\rho}_X (\Psi)$ is a true mixture for any $X\in\set{A,B}$.

<details>
<summary>Proof</summary>

It suffices to prove only the first statement, since the second is equivalent.

**($\implies$):** Let $\ket{\Psi}$ be separable. Then we know from Theorem $\ref{theorem-1}$ that there exist $\ket{\varphi}\in\mathcal{H}_A$ and $\ket{\psi}\in\mathcal{H}_B$ with $\ket{\Psi} = \ket{\varphi}\otimes\ket{\psi}$. Because

$$
\begin{align*}
  1 =& \norm{\Psi} = \sqrt{\braket{\Psi|\Psi}} \\
  =& \sqrt{\braket{\varphi|\varphi}}\sqrt{\braket{\psi|\psi}} \\
  =& \norm{\varphi}\cdot\norm{\psi}
\end{align*}
$$

we must have $\norm{\varphi} \neq 0 \neq \norm{\psi}$. We define the unit vectors $\ket{e_0} := \frac{\ket{\varphi}}{\norm{\varphi}}$ and $\ket{f_0} := \frac{\ket{\psi}}{\norm{\psi}}$ and augment them by suitable vectors in order to form the orthornomal bases

$$
\begin{align*}
  &\Set{\ket{e_0} := \frac{\ket{\varphi}}{\norm{\varphi}}, \ket{e_1}, \dots} \subset\mathcal{H}_A \\
  &\Set{\ket{f_0} := \frac{\ket{\psi}}{\norm{\psi}}, \ket{f_1}, \dots} \subset\mathcal{H}_B \\
\end{align*}
$$

such that

$$
\begin{align*}
  \ket{\Psi} =& \ket{\varphi}\otimes\ket{\psi} \\
  =& \norm{\varphi}\cdot\norm{\psi} \ket{e_0} \otimes\ket{f_0} \\
  =& \sum_{a,b} \Psi_{a,b} \ket{e_a} \otimes\ket{f_b}
\end{align*}
$$

where

$$
  \Psi_{ab} = \begin{cases}
    \norm{\varphi}\cdot\norm{\psi} = 1, \quad& a = 0 = b \\
    0, \quad& \text{else}
  \end{cases}
$$

Thus, we have

$$
\begin{align*}
  \hat{\rho}_A (\Psi) =& \sum_{a_1, a_2, b} \Psi_{a_1 b} \Psi_{a_2 b}^* \ket{e_{a_2}} \bra{e_{a_1}} \\
  =& \norm{\varphi}\cdot\norm{\psi} \ket{e_0} \bra{e_0} \\
  =& \ket{e_0} \bra{e_0}
\end{align*}
$$

which as a rank-one projection onto a one-dimensional subspace is a pure state. Consequently, it satisfies $\hat{\rho}_A (\Psi)^2 = \ket{e_0}\braket{e_0|e_0}\bra{e_0} = \hat{\rho}_A (\Psi)$. Similarly, it follows that $\hat{\rho}_B (\Psi) = \ket{f_0} \bra{f_0}$, proving that $\hat{\rho}_B (\Psi)$ is a pure state as well.

**($\impliedby$):** Let $\hat{\rho}_A (\Psi)$ be a pure state. Then there exists a unit vector $\ket{\varphi}\in\mathcal{H}_A$ such that $\hat{\rho}_A (\Psi) = \ket{\varphi}\bra{\varphi}$. This density operator $\hat{\rho}_A (\Psi)$ has a single eigenvector with eigenvalue $1$ and a degenerate eigenvalue $0$. According to the Schmidt decomposition, the vector $\ket{\Psi}$ then has the form $\ket{\Psi} = \ket{\varphi}\otimes\ket{\psi}$ with unit vectors $\ket{\varphi}\in\mathcal{H}_A$ and $\ket{\psi}\in\mathcal{H}_B$. The same argument apply if $\hat{\rho}_B (\Psi)$ is assumed as a pure state.
</details>
</MathBox>

Two systems $\mathcal{S}_1$ and $\mathcal{S}_2$ are entangled with respect to a certain degree of freedom if their total state $\ket{\Psi}_{12}$, relative to that degree of freedom, cannot be factored into a product of individual states, i.e. $\ket{\Psi}_{12} = \ket{\psi}_1 \otimes\ket{\varphi}_2$.

In simpler terms, an entangled state describes a situation where the quantum state of the entire system cannot be separated into independent states for each subsystem. This means that the subsystems are not probabilistically independent, and the measurement outcomes of one system can affect the other, even when they are spatially separated.

It's important to note that entanglement implies superposition, but the reverse is not true. In other words, while entangled states always involve superposition, not all superpositions are necessarily entangled.

On the other hand, a state $\hat{\rho}$ is separable (i.e., non-entangled) if it can be written as a statistical mixture of product states:

$$
  \hat{\rho} = \sum_j w_j \hat{\rho}_1^{(j)} \otimes \hat{\rho}_2^{(j)}
$$

where $w_j \geq 0$ and $\sum_j w_j = 1$ with the $w_j$ representing probabilities of the different product states $\hat{\rho}_1^{(j)}$ and $\hat{\rho}_2^{(j)}$ for subsystems $\mathcal{S}_1$ and $\mathcal{S}_2$ respectively. In such a separable state, the subsystems are described by independent statistical mixtures, and no non-classical correlations (like entanglement) exist between them.

## Bell basis

The Bell basis forms an orthonormal basis for the four-dimensional Hilbert space ${}^\P \mathcal{H}^{\otimes 2}$ and consists of the Bell states

$$
\begin{align*}
  \ket{\Phi^\pm} :=& \frac{1}{\sqrt{2}} \left(\ket{00} \pm \ket{11}\right) \\
  \ket{\Psi^\pm} :=& \frac{1}{\sqrt{2}} \left(\ket{01} \pm \ket{10}\right) 
\end{align*}
$$

The Bell basis describe a maximally entangled system.

<details>
<summary>Details</summary>

To see that the Bell basis orthonormal we verify that the basis vectors are normalized and orthogonal.

**Normalization**

Computing the norm of $\ket{\Phi^\pm}$

$$
\begin{align*}
  \braket{\Phi^\pm |\Phi^\pm} =& \frac{1}{2} \braket{00 \pm 11|00 \pm 11} \\
  =& \frac{1}{2} \left(\braket{00|00} \pm \braket{11|00} \pm \braket{00|11} + \braket{11|11}\right) \\
  =& \frac{1}{2} (\underbrace{\braket{0|0}}_{=1}\braket{0|0} \pm \underbrace{\braket{1|0}}_{=0} \braket{1|0} \pm \underbrace{\braket{0|1}}_{=0} \braket{0|1} + \underbrace{\braket{1|1}}_{=1} \braket{1|1}) \\
  =& 1
\end{align*}
$$

Computing the norm of $\ket{\Psi^\pm}$

$$
\begin{align*}
  \braket{\Psi^\pm |\Psi^\pm} =& \frac{1}{2} \braket{01 \pm 10|01 \pm 10} \\
  =& \frac{1}{2} \left(\braket{01|01} \pm \braket{01|10} \pm \braket{10|01} + \braket{10|10}\right) \\
  =& \frac{1}{2} (\underbrace{\braket{0|0}\braket{1|1}}_{=1} \pm \underbrace{\braket{0|1} \braket{1|0}}_{=0} \pm \underbrace{\braket{1|0}\braket{0|1}}_{=0} + \underbrace{\braket{1|1}\braket{0|0}}_{=1}) \\
  =& 1
\end{align*}
$$

**Orthogonality**

Computing the inner product of $\braket{\Phi^+|\Phi^-}$

$$
\begin{align*}
  \braket{\Phi^+|\Phi^-} =& \frac{1}{2}\braket{00 + 11|00 - 11} \\
  =& \frac{1}{2}\left(\braket{00|00} - \braket{00|11} + \braket{11|00} - \braket{11|11}\right) \\
  =& \frac{1}{2}(\underbrace{\braket{0|0}\braket{0|0}}_{=1} - \underbrace{\braket{0|1}\braket{0|1}}_{=0} + \underbrace{\braket{1|0}\braket{1|0}}_{=0} - \underbrace{\braket{1|1}\braket{1|1}}_{=1}) \\
  =& 0
\end{align*}
$$

Computing the inner product $\braket{\Psi^+|\Psi^-}$

$$
\begin{align*}
  \braket{\Psi^+|\Psi^-} =& \frac{1}{2}\braket{01 + 10|01 - 10} \\
  =& \frac{1}{2}\left(\braket{01|01} - \braket{01|10} + \braket{10|01} - \braket{10|10}\right) \\
  =& \frac{1}{2}(\underbrace{\braket{0|0}\braket{1|1}}_{=1} - \underbrace{\braket{0|1}\braket{1|0}}_{=0} + \underbrace{\braket{1|0}\braket{0|1}}_{=0} - \underbrace{\braket{1|1}\braket{0|0}}_{=1}) \\
  =& 0
\end{align*}
$$

Computing the inner product $\braket{\Phi^\pm|\Psi^\pm}$

$$
\begin{align*}
  \braket{\Phi^\pm|\Psi^\pm} =& \frac{1}{2}\braket{00 \pm 11|01 \pm 10} \\
  =& \frac{1}{2}\left(\braket{00|01} \pm \braket{00|10} \pm \braket{11|01} + \braket{11|10}\right) \\
  =& \frac{1}{2}(\underbrace{\braket{0|0}\braket{0|1}}_{=0} \pm \underbrace{\braket{0|1}\braket{0|0}}_{=0} \pm \underbrace{\braket{1|0}\braket{1|1}}_{=0} + \underbrace{\braket{1|1}\braket{1|0}}_{=0}) \\
  =& 0
\end{align*}
$$

Computing the inner product of $\braket{\Phi^\mp|\Psi^\pm}$

$$
\begin{align*}
  \braket{\Phi^\mp|\Psi^\pm} =& \frac{1}{2}\braket{00 \mp 11|01 \pm 10} \\
  =& \frac{1}{2}\left(\braket{00|01} \pm \braket{00|10} \mp \braket{11|01} - \braket{11|10}\right) \\
  =& \frac{1}{2}(\underbrace{\braket{0|0}\braket{0|1}}_{=0} \pm \underbrace{\braket{0|1}\braket{0|0}}_{=0} \mp \underbrace{\braket{1|0}\braket{1|1}}_{=0} - \underbrace{\braket{1|1}\braket{1|0}}_{=0}) \\
  =& 0
\end{align*}
$$
</details>

The spin operators $\hat{\sigma}_j^{(A)} \otimes \hat{\sigma}_j^{(B)}$ act on the Bell basis of the composite system ${}^\P \mathcal{H}_{AB} = {}^\P \mathcal{H} \otimes {}^\P \mathcal{H}$ in the following way

$$
\begin{align*}
  (\hat{\sigma}_x \otimes \hat{\sigma}_x) \ket{\Phi^\pm} =& \pm\ket{\Phi}, \quad (\hat{\sigma}_x \otimes \hat{\sigma}_x) \ket{\Psi^\pm} =& \pm\ket{\Psi} \\
  (\hat{\sigma}_x \otimes \hat{\sigma}_y) \ket{\Phi^\pm} =& -\ket{\Phi^\mp}, \quad (\hat{\sigma}_x \otimes \hat{\sigma}_y) \ket{\Psi^\pm} =& \pm\ket{\Psi^\pm} \\
  (\hat{\sigma}_z \otimes \hat{\sigma}_z) \ket{\Phi^\pm} =& \ket{\Phi}, \quad (\hat{\sigma}_z \otimes \hat{\sigma}_z) \ket{\Psi^\pm} =& -\ket{\Psi}
\end{align*}
$$

<details>
<summary>Details</summary>

Calculating $(\hat{\sigma}_x \otimes \hat{\sigma}_x)\ket{\Phi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_x \otimes \hat{\sigma}_x)\ket{\Phi^\pm} =& (\hat{\sigma}_x \otimes \hat{\sigma}_x) \frac{1}{\sqrt{2}}(\ket{00} \pm\ket{11}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_x \otimes \hat{\sigma}_x)(\ket{0} \otimes \ket{0} \pm \ket{1} \otimes \ket{1}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_x \ket{0} \otimes \hat{\sigma}_x \ket{0} \pm \hat{\sigma}_x \ket{1} \otimes \hat{\sigma}_x \ket{1}) \\
  =& \frac{1}{\sqrt{2}} (\ket{1} \otimes \ket{1} \pm \ket{0} \otimes \ket{0}) \\
  =& \frac{1}{\sqrt{2}} (\ket{11}\pm\ket{00}) = \pm\ket{\Phi}
\end{align*}
$$

Calculating $(\hat{\sigma}_x \otimes \hat{\sigma}_x)\ket{\Psi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_x \otimes \hat{\sigma}_x)\ket{\Psi^\pm} =& (\hat{\sigma}_x \otimes \hat{\sigma}_x) \frac{1}{\sqrt{2}}(\ket{01} \pm\ket{10}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_x \otimes \hat{\sigma}_x)(\ket{0} \otimes \ket{1} \pm \ket{1} \otimes \ket{0}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_x \ket{0} \otimes \hat{\sigma}_x \ket{1} \pm \hat{\sigma}_x \ket{1} \otimes \hat{\sigma}_x \ket{0}) \\
  =& \frac{1}{\sqrt{2}} (\ket{1} \otimes \ket{0} \pm \ket{0} \otimes \ket{1}) \\
  =& \frac{1}{\sqrt{2}} (\ket{10}\pm\ket{01}) = \pm\ket{\Phi^\pm}
\end{align*}
$$

Calculating $(\hat{\sigma}_y \otimes \hat{\sigma}_y)\ket{\Phi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_y \otimes \hat{\sigma}_y)\ket{\Phi^\pm} =& (\hat{\sigma}_y \otimes \hat{\sigma}_y) \frac{1}{\sqrt{2}}(\ket{00} \pm\ket{11}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_y \otimes \hat{\sigma}_y)(\ket{0} \otimes \ket{0} \pm \ket{1} \otimes \ket{1}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_y \ket{0} \otimes \hat{\sigma}_y \ket{0} \pm \hat{\sigma}_y \ket{1} \otimes \hat{\sigma}_y \ket{1}) \\
  =& \frac{1}{\sqrt{2}} [i\ket{1} \otimes i\ket{1} \pm (-i\ket{0}) \otimes (-i\ket{0})] \\
  =& \frac{1}{\sqrt{2}} (-\ket{11} \mp \ket{00}) = -\ket{\Phi^\mp}
\end{align*}
$$

Calculating $(\hat{\sigma}_y \otimes \hat{\sigma}_y)\ket{\Psi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_y \otimes \hat{\sigma}_y)\ket{\Psi^\pm} =& (\hat{\sigma}_y \otimes \hat{\sigma}_y) \frac{1}{\sqrt{2}}(\ket{01} \pm\ket{10}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_y \otimes \hat{\sigma}_y)(\ket{0} \otimes \ket{1} \pm \ket{1} \otimes \ket{0}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_y \ket{0} \otimes \hat{\sigma}_y \ket{1} \pm \hat{\sigma}_y \ket{1} \otimes \hat{\sigma}_y \ket{0}) \\
  =& \frac{1}{\sqrt{2}} [i\ket{1} \otimes (-i\ket{0}) \pm (-i\ket{0}) \otimes i\ket{1}] \\
  =& \frac{1}{\sqrt{2}} (\ket{10} \pm \ket{01}) = \pm\ket{\Psi^\pm}
\end{align*}
$$

Calculating $(\hat{\sigma}_z \otimes \hat{\sigma}_z)\ket{\Phi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_z \otimes \hat{\sigma}_z)\ket{\Psi^\pm} =& (\hat{\sigma}_z \otimes \hat{\sigma}_z) \frac{1}{\sqrt{2}}(\ket{00} \pm\ket{11}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_z \otimes \hat{\sigma}_z)(\ket{0} \otimes \ket{0} \pm \ket{1} \otimes \ket{1}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_z \ket{0} \otimes \hat{\sigma}_z \ket{0} \pm \hat{\sigma}_z \ket{1} \otimes \hat{\sigma}_z \ket{1}) \\
  =& \frac{1}{\sqrt{2}} [\ket{0} \otimes \ket{0} \pm (-\ket{1}) \otimes (-\ket{1})] \\
  =& \frac{1}{\sqrt{2}} (\ket{00} \pm \ket{11}) = \ket{\Psi^\pm}
\end{align*}
$$

Calculating $(\hat{\sigma}_z \otimes \hat{\sigma}_z)\ket{\Psi^\pm}$:

$$
\begin{align*}
  (\hat{\sigma}_z \otimes \hat{\sigma}_z)\ket{\Psi^\pm} =& (\hat{\sigma}_z \otimes \hat{\sigma}_z) \frac{1}{\sqrt{2}}(\ket{01} \pm\ket{10}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_z \otimes \hat{\sigma}_z)(\ket{0} \otimes \ket{1} \pm \ket{1} \otimes \ket{0}) \\
  =& \frac{1}{\sqrt{2}} (\hat{\sigma}_z \ket{0} \otimes \hat{\sigma}_z \ket{1} \pm \hat{\sigma}_z \ket{1} \otimes \hat{\sigma}_z \ket{0}) \\
  =& \frac{1}{\sqrt{2}} [\ket{0} \otimes (-\ket{1}) \pm (-\ket{1}) \otimes \ket{0}] \\
  =& \frac{1}{\sqrt{2}} (-\ket{01} \mp \ket{10}) = -\ket{\Psi^\pm}
\end{align*}
$$
</details>

In the Bell basis, the operators $\hat{\sigma}_x \otimes \hat{\sigma}_x$ and $\hat{\sigma}_z \otimes \hat{\sigma}_z$ have matrix representations

$$
  \hat{\sigma}_x \otimes \hat{\sigma}_x = \left[\begin{smallmatrix} 
    1 & 0 & 0 & 0 \\
    0 & -1 & 0 & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1
  \end{smallmatrix}\right]
  ,\quad 
  \hat{\sigma}_z \otimes \hat{\sigma}_z = \left[\begin{smallmatrix} 
    1 & 0 & 0 & 0 \\
    0 & 1 & 0 & 0 \\
    0 & 0 & -1 & 0 \\
    0 & 0 & 0 & -1
  \end{smallmatrix}\right]
$$

from which it is evident that these operators commute, i.e. $[\hat{\sigma}_x \otimes \hat{\sigma}_x, \hat{\sigma}_z \otimes \hat{\sigma}_z] = 0$.

In a composite system ${}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B$, the Bell basis vectors have partial traces

$$
  \hat{\rho}_A (\Phi^\pm) = \hat{\rho}_A (\Psi^\pm) = \frac{1}{2}(\ket{0}_A \bra{0} + \ket{1}_A \bra{1}) = \frac{1}{2}\hat{I}_A
$$

and

$$
  \hat{\rho}_B (\Phi^\pm) = \hat{\rho}_A (\Psi^\pm) = \frac{1}{2}(\ket{0}_B \bra{0} + \ket{1}_B \bra{1}) = \frac{1}{2}\hat{I}_B
$$

<details>
<summary>Details</summary>

In the Bell basis, the partial trace coefficients are

$$
\begin{align*}
  \Phi_{00}^\pm = \pm\Phi_{11}^\pm = \Psi_{01}^\pm = \pm\Psi_{10}^\pm =& \frac{1}{\sqrt{2}} \\
  \Phi_{01}^\pm = \pm\Phi_{10}^\pm = \Psi_{00}^\pm = \pm\Psi_{11}^\pm =& 0
\end{align*}
$$

The partial trace of $\ket{\Phi^\pm}$ over $\mathcal{H}_X$ for $X\in\set{A,B}$ is

$$
\begin{align*}
  \hat{\rho}_X (\ket{\Phi^\pm}) =& (\overline{\Phi_{00}^\pm} \Phi_{00}^\pm + \underbrace{\overline{\Phi_{01}^\pm} \Phi_{01}^\pm}_{=0}) \ket{0}^X \bra{0} \\
  +& (\overline{\Phi_{00}^\pm} \underbrace{\Phi_{10}^\pm}_{=0} + \underbrace{\overline{\Phi_{01}^\pm}}_{=0} \Phi_{11}^\pm) \ket{1}^X \bra{0} \\
  +& (\underbrace{\overline{\Phi_{10}^\pm}}_{=0} \Phi_{00}^\pm + \overline{\Phi_{11}^\pm} \underbrace{\Phi_{01}^\pm}_{=0}) \ket{0}^X \bra{1} \\
  +& (\underbrace{\overline{\Phi_{10}^\pm} \Phi_{10}^\pm}_{=0} + \overline{\Phi_{11}^\pm} \Phi_{11}) \ket{1}^X \bra{1} \\
  =& \frac{1}{2}(\ket{0}^X \bra{0} + \ket{1}^X \bra{1})
\end{align*}
$$

The partial trace of $\ket{\Psi^\pm}$ over $\mathcal{H}_X$ for $X\in\set{A,B}$ is

$$
\begin{align*}
  \hat{\rho}_X (\ket{\Psi^\pm}) =& (\underbrace{\overline{\Psi_{00}^\pm} \Psi_{00}^\pm}_{=0} + \overline{\Psi_{01}^\pm} \Psi_{01}^\pm) \ket{0}^X \bra{0} \\
  +& (\overline{\underbrace{\Psi_{00}^\pm}}_{=0} \Psi_{10}^\pm + \overline{\Psi_{01}^\pm} \underbrace{\Psi_{11}^\pm}_{=0}) \ket{1}^X \bra{0} \\
  +& (\overline{\Psi_{10}^\pm} \underbrace{\Psi_{00}^\pm}_{=0} + \underbrace{\overline{\Psi_{11}^\pm}}_{=0} \Psi_{01}^\pm) \ket{0}^X \bra{1} \\
  +& (\overline{\Psi_{10}^\pm} \Psi_{10}^\pm + \underbrace{\overline{\Psi_{11}^\pm} \Psi_{11}}_{=0}) \ket{1}^X \bra{1} \\
  =& \frac{1}{2}(\ket{0}^X \bra{0} + \ket{1}^X \bra{1})
\end{align*}
$$
</details>

If $\unitvec{n}\in \mathbb{S}^2 \subset\R^3$ is unit vector, then $\ket{\Psi^-}$ can be expressed as

$$
\begin{equation*}
  \ket{\Psi^-} = \frac{1}{\sqrt{2}}(\ket{\uparrow_{\unitvec{n}}} \otimes \ket{\downarrow_{\unitvec{n}}} - \ket{\downarrow_{\unitvec{n}}} \otimes \ket{\uparrow_{\unitvec{n}}})
\tag{\label{equation-120}}
\end{equation*}
$$

<details>
<summary>Proof</summary>

Recall that in the basis $\Set{\ket{0} = \left[\begin{smallmatrix}1 \\ 0 \end{smallmatrix}\right], \ket{1} = \left[\begin{smallmatrix}0 \\ 1 \end{smallmatrix}\right]}$, a qubit $\ket{\psi}\in {}^\P \mathcal{H} \cong\mathbb{C}^2$ has the general form

$$
  \ket{\psi(\theta,\phi)} := e^{-i\phi/2} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\phi/2} \sin\left(\frac{\theta}{2}\right)
$$

so that

$$
\begin{align*}
  \ket{\uparrow_{\unitvec{n}}} =& e^{-i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right)
  \ket{\downarrow_{\unitvec{n}}} =& -e^{-i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right)
\end{align*}
$$

Thus

$$
\begin{align*}
  &\ket{\uparrow_{\unitvec{n}}} \otimes \ket{\downarrow_{\unitvec{n}}} - \ket{\downarrow_{\unitvec{n}}} \otimes \ket{\uparrow_{\unitvec{n}}} \\
  =& \left[e^{-i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right)\right] \otimes \left[-e^{-i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \right] \\
  &- \left[-e^{-i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right)\right] \otimes \left[e^{-i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \right] \\
  =& e^{-i\varphi} \cos\left(\frac{\theta}{2}\right) \sin\left(\frac{\theta}{2}\right) \ket{00} + \cos^2\left(\frac{\theta}{2}\right) \ket{01} - \sin^2\left(\frac{\theta}{2}\right) \ket{10} + e^{i\varphi} \cos\left(\frac{\theta}{2}\right)\sin\left(\frac{\theta}{2}\right) \ket{11} \\
  &- \left[-e^{-i\varphi} \cos\left(\frac{\theta}{2}\right) \sin\left(\frac{\theta}{2}\right) \ket{00} - \sin^2\left(\frac{\theta}{2}\right) \ket{01} + \cos^2\left(\frac{\theta}{2}\right) \ket{10} + e^{i\varphi} \cos\left(\frac{\theta}{2}\right)\sin\left(\frac{\theta}{2}\right) \ket{11}\right] \\
  =& \left(\sin^2\left(\frac{\theta}{2}\right) + \cos^2\left(\frac{\theta}{2}\right)\right)\ket{01} - \left(\sin^2\left(\frac{\theta}{2}\right) + \cos^2\left(\frac{\theta}{2}\right)\right)\ket{10} \\
  =& \ket{01} - \ket{10} = \sqrt{2}\ket{\Psi^-}
\end{align*}
$$
</details>

## Entanglement swapping

Entanglement swapping is a phenomenon in which quantum systems become entangled without direct interaction between them. This can be illustrated as follows.

Consider a four-qubit state

$$
  \ket{\Phi}_{ABCD} \in {}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B \otimes {}^\P \mathcal{H}_C \otimes {}^\P \mathcal{H}_D =: \mathcal{H}_{ABCD}
$$

prepared as a separable product-state of two entangled two-qubit Bell states $\ket{\Psi^-}_{AB} \in {}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B =: \mathcal{H}_{AB}$ and $\ket{\Psi^-}_{CD} \in {}^\P \mathcal{H}_C \otimes {}^\P \mathcal{H}_D =: \mathcal{H}_{CD}$ such that

$$
\begin{align*}
  \ket{\Phi}_{ABCD} =& \ket{\Psi^-}_{AB} \otimes\ket{\Psi^-}_{CD} \\
  =& \frac{1}{\sqrt{2}}(\ket{01}_{AB} - \ket{10}_{AB}) \otimes \frac{1}{\sqrt{2}}(\ket{01}_{CD} - \ket{10}_{CD}) \\
  =& \frac{1}{2}(\ket{0101} - \ket{0110} - \ket{1001} + \ket{1010}) \\
  =& \frac{1}{2}(\ket{\Psi^+}_{AD} \otimes \ket{\Psi^+}_{BC} - \ket{\Psi^-}^{AD} \otimes \ket{\Psi^-}_{BC} \\
  &- \ket{\Phi^+}_{AD} \otimes \ket{\Phi^+}_{BC} + \ket{\Phi^-}_{AD} \otimes \ket{\Phi^-}_{BC}) 
\end{align*}
$$

Here, systems $A$ and $B$ may have interacted in some way to form the entangled state $\ket{\Psi^-}_{AB}$. Likewise, systems $C$ and $D$ may have interacted to form the entangled state $\ket{\Psi^-}_{CD}$. However, it is possible to prepare the entangled states $\ket{\Psi^-}_{AB}$ and $\ket{\Psi^-}_{CD}$ such that system $A$ has never interacted with either $C$ or $D$. Nevertheless, by suitable measurement in the state $\ket{\Phi}_{ABCD}$ it is possible to create entangled states in the system $AD$ composed of the subsystems $A$ and $D$. 

Since $[\hat{\sigma}_z \otimes \hat{\sigma}_z, \hat{\sigma}_x \otimes \hat{\sigma}_x] = 0$, it follows that the operators

$$
\begin{align*}
  \hat{\Sigma}_z^{(BC)} := \hat{I}_A \otimes \hat{\sigma}_z \otimes \hat{\sigma}_z \otimes \hat{I}_D \\
  \hat{\Sigma}_x^{(BC)} := \hat{I}_A \otimes \hat{\sigma}_x \otimes \hat{\sigma}_x \otimes \hat{I}_D
\end{align*}
$$

commute. Consequently, the corresponding observables, $BC$-spin in the $z$-direction and $BC$-spin in the $x$-direction, can both be measured sharply in a given state. The measurement of the these observables in the state $\ket{\Phi}_{ABCD}$ collapses the $BC$-state state to one of the states $\ket{\Psi^\pm}_{BC}$ or $\ket{\Phi^\pm}_{BC}$, depending on the values observed.

After measurement, the composite system of subsystems $AD$ and $BC$ will always be separable in the Bell basis states in $\mathcal{H}_{AD}$ and $\mathcal{H}_{BC}$. The observed $BC$-state is determined by the pair of measured values for $\hat{\Sigma}_z^{(BC)}$ and $\hat{\Sigma}_x^{(BC)}$, while the qubit-pair $AD$ becomes entangled with the observed $BC$-state. As a result, the qubits $A$ and $D$ are entangled even though they have never interacted directly.

<TableFigure caption="Determination of post-measurement state by measurement of $\hat{\Sigma}_z^{(BC)}$ and $\hat{\Sigma}_x^{(BC)}$ on $\ket{\Phi}_{ABCD}$">
| Measured value of $\hat{\Sigma}_z^{(BC)}$ | Measured value of $\hat{\Sigma}_x^{(BC)}$ | Composite state after measurement | State of subsystem $AD$ after measurement |
| --- | --- | --- | --- |
| $1$ | $1$ | $\ket{\Phi^+}_{AD} \otimes \ket{\Phi^+}_{BC}$ | $\ket{\Phi^+}_{AD}$ |
| $1$ | $-1$ | $\ket{\Phi^-}_{AD} \otimes \ket{\Phi^-}_{BC}$ | $\ket{\Phi^-}_{AD}$ |
| $-1$ | $1$ | $\ket{\Psi^+}_{AD} \otimes \ket{\Psi^+}_{BC}$ | $\ket{\Psi^+}_{AD}$ |
| $-1$ | $-1$ | $\ket{\Phi^-}_{AD} \otimes \ket{\Phi^-}_{BC}$ | $\ket{\Phi^-}_{AD}$ |
</TableFigure>

## Einstein-Podolsky-Rosen (EPR) paradox

In 1935, Albert Einstein, Boris Podolsky and Nathan Rosen (EPR) published a seminal paper arguing that quantum mechanics is incomplete by refuting the following claim:

> **EPR Claim 1:** The quantum mechanical description of a system by its state vector is complete (quantum mechanics is complete).

According to EPR, a physical theory is complete if every element of physical reality has a counterpart in the theory. In other words, physical quantities describing a physical system must correspond to pre-existing elements of reality. In their definition a physical quantity is an element of reality of a system if the value of this quantity can be predicted with certainty without having to interact with the system. From this, they concluded that *incompatible observables* cannot both be elements of reality, because their values cannot be simultaneously predicted with certainty. This statement can be formulated as:

> **EPR Claim 2:** The physical quantities of a system corresponding to two incompatible observables cannot jointly be elements of reality for that system (the values of incompatible observables are not jointly real).

EPR then showed by contraposition that the completeness of a quantum mechanics (*Claim 1*) implies that the values of incompatible observables are not jointly real (*Claim 2*). They argue that if the negation of *Claim 2* were true, the physical quantities corresponding to two incompatible observables of a system were both elements of reality of that system and thus could both be predicted with certainty, implying that quantum mechanics is incomplete, i.e.

$$
  \lnot\text{Claim 2} \implies \lnot\text{Claim 1}
$$

which is logically equivalent to the contraposition

$$
  \text{Claim 1} \implies \text{Claim 2}
$$

EPR then proceeded to prove with the help of entangled states and a 'reasonable definition of reality' that *Claim 1* actually implies the negation *Claim 2*, i.e.

$$
\begin{equation*}
  \text{Claim 1} \implies \lnot\text{Claim 2}
\tag{\label{equation-119}}
\end{equation*}
$$

This contradiction is the EPR paradox. Since both implications cannot be simultaneously true, EPR concluded that *Claim 1* must be false, meaning that quantum mechanics is incomplete. However, repeated experiments have demonstrated that $\eqref{equation-119}$ does not hold, suggesting that the reality of the considered system is 'unreasonable' in the classical sense.

### Bohm's version of the EPR thought experiment

The following is Bohm's version of the EPR thought experiment used prove $\eqref{equation-119}$. Consider a pair of qubits in described by the entangled Bell state in ${}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B$

$$
  \ket{\Phi^+} = \frac{1}{\sqrt{2}} (\ket{\uparrow_{\unitvec{z}}}_A \otimes \ket{\uparrow_{\unitvec{z}}}_B + \ket{\downarrow_{\unitvec{z}}}_A \otimes \ket{\downarrow_{\unitvec{z}}}_B) = \frac{1}{\sqrt{2}}(\ket{00} + \ket{11})
$$

where qubit $A$ is accessible to Alice and qubit $B$ to Bob. Assuming that quantum mechanics is complete (*Claim 1* holds), all predictions can be obtained from the state $\ket{\Phi^+}$. Since

$$
  \ket{\uparrow_{\unitvec{x}}}_A \otimes \ket{\uparrow_{\unitvec{x}}}_B + \ket{\downarrow_{\unitvec{x}}}_A \otimes \ket{\downarrow_{\unitvec{x}}}_B = \ket{00} + \ket{11}
$$

It follows that

$$
\begin{align*}
  \ket{\Phi}^+ =& ket{\uparrow_{\unitvec{z}}}_A \otimes \ket{\uparrow_{\unitvec{z}}}_B + \ket{\downarrow_{\unitvec{z}}}_A \otimes \ket{\downarrow_{\unitvec{z}}}_B \\
  \ket{\uparrow_{\unitvec{x}}}_A \otimes \ket{\uparrow_{\unitvec{x}}}_B + \ket{\downarrow_{\unitvec{x}}}_A \otimes \ket{\downarrow_{\unitvec{x}}}_B
\end{align*}
$$

If Alice measures the observable $\hat{\sigma}_z$ in her subsystem, she effectively measures of $\hat{\sigma}_z \otimes \hat{I}_B$ in the composite system. The eigenvalues of this composite observables are $\pm 1$ with corresponding degenerate eigenspaces

$$
\begin{align*}
  \operatorname{eig}(\hat{\sigma}_z, 1) =& \operatorname{span}\set{\ket{\uparrow_{\unitvec{z}}} \otimes\ket{\psi} : \ket{\psi}\in {}^\P \mathcal{H}_B} \\
  \operatorname{eig}(\hat{\sigma}_z, -1) =& \operatorname{span}\set{\ket{\downarrow_{\unitvec{z}}} \otimes\ket{\psi} : \ket{\psi}\in {}^\P \mathcal{H}_B}
\end{align*}
$$

The projections onto these eigenspaces are

$$
\begin{align*}
  \hat{P}_{z,1} = \ket{\uparrow_{\unitvec{z}}} \bra{\uparrow_{\unitvec{z}}} \otimes \hat{I}_B \\
  \hat{P}_{z,-1} = \ket{\downarrow_{\unitvec{z}}} \bra{\downarrow_{\unitvec{z}}} \otimes \hat{I}_B
\end{align*}
$$

which satisfy

$$
\begin{align*}
  \hat{P}_{z,1} =& \ket{\Phi^+} = \frac{1}{\sqrt{2}}\left((\ket{\uparrow_{\unitvec{z}}}\bra{\uparrow_{\unitvec{z}}}\otimes\hat{I}_B)(\ket{\uparrow_{\unitvec{z}}}\otimes\ket{\uparrow_{\unitvec{z}}} + \ket{\downarrow_{\unitvec{z}}}\otimes\ket{\downarrow_{\unitvec{z}}}) \right) \\
  =& \frac{1}{\sqrt{2}}(\ket{\uparrow_{\unitvec{z}}} \underbrace{\braket{\uparrow_{\unitvec{z}}|\uparrow_{\unitvec{z}}}}_{=1} \otimes \ket{\uparrow_{\unitvec{z}}} + \ket{\uparrow_{\unitvec{z}}}\underbrace{\braket{\uparrow_{\unitvec{z}}|\downarrow_{\unitvec{z}}}}_{=0} \otimes\ket{\downarrow_{\unitvec{z}}}) \\
  =& \frac{1}{\sqrt{2}} \ket{\uparrow_{\unitvec{z}}}\otimes\ket{\uparrow_{\unitvec{z}}}
\end{align*}
$$

and similarly

$$
  \hat{P}_{z,-1} = \ket{\Phi^+} = \frac{1}{\sqrt{2}}\ket{\downarrow_{\unitvec{z}}}\otimes\ket{\downarrow_{\unitvec{z}}}
$$

with norm

$$
  \norm{\hat{P}_{z,\pm 1}} = \frac{1}{\sqrt{2}}
$$

If Alice measures $\hat{\sigma}_z$ in her subsystem and obtains $1$, the composite system collapses to

$$
\begin{align*}
  \ket{\Psi_{z,1}} :=& \frac{\hat{P}_{z,1}\ket{\Phi^+}}{\norm{\hat{P}_{z,1}\ket{\Phi^+}}} \\
  =& \frac{(\ket{\uparrow_{\unitvec{z}}}\bra{\uparrow_{\unitvec{z}}}\otimes\hat{I}_B)\ket{\Phi^+}}{\Norm{(\ket{\uparrow_{\unitvec{z}}}\bra{\uparrow_{\unitvec{z}}}\otimes\hat{I}_B)\ket{\Phi^+}}} \\
  =& \ket{\uparrow_{\unitvec{z}}}\otimes\ket{\uparrow_{\unitvec{z}}}
\end{align*}
$$

This means that Bob's qubit is in state

$$
\begin{align*}
  \hat{\rho}_B (\ket{\Psi_{z,1}}\bra{\Psi_{z,1}}) =& \operatorname{tr}_A (\ket{\Psi_{z,1}}\bra{\Psi_{z,1}}) \\
  =& \operatorname{tr}\left((\ket{\uparrow_{\unitvec{z}}} \otimes \ket{\uparrow_{\unitvec{z}}})(\ket{\uparrow_{\unitvec{z}}} \otimes \ket{\uparrow_{\unitvec{z}}}) \right) \\
  =& \operatorname{tr}\left(\ket{\uparrow_{\unitvec{z}}} \bra{\uparrow_{\unitvec{z}}}\otimes\ket{\uparrow_{\unitvec{z}}}\bra{\uparrow_{\unitvec{z}}}\right) \\
  =& \underbrace{\operatorname{tr}(\ket{\uparrow_{\unitvec{z}}} \bra{\uparrow_{\unitvec{z}}})}_{=1}\ket{\uparrow_{\unitvec{z}}} \bra{\uparrow_{\unitvec{z}}} \\
  =& \ket{\uparrow_{\unitvec{z}}} \bra{\uparrow_{\unitvec{z}}}
\end{align*}
$$

which is the density operator of the pure state $\ket{\uparrow_{\unitvec{z}}}$. Hence, after a measurement of $\hat{\sigma}_z$ in which Alice observes the value $1$, Bob's system has to be in the state $\ket{\uparrow_{\unitvec{z}}}$ with sharp eigenvalue $1$. Analogously, if Alice measures $\hat{\sigma}_z$ on her qubit and observes the value $-1$, then the composite system collapses to

$$
\begin{align*}
  \ket{\Psi_{z,-1}} :=& \frac{\hat{P}_{z,1}\ket{\Phi^+}}{\norm{\hat{P}_{z,1}\ket{\Phi^+}}} \\
  =& \frac{(\ket{\downarrow_{\unitvec{z}}}\bra{\downarrow_{\unitvec{z}}}\otimes\hat{I}_B)\ket{\Phi^+}}{\Norm{(\ket{\downarrow_{\unitvec{z}}}\bra{\downarrow_{\unitvec{z}}}\otimes\hat{I}_B)\ket{\Phi^+}}} \\
  =& \ket{\downarrow_{\unitvec{z}}}\otimes\ket{\downarrow_{\unitvec{z}}}
\end{align*}
$$

In this case, Bob's system has to be in the state $\ket{\downarrow_{\unitvec{z}}}$ with eigenvalue $-1$. Consequently,the spin in $z$-direction is an element of reality for Bob's qubit.

If, however, Alice chooses instead to measure $\hat{\sigma}_x$ and observes the value $1$, then the composite system collpases to 

$$
\begin{align*}
  \ket{\Psi_{x,-1}} :=& \frac{\hat{P}_{x,1}\ket{\Phi^+}}{\norm{\hat{P}_{x,1}\ket{\Phi^+}}} \\
  =& \frac{(\ket{\downarrow_{\unitvec{x}}}\bra{\downarrow_{\unitvec{x}}}\otimes\hat{I}_B)\ket{\Phi^+}}{\Norm{(\ket{\downarrow_{\unitvec{x}}}\bra{\downarrow_{\unitvec{x}}}\otimes\hat{I}_B)\ket{\Phi^+}}} \\
  =& \ket{\downarrow_{\unitvec{x}}}\otimes\ket{\downarrow_{\unitvec{x}}}
\end{align*}
$$

In this case Bob's qubit will be in the state $\ket{\uparrow_{\unitvec{x}}}$ with sharp eigenvalue $1$. Similarly, if Alice measures $\hat{\sigma}_x$ and observes the value $-1$, then Bob's qubit after a measurement will be in the state $\ket{\downarrow_{\unitvec{x}}}$ with sharp eigenvalue $-1$. Thus, if Alice measures $\hat{\sigma}_x$ on her qubit, then for Bob's qubit, the spin in $x$-direction is an element of reality.

Regardless in which direction Alice measures the spin of her qubit, the corresponding spin component of Bob's qubit can always be predicted with certainty. This means that Alice's choice of measuring the spin of her qubit in $z$- or $x$-direction determines whether the spin in $z$- or $x$-direction is an element of its reality for Bob's qubit. Importantly, this also holds when Alice and Bob are separated in such a way that no signal from Alice traveling at the speed of light could inform Bob's qubit of Alice's measurement choice in time. 

EPR argued that noe reasonable definition of reality should permit measurement choices at one loccation to instantenously determine elements of reality at another, spatially separated location. If one accepts this argument then $\eqref{equation-119}$ would be proven, implying that quantum mechanics is incomplete. One resolution could be the existence of hidden variables, additional parameters determining the system's behaviour but not reveal by a quantum state vector.

However, experiments have shown that the physical reality behaves in an 'unreasonable' manner according to EPR's crieria. Specifically, local measurements by Alice do appear to influence Bob's system instantaneously, even though no signal is transmitted. This phenomenon, called quantum non-locality, suggests that nature does not adhere to classical locality constraints, challenging the classical notion of independent reality.

## Bell inequality

Bell's inequality is based on the assumption that the results of spin measurements on two qubits can be represented as discrete random variables of a joint distribution. This implies that the observed spin values are predetermined by hidden variables. However, Bell's inequality is violated for certain entangled states. Consequently, the assumption of a joint distribution for spin values of two qubits in certain entangled states is invalid, which invalidates the equivalent assumption of hidden variables.

Consider a pair of qubits in the Hilbert space ${}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B$ prepared in the Bell state

$$
  \ket{\Psi^-} = \frac{1}{\sqrt{2}}(\ket{01} - \ket{10})
$$

where qubit $A$ is sent to Alice and qubit $B$ to Bob. Alice and Bob can perform a spin measurement in any direction they choose, represented by a unit vector $\unitvec{n}\in\mathbb{S}^2 \subset \R^3$ given by

$$
  \unitvec{n}(\theta, \phi) = \begin{bmatrix} 
    \sin(\theta)\cos(\phi) \\ 
    \sin(\theta)\sin(\phi) \\
    \cos(\theta)
  \end{bmatrix}
$$

On their respective qubits, Alice and Bob measures the observables

$$
\begin{align*}
  \hat{\Sigma}_{\unitvec{n}_A}^{(A)} =& \unitvec{n}_A \cdot\boldsymbol{\sigma} \\
  \hat{\Sigma}_{\unitvec{n}_B}^{(B)} =& \unitvec{n}_B \cdot\boldsymbol{\sigma}
\end{align*}
$$

The respective measurement results, denoted $s_{\unitvec{n}_A}^{(A)}$ and $s_{\unitvec{n}_B}^{(B)}$, are discrete random variables parametrized by $\hat{\mathbf{n}_A}$ and $\hat{\mathbf{n}_B}$, respectively, which can only take values in $\set{\pm 1}$.

The expectation value of the joint measurement $\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}$ in the Bell state $\ket{\Psi^-}$ is given by

$$
\begin{equation*}
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}}_{\Psi^-} = -\unitvec{n}_A \cdot \unitvec{n}_B
\tag{\label{equation-129}}
\end{equation*}
$$

<details>
<summary>Details</summary>

From $\eqref{equation-120}$, we can write $\ket{\Psi^-}$ as

$$
  \ket{\Psi^-} = \frac{1}{\sqrt{2}} (\ket{\uparrow_{\unitvec{n}_A}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \ket{\downarrow_{\unitvec{n}_A}} \otimes \ket{\uparrow_{\unitvec{n}_A}})
$$

with $\hat{\Sigma}_{\unitvec{n}_A}^{(A)} = \unitvec{n}_A \cdot\boldsymbol{\sigma}$ and $\hat{\Sigma}_{\unitvec{n}_B}^{(B)} = \unitvec{n}_B \cdot\boldsymbol{\sigma}$ it then follows that

$$
\begin{align*}
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}}_{\Psi^-} =& \braket{\Psi^- |\unitvec{n}_A \cdot\boldsymbol{\sigma} \otimes \unitvec{n}_B \cdot \boldsymbol{\sigma}|\Psi^-} \\
  =& \frac{1}{\sqrt{2}} \braket{\Psi^- | \underbrace{\unitvec{n}\cdot\boldsymbol{\sigma} \ket{\uparrow}_{\unitvec{n}_A}}_{=\ket{\uparrow_{\unitvec{n}_A}}} \otimes \unitvec{n}_B \cdot\boldsymbol{\sigma} \ket{\downarrow_{\unitvec{n}_A}} - \underbrace{\unitvec{n}_A \cdot \boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}_A}}}_{=-\ket{\downarrow_{\unitvec{n}_A}}} \otimes \unitvec{n}_B \cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{n}_A}}} \\
  =& \frac{1}{\sqrt{2}} \Braket{\Psi^-|(\ket{\uparrow_{\unitvec{n}_A}} \otimes \unitvec{n}_B \cdot\boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}_A}} + \ket{\downarrow_{\unitvec{n}_A}} \otimes \unitvec{n}_B \cdot \ket{\uparrow_{\unitvec{n}_A}})}
\end{align*}
$$

In the last term we can use the identity $\eqref{equation-109}$ to get

$$
\begin{align*}
  \unitvec{n}_B \cdot\boldsymbol{\sigma} \ket{\downarrow_{\unitvec{n}_A}} =& \unitvec{n}_B \cdot (-\unitvec{n}_A \cdot\boldsymbol{\sigma}) \ket{\downarrow_{\unitvec{n}_A}} \\
  =& -(\unitvec{n}_B \cdot\boldsymbol{\sigma})(\unitvec{n}_A \cdot\boldsymbol{\sigma}) \ket{\downarrow_{\unitvec{n}_A}} \\
  =& -\left((\unitvec{n}_B \cdot \unitvec{n}_A)\mathbf{I}_2 + i(\unitvec{n}_A \times \unitvec{n}_B) \cdot \boldsymbol{\sigma} \right)\ket{\downarrow_{\unitvec{n}_A}}
\end{align*}
$$

Analogously, we show that

$$
  \unitvec{n}_B \cdot\boldsymbol{\sigma} \ket{\uparrow_{\unitvec{n}_A}} = \left((\unitvec{n}_B \cdot \unitvec{n}_A)\mathbf{I}_2 + i(\unitvec{n}_A \times \unitvec{n}_B) \cdot \boldsymbol{\sigma} \right)\ket{\uparrow_{\unitvec{n}_A}}
$$

Substituting back gives

$$
\begin{align*}
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}}_{\Psi^-} =& \frac{-\unitvec{n}_B \cdot\unitvec{n}_A}{\sqrt{2}} \Braket{\Psi^-|(\ket{\uparrow_{\unitvec{n}_A}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \ket{\downarrow_{\unitvec{n}_A}} \otimes \ket{\uparrow_{\unitvec{n}_A}})} \\
  &- \frac{i}{\sqrt{2}} \Braket{\Psi^- |(\ket{\uparrow_{\unitvec{n}_A}} \otimes (\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}_A}})} \\
  +& \frac{i}{\sqrt{2}} \Braket{\Psi^- |(\ket{\downarrow_{\unitvec{n}_A}} \otimes (\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{n}_A}})} \\
  =& -\unitvec{n}_B \cdot \unitvec{n}^A \underbrace{\braket{\Psi^-|\Psi^-}}_{=1} \\
  &- \frac{i}{2} \Braket{\ket{\uparrow_{\unitvec{n}_A}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \ket{\downarrow_{\unitvec{n}_A}} \otimes \ket{\uparrow_{\unitvec{n}_A}} | \ket{\uparrow_{\unitvec{n}_A}} \otimes (\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}_A}}} \\
  &+ \frac{i}{2} \Braket{\ket{\uparrow_{\unitvec{n}_A}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \ket{\downarrow_{\unitvec{n}_A}} \otimes \ket{\uparrow_{\unitvec{n}_A}} | \ket{\downarrow_{\unitvec{n}_A}} \otimes (\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{n}_A}}} \\
  =& -\unitvec{n}_B \cdot \unitvec{n}_A \\
  &- \frac{i}{2} \left(\Braket{\ket{\downarrow_{\unitvec{n}_A}}|(\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma} \ket{\downarrow_{\unitvec{n}_A}}} + \Braket{\ket{\uparrow_{\unitvec{n}_A}}|(\unitvec{n}_B \times \unitvec{n}_A)\cdot\boldsymbol{\sigma} \ket{\uparrow_{\unitvec{n}_A}}} \right)
\end{align*}
$$

To prove $\Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}}_{\Psi^-} = -\unitvec{n}_B \cdot \unitvec{n}_A$, we show that in general for $\unitvec{m}, \unitvec{n} \in\mathbb{S}^2 \subset\R^3$

$$
\begin{equation*}
  \braket{\downarrow_{\unitvec{n}} |\unitvec{m} \cdot\boldsymbol{\sigma} |\downarrow_{\unitvec{n}}} + \braket{\uparrow_{\unitvec{n}} |\unitvec{m} \cdot\boldsymbol{\sigma} |\downarrow_{\unitvec{n}}} = 0
\tag{\label{equation-121}}
\end{equation*}
$$

Consider first $\unitvec{m}\cdot\ket{\uparrow_{\unitvec{n}}}$ in the orthonormal basis $\set{\ket{\uparrow_{\unitvec{n}}}, \ket{\downarrow_{\unitvec{n}}}}$:

$$
\begin{equation*}
  \unitvec{m} \cdot\boldsymbol{\sigma} \ket{\uparrow_{\unitvec{n}}} = a_{\unitvec{m}} \ket{\uparrow_{\unitvec{n}}} + b_{\unitvec{m}} \ket{\downarrow_{\unitvec{n}}}
\tag{\label{equation-124}}
\end{equation*}
$$

If $b_{\unitvec{m}} = 0$, it follows that

$$
\begin{equation*}
  \unitvec{m} \cdot \ket{\uparrow_{\unitvec{n}}} = a_{\unitvec{m}} \ket{\uparrow_{\unitvec{n}}}
\tag{\label{equation-122}}
\end{equation*}
$$

and $a_{\unitvec{m}}$ is an eigenvalue of $\unitvec{m}\cdot\boldsymbol{\sigma}$ with eigenvector $\ket{\uparrow_{\unitvec{n}}}$. From $\eqref{equation-109}$, it follows that $(\unitvec{m}\cdot\boldsymbol{\sigma})^2 = \mathbf{I}_2$, and thus the eigenvalues of $\unitvec{m}\cdot\boldsymbol{\sigma}$ are $\pm 1$. The eigenspace for the eigenvalue $-a_{\unitvec{m}}$ is one-dimensional and orthogonal to the eigenvector $\ket{\downarrow_{\unitvec{n}}}$ for the eigenvalue $a_{\unitvec{m}}$. Hence,

$$
\begin{equation*}
  \unitvec{m} \cdot \boldsymbol{\sigma} \ket{\downarrow_{\unitvec{n}}} = -a_{\unitvec{m}} \ket{\downarrow_{\unitvec{n}}}
\tag{\label{equation-123}}
\end{equation*}
$$

and $\eqref{equation-121}$ follows from $\eqref{equation-122}$ and $\eqref{equation-123}$. In case $b_{\unitvec{m}} \neq 0$, we obtain $\eqref{equation-124}$ because of $\braket{\ket{\downarrow_{\unitvec{n}}}|\ket{\uparrow_{\unitvec{n}}}} = 0$ giving

$$
\begin{equation*}
  \braket{\downarrow_{\unitvec{n}}|\unitvec{m}\cdot\boldsymbol{\sigma}|\downarrow_{\unitvec{n}}}
\tag{\label{equation-125}}
\end{equation*}
$$

On the other hand, because of $(\unitvec{m}\cdot\boldsymbol{\sigma})^2 = \mathbf{I}_2$ it follows from $\eqref{equation-124}$ also that

$$
\begin{align*}
  \ket{\uparrow_{\unitvec{n}}} =& a_{\unitvec{m}} \unitvec{m}\cdot\boldsymbol{\sigma} \ket{\uparrow_{\unitvec{n}}} + b_{\unitvec{m}} \unitvec{m}\cdot\boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}}} \\
  =& a_{\unitvec{m}} \left(a_{\unitvec{m}} \ket{\uparrow_{\unitvec{n}}} + b_{\unitvec{m}} \right) + b_{\unitvec{m}} \unitvec{m}\cdot\boldsymbol{\sigma}\ket{\downarrow_{\unitvec{n}}}
\end{align*}
$$

Taking the inner product on both side with $\bra{\downarrow_{\unitvec{n}}}$ yields

$$
\begin{equation*}
  \braket{\downarrow_{\unitvec{n}}|\unitvec{m}\cdot\boldsymbol{\sigma}|\downarrow_{\unitvec{n}}} = -a_{\unitvec{m}}
\tag{\label{equation-126}}
\end{equation*}
$$

since $\braket{\downarrow_{\unitvec{n}}|\uparrow_{\unitvec{n}}} = 0$. From $\eqref{equation-125}$ and $\eqref{equation-126}$ follows $\eqref{equation-121}$.
</details>

In particular, when Alice and Bob measure along the same direction $\unitvec{n}_A = \unitvec{n} = \unitvec{n}_B$, the expectation value becomes

$$
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_B}^{(B)}}_{\Psi^-} = -1
$$

Now, suppose now that the properties of each qubit are determined by a hidden variable $\omega\in\Omega$. We assume that this hidden variable provides a complete description of the qubits, meaning that the measured spin values $s_{\unitvec{n}_A}^{(A)} (\omega)$ and $s_{\unitvec{n}_B}^{(B)} (\omega)$ in any directions $\unitvec{n}_A$ and $\unitvec{n}_B$ are fully determined by $\omega$. 

If Alice knew the value of $\omega$ for her qubit, she could determine the function $s_{\unitvec{n}_A}^{(A)} (\omega)$ by sufficient measurements, thereby predicting the result of spin measurements on her qubit. The same applies for Bob. However, since $\omega$ is uknown, it is referred to as a hidden variable. We assume that each value of $\omega\in\Omega$ occurs with a probability $0 \leq \mathbb{P}(\omega) \leq 1$, satisfying

$$
  \mathbb{P}(\Omega) = \sum_\Omega \d\mathbb{P}(\omega) = 1
$$

Altogether, this means that the spin measurement values $s_{\unitvec{n}_A}^{(A)}$ and $s_{\unitvec{n}_B}^{(B)}$ are random variables on a probability space $(\Omega, \mathscr{A}, \mathbb{P})$, parametrized by unit vectors $\unitvec{n}_A$ and $\unitvec{n}_B$. These random variables depend on the quantum state, which in our case is $\ket{\Psi^-}$. Since we consider $s_{\unitvec{n}_A}^{(A)}$ and $s_{\unitvec{n}_B}^{(B)}$ as the measured spin values for the particles in the state $\ket{\Psi^-}$, we require that their expectation value satisfies

$$
  \mathbb{E}(s_{\unitvec{n}_A}^{(A)} s_{\unitvec{n}_B}^{(B)}) = \sum_{(s_1,s_2)\in\set{\pm 1, \pm 1}} s_1 s_2 \mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = s_1 \land s_{\unitvec{n}_B}^{(B)} = s_2} = -1
$$

<MathBox title="Bell's inequality" boxType='theorem'>
Let $s_{\unitvec{n}}^{(A)}$ and $s_{\unitvec{n}}^{(B)}$ be two discrete random variables on a probability space $(\Omega,\mathscr{A},\mathbb{P})$ that are parametrized by unit vectors $\unitvec{n}\in\R^3$ and take values in $\set{\pm 1}$, i.e. for $X \in \set{A,B}$

$$
\begin{align*}
  s^{(X)} : \mathbb{S}^2 \times \Omega \to& \set{\pm 1} \\
  (\unitvec{n}, \omega) \mapsto& s_{\unitvec{n}}^{(X)}
\end{align*}
$$

and which additionally satisfy

$$
\begin{equation*}
  \mathbb{E}\left(s_{\unitvec{n}}^{(A)} s_{\unitvec{n}}^{(B)}\right) = -1,\; \forall \unitvec{n}\in\mathbb{S}^2 \subset\R^3
\tag{\label{equation-127}}
\end{equation*}
$$

Then for arbitrary unit vectors $\unitvec{n}^{(i)}$ with $i\in\set{1,2,3}$ the Bell inequality

$$
\begin{equation*}
  \left|\mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(B)}\right) - \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(B)}\right)\right| - \mathbb{E}\left(s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(B)}\right) \leq 1
\tag{\label{equation-128}}
\end{equation*}
$$

holds.

<details>
<summary>Proof</summary>

From $\eqref{equation-127}$ it follows for arbitrary directions $\unitvec{n}$ that

$$
\begin{align*}
  -1 =& \mathbb{E}\left(s_{\unitvec{n}}^{(A)} s_{\unitvec{n}}^{(B)}\right) = \underbrace{\mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = s_{\unitvec{n}}^{(B)}}}_{1 - \mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = -s_{\unitvec{n}}^{(B)}}} - \mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = -s_{\unitvec{n}}^{(B)}} \\
  =& 1 - 2\mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = -s_{\unitvec{n}}^{(B)}}
\end{align*}
$$

and thus

$$
  \mathbb{P}\Set{s_{\unitvec{n}}^{(A)} = -s_{\unitvec{n}}^{(B)}} = 1
$$

Furthermore, we get

$$
\begin{align*}
  \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(B)}\right) - \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(B)}\right) =& -\mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)}\right) + \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)}\right) \\
  =& \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} (s_{\unitvec{n}^{(3)}}^{(A)} - s_{\unitvec{n}^{(2)}}^{(A)})\right) \\
  \underbrace{=}_{(s_{\unitvec{n}^{(2)}}^{(A)})^2 = 1}& \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} \left[(s_{\unitvec{n}^{(3)}}^{(A)})^2 s_{\unitvec{n}^{(2)}}^{(A)} - s_{\unitvec{n}^{(2)}}^{(A)}\right]\right) \\
  =& \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)} (s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)} - 1)\right)
\end{align*}
$$

This implies the claimed inequality as follows:

$$
\begin{align*}
  \left|\mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(B)}\right) - \mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(B)}\right)\right| =& \left|\mathbb{E}\left(s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)} (s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)} - 1 )\right)\right| \\
  \leq& \mathbb{E}\left(\left|s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)} (s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)} - 1)\right|\right) \\
  =& \mathbb{E}\left(\left|s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)}\right|\cdot\left|s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)} - 1)\right|\right) \\
  \underbrace{=}_{|s_{\unitvec{n}^{(1)}}^{(A)} s_{\unitvec{n}^{(2)}}^{(A)}| = 1}& \mathbb{E}\left(\left|1 - s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)}\right|\right) \\
  \underbrace{=}_{s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)} \leq 1}& \mathbb{E}\left(1 - s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)}\right) \\
  =& 1 - \mathbb{E}\left(s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(A)}\right) \\
  =& 1 + \mathbb{E}\left(s_{\unitvec{n}^{(2)}}^{(A)} s_{\unitvec{n}^{(3)}}^{(B)}\right)
\end{align*}
$$
</details>
</MathBox>

If we measure the spin in the directions

$$
  \unitvec{n}^{(1)} = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \quad \unitvec{n}^{(2)} = \begin{bmatrix} \frac{1}{\sqrt{2}} \\ 0 \\ \frac{1}{\sqrt{2}} \end{bmatrix}, \quad \unitvec{n}^{(3)} = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}
$$

and substitute the corresponding quantum mechanical expectation values into $\eqref{equation-128}$, we obtain

$$
\begin{align*}
  &\left| \Braket{\hat{\Sigma}_{\unitvec{n}^{(1)}}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}^{(2)}}^{(B)}}_{\Psi^-} - \Braket{\hat{\Sigma}_{\unitvec{n}^{(1)}}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}^{(3)}}^{(B)}}_{\Psi^-}  \right| - \Braket{\hat{\Sigma}_{\unitvec{n}^{(2)}}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}^{(3)}}^{(B)}}_{\Psi^-} \\
  =& |\unitvec{n}^{(1)} \cdot \unitvec{n}^{(3)} - \unitvec{n}^{(1)} \cdot \unitvec{n}^{(3)}| + \unitvec{n}^{(2)} \cdot \unitvec{n}^{(3)} \\
  =& \left|-\frac{1}{\sqrt{2}}\right| + \frac{1}{\sqrt{2}} = \sqrt{2} > 1
\end{align*}
$$

which means that quantum mechanics predicts a violation of the Bell inequality for the state $\ket{\Psi^-}$ in the given directions.

Since hidden variable theories rely on joint probability distributions, it is natural to analyze correlations. For arbitrary unitvectors $\unitvec{n}_A$ and $\unitvec{n}_B$ we find that

$$
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{I}_B}_{\Psi^-} = 0 = \Braket{\hat{I}_A \otimes \hat{\Sigma}_{\unitvec{n}_A}^{(A)}}
$$

<details>
<summary>Proof</summary>

From $\eqref{equation-120}$, we express $\ket{\Psi^-}$ in terms of the basis defined by $\unitvec{n} = \unitvec{n}_A$

$$
  \ket{\Psi^-} = \frac{1}{\sqrt{2}} = \frac{1}{\sqrt{2}} (\ket{\uparrow_{\unitvec{n}_A}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \ket{\downarrow_{\unitvec{n}_A}} \otimes \ket{\uparrow_{\unitvec{n}_A}})
$$

With $\hat{\Sigma}_{\unitvec{n}_A}^{(A)} = \unitvec{n}_A \cdot\boldsymbol{\sigma}$ we have

$$
\begin{align*}
  \Braket{\hat{\Sigma}_{\unitvec{n}_A}^{(A)} \otimes \hat{I}_B}_{\Psi^-} =& \braket{\Psi^- |\unitvec{n}_A \cdot\boldsymbol{\sigma} \otimes \hat{I}_B |\Psi^-} \\
  =& \frac{1}{\sqrt{2}} \braket{\Psi^-|\underbrace{\unitvec{n}_A \cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{n}_A}}}_{=\ket{\uparrow_{\unitvec{n}_A}}} \otimes \ket{\downarrow_{\unitvec{n}_A}} - \underbrace{\unitvec{n}_A \cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{n}_A}}}_{=-\ket{\downarrow_{\unitvec{n}_A}}} \otimes \ket{\uparrow_{\unitvec{n}_A}}} \\
  =& \frac{1}{\sqrt{2}} \braket{\Psi^-| \uparrow_{\unitvec{n}_A} \otimes \downarrow_{\unitvec{n}_A} + \downarrow_{\unitvec{n}_A} \otimes \uparrow_{\unitvec{n}_A}} \\
  =& \frac{1}{2} \braket{\uparrow_{\unitvec{n}_A} \otimes \downarrow_{\unitvec{n}_A} - \downarrow_{\unitvec{n}_A} \otimes \uparrow_{\unitvec{n}_A} | \uparrow_{\unitvec{n}_A} \otimes \downarrow_{\unitvec{n}_A} + \downarrow_{\unitvec{n}_A} \otimes \uparrow_{\unitvec{n}_A}} \\
  =& 0
\end{align*}
$$

where we used $\braket{\uparrow_{\unitvec{n}_A} | \uparrow_{\unitvec{n}_A}} = 1$ and $\braket{\uparrow_{\unitvec{n}_A} | \downarrow_{\unitvec{n}_A}} = 0$ in the last step. A similar argument shows that

$$
  \Braket{\hat{I}_A \otimes \hat{\Sigma}_{\unitvec{n}_A}^{(A)}}_{\Psi^-} = 0
$$
</details>

For the hidden variables $s_{\unitvec{n}_A}^{(A)}$ and $s_{\unitvec{n}_B}^{(B)}$, the corresponding expectation value must satisfy

$$
  \mathbb{E}\left(s_{\unitvec{n}_A}^{(A)}\right) = 0 = \mathbb{E}\left(s_{\unitvec{n}_A}^{(A)}\right)
$$

Thus, the correlation between $s_{\unitvec{n}_A}^{(A)}$ and $s_{\unitvec{n}_B}^{(B)}$ is given by

$$
  \operatorname{cor}\left(s_{\unitvec{n}_A}^{(A)}, s_{\unitvec{n}_A}^{(A)}\right) = \mathbb{E}\left(s_{\unitvec{n}_A}^{(A)}, s_{\unitvec{n}_A}^{(A)}\right)
$$

The correlations arising from entangled states are known as EPR-correlations.

## CHSH generalization of the Bell inequality

Just as the original Bell inequality, the generalization derived by Clause, Horne, Simony and Holt (CHSH) also considers a pair of particles on which individual measurements yielding possible values in $\set{\pm 1}$ can be performed. The key distinction is that, unlike in Bell's original derivation, no requirement of the form $\eqref{equation-127}$ needs to be made. Additionally it establishes an upper bound for expectation values of products of observable single-particle measurements.

Consider a pair of particles, one accessible to Alice and the other to Bob. Unlike in Bell's original formulation, the observables they measure are not restricted to those identified by a direction $\unitvec{n}\in\R^3$. Instead, Alice and Bob can choose their measurement using (possibly multi-dimensional) parameters $\mathbf{p}_A \in P_A$ and $\mathbf{p}_B \in P_B$, respectively. This means they measure respective observables $\hat{S}_{\mathbf{p}_A}^{(A)}$ and $\hat{S}_{\mathbf{p}_B}^{(B)}$, each taking values $\pm 1$. 

Now, suppose each particle is completely described by a hidden variable $\omega\in\Omega$, which determine the measurement outcomes $s_{\mathbf{p}_A}^{(A)}$ and $s_{\mathbf{p}_B}^{(B)}$. These outcomes, corresponding to the chosen measurement settings $\mathbf{p}_A$ and $\mathbf{p}_B$ are treated as parametrized random variables with a joint distribution on a probability space $(\Omega,\mathscr{A},\mathbb{P})$.

<MathBox title='' boxType='lemma' tag='lemma-1'>
Let $s_i: \Omega\to\set{\pm 1}$ for $i\in{1,2,3,4}$ be four discrete random variables on a probability space $(\Omega,\mathscr{A},\mathbb{P})$ that can take only the values in $\set{\pm 1}$. Then the following inequality holds

$$
  \left|\mathbb{E}(s_1 s_2) - \mathbb{E}(s_1 s_3) + \mathbb{E}(s_2 s_3) + \mathbb{E}(s_3 s_4) \right| \leq 2
$$

<details>
<summary>Proof</summary>

Since $s_i (\omega) \in\set{\pm 1}$ for all $\omega\in\Omega$ and $i\in\set{1,2,3,4}$, it follows that either

$$
  s_2 (\omega) - s_3(\omega) \implies s(\omega) + s_3 (\omega) = \pm 2
$$

or

$$
  s_2 (\omega) + s_3(\omega) \implies s(\omega) - s_3 (\omega) = \pm 2
$$

an

$$
  s_1 (\omega) [s_2 (\omega) - s_3 (\omega)] + s_4 (\omega) [s_2 (\omega) + s_3 (\omega)] = \pm 2
$$

This implies

$$
  |s_1 (\omega) [s_2 (\omega) - s_3 (\omega)] + s_4 (\omega) [s_2 (\omega) + s_3 (\omega)]| \leq 2
$$

and by linearity of expectation it follows that

$$
\begin{align*}
  &\left|\mathbb{E}(s_1 s_2) - \mathbb{E}(s_1 s_3) + \mathbb{E}(s_2 s_3) + \mathbb{E}(s_3 s_4) \right| \\
  &=|\mathbb{E}\left(s_1 (\omega) [s_2 (\omega) - s_3 (\omega)] + s_4 (\omega) [s_2 (\omega) + s_3 (\omega)]\right)| \leq 2
\end{align*}
$$
</details>
</MathBox>

<MathBox title='CHSH inequality' boxType='theorem'>
Let $s_\mathbf{p}^{(A)}$ and $s_\mathbf{p}^{(B)}$ be two discrete random variables on a probability space $(\Omega,\mathscr{A},\mathbb{P})$, taking values in $\set{\pm 1}$ and parametrized by $\mathbf{p}\in P$, i.e. for $X \in\set{A,B}$

$$
\begin{align*}
  s^X : P\times\Omega \to& \set{1 \pm} \\
  (\mathbf{p},\omega) \mapsto& s_\mathbf{p}^{(X)}
\end{align*}
$$

Then for arbitrary parameters $\mathbf{p}_1,\dots,\mathbf{p}_4 \in P$ the following generalization of the Bell inequality holds

$$
\begin{equation*}
  \left|\mathbb{E}(s_{\mathbf{p}_1}^{(A)} s_{\mathbf{p}_2}^{(B)}) - \mathbb{E}(s_{\mathbf{p}_1}^{(A)} s_{\mathbf{p}_3}^{(B)}) + \mathbb{E}(s_{\mathbf{p}_4}^{(A)} s_{\mathbf{p}_2}^{(B)}) + \mathbb{E}(s_{\mathbf{p}_4}^{(A)} s_{\mathbf{p}_3}^{(B)}) \right| \leq 2
\tag{\label{equation-130}}
\end{equation*}
$$

<details>
<summary>Proof</summary>

This follows immediately from Lemma $\ref{lemma-1}$ by setting $s_i = s_{\mathbf{p}_i}^{(A)}$ for $i\in\set{1,4}$ and $s_i = s_{\mathbf{p}_i}^{(B)}$ for $i\in\set{2,3}$.
</details>
</MathBox>

Consider two particles in the entangled Bell state $\ket{\Psi^-}$. Let the observables $\hat{S}_{\mathbf{p}_i}^{(X)}$ correspond to the spin observables along directions $\unitvec{n}_X$, defined as

$$
  \hat{\Sigma}_{\unitvec{n}_i}^{(X)} = \unitvec{n}_X \cdot\boldsymbol{\sigma}, \; X\in\set{A,B},\; i\in{1,\dots,4}
$$

We choose measurement directions in the $(x,z)$-plane, given by

$$
  \unitvec{n}_i = \begin{bmatrix} \cos(\nu_i) \\ 0 \\ \sin(\nu_i) \end{bmatrix} \in \mathbb{S}^2, \; i\in\set{1,\dots,4}
$$

From $\eqref{equation-129}$, it follows that

$$
\begin{align*}
  &\Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\Psi^-} - \Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\Psi^-} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\Psi^-} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\Psi^-} \\
  =& -\cos(\nu_1 - \nu_2) + \cos(\nu_1 - \nu_3) - \cos(\nu_4 - \nu_2) - \cos(\nu_4 - \nu_3)
\end{align*}
$$

Choosing the specific directions

$$
  \nu_1 = \frac{3\pi}{4}, \quad \nu_2 = \frac{\pi}{2}, \quad \nu_3 = 0, \quad \nu_4 = \frac{\pi}{4}
$$

we obtain

$$
\begin{equation*}
  \left|\Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\Psi^-} - \Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\Psi^-} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\Psi^-} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\Psi^-}\right| = 2\sqrt{2} > 2
\tag{\label{equation-131}}
\end{equation*}
$$

which contradicts the CHSH inequality $\eqref{equation-130}$. 

### Aspect, Dalibard and Roger experiment

An experiment conducted by Aspect, Dalibard and Roger confirmed the violation of the CHSH inequality. Their setup involved a source emitting two entangled photons via a cascade transition, with one photon sent to Alice and the other to Bob. The photons traveled for approximately $40$ ns before reaching their respective measurement devices. During this travel time
- Alice independently choose to measure either $\hat{\Sigma}_{\unitvec{n}_1}^{(A)}$ or $\hat{\Sigma}_{\unitvec{n}_4}^{(A)}$. The switching time between these observables was at most $10$ ns.
- Bob independently choose to measure either $\hat{\Sigma}_{\unitvec{n}_2}^{(B)}$ or $\hat{\Sigma}_{\unitvec{n}_3}^{(B)}$.

A coincidence filter ensured that only photon pairs originating from the same cascade were considered. The detectors registered one of the two possible outcomes, $\pm 1$, for each photon.

Let $M_{i,j}^{A,B}$ for $i,j\in\set{1,\dots,4}$ be the set of measurements where $\hat{\Sigma}_{\unitvec{n}_i}^{(A)}$ and $\hat{\Sigma}_{\unitvec{n}_j}^{(B)}$ were measured. Define $N_{i,j}^{A,B}$ as the number of such measurements, and let $s_{\unitvec{n}_i}^{(X)} (l)$ for $X\in\set{A,B}$ denote the observed outcome in measurement $l\in M_{i,j}^{A,B}$. The empirical expectation values, denoted $\overline{\hat{\Sigma}_{\unitvec{n}_i}^{(A)}\hat{\Sigma}_{\unitvec{n}_j}^{(B)}}$, are computed as

$$
  \overline{\hat{\Sigma}_{\unitvec{n}_i}^{(A)}\hat{\Sigma}_{\unitvec{n}_j}^{(B)}} = \frac{1}{N_{i,j}^{A,B}} \sum_{l\in M_{i,j}^{A,B}} s_{\unitvec{n}_i}^{(A)} (l) s_{\unitvec{n}_j}^{(B)} (l)
$$

Inserting the empirical expectation values $\overline{\hat{\Sigma}_{\unitvec{n}_i}^{(A)}\hat{\Sigma}_{\unitvec{n}_j}^{(B)}}$ as approximations of the quantum mechanical expectation values $\Braket{\hat{\Sigma}_{\unitvec{n}_i}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_j}^{(B)}}_{\Psi^-}$ confirms $\eqref{equation-131}$, and thus the quantum mechanical prediction. However, inserting $\overline{\hat{\Sigma}_{\unitvec{n}_i}^{(A)}\hat{\Sigma}_{\unitvec{n}_j}^{(B)}}$ into the classical expectation $\mathbb{E}[s_{\unitvec{n}_i}^{(A)} s_{\unitvec{n}_j}^{(B)}]$ reveals a violation of the Bell inequality.

Each measurement of $\hat{\Sigma}_{\unitvec{n}_i}^{(X)}$ for $X\in\set{A,B}$ and $i\in\set{1,\dots,4}$ consitently yields a value in $\set{\pm 1}$. It may seem reasonable to assume that these observables always possess definite values before measurement. If that were the case, every pair of observables $(\hat{\Sigma}_{\unitvec{n}_i}^{(A)}, \hat{\Sigma}_{\unitvec{n}_j}^{(B)})$ for $i,j\in\set{1,\dots,4}$ would always predetermined values in $\set{\pm 1, \pm 1}$, thereby ensuring the validity of the CHSH inequality. However, as shown in $\eqref{equation-131}$, this assumption is violated by quantum mechanics.

This contradiction implies that $\hat{\Sigma}_{\unitvec{n}_i}^{(A)}$ and $\hat{\Sigma}_{\unitvec{n}_j}^{(B)}$ cannot simultaneously posess definite values, even though each can be individually measured with definite outcomes. In other words, while these observables yield $\pm 1$ when measured separately, their joint values do not preexist independently of the measurement process.

Quantum mechanics predicts Bell inequality violations only for entangled states and specific measurement directions. For example, in $\ket{\Psi^-}$, if we choose spin measurements along $\unitvec{n}_2 = \unitvec{n}_3$, the quantum mechanical predicition yields $-\sqrt{2}$, satisfying the CHSH inequality. Furthermore, for separable (i.e., non-entangled) states, quantum mechanical predictions always satisfy the Bell inequality.

<MathBox title='' boxType='proposition'>
In any separable state $\ket{\varphi}\otimes\ket{\psi}\in {}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B$ the expectation values of spin observables $\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_1}^{(B)}$ in arbitrary spin directions $\unitvec{n}_i$ with $i\in\set{1,\dots,4}$ satisfy the CHSH variant of the Bell inequality, i.e.

$$
  \left|\Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\varphi\otimes\psi} - \Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\varphi\otimes\psi} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\varphi\otimes\psi} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\varphi\otimes\psi}\right| \leq 2
$$

holds.

<details>
<summary>Proof</summary>

Generally, the expectation values of products of observables $\hat{M}_A \otimes \hat{M}_B$ factorize in separable states $\ket{\varphi}\otimes\ket{\psi} \in {}^\P \mathcal{H}_A \otimes {}^\P \mathcal{H}_B$, i.e.

$$
\begin{align*}
  \braket{\hat{M}_A \otimes \hat{M}_B} =& \braket{\varphi\otimes\psi|\hat{M}_A \otimes \hat{M}_B|\varphi\otimes\psi} \\
  =& \braket{\varphi\otimes\psi|\hat{M}_A \varphi \otimes \hat{M}_B \psi} \\
  =& \braket{\varphi|\hat{M}_A|\varphi}\braket{\psi|\hat{M}_B|\psi} \\
  =& \braket{\hat{M}_A}_\varphi \braket{\hat{M}_B}_\psi \tag{\label{equation-132}}
\end{align*}
$$

An arbitrary state $\ket{\varphi}\in {}^\P \mathcal{H}_A$ can be given in the form

$$
  \ket{\varphi} = e^{i\alpha} \cos(\beta)\ket{0} + e^{i\gamma} \sin(\beta)\ket{1}
$$

The spin-up state for a spin in the direction $\unitvec{n}(\theta,\phi)$ is given by

$$
  \ket{\uparrow_{\unitvec{n}(\theta,\phi)}} = e^{-i\phi/2} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\phi/2} \sin\left(\frac{\theta}{2}\right)\ket{1}
$$

such that we can write $\ket{\varphi}$ with the help of a unit vector $\unitvec{n}_\varphi := \unitvec{n}(2\beta, \frac{\gamma - \alpha}{2})$ in the form

$$
  \ket{\varphi} = e^{i(\alpha + \gamma)/2} \ket{\uparrow_{\unitvec{n}_\varphi}}
$$

The same holds for $\ket{\psi} = e^{i\delta} \ket{\uparrow_{\unitvec{n}_\psi}}$ with suitably chosen $\delta$ and $\unitvec{n}_\psi$.

Next, we show that

$$
\begin{equation*}
  \braket{\hat{\sigma}_{\unitvec{n}}}_{\uparrow_{\unitvec{m}}} = \unitvec{n}\cdot\unitvec{m}
\tag{\label{equation-133}}
\end{equation*}
$$

Since

$$
\begin{align*}
  \hat{\Sigma}_{\unitvec{n}} =& \unitvec{n}\cdot\boldsymbol{\sigma} \\
  \unitvec{m}\cdot\boldsymbol{\sigma}\ket{\uparrow_{\unitvec{m}}} =& \ket{\uparrow_{\unitvec{m}}} \\
  (\unitvec{m}\cdot\boldsymbol{\sigma})^\dagger =& \unitvec{m}\cdot\boldsymbol{\sigma}
\end{align*}
$$

if follows that

$$
\begin{align*}
  \braket{\hat{\sigma}_{\unitvec{n}}}_{\uparrow_{\unitvec{m}}} =& \braket{\uparrow_{\unitvec{m}}|\unitvec{n}\cdot\boldsymbol{\sigma}|\uparrow_{\unitvec{m}}} \\
  =& \frac{1}{2}\left[\Braket{(\unitvec{m}\cdot\boldsymbol{\sigma}) \uparrow_{\unitvec{m}}|(\unitvec{n}\cdot\boldsymbol{\sigma})\uparrow_{\unitvec{m}}} + \Braket{\uparrow_{\unitvec{m}}|(\unitvec{n}\cdot\boldsymbol{\sigma})(\unitvec{m}\cdot\boldsymbol{\sigma})|\uparrow_{\unitvec{m}}}\right] \\
  =& \frac{1}{2}\Braket{\uparrow_{\unitvec{m}}|(\unitvec{m}\cdot\boldsymbol{\sigma})(\unitvec{n}\cdot\boldsymbol{\sigma}) + (\unitvec{n}\cdot\boldsymbol{\sigma})(\unitvec{m}\cdot\boldsymbol{\sigma})|\uparrow_{\unitvec{m}}} \\
  =& \frac{1}{2}\Braket{\uparrow_{\unitvec{m}}|(\unitvec{m}\cdot\unitvec{n})\mathbf{I} + i((\unitvec{m}\times\unitvec{n})\cdot\boldsymbol{\sigma}) + (\unitvec{n}\cdot\unitvec{m})\mathbf{I} + i((\unitvec{n}\times\unitvec{m})\cdot\boldsymbol{\sigma})|\uparrow_{\unitvec{m}}} \\
  =& \unitvec{n}\cdot\unitvec{m} + \frac{i}{2}\braket{\uparrow_{\unitvec{n}}|\underbrace{(\unitvec{m}\times\unitvec{n} + \unitvec{n}\times\unitvec{m})}_{=0} \cdot\boldsymbol{\sigma}|\uparrow_{\unitvec{m}}} \\
  =& \unitvec{n}\cdot\unitvec{m}
\end{align*}
$$

Combining $\eqref{equation-132}$ and $\eqref{equation-133}$ yields

$$
\begin{align*}
  \braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_1}^{(B)}}_{\varphi\otimes\psi} =& \braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)}}_\varphi \braket{\hat{\Sigma}_{\unitvec{n}_1}^{(B)}}_\psi \\
  =& (\unitvec{n}_i \cdot \unitvec{n}_\varphi) (\unitvec{n}_j \cdot \unitvec{n}_\psi)
\end{align*}
$$

and thus

$$
\begin{align*}
  & \left|\Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\varphi\otimes\psi} - \Braket{\hat{\Sigma}_{\unitvec{n}_1}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\varphi\otimes\psi} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_2}^{(B)}}_{\varphi\otimes\psi} + \Braket{\hat{\Sigma}_{\unitvec{n}_4}^{(A)} \otimes \hat{\Sigma}_{\unitvec{n}_3}^{(B)}}_{\varphi\otimes\psi}\right| \\
  =& \left| \unitvec{n}_1 \cdot \unitvec{n}_\varphi (\unitvec{n}_2 \cdot \unitvec{n}_\psi - \unitvec{n}_3 \cdot \unitvec{n}_\psi) + \unitvec{n}_4 \cdot \unitvec{n}_\varphi (\unitvec{n}_2 \cdot \unitvec{n}_\psi - \unitvec{n}_3 \cdot \unitvec{n}_\psi) \right| \\
  \leq& \left| \unitvec{n}_1 \cdot \unitvec{n}_\varphi\right|\cdot \left|\unitvec{n}_2 \cdot \unitvec{n}_\psi - \unitvec{n}_3 \cdot \unitvec{n}_\psi \right| + \left|\unitvec{n}_4 \cdot \unitvec{n}_\varphi\right|\cdot \left|\unitvec{n}_2 \cdot \unitvec{n}_\psi - \unitvec{n}_3 \cdot \unitvec{n}_\psi) \right| \\
  \leq& \left|(\unitvec{n}_2 - \unitvec{n}_3)\cdot\unitvec{n}_\psi \right| + \left|(\unitvec{n}_2 + \unitvec{n}_3)\cdot\unitvec{n}_\psi \right|
\end{align*}
$$

For arbitrary $x,y \in\R$, we have

$$
  |x| + |y| = \begin{cases}
    |x + y|, \quad& xy \geq 0 \\
    |x - y|, \quad& xy < 0
  \end{cases}
$$

and thus

$$
  \left|(\unitvec{n}_2 - \unitvec{n}_3)\cdot\unitvec{n}_\psi \right| + \left|(\unitvec{n}_2 + \unitvec{n}_3)\cdot\unitvec{n}_\psi \right| = 2\max\Set{\left\lvert\unitvec{n}_2 \cdot \unitvec{n}_\psi \right\rvert, \left\lvert\unitvec{n}_3 \cdot \unitvec{n}_\psi \right\rvert} \leq 2
$$
</details>
</MathBox>

## Bell telephone

The seemingly 'unreasonable' behavior of quantum mechanics, where Alice's measurement appears to instantaneously affect the state of Bob's particle—has led some to speculate about the possibility of superluminal communication. This hypothetical communication device, often referred to as the Bell telephone, would allow Alice to send information to Bob faster than the speed of light. However, as we will now show, such a device cannot be used to transmit any information at all, not even at subluminal speeds.

The proposed Bell telephone operates as follows: Suppose Alice and Bob each possess a particle that together form the Bell state $\ket{\Phi^+}$. Alice can choose to measure her particle along different bases, thereby influencing Bob's state. Specifically:
- If Alice measures $\hat{\sigma}_z$, she projects Bob's particle into $\ket{0} = \ket{\uparrow_{\unitvec{z}}}$ or $\ket{1} = \ket{\downarrow_{\unitvec{z}}}$.
- If Alice measures $\hat{\sigma}_x$, she projects Bob's particle into $\ket{+} = \ket{\uparrow_{\unitvec{z}}}$ or $\ket{1} = \ket{\downarrow_{\unitvec{z}}}$.

Alice's idea is to send a message to Bob by encoding bits according to the measurement she performs, as outlined in the table below.

<TableFigure caption="Protocol for the Bell telephone">
| Agreed bit value | Alice measures | Bob's qubit value in the state |
| --- | --- | --- |
| $0$ | $\hat{\sigma}_z$ | $\ket{0}$ or $\ket{1}$ |
| $1$ | $\hat{\sigma}_x$ | $\ket{+}$ or $\ket{-}$ |
</TableFigure>

Bob is supposed to determine the bit Alice intended to send by checking whether his particle is in $\set{\ket{0},\ket{1}}$ or $\set{\ket{+},\ket{-}}$. However, this scheme fails because, from Bob's perspective, his particle is always in a mixed state after Alice's measurement. Mathematically, this mixed state can be expressed using either the $\set{\ket{0},\ket{1}}$ basis or $\set{\ket{+},\ket{-}}$ basis. Regardless of which observable Alice measures, Bob's reduced density matrix remains unchanged. Consequently, Bob has no way of distinguishing between the two cases, meaning he cannot infer the bit Alice intended to send.
 
Bob might attempt to determine the state of his particle by measuring either $\hat{\sigma}_z$ or $\hat{\sigma}_x$. Suppose he measures $\hat{\sigma}_z$ and observes the value $1$. He still cannot conclude that his particle was in state $\ket{0}$, since the probability to observed the value $1$ when measuring $\hat{\sigma}_z$ is also different in the states $\ket{+}$ and $\ket{-}$:

$$
  |\braket{0|+}|^2 = \frac{1}{2} = |\braket{0|-}|^2
$$

Consider a bipartite quantum system where Alice and Bob control subsystems $\mathcal{H}_A$ and $\mathcal{H}_B$, respectively. Alice has access to two distinct observables $\hat{M}_A$ and $\hat{\tilde{M}}_A$, each with a purely discrete spectrum. She encodes the classical bits $0$ nad $1$ by chooseing to measure either $\hat{M}_A$ or $\hat{\tilde{M}}$.

For simplicity, assume that the eigenvalues $\lambda_a \in\sigma(\hat{M}_A)$ and $\tilde{\lambda}_a \in\sigma(\hat{\tilde{M}}_A)$ are all non-degenerate in $\mathcal{H}_A$. The argument extends to degenerate eigenvalues, but with more cumbersome notation.

The observables $\hat{M}_A$ and $\hat{\tilde{M}}_A$ have respective orthonormal eigenbases $\set{\ket{\tilde{e}_a}| \ket{e_a} \in \operatorname{eig}(\hat{M}_A, \lambda_a)}$ and $\set{\ket{\tilde{e}_a}| \ket{\tilde{e}_a} \in \operatorname{eig}(\hat{\tilde{M}}_A, \tilde{\lambda}_a)}$ in $\mathcal{H}_A$, which are related by a unitary transformation $\hat{U}\in\mathcal{U}(\mathcal{H})$ such that

$$
\begin{equation*}
\begin{split}
  \ket{\tilde{e}_a} =& \hat{U}\ket{e_a} \\
  =& \sum_{a_1} \braket{e_{a_1}|\hat{U}|e_{a_1}}\ket{e_{a_1}} \\
  =& \sum_{a_1} \hat{U}_{a_1 a} \ket{e_{a_1}}
\end{split}\
\tag{\label{equation-138}}
\end{equation*}
$$

For Bob's system let $\set{\ket{f_b}}$ be an orthonormal basis of $\mathcal{H}_B$. The composite system $\mathcal{H}_A \otimes \mathcal{H}_B$ has orthornomal eigenbases $\set{\ket{e_a \otimes f_b}}$ corresponding to $\hat{M}_A \otimes \hat{I}_B$, and $\set{\ket{\tilde{e}_a} \otimes \ket{f_b}}$ corresponding to $\hat{\tilde{M}}_A \otimes \hat{I}_B$, so that

$$
\begin{align*}
  (\hat{M}_A \otimes \hat{I}_B) \ket{e_a \otimes f_b} =& \lambda_a \ket{e_a \otimes f_b} \\
  (\hat{\tilde{M}}_M \otimes \hat{I}_B) \ket{\tilde{e}_a \otimes f_b} =& \tilde{\lambda}_a \ket{\tilde{e}_a \otimes f_b}
\end{align*}
$$

such that $\sigma(\hat{M}_A \otimes \hat{I}_B) = \sigma(\hat{M}_A)$ as well as $\sigma(\hat{\tilde{M}}_A \otimes\hat{I}_B) = \sigma(\hat{\tilde{M}}_A)$. As an eigenvalue of the observable $\hat{M}_A \otimes\hat{I}_B$ each of these eigenvalues is $\dim(\mathcal{H}_B)$-fold degenerate, i.e. $\dim[\operatorname{eig}(\hat{M}\times\hat{I}_B), \lambda_A] = \dim(\mathcal{H}_B)$. A general eigenstate of $\hat{M}_A \otimes \hat{I}_B$ is of the form

$$
  \ket{e_a \otimes \varphi} = \sum_b \varphi_b \ket{e_a \otimes f_b}
$$

and similar statements hold for $\hat{\tilde{M}}_A \otimes\hat{I}_B$.

Let the composite system initially be prepared in the pure state

$$
\begin{equation*}
  \ket{\Psi} = \sum_{a,b} \Psi_{ab} \ket{e_a \otimes f_b} = \sum_{a,b} \tilde{\Psi}_{ab} \ket{\tilde{e}_a \otimes f_b}
\tag{\label{equation-137}}
\end{equation*}
$$

If Alice measures $\hat{M}_A$ to send bit $0$, the composite system collapses into

$$
  \hat{\rho}_{\lambda_a} := \frac{\hat{P}_{\lambda_a} \hat{\rho}_\Psi \hat{P}_{\lambda_a}}{\operatorname{tr}(\hat{\rho}\hat{P}_{\lambda_a})}
$$

where $\hat{P}_{\lambda_a} = \ket{e_a} \otimes \bra{e_a}\otimes\hat{I}_B$ is the projector onto the eigenspace $\operatorname{eig}(\hat{M}_A \otimes \hat{I}_B, \lambda_a)$ and $\hat{\rho}_\Psi = \ket{\Psi}\bra{\Psi}$ is the density operator of the original pure state.

The probability to observe $\lambda_a$ and thus to end up in the state $\hat{\rho}_{\lambda_a}$, is given by $\operatorname{tr}(\hat{\rho}\hat{P}_{\lambda_a})$. For an observer unaware of the measurement outcome, including Bob, the post-measurement composite system is then described by the mixed state $\hat{\rho}$ which is a statistical ensemble of state $\hat{\rho}_{\lambda_a}$ each occuring with a probability $\operatorname{tr}(\hat{\rho}\hat{P}_{\lambda_a})$, i.e.

$$
\begin{equation*}
  \hat{\rho} = \sum_a \operatorname{tr}(\hat{\rho}\hat{P}_{\lambda_a}) = \sum_a \hat{P}_{\lambda_a} \hat{\rho}_\Psi \hat{P}_{\lambda_a}
\tag{\label{equation-136}}
\end{equation*}
$$

The mixed state, which describes Bob's sub-system after Alice's measurement of the observable $\hat{M}_A$ is given by the partial trace operator

$$
\begin{equation*}
  \hat{\rho}_B (\hat{\rho}) = \sum_{b_1, b_2} \sum_a \Psi_{ab_1} \Psi_{ab_2}^* \ket{f_{b_1}}\bra{f_{b_1}}
\tag{\label{equation-134}}
\end{equation*}
$$

<details>
<summary>Details</summary>

To derive $\eqref{equation-134}$, we have

$$
\begin{align*}
  \hat{P}_{\lambda_a}\ket{\Psi} =& (\ket{e_a}\bra{e_a} \otimes\hat{I}_B) \sum_{a_1,b} \Psi_{a_1 b} \ket{e_{a_1}} \otimes \ket{f_b} \\
  =& \sum_{a_1, b} \Psi_{a_1 b} \ket{e_a} \underbrace{\braket{e_a|e_{a_1}}}_{=\delta_{aa_1}} \otimes\ket{f_b} \\
  =& \sum_b \Psi_{ab} \ket{e_a} \otimes \ket{f_b} 
\end{align*}
$$

which implies

$$
\begin{align*}
  \hat{P}_{\lambda_a} \ket{\Psi}\bra{\Psi} \hat{P}_{\lambda_a} =& \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \ket{e_a} \otimes \bra{f_{b_1}} \ket{e_{a_1}} \otimes \ket{f_{b_2}} \\
  =& \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \ket{e_a} \bra{e_a} \otimes \ket{f_{b_1}} \bra{f_{b_2}} \tag{\label{equation-135}}
\end{align*}
$$

Inserting $\eqref{equation-135}$ into $\eqref{equation-136}$ yields

$$
  \hat{\rho} = \sum_a \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \ket{e_a}\bra{e_a}\otimes\ket{f_{b_1}}\bra{f_{b_2}}
$$

for the density operator of the composite system. The reduced density operator for the subsystem $\mathcal{H}_B$ is given by

$$
\begin{align*}
  \hat{\rho}_B (\hat{\rho}) =& \operatorname{tr}_A (\hat{\rho}) \\
  =& \operatorname{tr}_A \left( \sum_a \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \ket{e_a}\bra{e_a}\otimes\ket{f_{b_1}}\bra{f_{b_2}} \right) \\
  =& \sum_a \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \operatorname{tr}_A \left(\ket{e_a}\bra{e_a}\otimes\ket{f_{b_1}}\bra{f_{b_2}}\right) \\
  =& \sum_a \sum_{b_1, b_2} \Psi_{ab_1} \Psi_{ab_2}^* \underbrace{\operatorname{tr}(\ket{e_a}\bra{e_a})}_{=1} \ket{f_{b_1}}\bra{f_{b_2}} \\
  =& \sum_{b_1, b_2} \sum_a \Psi_{ab_1} \Psi_{ab_2}^* \ket{f_{b_1}}\bra{f_{b_1}} 
\end{align*}
$$
</details>

Similarly, if Alice measures the observable $\hat{\tilde{M}}_A$ to send bit $1$, Bob's subsystem is in the mixed state

$$
\begin{equation*}
  \hat{\rho}_B (\hat{\tilde{\rho}}) = \sum_{b_1, b_2} \sum_a \tilde{\Psi}_{ab_1} \tilde{\Psi}_{ab_2}^* \ket{f_{b_1}}\bra{f_{b_2}}
\tag{\label{equation-139}}
\end{equation*}
$$

From $\eqref{equation-138}$ and $\eqref{equation-137}$ it follows that

$$
  \Psi_{ab} = \sum_{a_1} \mathbf{U}_{aa_1} \tilde{\Psi}_{a_1 b}
$$

and thus

$$
\begin{align*}
  \sum_a \Psi_{ab_1} \Psi_{ab_2}^* =& \sum_{a, a_1, a_2} \mathbf{U}_{aa_1} \tilde{\Psi}_{a_1 b_1} \mathbf{U}_{aa_2}^* \tilde{\Psi}_{a_2 b_2}^* \\
  =& \sum_{a, a_1, a_2} \mathbf{U}_{aa_1} \mathbf{U}_{a_2 a}^\dagger \tilde{\Psi}_{a_1 b_1} \tilde{\Psi}_{a_2 b_2}^* \\
  =& \sum_{a_1, a_2} \underbrace{(\mathbf{U}^\dagger \mathbf{U})_{a_1 a_1}}_{=\delta_{a_2 a_1}} \tilde{\Psi}_{a_1 b_1} \tilde{\Psi}_{a_2 b_2}^* \\
  =& \sum_a \tilde{\Psi}_{ab_1} \tilde{\Psi}_{ab_2}^* \tag{\label{equation-140}}
\end{align*}
$$

From $\eqref{equation-134}$ and $\eqref{equation-139}$ together with $\eqref{equation-140}$, it follows that

$$
  \hat{\rho}_B (\hat{\rho}) = \hat{\rho}_B (\hat{\tilde{\rho}})
$$

which means that Bob's subsystem is always in the same mixed state regardless of which observable Alice measures. This means that Bob has no way to infer whether Alice intended to send bit $0$ or $1$, proving that classical information cannot be transmitted in this manner.

## Perfect quantum copier

The fact that a quantum-copier does not exist, or as formulated alternatively, that quantum states cannot be cloned, is due to the linear structure of the Hilbert space $\mathcal{H}$ containing the state vectors. Given
- an arbitrary state $\ket{\psi}\in\mathcal{H}$ to be copied and
- a state $\ket{\omega}\in\mathcal{H}$ to emerge as a copy

A quantum copier $\hat{K}$ is a linear transformation that leaves the original state $\ket{\psi}$ unchanged and transforms the white-page state $\ket{\omega}$ such that it becomes the original state $\ket{\psi}$, i.e. $\hat{K}: \mathcal{H}^{\otimes 2}\to \mathcal{H}^{\otimes 2}$ is given by

$$
  \ket{\psi}\otimes\ket{\omega} \mapsto \ket{\psi}\otimes\ket{\psi}
$$

for arbitrary $\ket{\psi}\in\mathcal{H}$ and a given fixed $\ket{\omega}\in\mathcal{H}$.

<MathBox title='Quantum no-cloning theorem' boxType='theorem'>
A quantum copier cannot exist.

<details>
<summary>Proof</summary>

It suffices to consider qubits, i.e. $\mathcal{H} = {}^\P \mathcal{H}$ and the action of a quantum-copier on the qubit-states $\ket{0}$, $\ket{1}$ and $\frac{1}{\sqrt{2}}(\ket{0} + \ket{1})$. Per definition, $\hat{K}$, has to satisfy

$$
\begin{align*}
  \hat{K}(\ket{0}\otimes\ket{\omega}) =& \ket{0}\otimes\ket{0} \\
  \hat{K}(\ket{1}\otimes\ket{\omega}) =& \ket{1}\otimes\ket{1} \\
  \hat{K}\left(\frac{\ket{0} + \ket{1}}{\sqrt{2}} \otimes\ket{\omega}\right) =& \frac{\ket{0} + \ket{1}}{\sqrt{2}}\otimes\frac{\ket{0} + \ket{1}}{\sqrt{2}} \\
\end{align*}
$$

Since $\hat{K}$ is supposed to be linear, we find instead that 

$$
\begin{align*}
  \hat{K}\left(\frac{\ket{0} + \ket{1}}{\sqrt{2}} \otimes\ket{\omega}\right) =& \hat{K}\left(\frac{1}{\sqrt{2}}(\ket{0}\otimes\ket{\omega}) + \frac{1}{\sqrt{2}}(\ket{1}\otimes\ket{\omega})\right) \\
  =& \frac{1}{\sqrt{2}}\left(\hat{K}(\ket{0}\otimes\ket{\omega}) + \hat{K}(\ket{1}\otimes\ket{\omega})\right) \\
  =& \frac{1}{\sqrt{2}} (\ket{0}\otimes\ket{0} + \ket{1}\otimes\ket{1}) \\
  \neq& \frac{\ket{0} + \ket{1}}{\sqrt{2}}\otimes\frac{\ket{0} + \ket{1}}{\sqrt{2}}
\end{align*}
$$
</details>
</MathBox>

It is worth noting that there can be devices that copy particular states. The quantum no-cloning theorem only makes the statement that there is no device which does that for all states.
