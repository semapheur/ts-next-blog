---
title: 'Quantum Information'
subject: 'Physics'
showToc: true
references:
  - book_scherer_2019
  - book_watrous_2018
  - book_wilde_2017
---

# Qubit

<MathBox title='Qubit' boxType='definition'>
A *qubit* is a quantum system described by a two-dimensional Hilbert space, denoted ${}^\P \mathcal{H} \simeq \mathbb{C}^2$, known as the *qubit space*. The information stored in a qubit is described by a unit vector in ${}^\P \mathcal{H}$, which evolves according to the postulates of quantum mechanics. 

Since ${}^\P \mathcal{H}$ is isomorphic to $\mathbb{C}^2$, the standard mathematical representation of a qubit state is a normalized vector in $\mathbb{C}^2$ with orthonormal basis $\set{\ket{0}, \ket{1}}$:

$$
  \ket{\psi} = \alpha\ket{0} + \beta\ket{1}
$$

where $\alpha, \beta\in\mathbb{C}$ satisfy the normalization condition $|\alpha|^2 + |\beta|^2 = 1$.
</MathBox>

The physical realization of a two-dimensional quantum state space is accomplished by restricting the preparation of two-dimensional eigenspaces of a suitably chosen observable. Example of such quantum systems and observables with two-dimensional eigenspaces are

- **Electrons and their spin:** The spin state of an electron is described by a qubit space ${}^\P \mathcal{H} \simeq \mathbb{C}^2$, which have different orthonormal bases corresponding to the eigenstates of different spin operators:
    - Eigenstates of $\boldsymbol{\sigma}_x$ (spin along the $z$-axis)
    $$
      \ket{0} = \ket{\uparrow_{\hat{\mathbf{z}}}}, \quad \ket{1} = \ket{\downarrow_{\hat{\mathbf{z}}}}
    $$
    - Eigenstates of $\boldsymbol{\sigma}_x$ (spin along the $x$-axis)
    $$
    \begin{align*}
      \ket{+} :=& \ket{\uparrow_{\hat{\mathbf{x}}}} = \frac{1}{\sqrt{2}}(\ket{\uparrow_{\hat{\mathbf{z}}}} + \ket{\downarrow_{\hat{\mathbf{z}}}}) \\
      \ket{-} :=& \ket{\uparrow_{\hat{\mathbf{x}}}} = \frac{1}{\sqrt{2}}(\ket{\uparrow_{\hat{\mathbf{z}}}} - \ket{\downarrow_{\hat{\mathbf{z}}}})
    \end{align*}
    $$
    - Eigenstates of $\boldsymbol{\sigma}_y$ (spin along the $y$-axis)
    $$
    \begin{align*}
      \ket{i} :=& \ket{\uparrow_{\hat{\mathbf{y}}}} = \frac{1}{\sqrt{2}}(\ket{\uparrow_{\hat{\mathbf{z}}}} + i\ket{\downarrow_{\hat{\mathbf{z}}}}) \\
      \ket{-i} :=& \ket{\uparrow_{\hat{\mathbf{y}}}} = \frac{1}{\sqrt{2}}(\ket{\uparrow_{\hat{\mathbf{z}}}} - i\ket{\downarrow_{\hat{\mathbf{z}}}})
    \end{align*}
    $$
- **Photons and their polarization**: The polarization of a photon propagating in a fixed direction is described by a two-dimensional vector, known as the Jones vector. This forms a Hilbert space $\mathcal{H}\simeq\mathbb{C}^2$, with different orthonormal bases corresponding to eigenstates of different polarization observables
    - Eigenstates of $\boldsymbol{\sigma}_z$ (horizontal/vertical polarization)
    $$
      \ket{0} = \ket{H}, \quad \ket{1} = \ket{V}
    $$
    where $\ket{H}$ (horizontal polarization) and $\ket{V}$ (vertical polarization) are eigenstates of the operator 
    $$
      \boldsymbol{\sigma}_z = \ket{H}\bra{H} - \ket{V}\bra{V}
    $$
    - Eigenstates of $\boldsymbol{\sigma}_x$ (diagonal polarizer)
    $$
    \begin{align*}
      \ket{+} =& \frac{1}{\sqrt{2}} (\ket{H} + \ket{V}) \\
      \ket{-} =& \frac{1}{\sqrt{2}} (\ket{H} - \ket{V})
    \end{align*}
    $$
    - Eigenstates of $\boldsymbol{\sigma}_y$ (circular polarizer)
    $$
    \begin{align*}
      \ket{R} =& \frac{1}{\sqrt{2}} (\ket{H} + i\ket{V}) \\
      \ket{L} =& \frac{1}{\sqrt{2}} (\ket{H} - i\ket{V})
    \end{align*}
    $$
    where $\ket{R}$ and $\ket{L}$ correspond to right- and left-circular polarization, respectively.

<TableFigure caption="Representation of classical bits by qubits">
| Observed value of $\boldsymbol{\sigma}_z$ | Qubit state | Classical bit value |
| --- | --- | --- |
| $1$ | $\ket{0} = \ket{\uparrow_{\hat{\mathbf{z}}}}$ | $0$ |
| $-1$ | $\ket{1} = \ket{\downarrow_{\hat{\mathbf{z}}}}$ | $1$ |
</TableFigure>

The normalization condition $|a|^2 + |b|^2 = 1$ for a qubit state $\ket{\psi} = a\ket{0} + b\ket{1}$ admits a parametrization of $a,b\in\mathbb{C}$ in terms of real parameters $\alpha,\beta,\theta\in\R$ such that $a = e^{i\alpha} \cos(\theta/2)$ and $b = e^{i\beta} \sin(\theta/2)$. Thus, a qubit state takes the general form

$$
  \ket{\psi} = e^{i\alpha} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\beta} \sin\left(\frac{\theta}{2}\right) \ket{1}
$$

Since global phase factors do not affect quantum states, the physically equivalent representative in the same ray $[\psi]_\sim \in \mathcal{H}\mathrm{P}$ is obtained by factoring out $e^{-(\alpha + beta)/2}$. Defining $\phi = \beta - \alpha$ yields the parametrization

$$
  \ket{\psi(\theta,\phi)} := e^{-i\phi/2} \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\phi/2} \sin\left(\frac{\theta}{2}\right)\ket{1}
$$

which is called the the Bloch sphere representation of a qubit state.

## Observables and eigenstates

To construct an observable that has $\ket{\psi(\theta,\phi)}$ as an eigenstate, we define the Hermitian operator

$$
\begin{equation}
  \mathbf{a}\cdot\boldsymbol{\sigma} := \sum{j=1}^3 a_j \boldsymbol{\sigma}_j = \begin{bmatrix} a_3 & a_1 - ia_2 \\ a_1 + ia_2 & -a_3 \end{bmatrix} \tag{\label{equation-1}}
\end{equation}
$$

where $\boldsymbol{\sigma} = (\boldsymbol{\sigma}_1, \boldsymbol{\sigma}_2, \boldsymbol{\sigma}_3)$ are the Pauli matrices. For a unit vector $\hat{\mathbf{n}}(\theta,\phi)$ on the Bloch sphere

$$
  \hat{\mathbf{n}}(\theta, \phi) = \begin{bmatrix} \sin(\theta)\cos(\phi) \\ \sin(\theta)\cos(\phi) \\ \cos(\theta) \end{bmatrix}
$$

the corresponing operator is

$$
  \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} = \begin{bmatrix}
    \cos\theta & e^{-i\phi} \sin\theta \\
    e^{i\phi} \sin(\theta) & -\cos\theta
  \end{bmatrix}
$$

This represents the spin measurement along direction $\hat{\mathbf{n}}$. Applying it to $\ket{\psi(\theta, \phi)}$ yields

$$
\begin{align*}
  \hat{\mathbf{n}}(\theta, \phi) \cdot\boldsymbol{\sigma} \ket{\psi(\theta, \phi)} =& \begin{bmatrix} \cos\theta & e^{-i\phi} \sin\theta \\ e^{i\phi} \sin\theta & -\cos\theta \end{bmatrix} \cdot \begin{bmatrix} e^{-i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \\ e^{i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \end{bmatrix} \\
  =& \begin{bmatrix} 
    e^{-i\frac{\phi}{2}} \left[\cos(\theta) \cos\left(\frac{\theta}{2}\right) + \sin(\theta)\sin\left(\frac{\phi}{2}\right)\right] \\
    e^{i\frac{\phi}{2}} \left[\sin(\theta) \cos\left(\frac{\theta}{2}\right) - \sin(\theta)\sin\left(\frac{\phi}{2}\right)\right]
  \end{bmatrix} \\
  =& \begin{bmatrix} e^{-i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \\ e^{i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \end{bmatrix} \\
  =& \ket{\psi(\theta, \phi)}
\end{align*}
$$

The state $\ket{\psi(\theta,\phi)}$ is thus the spin-up state $\ket{\uparrow_{\hat{\mathbf{n}}}}$ for spin in the direction $\hat{\mathbf{n}}$. Similarly, the spin-down state is

$$
  \ket{\downarrow_{\hat{\mathbf{n}}}} = \begin{bmatrix} -e^{-i\frac{\phi}{2}} \sin\left(\frac{\theta}{2}\right) \\ e^{i\frac{\phi}{2}} \cos\left(\frac{\theta}{2}\right) \end{bmatrix}
$$

which satisfies

$$
  \hat{\mathbf{n}} \cdot \boldsymbol{\sigma} \ket{\downarrow_{\hat{\mathbf{n}}}} = -\ket{\downarrow_{\hat{\mathbf{n}}}}
$$

In particular, it follows that
- $\hat{\mathbf{n}}(0,0) \cdot\operatorname{\sigma} = \boldsymbol{\sigma}_z$ and $\ket{\uparrow_{\hat{\mathbf{n}}(0,0)}} = \ket{\uparrow_{\hat{\mathbf{z}}}}$
- $\hat{\mathbf{n}}\left(\frac{\pi}{2},0 \right) \cdot\operatorname{\sigma} = \boldsymbol{\sigma}_z$ and $\ket{\uparrow_{\hat{\mathbf{n}}\left(\frac{\pi}{2},0 \right)}} = \ket{\uparrow_{\hat{\mathbf{x}}}}$

The state $\ket{\psi(\theta,\phi)} = \ket{\uparrow_{\hat{\mathbf{n}}}}$ parametrized by $\theta, \phi$, thus represents an arbitrary qubit state on the Bloch sphere, and the operator $\hat{\mathbf{n}}\cdot\boldsymbol{\sigma}$ represents the observable with this state as eigenstate of eigenvalue $1$.

<LatexFigure width={75} src='/fig/bloch_sphere.svg' alt=''
  caption='Bloch representation of a qubit'
>
```latex
\documentclass[tikz]{standalone}
\usepackage{amsmath}
\usepackage{braket}
\usepackage{tikz}
\usepackage{tikz-3dplot}
\usetikzlibrary{3d}

% Set 3D plot view angle
\tdplotsetmaincoords{70}{110}

\def\rvec{3}
\def\thetavec{40}
\def\phivec{60}

\begin{document}

\begin{tikzpicture}[tdplot_main_coords]
  \coordinate (O) at (0,0,0);

  % Shaded ball (not working in svg)
  %\shade[ball color=lightgray, opacity=0.5] (0,0,0) circle (\rvec cm);
  \fill[lightgray!40] (0,0,0) circle (\rvec cm);

  % Axes
  \draw[] (0,0,0) -- (\rvec,0,0);
  \draw[] (0,0,0) -- (0,\rvec,0);
  \draw[] (0,0,0) -- (0,0,\rvec);

  % Great circles
  \draw[canvas is xy plane at z=0, red, dashed] (0,0) circle (\rvec);
  \draw[canvas is zx plane at y=0, green, dashed] (0,0) circle (\rvec);

  % Eigenstates
  \draw plot [mark=*, mark size=1] (0, 0, \rvec) node[anchor=south, shift=({-0.3,0})] {\scriptsize $\ket{0} = \ket{\uparrow_{\hat{\mathbf{z}}}}$};
  \draw plot [mark=*, mark size=1] (0, 0, -\rvec) node[anchor=north, shift=({0.3,0})] {\scriptsize $\ket{1} = \ket{\downarrow_{\hat{\mathbf{z}}}}$};

  \draw plot [mark=*, mark size=1] (0, \rvec, 0) node[anchor=west, shift=({0,0.2})] {\scriptsize $\ket{i} = \ket{\uparrow_{\hat{\mathbf{y}}}}$};
  \draw plot [mark=*, mark size=1] (0, -\rvec, 0) node[anchor=east, shift=({0,-0.2})] {\scriptsize $\ket{-i} = \ket{\downarrow_{\hat{\mathbf{y}}}}$};

  \draw plot [mark=*, mark size=1] (\rvec, 0, 0) node[anchor=north east] {\scriptsize $\ket{+} = \ket{\uparrow_{\hat{\mathbf{x}}}}$};
  \draw plot [mark=*, mark size=1] (-\rvec, 0, 0) node[anchor=south west, shift=({-0.2,0.2})] {\scriptsize $\ket{-} = \ket{\downarrow_{\hat{\mathbf{x}}}}$};

  % Qubit
  \tdplotsetcoord{P}{\rvec}{\thetavec}{\phivec};
  \draw[thick,->,color=blue] (0,0,0) -- (P) node[anchor=south west] {\scriptsize $\ket{\psi} = \ket{\uparrow_{\hat{\mathbf{n}}(\theta,\phi)}}$};
  \draw[dashed, color=blue] (O) -- (Pxy);
  \draw[dashed, color=blue] (P) -- (Pxy);

  \tdplotdrawarc{(O)}{0.3*\rvec}{0}{\phivec}{anchor=north}{$\phi$};

  \tdplotsetthetaplanecoords{\phivec};
  \tdplotdrawarc[tdplot_rotated_coords]{(O)}{0.3*\rvec}{0}{\thetavec}{anchor=south west}{$\theta$};

\end{tikzpicture}

\end{document}
```
</LatexFigure>

### Mixed states

A mixed state of a qubit is represented by a density matrix of the form

$$
  \boldsymbol{\rho}_\mathbf{x} = \frac{1}{2} \begin{bmatrix} 1 + x_3 & x_1 - ix_2 \\ x_1 + ix_2 & 1 - x_3 \end{bmatrix} = \frac{1}{2}(\mathbf{I}_2 + \mathbf{x}\cdot\boldsymbol{\sigma})
$$

where $\mathbf{x}\in\R^3$ is a Bloch vector.

<details>
<summary>Proof</summary>

A general density matrix $\boldsymbol{\rho} \in\mathcal{M}_2 (\mathbb{C})$ has the form

$$
  \boldsymbol{\rho} = \begin{bmatrix} a & b \\ c & d \end{bmatrix}
$$

Since $\boldsymbol{\rho}$ is Hermitian, i.e. $\boldsymbol{\rho}^\dagger = \boldsymbol{\rho}$, it follows that $a, d \in\R$ and $b = c^*$. The trace condition $\operatorname{tr}(\boldsymbol{\rho}) = 1$ implies that $a + d  1$. Thus, we can introduce a real parameter $x_3\in\R$ such that

$$
  a = \frac{1 + x_3}{2}, \quad d = \frac{1 - x_3}{2}
$$

Similarly, defining the real numbers $x_1 = 2\Re(c)$ and $x_2 = 2\Im(c)$, we rewrite $\boldsymbol{\rho}$ as

$$
  \boldsymbol{\rho}_\mathbf{x} = \frac{1}{2} \begin{bmatrix} 1 + x_3 & x_1 - ix_2 \\ x_1 + ix_2 & 1 - x_3 \end{bmatrix}
$$

Using $\eqref{equation-1}$, we can write this succintly as $\operatorname{\rho} = \frac{1}{2}(\mathbf{I}_2 + \mathbf{x}\cdot\boldsymbol{\sigma})$.
</details>

The eigenvalues of $\operatorname{\rho}_\mathbf{x}$ are given by

$$
  q_{1,2} = \frac{1 + \norm{\mathbf{x}}}{2}
$$

<details>
<summary>Details</summary>

The eigenvalues of $\boldsymbol{\rho}$ are found by solving $\det(\boldsymbol{\rho} - q\mathbf{I}_2) = 0$ or in component form

$$
\begin{align*}
  0 =& \frac{1}{2}\begin{vmatrix}
    1 + x_3 - 2q & x_1 - ix_2 \\
    x_1 + ix_2 & 1 - x_3 - 2q
  \end{vmatrix} \\
  =& \left(\frac{1 + x_3}{2} - q \right) \left(\frac{1 - x_3}{2} - q \right) - \left(\frac{x_1 - ix_2}{2}\right) \left(\frac{x_1 + ix_2}{2}\right)
\end{align*}
$$

Expanding the first term gives

$$
\begin{align*}
  \left(\frac{1 + x_3}{2} - q \right) \left(\frac{1 - x_3}{2} - q \right) =& \left(\frac{1 + x_3}{2}\right)\left(\frac{1 - x_3}{2}\right) - q + q^2 \\
  \frac{1 - x_3^2}{4} - q + q^2
\end{align*}
$$

while the second term becomes

$$
  \left(\frac{x_1 - ix_2}{2}\right) \left(\frac{x_1 + ix_2}{2}\right) = \frac{x_1^2 + x_2^2}{4}
$$

Combining the terms gives the quadratic equation

$$
  q^2 - q + \frac{1}{4}(1 - x_3^2 - (x_1^2 + x_2^2)) = q^2 - q -\frac{1}{4}(1 - \norm{\mathbf{x}}^2) = 0
$$

with solutions

$$
  q = \fac{1 \pm \sqrt{1 - (1 - \norm{\mathbf{x}}^2)}}{2} = \frac{1 \pm \norm{x}^2}{2}
$$
</details>

From the positivity of $\boldsymbol{\rho}$, i.e. $\boldsymbol{\rho} \geq 0$, we require $q_{1,2} \geq 0$, which implies $\norm{\mathbf{x}} \leq 1$. This means that the density matrices for mixtures of qubits can be parametrized by vectors $\mathbf{x}$ in the unit ball of $\R^3$, written $\mathbf{x}\in\mathcal{B}_1 (0, \R^3)$. This parametrization is called the Bloch representation. 

Squaring the density matrix $\boldsymbol{\rho}_\mathbf{x}$ gives

$$
  \boldsymbol{\rho}_\mathbf{x}^2 = \frac{1}{4} (\mathbf{I}_2 + \mathbf{x}\cdot\boldsymbol{\sigma}) = \frac{1}{4}[\boldsymbol{I}_2 (1 + \norm{\mathbf{x}}^2) + 2\mathbf{x}\cdot\boldsymbol{\sigma}]
$$

It follows that $\boldsymbol{\rho}_\mathbf{x}^2 = \boldsymbol{\rho}_\mathbf{x}$ if and only if $\norm{\mathbf{x}} = 1$. Thus, states corresponding to bounday points $\norm{\mathbf{x}} = 1$ of the Bloch sphere are pure states, while those inside the Bloch ball, $\norm{\mathbf{x}} < 1$ are mixed states.

The Bloch vector $\mathbf{x}$ characterize a qubit's state by encoding expectation values of the Pauli matrices. Specifically, it is given by

$$
  \mathbf{x} = \operatorname{tr}(\boldsymbol{\rho}_\mathbf{x} \mathbf{\sigma})
$$

<details>
<summary>Proof</summary>

$$
\begin{align*}
  \operatorname{tr}(\boldsymbol{\rho}_\mathbf{x} \boldsymbol{\sigma}_j) =& \operatorname{tr}\left(\frac{1}{2}\left(\mathbf{I}_2 + \mathbf{x}\cdot\boldsymbol{\sigma})\boldsymbol{\sigma}_j \right) \\
  =& \frac{1}{2}\left(\boldsymbol{\sigma}_j + \sum_{k=1}^3 x_k \boldsymbol{\sigma}_k \boldsymbol{\sigma}_j \right) \\
  =& \frac{1}{2} \underbrace{\operatorname{tr}(\boldsymbol{\sigma}_j)}_{=0} + \frac{1}{2} \sum_{k=1}^3 x_k \\operatorname{tr}(\boldsymbol{\sigma}_k \boldsymbol{\sigma}_j) \\
  =& \frac{1}{2} \sum_{k=1}^3 x_k \operatorname{tr}(\mathbf{I}_2 \delta_{kj} + i\epsilon_{kjl} \boldsymbol{\sigma}_l) \\
  =& \frac{1}{2} x_k [\delta_{kj} \underbrace{\operatorname{tr}(\mathbf{I}_2)}_{=2} + i\epsilon_{kjl} \underbrace{\operatorname{tr}(\boldsymbol{\sigma}_l)}_{=0}] \\
  =& x_j
\end{align*}
$$
</details>

## Operators on qubits

<MathBox title='Spin rotation' boxType='definition'>
Let $\hat{\mathbf{n}} \in \mathbb{S}^2$ be unit vector in $\R^3$. A rotation about $\hat{\mathbf{n}}$ by an angle $\alpha$ on the qubit space ${}^\P \mathcal{H}$ is given by

$$
  \hat{D}_{\hat{\mathbf{n}}}(\alpha) := e^{-i\frac{\alpha}{2} \hat{\mathbf{n}}\cdot\boldsymbol{\sigma}}
$$

known as the spin rotation operator
</MathBox>

<MathBox title='Properties of spin rotation' boxType='proposition' tag='proposition-3'>
Let $\hat{\mathbf{n}} \in\mathbb{S}^2$ be unit vector in $\R^3$. The spin operator $\mathbf{D}_{\hat{\mathbf{n}}}$ has the following properties
1. $\mathbf{D}_{\hat{\mathbf{n}}}(\alpha) = \cos\left(\frac{\alpha}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma}$
2. $\mathbf{D}_{\hat{\mathbf{n}}}^\dagger (\alpha) = \mathbf{D}_{\hat{\mathbf{n}}} (-\alpha) = \cos\left(\frac{\alpha}{2}\right)\mathbf{I}_2 + i\sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma}$
3. $\mathbf{D}_{\hat{\mathbf{n}}}(\alpha) \mathbf{D}^\dagger_{\hat{\mathbf{n}}}(\alpha) = \mathbf{I}$
4. $\mathbf{D}_{\hat{\mathbf{n}}}(\alpha) \mathbf{D}^\dagger_{\hat{\mathbf{n}}}(\beta) = \mathbf{D}_{\hat{\mathbf{n}}}(\alpha + \beta)$

<details>
<summary>Proof</summary>

Recall that for matrices $\mathbf{A}$ satisfying $\mathbf{A}^2 = \mathbf{I}$

$$
\begin{equation}
  e^{i\alpha\mathbf{A}} := \sum_{n=0}^\infty \frac{(i\alpha)^n}{n!} \mathbf{A}^n = \cos(\alpha)\mathbf{I} + i\sin(\alpha)\mathbf{A} \tag{\label{equation-2}}
\end{equation}
$$

**(1):** Since $\norm{\hat{\mathbf{n}}} = 1$ it follows that $(\hat{\mathbf{n}}\cdot\boldsymbol{\sigma})^2 = \mathbf{I}$. Hence, the results follows immediately from $\eqref{equation-2}$.

**(2):** Since $(-i\hat{\mathbf{n}} \cdot \boldsymbol{\sigma})^\dagger = i\hat{\mathbf{n}}\cdot\boldsymbol{\sigma}$, the result follows immediately from **(1)**.

**(3):** From **(1)** and **(2)**, we have

$$
\begin{align*}
  \mathbf{D}_{\hat{\mathbf{n}}} (\alpha) \mathbf{D}_{\hat{\mathbf{n}}}^\dagger (\alpha) =& \left(\cos\left(\frac{\alpha}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \right) \left(\cos\left(\frac{\alpha}{2}\right)\mathbf{I}_2 + i\sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \right) \\
  =& \left[\cos\left(\frac{\alpha}{2}\right) \mathbf{I}_2 \right]^2 - \left[i \sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \right]^2 \\
  =& \left(\cos^2 \left(\frac{\alpha}{2}\right) + \sin^2 \left(\frac{\alpha}{2}\right) \right)\mathbf{I}_2 \\
  =& \mathbf{I}_2
\end{align*}
$$

**(4):**

$$
\begin{align*}
  \mathbf{D}_{\hat{\mathbf{n}}} (\alpha) \mathbf{D}_{\hat{\mathbf{n}}} (\beta) =& \left(\cos\left(\frac{\alpha}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\alpha}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \right) \left(\cos\left(\frac{\beta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\beta}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \right) \\
  =& \cos\left(\frac{\alpha}{2}\right)\cos\left(\frac{\beta}{2}\right)\mathbf{I}_2 - \sin\left(\frac{\alpha}{2}\right)\sin\left(\frac{\beta}{2}\right) \underbrace{(\hat{\mathbf{n}}\cdot\boldsymbol{\sigma})^2}_{=\mathbf{I}_2} \\
  &- i\underbrace{\left(\cos\left(\frac{\alpha}{2}\right)\sin\left(\frac{\beta}{2}\right) + \sin\left(\frac{\alpha}{2}\right)\cos\left(\frac{\beta}{2}\right)\right)}_{=\sin[(\alpha + \beta)/2]} \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \\
  =& \underbrace{\left(\cos\left(\frac{\alpha}{2}\right)\cos\left(\frac{\beta}{2}\right) - \sin\left(\frac{\alpha}{2}\right)\sin\left(\frac{\beta}{2}\right)\right)}_{=\cos[(\alpha + \beta)/2]}\mathbf{I}_2 - i\sin\left(\frac{\alpha + \beta}{2}\right) \hat{\mathbf{n}} \cdot\boldsymbol{\sigma} \\
  =& \cos\left(\frac{\alpha + \beta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\alpha + \beta}{2}\right) \hat{\mathbf{n}}\cdot\boldsymbol{\sigma} \\
  =& \mathbf{D}_{\hat{\mathbf{n}}} (\alpha + \beta)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Inverse spin rules' boxType='proposition'>
Inverse spin rotations about the $y$ and $z$ axes are given by
1. $\boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{y}}} (\eta) \boldsymbol{\sigma}_x = \mathbf{D}_{\hat{\mathbf{y}}} (-\eta)$
2. $\boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{z}}} (\eta) \boldsymbol{\sigma}_x = \mathbf{D}_{\hat{\mathbf{z}}} (-\eta)$

<details>
<summary>Proof</summary>

**(1):**

$$
\begin{align*}
  \boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{y}}} (\eta) \boldsymbol{\sigma}_x =& \boldsymbol{\sigma}_x \left(\cos\left(\frac{\eta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\eta}{2}\right) \hat{\mathbf{y}} \cdot \boldsymbol{\sigma} \right)\boldsymbol{\sigma}_x \\
  =& \cos\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_x^2}_{=\mathbf{I}_2} - i\sin\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_x \boldsymbol{\sigma}_y}_{=i\boldsymbol{\sigma}_z} \boldsymbol{\sigma}_x \\
  =& \cos\left(\frac{\eta}{2}\right) \mathbf{I}_2 + \sin\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_z \boldsymbol{\sigma}_x}_{i\sigma y} \\
  =& \cos\left(\frac{\eta}{2}\right) \mathbf{I}_2 + i\sin\left(\frac{\eta}{2}\right) \boldsymbol{\sigma}_y \\
  =& \mathbf{D}_{\hat{\mathbf{y}}} (-\eta)
\end{align*}
$$

**(2):**

$$
\begin{align*}
  \boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{z}}} (\eta) \boldsymbol{\sigma}_x =& \boldsymbol{\sigma}_x \left(\cos\left(\frac{\eta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\eta}{2}\right) \hat{\mathbf{z}} \cdot \boldsymbol{\sigma} \right)\boldsymbol{\sigma}_x \\
  =& \cos\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_x^2}_{=\mathbf{I}_2} - i\sin\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_x \boldsymbol{\sigma}_z}_{=-i\boldsymbol{\sigma}_y} \boldsymbol{\sigma}_x \\
  =& \cos\left(\frac{\eta}{2}\right) \mathbf{I}_2 - \sin\left(\frac{\eta}{2}\right) \underbrace{\boldsymbol{\sigma}_y \boldsymbol{\sigma}_x}_{-i\boldsymbol{\sigma}_z} \\
  =& \cos\left(\frac{\eta}{2}\right) \mathbf{I}_2 + i\sin\left(\frac{\eta}{2}\right) \boldsymbol{\sigma}_z \\
  =& \mathbf{D}_{\hat{\mathbf{z}}} (-\eta)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition' tag='proposition-1'>
Let $\hat{U}$ be a unitary operator on the qubit space ${}^\P \mathcal{H}$. Then there exists parameters $\alpha,\beta,\delta,\gamma\in\R$ such that the matrix representation of $\hat{U}$ in the standard basis $\set{\ket{0}, \ket{1}}$ is given by

$$
\begin{equation}
  \mathbf{U} = e^{i\alpha} \begin{bmatrix}
    e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right) & -e^{-i\frac{\delta - \beta}{2}} \sin\left(\frac{\gamma}{2}\right) \\
    e^{-i\frac{\beta - \delta}{2}} \sin\left(\frac{\gamma}{2}\right) & e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right)
  \end{bmatrix} \tag{\label{equation-3}}
\end{equation}
$$

<details>
<summary>Proof</summary>

Let $\mathbf{U}$ be a unitary matrix in the standard basis $\set{\ket{0}, \ket{1}}$, given by

$$
  \mathbf{U} = \begin{bmatrix} a & b \\ c & d \end{bmatrix}, \; a,b,c,d\in\mathbb{C}
$$

From the unitarity condition $\mathbf{UU}^\dagger = \mathbf{I}_2$, we obtain the constraints

$$
\begin{gather*}
  |a|^2 + |b|^2 = 1 = |c|^2 + |d|^2 \\
  ac^* + bd^* = 0
\end{gather*}
$$

**Case 1: $c = 0$ (or equivalently $b = 0$)**

If $c = 0$, then from $|d|^2 = 1$ follows that $d = e^{i\eta}$. This again implies $b = 0$ and from $|a|^2 = 1$ it follows that $a = e^{i\xi}$. In this case $\mathbf{U}$ takes the diagonal form

$$
  \mathbf{U} = \begin{bmatrix}
    e^{i\xi} & 0 \\
    0 & e^{i\eta}
  \end{bmatrix}
$$

Setting $\alpha = (\xi + \eta)/2$, $\beta = \eta - \xi$ and $\delta = \gamma = 0$, we recover the desired form. If $a = 0$, a similar argument leads to

$$
  \mathbf{U} = \begin{bmatrix}
    0 & e^{i\omega} \\
    e^{i\tau} & 0
  \end{bmatrix}
$$

Setting $\alpha = (\omega + \tau + \pi)/2$, $\delta = \omega + \pi - \tau$, $\beta = 0$ and $\gamma = \pi$, we obtain the desired form of $\mathbf{U}$.

**Case 2: $c \neq 0$**

If $ac^* \neq 0$, the unitarity condition yields

$$
\begin{align*}
  a =& -b \frac{d^*}{c^*} \\
  \implies |a|^2 =& |b|^2 \frac{|d|^2}{|c|^2} \\
  \implies 1 =& |a|^2 + |b|^2 = |b|^2 \left(1 + \frac{|d|^2}{|c|^2} \right) \\
  =& |b|^2 \frac{|c|^2 + |d|^2}{|c|^2} = \frac{|b|^2}{|c|^2}
\end{align*}
$$

which implies $|b| = |c|$ and $|a| = |d|$. Thus, there are $\xi,\eta,\gamma\in\R$ such that

$$
  a = e^{i\xi} \cos\left(\frac{\gamma}{2}\right), \quad d = e^{i\eta} \cos\left(\frac{\gamma}{2} \right)
$$

which in turn implies that

$$
  |c|^2 = |b|^2 = 1 - |a|^2 = \sin^2 \left(\frac{\gamma}{2}\right)
$$

Thus, there are $\omega,\tau\in\R$ such that

$$
  b = -e^{i\omega} \sin\left(\frac{\gamma}{2}\right), \quad c = e^{i\tau} \sin\left(\frac{\gamma}{2}\right)
$$

Using the identity $ac^* = -bd^* \neq 0$, we obtain

$$
  e^{i(\xi - \tau)} \sin\left(\frac{\gamma}{2}\right) \cos\left(\frac{\gamma}{2}\right) = e^{i(\omega - \eta)} \sin\left(\frac{\gamma}{2}\right) \cos\left(\frac{\gamma}{2}\right)
$$

and thus $\xi - \tau = \omega - \eta + 2k\pi$. Choosing $\eta = \omega + \tau - \xi$, we can rewrite $\mathbf{U}$ as

$$
  \mathbf{U} = \begin{bmatrix}
    e^{i\xi} \cos\left(\frac{\gamma}{2}\right) & -e^{i\omega} \sin\left(\frac{\gamma}{2}\right) \\
    e^{i\tau} \sin\left(\frac{\gamma}{2}\right) & e^{i(\omega + \tau - \xi)} \cos\left(\frac{\gamma}{2} \right)
  \end{bmatrix}
$$

With the change of variables

$$
\begin{align*}
  \alpha :=& \frac{\omega + \tau}{2} \\
  \beta :=& \tau - \xi \\
  \delta := \omega - \xi
\end{align*}
$$

we obtain

$$
\begin{align*}
  \xi =& \alpha - \frac{\beta + \delta}{2} \\
  \omega =& \alpha + \frac{\delta - \beta}{2} \\
  \tau =& \alpha + \frac{\beta -\delta}{2} \\
  \omega + \tau - \xi =& \alpha + \frac{\beta + \delta}{2}
\end{align*}
$$

giving $\mathbf{U}$ the desired form.
</details>
</MathBox>

<MathBox title='' boxType='corollary' tag='corollary-1'>
Let $\hat{U}\in\mathrm{U}(2)$ be a unitary operator on the qubit space ${}^\P \mathcal{H}$. Then there exists parameters $\alpha,\beta,\delta,\gamma\in\R$ such that

$$
  \hat{U} = e^{i\alpha} \mathbf{D}_{\hat{\mathbf{z}}} (\beta) \mathbf{D}_{\hat{\mathbf{y}}} (\gamma) \mathbf{D}_\mathbf{z} (\delta)
$$

<details>
<summary>Proof</summary>

We have

$$
\begin{align*}
  \mathbf{D}_{\hat{\mathbf{z}}} (\beta) = \cos\left(\frac{\delta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\delta}{2}\right) \hat{\mathbf{z}}\cdot\boldsymbol{\sigma} = \cos\left(\frac{\delta}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\delta}{2}\right) \boldsymbol{\sigma}_z \\
  =& begin{bmatrix} 
    \cos\left(\frac{\delta}{2}\right) - i\sin\left(\frac{\delta}{2}\right) & 0 \\
    0 & \cos\left(\frac{\delta}{2}\right) + i\sin\left(\frac{\delta}{2}\right) = \begin{bmatrix} e^{-i\delta/2} & 0 \\ 0 & e^{i\delta/2}
  \end{bmatrix}
\end{align*}
$$

and

$$
\begin{align*}
  \mathbf{D}_{\hat{\mathbf{y}}} (\gamma) =& \cos\left(\frac{\gamma}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\gamma}{2}\right) \hat{\mathbf{y}} - i\sin\left(\frac{\gamma}{2}\right) \boldsymbol{\sigma}_y \\
  =& \begin{bmatrix} \cos\left(\frac{\gamma}{2}\right) & -\sin\left(\frac{\gamma}{2}\right) \\ \sin\left(\frac{\gamma}{2}\right) & \cos\left(\frac{\gamma}{2}\right) \end{bmatrix}
\end{align*}
$$

such that

$$
\begin{align*}
  \mathbf{D}_{\hat{\mathbf{z}}}(\beta) \mathbf{D}_{\hat{\mathbf{y}}}(\gamma) \mathbf{D}_{\hat{\mathbf{z}}}(\delta) =& \begin{bmatrix} e^{-i\frac{\beta}{2}} & 0 \\ 0 & e^{i\frac{\beta}{2}} \end{bmatrix} \begin{bmatrix} \cos\left(\frac{\gamma}{2}\right) & -\sin\left(\frac{\gamma}{2}\right) \\ \sin\left(\frac{\gamma}{2}\right) & \cos\left(\frac{\gamma}{2}\right) \end{bmatrix} \begin{bmatrix} e^{-i\frac{\beta}{2}} & 0 \\ 0 & e^{i\frac{\beta}{2}} \end{bmatrix} \\
  =& \begin{bmatrix}
    e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right) & -e^{-i\frac{\delta - \beta}{2}} \sin\left(\frac{\gamma}{2}\right) \\
    e^{-i\frac{\beta - \delta}{2}} \sin\left(\frac{\gamma}{2}\right) & e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right)
  \end{bmatrix}
\end{align*}
$$

Multiplying with $e^{i\alpha}$ gives the desired result.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
For every unitary operator $\hat{U}$ on ${}^\P \mathcal{H}$ there exists operators $\hat{A}, \hat{B}$ and $\hat{C}$ on ${}^\P \mathcal{H}$ and $\alpha\in\R$ such that $\mathbf{ABC} = \mathbf{I}$ and

$$
  \mathbf{U} = e^{i\alpha} \mathbf{A} \boldsymbol{\sigma}_x \mathbf{B} \boldsymbol{\sigma}_x \mathbf{C}
$$

<details>
<summary>Proof</summary>

From Corollary $\ref{corollary-1}$, we have

$$
  \hat{U} = e^{i\alpha} \hat{D}_{\hat{\mathbf{z}}} (\beta) \hat{D}_{\hat{\mathbf{y}}} (\gamma) \hat{D}_\mathbf{z} (\delta)
$$

We set

$$
\begin{align*}
  A: &= \mathbf{D}_{\hat{\mathbf{x}}}(\beta) \mathbf{D}_{\hat{\mathbf{y}}}(\frac{\gamma}{2}) \\
  B: &= \mathbf{D}_{\hat{\mathbf{y}}}\left(-\frac{\gamma}{2}\right) \mathbf{D}_{\hat{\mathbf{z}}}\left(\frac{\delta + \beta}{2}\right) \\
  C: &= \mathbf{D}_{\hat{\mathbf{z}}}\left(\frac{\delta - \beta}{2}\right).
\end{align*}
$$

Then it follows that

$$
\begin{align*}
  \mathbf{ABC} =& \mathbf{D}_{\hat{\mathbf{z}}} (\beta) \underbrace{\mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right) \mathbf{D}_{-\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right)}_{=\mathbf{D}_{\hat{\mathbf{y}}}(0) = \mathbf{I}_2} \mathbf{D}_{\hat{\mathbf{z}}} \left(-\frac{\delta + \beta}{2} \right) \underbrace{\mathbf{D}_{\hat{\mathbf{z}}} \left(\frac{\delta - \beta}{2} \right)}_{=\mathbf{D}_{\hat{\mathbf{z}}} (-\beta)} \\
  =& \mathbf{D}_{\hat{\mathbf{z}}} (\beta) \mathbf{D}_{\hat{\mathbf{z}}} (-\beta) \\
  =& \mathbf{I}_2
\end{align*}
$$

and

$$
\begin{align*}
  &e^{i\alpha} \mathbf{A} \boldsymbol{\sigma}_x \mathbf{B} \boldsymbol{\sigma}_x \mathbf{C} \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{x}}} (\beta) \mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right) \boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{y}}} \left(-\frac{\gamma}{2}\right) \mathbf{D}_{\hat{\mathbf{z}}} \left(-\frac{\delta + \beta}{2}\right) \boldsymbol{\sigma}_x \boldsymbol{D}_{\hat{\mathbf{z}}} \left(\frac{\delta - \beta}{2} \right) \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{x}}} (\beta) \mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right) \boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{y}}} \left(-\frac{\gamma}{2}\right) \overbrace{\boldsymbol{\sigma}_x \boldsymbol{\sigma}_x}^{\mathbf{I}_2} \mathbf{D}_{\hat{\mathbf{z}}} \left(-\frac{\delta + \beta}{2}\right) \boldsymbol{\sigma}_x \boldsymbol{D}_{\hat{\mathbf{z}}} \left(\frac{\delta - \beta}{2} \right) \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{x}}} (\beta) \mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right) \underbrace{\boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{y}}} \left(-\frac{\gamma}{2}\right) \boldsymbol{\sigma}_x}_{=\mathbf{D}_{\hat{\mathbf{y}}}(\gamma/2)} \underbrace{\boldsymbol{\sigma}_x \mathbf{D}_{\hat{\mathbf{z}}} \left(-\frac{\delta + \beta}{2}\right) \boldsymbol{\sigma}_x}_{=\mathbf{D}_{\hat{\mathbf{z}}}[(\delta + \beta)/2]} \boldsymbol{D}_{\hat{\mathbf{z}}} \left(\frac{\delta - \beta}{2} \right) \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{z}}} (\beta) \underbrace{\mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right) \mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\gamma}{2}\right)}_{=\mathbf{D}_{\hat{\mathbf{y}}}(\gamma)} \underbrace{\mathbf{D}_{\hat{\mathbf{z}}} \left(\frac{\delta + \beta}{2}\right) \mathbf{D}_{\hat{\mathbf{z}}} \left(\frac{\delta - \beta}{2}\right)}_{=\mathbf{D}_{\hat{\mathbf{z}}}(\delta)} \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{z}}} (\beta) \mathbf{D}_{\hat{\mathbf{y}}} (\gamma) \mathbf{D}_{\hat{\mathbf{z}}} (\delta) = \mathbf{U}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition' tag='proposition-2'>
Let $\hat{U}$ be a unitary operator on ${}^\P \mathcal{H}$. Then there exists parameters $\alpha, \xi\in\R$ and a unit vector $\hat{\mathbf{n}}\in\mathbb{S}^2$ in $\R^3$ such that

$$
  \mathbf{U} = e^{i\alpha} \mathbf{D}_{\hat{\mathbf{n}}} (\xi)
$$

<details>
<summary>Proof</summary>

From Proposition $\ref{proposition-1}$, we know that there exists parameters $\alpha,\beta,\delta,\gamma\in\R$ such that

$$
\begin{align*}
  \mathbf{U} =& e^{i\alpha} \begin{bmatrix}
    e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right) & -e^{-i\frac{\delta - \beta}{2}} \sin\left(\frac{\gamma}{2}\right) \\
    e^{-i\frac{\beta - \delta}{2}} \sin\left(\frac{\gamma}{2}\right) & e^{-i\frac{\beta + \delta}{2}} \cos\left(\frac{\gamma}{2}\right)
  \end{bmatrix} \\
  =& e^{i\alpha} \begin{bmatrix}
    \left[\cos\left(\frac{\beta + \delta}{2}\right) - i\cos\left(\frac{\beta + \delta}{2}\right)\right] \cos\left(\frac{\gamma}{2}\right) & \left[\cos\left(\frac{\delta - \beta}{2}\right) - i\cos\left(\frac{\delta - \beta}{2}\right)\right] \sin\left(\frac{\gamma}{2}\right) \\
    \left[\cos\left(\frac{\beta - \delta}{2}\right) - i\cos\left(\frac{\beta - \delta}{2}\right)\right] \sin\left(\frac{\gamma}{2}\right) & \left[\cos\left(\frac{\beta + \delta}{2}\right) - i\cos\left(\frac{\beta + \delta}{2}\right)\right] \cos\left(\frac{\gamma}{2}\right)
  \end{bmatrix} \\
  =& e^{i\alpha} \left(\cos\left(\frac{\beta + \delta}{2}\right) \cos\left(\frac{\gamma}{2}\right) \mathbf{I}_2 \right. \\
  & \left.-i\left[\sin\left(\frac{\beta + \delta}{2}\right) \cos\left(\frac{\gamma}{2}\right) \boldsymbol{\sigma}_z + \cos\left(\frac{\delta - \beta}{2}\right) \sin\left(\frac{\gamma}{2}\right) \boldsymbol{\sigma}_y + \sin\left(\frac{\delta - \beta}{2}\right) \sin\left(\frac{\gamma}{2}\right)\boldsymbol{\sigma}_x \right]\right)
\end{align*}
$$

We aim to find $\xi$ and $\hat{\mathbf{n}}(\theta,\phi)$ such that $\mathbf{U} = e^{i\alpha} \mathbf{D}_{\hat{\mathbf{n}}} (\xi)$ for

$$
  \mathbf{D}_{\hat{\mathbf{n}}} (\xi) = \cos\left(\frac{\xi}{2}\right) \mathbf{I}_2 - i\sin\left(\frac{\xi}{2}\right) \hat{\mathbf{n}} \cdot \boldsymbol{\sigma}
$$

We thus seek a $\tilde{\xi}$ such that 

$$
\begin{equation}
  \cos\left(\frac{\tilde{\xi}}{2}\right) = \cos\left(\frac{\delta + \beta}{2}\right) \cos\left(\frac{\gamma}{2}\right) \tag{\label{equation-4}}
\end{equation}
$$

which leads to

$$
\begin{align*}
  \left|\sin\left(\frac{\tilde{\xi}}{2}\right)\right| =& \sqrt{1 - \cos^2 \left(\frac{\tilde{\xi}}{2}\right)} \\
  =& \sqrt{1 - \cos^2 \left(\frac{\delta + \beta}{2}\right) \cos^2 \left(\frac{\gamma}{2}\right)} \\
  \geq& \sqrt{1 - \cos^2 \left(\frac{\gamma}{2}\right)} = \left|\sin\left(\frac{\gamma}{2}\right)\right|
\end{align*}
$$

We choose $\xi = \tilde{\xi}$ if $\sin(\tilde{\xi}/2)$ and $\sin(\gamma/2)$ have the same sign and $\xi = -\tilde{\xi}$ otherwise. Then there exists $\theta_1 \in [0, \pi/2]$ and $\theta_2 = \pi - \theta_1 \in [\pi/2, \pi]$ such that

$$
  \sin(\theta_j) \sin\left(\frac{\gamma}{2}\right), \; j\in\set{1,2}
$$

From this it follows that

$$
  (1 - \cos^2 (\theta_j)) \sin^2 \left(\frac{\xi}{2}\right) = 1 - \cos^2 \left(\frac{\gamma}{2}\right)
$$

and this in turn implies

$$
\begin{align*}
  \cos^2 (\theta_j) \sin\left(\frac{\xi}{2}\right) =& \cos^2 \left(\frac{\gamma}{2}\right) + \sin^2 \left(\frac{\xi}{2}\right) - 1 \\
  =& \cos^2 \left(\frac{\gamma}{2}\right) - \cos^2 \left(\frac{\xi}{2}\right) \\
  =& \left(1 - \cos^2 \left(\frac{\delta + \beta}{2}\right)\right) \cos^2 \left(\frac{\gamma}{2}\right) \\
  =& \sin^2 \left(\frac{\delta + \beta}{2}\right) \cos^2 \left(\frac{\gamma}{2}\right)
\end{align*}
$$

Thus, we have

$$
  \left|\cos(\theta)_j \sin\left(\frac{\xi}{2}\right)\right| = \left|\sin\left(\frac{\delta + \beta}{2}\right) \cos\left(\frac{\gamma}{2}\right)\right|
$$

If $\sin(\xi/2)$ and $\sin[(\delta + \beta)/2]\cos(\gamma/2)$ have the same sign, we set $\theta = \theta_1$, otherwise $\theta = \theta_2$, such that in every case

$$
  \cos(\theta) \sin\left(\frac{\xi}{2}\right) = \sin\left(\frac{\delta + \beta}{2}\right) \cos\left(\frac{\gamma}{2}\right)
$$

We now set $\phi := (\beta - \delta + \pi)/2$ such that

$$
\begin{align*}
  \sin(\phi) =& \sin\left(\frac{\beta - \delta + \pi}{2}\right) = \cos\left(\frac{\beta - \delta}{2}\right) \\
  \cos(\phi) =& \cos\left(\frac{\beta - \delta + \pi}{2}\right) = -\sin\left(\frac{\beta - \delta}{2}\right) = \sin\left(\frac{\delta -\beta}{2}\right) 
\end{align*}
$$

Altogher, we thus have in $\eqref{equation-4}$

$$
\begin{align*}
  \cos\left(\frac{\beta + \delta}{2}\right) \cos\left(\frac{\gamma}{2}\right) =& \cos\left(\frac{\xi}{2}\right) \\
  \sin\left(\frac{\beta + \delta}{2}\right) \cos\left(\frac{\gamma}{2}\right) =& \sin\left(\frac{\xi}{2}\right) \cos(\theta) = \sin\left(\frac{\xi}{2}\right) \hat{n}_z \\
  \cos\left(\frac{\beta - \delta}{2}\right) \cos\left(\frac{\gamma}{2}\right) =& \sin\left(\frac{\xi}{2}\right) \sin(\theta)\sin(\phi) = \sin\left(\frac{\xi}{2}\right) \hat{n}_y \\
  \sin\left(\frac{\delta - \beta}{2}\right) \cos\left(\frac{\gamma}{2}\right) =& \sin\left(\frac{\xi}{2}\right) \sin(\theta)\cos(\phi) = \sin\left(\frac{\xi}{2}\right) \hat{n}_x
\end{align*}
$$

and finally

$$
\begin{align*}
  e^{-i\alpha} \mathbf{U} =& \cos\left(\frac{\xi}{2}\right)\mathbf{I}_2 - i\sin\left(\frac{\xi}{2}\right) \hat{\mathbf{n}}\cdot\mathbf{\sigma} \\
  =& \mathbf{D}_{\hat{\mathbf{n}}} (\xi)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Every unitary operator $\hat{U}\in\mathcal{U}({}^\P \mathcal{H})$ has a root, that is, there exists an operator $\sqrt{\hat{U}} \in\mathcal{U}({}^\P \mathcal{U})$ such that

$$
  (\sqrt{\hat{U}})^2 = \hat{U}
$$

<details>
<summary>Proof</summary>

From Proposition $\ref{proposition-2}$ we know that there exists $\alpha,\xi\in\R$ and $\hat{\mathbf{n}}\in\mathbb{S}^2$ such that

$$
  \mathbf{U} = e^{i\alpha} \mathbf{D}_{\hat{\mathbf{n}}} (\xi)
$$

With this we set set

$$
  \sqrt{\mathbf{U}} e^{i\frac{\alpha}{2}} \mathbf{D}_{\hat{\mathbf{n}}} \left(\frac{\xi}{2}\right)
$$

From Proposition $\ref{proposition-3}$ we know that $\mathbf{D}_{\hat{\mathbf{n}}} (\xi/2) \in\mathbb{U}({}^\P \mathcal{H})$, and since $e^{i\alpha/2} \in \mathcal{U}({}^\P \mathcal{H})$ it follows that $\sqrt{\mathbf{U}} \in\mathcal{U}({}^\P \mathcal{H})$ as well. Moreover, we find 

$$
\begin{align*}
  (\sqrt{\mathbf{U}})^2 = e^{i\frac{\alpha}{2}} \mathbf{D}_{\hat{\mathbf{n}}} \left(\frac{\xi}{2} \right) e^{i\frac{\alpha}{2}} \mathbf{D}_{\hat{\mathbf{n}}} \left(\frac{\xi}{2}\right) \\
  =& e^{i\alpha} \mathbf{D}_{\hat{\mathbf{n}}} (\xi) = \mathbf{U}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Hadamard transformation' boxType='definition'>
The Hadamard transfomation $\hat{H}: {}^\P \mathcal{H} \to {}^\P \mathcal{H}$ is defined as

$$
  \mathbf{H} := \frac{1}{\sqrt{2}}(\boldsymbol{\sigma}_x + \boldsymbol{\sigma}_z)
$$
</MathBox>

<MathBox title='Properties of Hadamard transformations' boxType='proposition'>
In the basis $\set{\ket{0},\ket{1}}$, the matrix representation of the Hadamard transformation $\mathbf{H}$ is

$$
  \mathbf{H} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}
$$

It satisfies the following properties:
1. $\mathbf{H}\ket{0} = \frac{1}{\sqrt{2}}(\ket{0} + \ket{1})$
2. $\mathbf{H}\ket{1} = \frac{1}{\sqrt{2}} (\ket{0} - \ket{1})$
3. $\mathbf{H}\ket{x_j} = \frac{1}{\sqrt{2}}(\ket{0} + e^{\pi ix_j} \ket{1})$
4. $\mathbf{H}^2 = \mathbf{I}_2$
5. $\mathbf{H} = e^{i \frac{3\pi}{2}} \mathbf{D}_{\hat{\mathbf{z}}} (0) \mathbf{D}_{\hat{\mathbf{y}}} \left(\frac{\pi}{2}\right) \mathbf{D}_{\mathbf{z}} (-\pi)$
</MathBox>

## Computational basis

The $n$-fold tensor product of qubit spaces is defined as

$$
  {}^\P \mathcal{H}^{\otimes n} := \bigotimes_{j=n-1}^{0} {}^\P \mathcal{H}_j
$$

We denote the $(j+1)$th factor space counting from the right in ${}^\P \mathcal{H}^{\otimes n}$ by ${}^\P \mathcal{H}_j$. In other words, we can write

$$
  {}^\P \mathcal{H}^{\otimes n} = {}^\P \mathcal{H}_{n-1} \otimes\cdots\otimes \overbrace{{}^\P \mathcal{H}_j}^{\text{$(j+1)$th factor}} \otimes\cdots\otimes {}^\P \mathcal{H}_0
$$

The Hilbert tensor product space ${}^\P \mathcal{H}^{\otimes n}$ has dimension $2^n$. Every natural number $x\in\N_0$ with $x < 2^n$ can be expressed in binary form as

$$
  x = \sum_{j=0}^{n-1} x_j 2^j, \; x_j \in\set{0,1}
$$

which results in the usual binary representation

$$
  (x)_2 = x_{n-1} \dots x_0, \; x_j \in\set{0,1}
$$

For each $x$ we define a vector $\ket{x}\in {}^\P \mathcal{H}^{\otimes n}$ as

$$
\begin{align*}
  \ket{x}^n :=& \ket{x_{n-1} \dots x_0} \\
  =& \bigotimes_{j=n-1}^0 \ket{j} 
\end{align*}
$$

If the context of the product space ${}^\P \mathcal{H}^{\otimes}$ is clear, we will also simply write $\ket{x} := \ket{x}^n$.

For the smallest and largest representable numbers, $0$ and $2^n - 1$ in ${}^\P \mathcal{H}^{\otimes n}$, we have

$$
\begin{align*}
  \ket{2^n - 1}^n =& \bigotimes_{j=0}^{n-1} \ket{1} \in {}^\P \mathcal{H}^{\otimes n} \\
  \ket{0}^n =& \bigotimes_{j=0}^{n-1} \ket{0} \in {}^\P \mathcal{H}^{\otimes n}
\end{align*}
$$

The set of vectors $\set{\ket{x}\in {}^\P \mathcal{H}^{\otimes n} | x\in\N_0, x < 2^n}$ forms an orthonormal basis in ${}^\P \mathcal{H}^{\otimes n}$, called the computational basis.

<details>
<summary>Proof</summary>

The inner product of $\ket{x},\ket{y} \in {}^\P \mathcal{H}^{\otimes n}$ is

$$
  \braket{x|y} =& \braket{x_{n-1} \dots x_0 | y_{n-1} \dots y_0} \\
  =& \sum_{j=0}^{n-1} \braket{x_j | y_j} = \begin{cases} 1, \quad& x_j = y_j \; \forall j \\ 0, \quad& \text{else} \\
  =& \delta_{xy}
$$

Hence, $\set{\ket{x} | x\in\N_0, x < 2^n}$ forms a set of $2^n = \dim({}^\P \mathcal{H}^{\otimes n})$ orthonormal vectors in ${}^\P \mathcal{H}^{\otimes n}$. Since the numbe of orthonormal vectors in this set is equal to the dimension of ${}^\P \mathcal{H}^{\otimes n}$, this set constitutes is an orthonormal basis of this Hilbert space.
</details>

<MathBox title='Local operator' boxType='definition'>
An operator $\hat{A}\in\mathcal{L}({}^\P \mathcal{H}^{\otimes n})$ is $k$-local if it is of the form

$$
  \hat{A} = \sum_{j\in I} a_{j_{n-1},\cdots,j_0} \hat{A}_{j_{n-1}} \otimes \cdots \otimes \hat{A}_{j_0}
$$

where $I\subset\N_+$ is an index set and for $j\in I$ and $l\in {0,\dots,n-1}$ we have $a_{j_l} \in\mathbb{C}$ and $\hat{A}_{j_l} \in\mathcal{L}({}^\P \mathcal{H})$, and the index sets

$$
  I_j = \Set{l \in\set{0,\dots,n-1}|A_{j_l} \neq \hat{I}}
$$

of qubits on which the $\hat{A}_{j_{n-1}} \otimes\cdots\otimes\hat{A}_{j_0}$ act non-trivially satisfy $|I_j| \leq k$.
</MathBox>

## Quantum operations

According to the quantum postulates, a quantum system can change in two fundamental ways:
1. **Unitary evolution** governed by a Hamiltonian
2. **State transformation** induced by measurement

However, yet another way to generate a state transformation is to couple our system of interest with another system, forming a composite system. Once combined, we can apply time evolution or measurements to the larger system. Afterward, the added system is discarded, leaving only the transformed state of the original system. This process of extending the system and then discarding part of it occurs in two scenarios:
- **Deliberate use (on purpose):** This happens when we introduce an auxilliary system as a computational resource, typically using ancillary qubits (ancillas). This includes cases where we intentionally measure these ancillas, influencing the evolution of our principal system.
- **Unintended interaction (by error):** This happens when our system of interest cannot be perfectly isolated and interacts with its surrounding environment. Such interactions can lead to decoherence, effectively entangling the system with the environment. If the environment is late observed, it can have measurable effects on the principal system.

The process of transforming a quantum state through enlargement to a composite system can be described in the following steps:
1. **Preparation of the principal system:** We with the principle system $A$ in the initial state
$$
  \hat{\rho}_A \in \mathcal{D}(\mathcal{H}_A)
$$
2. **Enlargement to a composite system:** We introduce an auxilliary system $B$, initially in state  $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$. Assuming the that system $A$ and $B$ are initially separable, the composite system is described by the tensor product state $\hat{\rho}_A \otimes\hat{\rho}_B$. Mathematically, this is represented by the embedding
$$
\begin{align*}
  \iota_{\hat{\rho}_B} : \mathcal{D}(\mathcal{H}_A) \to& \mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B) \\
  \hat{\rho}_A \mapsto& \hat{\rho}_A \otimes \hat{\rho}_B
\end{align*}
$$
3. **Time evolution of the composite system:** The combined system undergoes unitary evolution given by $\hat{U}\in\mathcal{U}(\mathcal{H}_A \otimes \mathcal{H}_B)$ transforming the state as
$$
\begin{align*}
  \hat{U} : \mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B) \to& \mathcal{D}(\mathcal{H}_A \otimes \mathcal{H}_B) \\
  \hat{\rho}_A \otimes \hat{\rho}_B \mapsto& \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger
\end{align*}
$$
In general, this operation can generate entanglement between $A$ and $B$.

4. **Measurement on system $B$:** Suppose we measure an observable of system $B$, with a corresponding projector $\hat{P}_B$ onto the eigenspace of the observable. Upon otaining an eigenvalue associated with $\hat{P}_B$, the post-measurement state is transformed as
$$
  \hat{U}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger \to \frac{(\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)}{\operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right)}
$$

If no measurement is performed on $B$, we set $\hat{P}_B = \hat{I}_B$, in which case the state remains $\hat{U}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger$. This follows from the fact that
$$
\begin{align*}
  \operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right) =& \operatorname{tr}\left(\hat{U}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger \right) \\
  =& \operatorname{tr}\left((\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger \hat{U} \right) \\
  =& \operatorname{tr}(\hat{\rho}_A \otimes \hat{\rho}_B) = \operatorname{tr}(\hat{\rho}_A) \operatorname{tr}(\hat{\rho}_B) \\
  =& 1
\end{align*}
$$

5. **Tracing out system $B$:** Discarding or ignoring system $B$, the final state of $A$ is obtained by taking the partial trace over $B$:
$$
  \frac{(\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)}{\operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right)} \to \frac{\operatorname{tr}_B \left((\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)\right)}{\operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right)}
$$

Altogether the initial state $\hat{\rho}_A$ of the principal system $A$ of interest is thus transformed as

$$
\begin{equation}
  \hat{\rho}_A \mapsto \frac{\operatorname{tr}_B \left((\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)\right)}{\operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right)} \in\mathcal{D}(\mathcal{H}_A) \tag{\label{equation-15}}
\end{equation}
$$

<MathBox title='Quantum operation' boxType='definition'>
Let $\mathcal{H}$ be a finite-dimensional Hilbert space. A *quantum operation* is a convex-linear map

$$
\begin{align*}
  \hat{K} : \mathcal{D}(\mathcal{H}) \to& \mathcal{D}_\leq (\mathcal{H}) \\
  \hat{\rho} \mapsto& \hat{K}(\hat{\rho})
\end{align*}
$$

where

$$
  \mathcal{D}_\leq (\mathcal{H}_A) := \set{\hat{\rho} \in\mathcal{H}_A | \hat{\rho}^\dagger = \hat{\rho}, \hat{\rho}\geq 0, \operatorname{tr}(\hat{\rho}) \leq 1}
$$

is the set of positive semi-definite operators with trace at most one. A quantum operation $\hat{K}$ admits two equivalent representations

1. **Operator-sum representation (Kraus representation)**

There exists operators $\hat{K}_l \in\mathcal{L}(\mathcal{H})$ for $l\in\set{1,\dots,m}$, called *Kraus operators* or *operation elements*, such that 

$$
\begin{equation}
  \hat{K}(\hat{\rho}) = \sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger \tag{\label{equation-13}}
\end{equation}
$$

where $\hat{K}_l$ satisfy $\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \leq \hat{I}$.

2. **Environmental representation (Stinespring representation):**

There exists an auxilliary Hilbert space $\mathcal{H}_B$, a density operator $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$ and an isometry $\hat{V}\in\mathcal{B}(\mathcal{H} \otimes \mathcal{H}_B)$ satisfying $\hat{V}^\dagger \hat{V} \leq \hat{I}$ such that

$$
\begin{equation}
  \hat{K}(\rho) = \operatorname{tr}_B \left(\hat{V}(\hat{\rho}\otimes\hat{\rho}_B)\hat{V}^\dagger \right) \tag{\label{equation-14}}
\end{equation}
$$

A quantum operation $\hat{K}$ is called *trace-preserving* (or a *quantum channel*) if

$$
  \sum_{k=1}^m \hat{K}_l^\dagger \hat{K}_l = \hat{I}
$$

which is equivalent to $\operatorname{tr}\left(\hat{K}(\rho)\right) = 1 = \operatorname{tr}(\rho)$ for all $\hat{\rho}\in\mathcal{D}(\mathcal{H})$. In this case, $\hat{K}$ is an operator on $\mathcal{D}(\mathcal{H})$, i.e. $\hat{K}:\mathcal{D}(\mathcal{H}) \to\mathcal{D}(\mathcal{H})$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $\hat{K}: \mathcal{D}(\mathcal{H}) \to\mathcal{D}_\leq (\mathcal{H})$ be a quantum operation with Kraus operators $\hat{K}_l \in\mathcal{L}(\mathcal{H})$ for $l\in\set{1,\dots,m}$. Additionally, let $\tilde{m}\geq m$ and consider a unitary matrix $\mathbf{U}\in\mathrm{U}(\tilde{m})$ be a unitary $\tilde{m}\times\tilde{m}$ matrix. Then the operators $\tilde{K}_j \in\mathcal{L}(\mathcal{H})$ with $j\in\set{1,\dots,\tilde{m}}$ given by

$$
  \tilde{\hat{K}}_j = \sum_{l=1}^m \mathbf{U}_{jl} \mathbf{K}_l
$$

are Kraus operators for $\hat{K}$ as well.

<details>
<summary>Proof</summary>

Note that the Hermitian of adjoint of $\tilde{\hat{K}}$ is

$$
  \tilde{\hat{K}}_j^\dagger = \sum_{l=1}^m \mathbf{U}_{jl}^* \hat{K}_l^\dagger = \sum_{l=1}^m \mathbf{U}_{lj}^\dagger \hat{K}_l
$$

We expand $\eqref{equation-13}$ for $\tilde{\hat{K}}$

$$
\begin{align*}
  \sum_{j=1}^{\tilde{m}} \tilde{\hat{K}}_j^\dagger \tilde{\hat{K}}_j =& \sum_{j=1}^{\tilde{m}} \left(\sum_{l=1}^m \mathbf{U}_{lj}^\dagger \hat{K}_l^\dagger \right) \left(\sum_{k=1}^m \mathbf{U}_{jk} \hat{K}_k \right) \\
  =& \sum_{l, k=1}^m \left(\sum_{j=1}^{\tilde{m}} \mathbf{U}_{lj}^\dagger \mathbf{U}_{jk} \right) \hat{K}_l^\dagger \hat{K}_k \\
  =& \sum_{l,k=1}^m \underbrace{(\mathbf{U}^\dagger \mathbf{U})}_{\delta_{lk}} \hat{K}_l^* \hat{K}_k = \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \\
  \leq& \hat{I}
\end{align*}
$$

This shows that $\tilde{\hat{K}}_l$ are valid Kraus operators.

The proof of $\eqref{equation-14}$ is almost identical since for any $\hat{\rho}\in\mathcal{D}(\mathcal{H})$, we have

$$
\begin{align*}
  \sum_{j=1}^{\tilde{m}} \tilde{\hat{K}}_j^\dagger \tilde{\hat{K}}_j =& \sum_{j=1}^{\tilde{m}} \left(\sum_{l=1}^m \mathbf{U}_{lj}^* \hat{K}_l^\dagger \right)\hat{\rho}\left( \sum_{k=1}^m \mathbf{U}_{jk}^* \hat{K}_k^\dagger \right) \\
  =& \sum_{l,k=1}^m \left(\sum_{j=1}^{\tilde{m}} \mathbf{U}_{lj}^\dagger \mathbf{U}_{jk} \right) \hat{K}_l^\dagger \hat{\rho}\hat{K}_k \\
  =& \sum_{l,k=1}^m \underbrace{\left(\mathbf{U}^\dagger \mathbf{U} \right)_{lk}}_{=\delta_{lk}} \hat{K}_l^\dagger \hat{\rho} \hat{K}_k = \sum_{l=1}^m \hat{K}_l^\dagger \hat{\rho} \hat{K}_l \\
  =& \hat{K}(\hat{\rho})
\end{align*}
$$

This shows that $\tilde{\hat{K}}$ is a valid operator-sum representation.
</details>
</MathBox>

A state transformation $\eqref{equation-15}$ can be formulated with the help of the quantum operation

$$
  \hat{K}(\hat{\rho}_A) = \operatorname{tr}_B \left(\hat{V} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger \right)
$$

in its environmental representation, where $\hat{V} = (\hat{I}_A \otimes \hat{P}_B)\hat{U}$ with $\hat{U}\in\mathcal{U}(\mathcal{H}_A \otimes \mathcal{H}_B)$.

<details>
<summary>Details</summary>

Since the orthogonal projection $\hat{P}_2$ satisfies

$$
  \hat{I}_A \otimes \hat{P}_B = \hat{I}_A \otimes \hat{P}_B^2 = \left(\hat{I}_A \otimes \hat{P}_B \right)^2
$$

and

$$
  \hat{I}_A \otimes \hat{P}_B = \hat{I}_A \otimes \hat{P}_B^\dagger = (\hat{I}_A \otimes \hat{P}_B)^\dagger
$$

we have

$$
\begin{align*}
  \operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger \right) =& \operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)^2 \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger \right) \\
  =& \operatorname{tr}\left( (\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I} _A \otimes \hat{P}_B) \right) \\
  =& \operatorname{tr}\left( (\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I} _A \otimes \hat{P}_B)^\dagger \right) \\
  =& \operatorname{tr}\left( (\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \left((\hat{I} _A \otimes \hat{P}_B) \hat{U}\right)^\dagger \right) \\
  =& \operatorname{tr}\left(\hat{V} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger \right) \\
  =& \operatorname{tr}\left(\operatorname{tr}_B \left(\hat{V} (\hat{\rho}_A \otimes \hat{\rho}_B) \right) \right) \\
  =& \operatorname{tr}\left(\hat{K}(\hat{\rho})\right)
\end{align*}
$$
</details>

In terms of $\hat{K}$, the state transformation $\eqref{equation-15}$ can be expressed as

$$
  \frac{\operatorname{tr}_B \left((\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)\right)}{\operatorname{tr}\left((\hat{I}_A \otimes \hat{P}_B)\hat{U}(\hat{\rho}^A \otimes \hat{\rho}_B) \hat{U}^\dagger \right)} \in\mathcal{D}(\mathcal{H}_A) = \frac{\hat{K}(\hat{\rho}_A)}{\operatorname{tr}\left(\hat{K}(\hat{\rho}_A) \right)}
$$

Consequently, the total state transformation can be expressed succintly with the help of a quantum operation $\hat{K}$ in the form

$$
\begin{align*}
  \mathcal{D}(\mathcal{H}_A) \to& \mathcal{D}(\mathcal{H}_A) \\
  \hat{\rho}_A \mapsto& \frac{\hat{K}(\hat{\rho}_A)}{\operatorname{tr}\left(\hat{K}(\hat{\rho})\right)}
 \end{align*}
$$

<MathBox title='' boxType='proposition'>
Let $\hat{K}:\mathcal{D}(\mathcal{H}_A) \to\mathcal{D}_\leq (\mathcal{H}_A)$ be a quantum operation in the environmental representation given by

$$
  \hat{K}(\hat{\rho}_A) = \operatorname{tr}_B \left( (\hat{I}_A \otimes \hat{P}_B) \hat{U} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B) \right)
$$

where $\hat{P}_B \in\mathcal{L}(\mathcal{H}_B)$ is an orthonormal projection, $\hat{U}\in\mathcal{U}(\mathcal{H}_A \otimes \mathcal{H}_B)$ and $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$. Then we have

$$
  [\hat{I}^A \otimes \hat{P}_B, \hat{U}] = 0 \implies \operatorname{tr}\left(\hat{K}(\hat{\rho}_A) \right) = \operatorname{tr}\left(\hat{\rho}_B \hat{P}_B \right), \; \hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)
$$

and in particular fo $\hat{P}_B = \hat{I}_B$ it follows that

$$
  \operatorname{tr}\left(\hat{K}(\hat{\rho}_A)\right) = 1, \; \forall \hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)
$$

<details>
<summary>Proof</summary>

The quantum operation $\hat{K}$ is in environmental representation with $\hat{V} = (\hat{I}_A \otimes \hat{P}_B)\hat{U}$ such that

$$
\begin{align*}
  \hat{V}^\dagger =& \left((\hat{I}_A \otimes \hat{P}_B)\hat{U}\right)^\dagger = \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B) \\
  =& \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B^\dagger) = \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)
\end{align*}
$$

and thus since $[\hat{I}_A \otimes \hat{P}_B, \hat{U}] = 0$

$$
\begin{align*}
  \hat{V}^\dagger \hat{V} =& \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)(\hat{I}_A \otimes \hat{P}_B)\hat{U} \\
  =& \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B^2)\hat{U} = \hat{U}^\dagger (\hat{I}_A \otimes \hat{P}_B)\hat{U} \\
  =& \hat{U}^\dagger \hat{U} (\hat{I}_A \otimes\hat{P}_B) = \hat{I}_A \otimes \hat{P}_B
\end{align*}
$$

Furthermore, we have a set of Kraus operators $\hat{K}_l$ for $\hat{K}$ such that

$$
\begin{align*}
  \sum_l \hat{K}_l^\dagger \hat{K}_l =& \operatorname{tr}_B \left((\hat{I}_A \otimes\sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \right) \\
  =& \operatorname{tr}_B \left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B})(\hat{I}_A \otimes\hat{P}_B)(\hat{I}_A \otimes\sqrt{\hat{P}_B}) \right) \\
  =& \operatorname{tr}_B \left(\hat{I}_A \otimes\sqrt{\hat{\rho}_B} \hat{P}_B \sqrt{\hat{\rho}_B} \right) \\
  =& \operatorname{tr}\left(\sqrt{\hat{\rho}_B} \hat{P}_B \sqrt{\hat{\rho}_B} \right) \hat{I}_A \\
  =& \operatorname{tr}\left( \sqrt{\hat{\rho}_B^2} \hat{P}_B \right) \hat{I}_A \\
  =& \operatorname{tr}(\hat{\rho}_B \hat{P}_B) \hat{I}_A
\end{align*}
$$

Applying Proposition $\ref{proposition-}$ with $\kappa = \operatorname{tr}(\hat{\rho}_B \hat{P}_B)$ then implies that $\operatorname{tr}\left(\hat{K}(\hat{\rho}) \right) = \operatorname{tr}(\hat{\rho}_B \hat{P}_B)$. If $\hat{P}_B = \hat{I}_B$, then $\operatorname{tr}\left(\hat{K}(\hat{\rho})\right) = \operatorname{tr}(\hat{\rho}_B) = 1$ since $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$.
</details>
</MathBox>

If the time evolution $\hat{U}\in\mathcal{U}(\mathcal{H}_A \otimes\mathcal{H}_B)$ of the combined system acts separably on the two subsystems $\mathcal{H}_A$ and $\mathcal{H}_B$ in the sense that it commutes with the measurement projections $\hat{I}_A \otimes\hat{P}_B$ on subsystem $\mathcal{H}_B$, the trace of the overall quantum operation can be determined from the product $\hat{\rho}_B \hat{P}_B$.

Since the domain $\mathcal{D}(\mathcal{H})$ of a quantum operation $\hat{K}$ is convex, it follows that for each $\hat{\rho}_1, \hat{\rho}_2 \in\mathcal{D}(\mathcal{H})$ and $u\in[0,1]$, we have

$$
  u\hat{\rho}_1 + (1 - u)\hat{\rho}_2 \in\mathcal{D}(\mathcal{H})
$$

Every quantum operation $\hat{K}$ is convex-linear, meaning it satisfies

$$
  \hat{K}\left(u\hat{\rho}_1 + (1 - u) \hat{\rho}_2 \right) = u\hat{K}(\hat{\rho}_1) + (1 - u)\hat{K}(\hat{\rho}_2)
$$

For a single qubit system $\mathcal{H} = {}^\P \mathcal{H}$, every $\hat{\rho}\in\mathcal{D}({}^\P \mathcal{H})$ can be parametrized by a Bloch vector $\mathbf{x}\in \mathcal{B}_1 (\R^3)$ expressed as

$$
  \hat{\rho}_\mathbf{x} = \frac{1}{2}(\mathbf{I}_2 + \mathbf{x}\cdot\boldsymbol{\sigma})
$$

where $\boldsymbol{\sigma}$ is the vector of Pauli matrices. Thus, the image of a trace-preserving quantum operation $\hat{K}:\mathcal{D}({}^\P \mathcal{H}) \to\mathcal{D}({}^\P \mathcal{H})$ on a single qubit must be of the form

$$
  \hat{K}(\hat{\rho}) = \frac{1}{2}\left(\mathbf{I}_2 + \mathbf{y}(\mathbf{x}) \cdot\hat{\sigma} \right)
$$

where $\mathbf{y}(\mathbf{x}) = \operatorname{tr}\left(\hat{K}(\hat{\rho}_\mathbf{x}) \hat{\sigma} \right)$. Consequently, every trace-preserving quantum operation $\hat{K}$ on a single qubit defines a tranformation $\hat{K} :\mathcal{B}_1 (\R^3) \to \mathcal{B}_1 (\R^3)$ given by 

$$
\begin{equation}
  \mathbf{x} \mapsto \operatorname{tr}\left(\hat{K}(\hat{\rho}_\mathbf{x}) \hat{\sigma} \right) \tag{\label{equation-16}}
\end{equation}
$$

<details>
<summary>Proof</summary>

To show that $\hat{K}(\hat{\rho})$ for a single qubit is convex-linear, note that for any Bloch vectors $\mathbf{x}_1, \mathbf{x}_2 \in\mathcal{B}_1 (\R^3)$, we have

$$
\begin{align*}
  \hat{\rho}_{u\mathbf{x}_1 + (1 - u)\mathbf{x}_2} =& \frac{1}{2}\left(\hat{I}_2 + (u\mathbf{x}_1 + (1 - u)\mathbf{x}_2) \cdot\boldsymbol{\sigma} \right) \\
  =& u \frac{1}{2} (\mathbf{I}_2 + \mathbf{x}_2 \cdot\boldsymbol{\sigma}) + (1 - u) \frac{1}{2}(\mathbf{I} + \mathbf{x}_2 \cdot\boldsymbol{\sigma}) \\
  =& u\hat{rho}_{\mathbf{x}_1} + (1 - u)\hat{\rho}_{\mathbf{x}_2}
\end{align*}
$$

and thus

$$
\begin{align*}
  \hat{K}(u\mathbf{x}_1 + (1 - \mu)\mathbf{x}_2) =& \operatorname{tr}\left(\hat{K}(\hat{\rho}_{u\mathbf{x}_1 + (1 - u)\mathbf{x}_2})\hat{\sigma} \right) \\
  =& \operatorname{tr}\left(\hat{K}(u \hat{\rho}_{\mathbf{x}_1} + (1 - u) \hat{\rho}_{\mathbf{x}_2} )\hat{\sigma} \right) \\
  =& \operatorname{tr}\left(u \hat{K}_(\hat{\rho}_{\mathbf{x}_1}) \sigma +(1 - u) \hat{K}(\hat{\rho}_{\mathbf{x}_2}) \hat{\sigma} \right) \\
  =& u \operatorname{tr}\left(\hat{K}(\hat{\rho}_{\mathbf{x}_1} \hat{\sigma}) + (1 - u)\boldsymbol{tr}\left(\hat{K}(\hat{\rho}_{\mathbf{x}_2})\right) \hat{\sigma} \right) \\
  =& u \hat{K}(\mathbf{x}_1) + (1 - u)\hat{K}(\mathbf{x}_2)
\end{align*}
$$

completing the proof.
</details>

### Equivalence of quantum operation representations

<MathBox title='' boxType='lemma' tag='lemma-1'>
Let $\mathcal{H}$ be a Hilbert space and for $l\in\set{1,\dots,m}$ let $\hat{K}_l \in \mathcal{L}(\mathcal{H})$. Then for any density operator $\hat{\rho}\in\mathcal{D}(\mathcal{H})$ the operator

$$
  \hat{K}(\hat{\rho}) = \sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger
$$

satifies $\hat{K}^\dagger (\hat{\rho}) = \hat{K}(\hat{\rho})$ and $0 \leq \hat{K}(\hat{\rho})$. Moreover, for any $\kappa\in (0,1]$ we have

$$
\begin{equation}
  \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I} \iff \operatorname{tr}(\hat{K}(\hat{\rho})) \leq \kappa, \;\forall \hat{\rho}\in\mathcal{D}(\mathcal{H}) \tag{\label{equation-5}}
\end{equation}
$$

and the equality in one side implies equality in the other.

<details>
<summary>Proof</summary>

By Hermiticity of $\hat{\rho}$ we have

$$
\begin{align*}
  \hat{K}^\dagger =& \left(\sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger \right)^\dagger = \sum_{l=1}^m (\hat{K}_l \hat{\rho} \hat{K}_l^\dagger)^\dagger \\
  =& \sum_{l=1}^m (\hat{K}_l^\dagger)^\dagger \hat{\rho}^\dagger \hat{K}_l^\dagger = \sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger \\
  =& \hat{K}(\rho)
\end{align*}
$$

and likewise by Hermiticity of $\hat{K}(\hat{\rho})$

$$
\begin{align*}
  \left(\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \right)^\dagger =& \sum_{l=1}^m (\hat{K}_l^\dagger \hat{K}_l)^\dagger = \sum_{l=1}^m \hat{K}_l^\dagger (\hat{K}_l^\dagger)^\dagger \\
  =& \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l
\end{align*}
$$

By positivity of $\hat{\rho}$, we have for any $\ket{\psi}\in\mathcal{H}$

$$
\begin{align*}
  \braket{\psi|\hat{K}(\hat{\rho})|\psi} =& \Braket{\psi|\sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger|\psi} \\
  =& \sum_{l=1}^m \braket{\psi|\hat{K}_l \hat{\rho}\hat{K}_l^\dagger|\psi} \\
  =& \sum_{l=1}^m \braket{\hat{K}_l^\dagger \psi|\hat{\rho}|\hat{K}_l^\dagger \psi} \geq 0
\end{align*}
$$

Next, we show $\implies$ in $\eqref{equation-5}$. Since $\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l$ is Hermitian it admits a spectral decomposition

$$
\begin{equation}
  \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l = \sum_a \lambda_a \ket{e_a} \bra{e_a} \tag{\label{equation-6}}
\end{equation}
$$

where $\set{\ket{e_a}} \subset\mathcal{H}$ is an orthonormal eigenbasis for eigenvalues $\set{\lambda_a}$. Consequently, we find for every eigenvalue $\lambda_a$ that

$$
\begin{align*}
  \lambda_a =& \Braket{e_a|\sum_{a'} \lambda_{a'} \ket{e_{a'}} \bra{e_{a'}}| e_a} = \Braket{e_a|\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l|e_a} \\
  \leq& \braket{e_a|\kappa e_a} = \kappa
\end{align*}
$$

Thus, we obtain for any $\hat{\rho}\in\mathcal{D}(\mathcal{H})$

$$
\begin{align*}
  \operatorname{tr}\left(\hat{K}(\hat{\rho})\right) =& \operatorname{tr}\left(\sum_{l=1}^m \hat{K}_l \hat{\rho} \hat{K}_l^\dagger \right) = \sum_{l=1}^m \operatorname{tr}(\hat{K}_l \hat{\rho} \hat{K}_l^\dagger) \\
  =& \sum_{l=1}^m \operatorname{tr}(\hat{\rho}\hat{K}_l^\dagger \hat{K}_l) = \operatorname{tr}\left(\hat{\rho} \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \right) \\
  =& \operatorname{tr}\left(\hat{\rho} \sum_a \lambda_a \ket{e_a} \bra{e_a} \right) = \sum_a \lambda_a \operatorname{tr}(\hat{\rho}\ket{e_a}\bra{e_a}) \\
  \leq& \kappa \sum_a \operatorname{tr} (\hat{\rho}\ket{e_a}\bra{e_a}) = \kappa \sum_{a,a'} \braket{e_{a'}|\hat{\rho}|e_a} \underbace{\braket{e_a|e_{a'}}}_{=\delta_{aa'}} \\
  =& \kappa \sum_a \braket{e_a|\hat{\rho}|e_a} = \kappa \operatorname{tr}(\hat{\rho}) \\
  =& \kappa
\end{align*}
$$

proving

$$
  \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I} \implies \operatorname{tr}\left(\hat{K}(\hat{\rho}) \right) \leq \kappa, \; \forall \hat{\rho}\in\mathcal{D}(\mathcal{H})
$$

We also see that $\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l = \kappa\hat{I}$ implies

$$
  \operatorname{tr}\left(\hat{K}(\hat{\rho})\right) = \operatorname{tr}(\hat{\rho}\kappa) = \kappa \operatorname{tr}(\hat{\rho}),\;\forall \hat{\rho}\in\mathcal{D}(\mathcal{H})
$$

To show $\impliedby$ in $\eqref{equation-5}$, we also note that $\operatorname{tr}\left(\hat{K}(\hat{\rho}) \right) \leq \kappa$ implies for every $\hat{\rho}\in\mathcal{D}(\mathcal{H})$

$$
  \kappa \geq \operatorname{tr}\left(\hat{\rho} \sum_{l=1}^m  \hat{K}_l^\dagger \hat{K}_l \right) = \sum_a \lambda_a \operatorname{tr}(\hat{\rho}\ket{e_a} \bra{e_a})
$$

Choosing $\hat{\rho} = \ket{e_{a'}} \bra{e_{a'}}$, we have $\operatorname{tr}(\hat{\rho}\ket{e_a}\bra{e_a}) = \delta_{aa'}$. It follows that $\lambda_a \leq \kappa$ for all $a$ and thus from $\eqref{equation-6}$ that

$$
  \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}
$$

Similarly, $\operatorname{tr}(\hat{K}(\rho)) = \kappa$ implies $\sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l = \kappa\hat{I}$.
</details>
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-2'>
Let $\mathcal{H}_A$ and $\mathcal{H}_B$ be finite-dimensional Hilbert spaces and let $\hat{V}\in\mathcal{B}(\mathcal{H}_A \otimes \mathcal{H}_B)$ be a bounded operator satisfying $\hat{V}^\dagger \hat{V} \leq \kappa \hat{I}_{AB}$ for any $\kappa\in (0,1]$. For $b_1, b_2 \in\set{1,\dots,\dim(\mathcal{H}_B)}$, define the operators $\hat{K}_{(b_1, b_2)}$ by specifying their matrix elements $(\hat{K}_{(b_1, b_2)})_{a_1 a_2}$ in the orthonormal basis $\set{\ket{e_a}}$ as

$$
  (\hat{K}_{(b_1, b_2)})_{a_1 a_2} = \left(\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}_B})\right)_{a_1 b_2, a_2 b_2}
$$

Then for any nonzero $\ket{\psi}\in\mathcal{H}_A$, we have

$$
  \Braket{\psi | \sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)}|\psi} = \frac{1}{\norm{\psi}^2} \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \right)
$$

where

$$
  \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \right) \leq \kappa \norm{\psi}^4
$$

<details>
<summary>Proof</summary>

Note that for any nonzero $\ket{\psi}\in\mathcal{H}_A$ we have

$$
\begin{align*}
  (\ket{\psi}\bra{\psi} \otimes\hat{I}_B)^2 =& \ket{\psi}\braket{\psi|\psi} \ket{\psi} \otimes \hat{I}_B \\
  =& \norm{\psi}^2 (\ket{\psi}\bra{\psi} \otimes\hat{I}_B) 
\end{align*}
$$

Using an orthonormal basis $\set{\ket{e_a}}\subset\mathcal{H}_A$, we find

$$
\begin{align*}
  &\Braket{\psi|\sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)}|\psi} \\
  =& \sum_{a_1, a_2} \braket{\psi|e_{a_1}} \Braket{e_{a_1}|\sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)}|e_{a_2}} \braket{e_{a_2}|\psi} \\
  =& \sum_{a_1, a_2} \braket{e_{a_2}|\psi} \braket{\psi|e_{a_1}} \Braket{e_{a_1}|\sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)}|e_{a_2}} \\
  =& \operatorname{tr}\left(\ket{\psi}\bra{\psi} \sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)} \right) \\
  =& \operatorname{tr}\left(\ket{\psi}\bra{\psi} \operatorname{tr}_B \left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \right) \right) \\
  =& \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \hat{I}_B) (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B})\right) \\
  =& \frac{1}{\norm{\psi}^2} \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \hat{I}_B)^2 (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B})\right) \\
  =& \frac{1}{\norm{\psi}^2} \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \hat{I}_B)^2 (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B})(\ket{\psi}\bra{\psi}\otimes\hat{I}_B)\right) \\
  =& \frac{1}{\norm{\psi}^2} \operatorname{tr}\left((\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}) \right)
\end{align*}
$$

To prove the upper bound of the trace, let $\set{\ket{e_a \otimes f_b}}$ be an orthonormal basis of $\mathcal{H}_A \otimes \mathcal{H}_B$. Then

$$
\begin{align*}
  &\operatorname{tr}\left(\left(\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}\right) \hat{V}^\dagger \hat{V} \left(\ket{\psi}\bra{\psi} \otimes \sqrt{\hat{\rho}_B}\right) \right) \\
  =& \sum_{a,b} \Braket{e_a \otimes f_b|\left(\ket{\psi}\bra{\psi} \otimes\sqrt{\hat{\rho}_B}\right)\hat{V}^\dagger \hat{V} \left(\ket{\psi}\bra{\psi}\otimes\sqrt{\hat{\rho}_B}\right)|e_a \otimes f_b} \\
  =& \sum_{a,b} \Braket{\left(\ket{\psi}\bra{\psi} \otimes\sqrt{\hat{\rho}_B}\right)^\dagger e_a \otimes f_b |\hat{V}^\dagger \hat{V}| \left(\ket{\psi}\bra{\psi}\otimes\sqrt{\hat{\rho}_B}\right) e_a \otimes f_b} \\
  =& \sum_{a,b} \Braket{\left(\ket{\psi}\bra{\psi}^\dagger \otimes\sqrt{\hat{\rho}_B}^\dagger\right) e_a \otimes f_b |\hat{V}^\dagger \hat{V}| \left(\ket{\psi}\bra{\psi}\otimes\sqrt{\hat{\rho}_B}\right) e_a \otimes f_b} \\
  =& \sum_{a,b} \Braket{\left(\ket{\psi}\bra{\psi} \otimes\sqrt{\hat{\rho}_B}\right) e_a \otimes f_b |\hat{V}^\dagger \hat{V}| \left(\ket{\psi}\bra{\psi}\otimes\sqrt{\hat{\rho}_B}\right) e_a \otimes f_b} \\
  =& \sum_{a,b} \Braket{\ket{\psi}\braket{\psi|e_a} \otimes \sqrt{\hat{\rho}_B}\ket{f_b} |\hat{V}^\dagger \hat{V}| \ket{\psi}\braket{\psi|e_a}\otimes\sqrt{\hat{\rho}_B} \ket{f_b}} \\
  =& \sum_{a,b} |\braket{e_a|\psi}|^2 \Braket{\ket{\psi} \otimes \sqrt{\hat{\rho}_B}\ket{f_b} |\hat{V}^\dagger \hat{V}| \ket{\psi}\otimes\sqrt{\hat{\rho}_B} \ket{f_b}} \\
  \leq& \kappa \sum_{a,b} |\braket{e_a|\psi}|^2 \Braket{\ket{\psi} \otimes \sqrt{\hat{\rho}_B}\ket{f_b} | \ket{\psi}\otimes\sqrt{\hat{\rho}_B} \ket{f_b}} \\
  =& \kappa\norm{\psi}^2 \sum_b \braket{\psi|\psi} \Braket{\sqrt{\hat{\rho}_B}\ket{f_b}|\sqrt{\hat{\rho}_B}\ket{f_b}} \\
  =& \kappa\norm{\psi}^4 \sum_b \Norm{\sqrt{\rho}_B f_b}^2 = \kappa \norm{\psi}^4 \sum_b \norm{\sqrt{q_b} f_b}^2 \\
  =& \kappa\norm{\psi}^4 \sum_b q_b \underbrace{\norm{f_b}^2}_{=1} = \kappa\norm{\psi}^4 \underbrace{\sum_b q_b}_{=1} \\
  =& \kappa\norm{\psi}^4
\end{align*}
$$

</details>
</MathBox>

<MathBox title='Equivalence of operator-sum and environmental representation of quantum operations' boxType='theorem' tag='theorem-1'>
Let $\mathcal{H}_A$ be a finite-dimensional Hilbert space, and consider the convex-linear map

$$
\begin{align*}
  K:\mathcal{D}(\mathcal{H}_A) \to& \mathcal{D}_\leq (\mathcal{H}_A) \\
  \hat{\rho}_A \mapsto& \hat{K}(\hat{\rho}_A)
\end{align*}
$$

where

$$
  \mathcal{D}_\leq (\mathcal{H}_A) := \set{\hat{\rho} \in\mathcal{H}_A | \hat{\rho}^\dagger = \hat{\rho}, \hat{\rho}\geq 0, \operatorname{tr}(\hat{\rho}) \leq 1}
$$

Then for any $\kappa\in (0,1]$, the following equivalence holds: There exists a finite-dimensional Hilbert space $\mathcal{H}_B$, a bounded operator $\hat{V}\in\mathcal{B}(\mathcal{H}_A \otimes \mathcal{H}_B)$ and a density operator $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$ such that 

$$
\begin{equation}
  \hat{V}^\dagger \hat{V} \leq \kappa \hat{I}_{AB} \tag{\label{equation-7}}
\end{equation}
$$

and

$$
\begin{equation}
  \hat{K}(\hat{\rho}_A) = \operatorname{tr}^B \left(\hat{V}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger \right) \tag{\label{equation-8}}
\end{equation}
$$

if and only if there exist operators $\hat{K}_l \in\mathcal{L}(\mathcal{H}_A)$ for $l \in\set{1,\dots,m}$ with $m\leq \dim(\mathcal{H}_B)^2$ such that

$$
\begin{equation}
  \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A \tag{\label{equation-9}}
\end{equation}
$$

and

$$
\begin{equation}
  \hat{K}(\hat{\rho}_A) = \sum_{l=1}^m \hat{K}_l \hat{\rho}_A \hat{K}_l^\dagger \tag{\label{equation-10}}
\end{equation}
$$

Within this equivalence we have the special case

$$
  \hat{V}^\dagger \hat{V} = \kappa\hat{I}_{AB} \iff \sum_{l=1}^m \hat{K}_l^\dagger \hat{K}_l = \kappa\hat{I}_A
$$

<details>
<summary>Proof</summary>

From Lemma $\ref{lemma-1}$ we know that any superoperator of the form $\eqref{equation-10}$ maps into $\mathcal{D}_\leq (\mathcal{H}_A)$. Hence, it remains to prove the equivalence.

**($\implies$):** Let $\hat{V}\in\mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_B)$ be such that it satisfies $\eqref{equation-7}$ and $\eqref{equation-8}$. Let $\set{\ket{e_a}}$ be an orthonormal basis of $\mathcal{H}_A$. From properties of density operators, we know that there exists an orthonormal basis $\set{\ket{f_b}}\subset\mathcal{H}_B$ and a set of eigenvectors $q_b \geq 0$ with $\sum_b q_b = 1$ admitting the spectral decomposition

$$
  \hat{\rho}_B = \sum_b q_b \ket{f_b} \bra{f_b}
$$

Using this, we also define

$$
  \sqrt{\hat{\rho}_B} = \sum_b \sqrt{q_b} \ket{f_b} \bra{f_b}
$$

which satisfies

$$
\begin{align*}
  (\sqrt{\hat{\rho}})^2 =& \sum_{b_1, b_2} \sqrt{q_{b_1} q_{b_2}} \ket{f_{b_1}} \underbrace{\braket{f_{b_1}|f_{b_2}}}_{=\delta_{b_1 b_2}} \bra{f_{b_2}} \\
  =& \sum_b q_b \ket{f_b} \bra{f_b} = \hat{\rho}_B
\end{align*}
$$

and

$$
\begin{align*}
  (\sqrt{\hat{\rho}_B})^\dagger =& \left(\sum_b \sqrt{q_b} \ket{f_b} \bra{f_b} \right) \\
  =& \sum_b \sqrt{q_b} (\ket{f_b} \bra{f_b})^\dagger \\
  =& \sum_b \sqrt{q_b} \ket{f_b} \bra{f_b} = \sqrt{\hat{\rho}_B}
\end{align*}
$$

For $b_1, b_2 \in\set{1,\dots,\dim(\mathcal{\mathcal{H}_B})}$ we then define the operators $\hat{K}_{(b_1, b_2)}$ by specifying their matrix elements $(\hat{K}_{(b_1, b_2)})_{a_1 a_2}$ in the orthonormal basis $\set{\ket{e_a}}$ as

$$
  (\hat{K}_{(b_1, b_2)})_{a_1 a_2} = (\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}_B}))_{a_1 b_1, a_2 b_2}
$$

Then we have

$$
\begin{align*}
  (\hat{K}_{(b_1, b_2)}^\dagger)_{a_1 a_2} =& (\hat{K}_{(b_1, b_2)})_{a_1 a_2}^* \\
  =& (\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}_B}))_{a_1 b_1, a_2 b_2}^* \\
  =& (\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}_B}))_{a_1 b_1, a_2 b_2}^\dagger \\
  =& ((\hat{I}_A \otimes \sqrt{\hat{\rho}_B})^\dagger \hat{V}^\dagger)_{a_1 b_1, a_2 b_2} \\
  =& ((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}^\dagger) \hat{V}^\dagger)_{a_1 b_1, a_2 b_2} \\
  =& ((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger)_{a_1 b_1, a_2 b_2}
\end{align*}
$$

and thus

$$
\begin{align*}
  & \left(\sum_{b_1, b_2} \hat{K}_{(b_1, b_2)} \hat{\rho}_A \hat{K}_{(b_1, b_2)}^\dagger \right) = \sum_{b_1, b_2} \sum_{a_3, a_4} (\hat{K}_{(b_1, b_2)})_{a_1 a_3} \boldsymbol{\rho}_{a_3 a_4}^{(A)} (\hat{K}_{(b_1, b_2)}^\dagger)_{a_4 a_2} \\
  =& \sum_{b_1, b_2} \sum_{a_3, a_4} \left(\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\right)_{a_1 b_1, a_3 b_2} \boldsymbol{\rho}_{a_3 a_4}^{(A)} \left((\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\hat{V}^\dagger\right)_{a_4 b_2, a_2 b_1} \\
  =& \sum_{b_1, b_2, b_3} \sum_{a_3, a_4} \left(\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\right)_{a_1 b_1, a_3 b_2} \boldsymbol{\rho}_{a_3 a_4}^{(A)} \delta_{b_2, b_3} \left((\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\hat{V}^\dagger\right)_{a_4 b_3, a_2 b_1} \\
  =& \sum_{b_1, b_2, b_3} \sum_{a_3, a_4} \left(\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\right)_{a_1 b_1, a_3 b_2} \underbrace{(\hat{\rho}_A \otimes \hat{I}_B)_{a_3 b_2, a_4, b_3}}_{=\boldsymbol{\rho}_{a_3 a_4}^{(A)} \delta_{b_2, b_3}} \left((\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\hat{V}^\dagger\right)_{a_4 b_3, a_2 b_1} \\
  =& \sum_b \left(\hat{V}(\hat{I}_A \otimes \sqrt{\hat{\rho}^B}) (\hat{\rho}_A \otimes \hat{I}_B) (\hat{I}_A \otimes \sqrt{\hat{\rho}^B})\hat{V}^\dagger \right)_{a_1 b, a_2 b} \\
  =& \sum_b \left(\hat{V}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger\right)_{a_1 b, a_2 b} \\
  =& \operatorname{tr}_B \left(\hat{V} (\hat{\rho}_A \otimes \hat{\rho}_B)\hat{V}^\dagger \right)_{a_1 a_2} \\
  =& \hat{K}(\hat{\rho}_A) _{a_1 a_2}
\end{align*}
$$

proving $\eqref{equation-10}$. The sums $\sum_{b_1, b_2}$ run over the index sets indexing an orthonormal basis of $\mathcal{H}_B$ and thus the total number $m$ of operators $\hat{K}_{b_1, b_2}$ cannot exceed $\dim(\mathcal{H}_B)^2$. To show that $\eqref{equation-7}$ implies $\eqref{equation-9}$ we first note that

$$
\begin{align*}
  & \sum_{b_1, b_2} (\hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)})_{a_1 a_2} = \sum_{b_1, b_2, a_3} (\hat{K}_{(b_1, b_2)}^\dagger)_{a_1 a_3} (\hat{K}_{(b_1, b_2)})_{a_3 a_2} \\
  =& \sum_{b_1, b_2, a_3} \left((\hat{I}_A \otimes \sqrt{\hat{\rho}}_B)\hat{V}^\dagger \right)_{a_1 b_2, a_3 b_1} \left(\hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \right)_{a_3 b_1, a_2 b_2} \\
  =& \sum_b \left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B})\right)_{a_1 b, a_2 b} \\
  =& \operatorname{tr}_B \left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \right)_{a_1 a_2}
\end{align*}
$$

such that

$$
  \sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)} = \operatorname{tr}\left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}\hat{V}^\dagger (\hat{I}_A \otimes \sqrt{\hat{\rho}}_B) \right)
$$

From Lemma $\ref{lemma-2}$, it follows that for any $\ket{\psi}\in\mathcal{H}_A$

$$
  \Braket{\psi|\sum_{b_1, b_2} \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)}|\psi} \leq \kappa\norm{\psi}^2 = \braket{\psi|\kappa\hat{I}_A|\psi}
$$

which is equivalent to $\eqref{equation-9}$. For the special case $\hat{V}^\dagger \hat{V} = \kappa\hat{I}_{AB}$ we have

$$
\begin{align*}
  \sum_{b_1, b_2} =& \hat{K}_{(b_1, b_2)}^\dagger \hat{K}_{(b_1, b_2)} = \operatorname{tr}\left((\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \hat{V}^\dagger \hat{V} (\hat{I}_A \otimes \sqrt{\hat{\rho}_B}) \right) \\
  =& \kappa\operatorname{tr}_B \left((\hat{I}_A \otimes \sqrt{\hat{\rho}})(\hat{I}_A \otimes\sqrt{\hat{\rho}_B}) \right) \\
  =& \kappa\operatorname{tr}_B (\hat{I}_A \otimes \hat{\rho}_B) = \kappa\operatorname{tr}(\hat{\rho}_B) \hat{I}_A \\
  =& \kappa\hat{I}_A 
\end{align*}
$$

To prove $\impliedby$ let $\hat{K}_l \in\mathcal{L}(\mathcal{H}_A)$ for $l\in\set{1,\dots,m}$ be such that they satisfy $\eqref{equation-9}$ and $\eqref{equation-10}$. Furthermore, let $\mathcal{H}_B$ be a Hilbert space with an orthonormal basis $\set{\ket{f_b}}_{b=1}^m$. We embed $\mathcal{H}_A$ in $\mathcal{H}_A \otimes \mathcal{H}_B$ by

$$
\begin{align*}
  \iota : \mathcal{H}_A \to& \hat{H}_B \\
  \ket{\psi} \mapsto& \ket{\psi\otimes f_1} = \ket{\psi}\otimes\ket{f_1}
\end{align*}
$$

and define

$$
\begin{align*}
  \check{V} : \iota\set{\mathcal{H}_A} \to& \mathcal{H}_A \otimes \mathcal{H}_B \\
  \ket{\psi\otimes f_1} \mapsto& \sum_{l=1}^m \hat{K}_l \ket{\psi} \otimes \ket{f_l}
\end{align*}
$$

Noting that

$$
\begin{align*}
  \braket{\check{V}^\dagger (e_a \otimes f_b)|\psi\otimes f_1} =& \braket{e_a \otimes f_b | \check{V}(\psi \otimes f_1)} \\
  =& \Braket{e_a \otimes | \sum_l \hat{K}_l \ket{\psi}\otimes \ket{f_l}} \\
  =& \sum_l \braket{e_a|\hat{K}_l \psi} \underbrace{\braket{f_b|f_l}}_{\delta_{bl}} \\
  =& \braket{e_a|K_b \psi}
\end{align*}
$$

then for any $\ket{\psi\otimes f_1}\in\iota\set{\mathcal{H}_A}$ the linear operator $\check{V}$ satisfies

$$
\begin{align*}
  \braket{\psi\otimes f_1 | \check{V}^\dagger (e_a \otimes f_b)} =& \braket{\check{V}^\dagger (e_a \otimes f_b)|\psi\otimes f_1}^\dagger \\
  =& \braket{e_a|\hat{K}_b \psi}^\dagger = \braket{\hat{K}_b \psi|e_a} = \braket{\psi|\hat{K}_b^\dagger e_a} \\
  =& \sum_l \braket{\psi|\hat{K}_l^\dagger e_a} \braket{f_l|f_b}_{=\delta_{lb}} \\
  =& \left(\sum_l \bra{\psi} \hat{K}_l^\dagger \otimes \ket{f_l} \right) \left(\ket{e_a \otimes f_b} \right)
\end{align*}
$$

For every $\ket{\psi\otimes f_1}\in\iota\set{\mathcal{H}_A}$ the linear operator $\check{V}$ also satisfies

$$
\begin{align*}
  \braket{\psi\otimes f_1 | \check{V}^\dagger \check{V} (\psi\otimes f_1)} =& \braket{\check{V}(\psi\otimes f_1)|\check{V}(\psi\otimes f_1)} \\
  =& \sum_{l_1, l_2} \braket{\hat{K}_{l_1} \psi\otimes f_{l_1}|\hat{K}_{l_2} \psi \otimes f_{l_2}} \\
  =& \sum_{l_1, l_2} \braket{\hat{K}_{l_1} \psi|\hat{K}_{l_2} \psi} \underbrace{f_{l_1}|f_{l_2}}_{=\delta_{l_1 l_2}} \\
  =& \sum_l \braket{\hat{K}_l \psi| \hat{K}_l \psi} \\
  =& \Braket{\psi|\sum_l \hat{K}_l^\dagger \hat{K}_l|\psi}
\end{align*}
$$

We thus have

$$
\begin{align*}
  & \sum_l \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A \\
  \implies& \Braket{\psi|\sum_l \hat{K}_l^\dagger \hat{K}_l|\psi} \leq \kappa\norm{\psi}^2 = \kappa\norm{\psi}^2 \norm{f_1}^2, \;\forall \ket{\psi}\in\mathcal{H}_A \\
  \implies& \braket{\psi\otimes f_1| \check{V}^\dagger \check{V}|\psi\otimes f_1} \leq \kappa\norm{\psi\otimes f_1}^2, \;\ket{\psi}\otimes f_1 \in \iota\set{\mathcal{H}_A} \\
  \implies& \check{V}^\dagger \check{V} \leq \kappa\hat{I}_{\iota\set{\mathcal{H}_A}}
\end{align*}
$$

where equality implies equality in each step. The operator $\check{V}$ is defined on the $\dim(\mathcal{H}_A)$-dimensional subspace $\iota\set{\mathcal{H}_A}$ of $\mathcal{H}_A \otimes \mathcal{H}_B$ with dimension $\dim(\mathcal{H}_A)\dim(\mathcal{H}_B)$. We can extend $\check{V}$ to an operator $\hat{V}$ on all of $\mathcal{H}_A \otimes \mathcal{H}_B$ by setting

$$
  \mathbf{V}^\dagger \mathbf{V} = \begin{bmatrix}
    \check{\mathbf{V}}^\dagger \check{\mathbf{V}} & \mathbf{0}_{\dim(\mathcal{H}_A) \times \dim(\mathcal{H}_B)} \\
    \mathbf{0}_{\dim(\mathcal{H}_B) \times \dim(\mathcal{H}_A)} & \kappa \mathbf{I}_{\dim(\mathcal{H}_B)}
  \end{bmatrix}
$$

which satisfies $\hat{V}^\dagger \hat{V} \leq \kappa\hat{I}_{AB}$ if $\sum_l \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A$ or $\hat{V}^\dagger \hat{V} = \kappa\hat{I}_{AB}$ if $\sum_l \hat{K}_l^\dagger \hat{K}_l = \kappa\hat{I}_A$.

It remains to show $\eqref{equation-8}$. For this we set

$$
  \hat{\rho}_B = \ket{f_1} \bra{f_1} \in\mathcal{D}(\mathcal{H}_B)
$$

and recall that any $\hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)$ can be written in the form

$$
  \hat{\rho}_A = \sum_a p_a \ket{e_a} \bra{e_a}
$$

where $p_a \in [0,1]$ satisfy $\sum_a p_a = 1$ and $\set{\ket{e_a}}$ forms an orthonormal basis of $\mathcal{H}_A$. Thus, we obtain

$$
\begin{align*}
  \hat{V} (\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger =& \sum_a p_a \hat{V} (\ket{e_a}\bra{e_a} \otimes \ket{f_1}\bra{f_1}) \hat{V}^\dagger \\
  =& \sum_a p_a \hat{V} \ket{e_a \otimes f_1} \bra{e_a \otimes f_1} \hat{V}^\dagger
\end{align*}
$$

where

$$
\begin{align*}
  V\ket{e_a \otimes f_1} =& \check{V} \ket{e_a \otimes f_1} = \sum_l \hat{K}_l \ket{e_a} \otimes \ket{f_1} \\
  \bra{e_a \otimes f_1} \hat{V}^\dagger =& \bra{e_a \otimes f_1} \check{V}^\dagger = \sum_l \bra{e_a}\hat{K}_l^\dagger \otimes \bra{f_l}
\end{align*}
$$

This yields

$$
\begin{align*}
  \hat{V}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger =& \sum_{a, l_1, l_2} p_a \left(\hat{K}_{l_1} \ket{e_a} \otimes \ket{f_{l_1}} \right) \left(\bra{e_a} \hat{K}_{l_2}^\dagger \otimes \bra{f_{l_2}} \right) \\
  =& \sum_{a, l_1, l_2} p_a \hat{K}_{l_1} \ket{e_a} \bra{e_a} \hat{K}_{l_2}^\dagger \otimes \ket{f_{l_1}} \bra{f_{l_2}} \\
  =& \sum_{l_1, l_2} \hat{K}_{l_1} \left(\sum_a p_a \ket{e_a} \bra{e_a} \right) \hat{K}_{l_2}^\dagger \otimes \ket{f_{l_1}} \bra{f_{l_2}} \\
  =& \sum_{l_1, l_2} \hat{K}_{l_1} \rho^A \hat{K}_{l_2}^\dagger \otimes \ket{f_{l_1}} \bra{f_{l_2}}
\end{align*}
$$

Taking the partial trace over $\mathcal{H}_B$ it follows that

$$
\begin{align*}
  \operatorname{tr}_B \left(\hat{V}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger \right) =& \operatorname{tr}_B \left( \sum_{l_1, l_2} \hat{K}_{l_1} \hat{\rho}_A \hat{K}_{l_2}^\dagger \otimes \ket{f_{l_1}} \bra{f_{l_2}} \right) \\
  =& \sum_{l_1, l_2} \operatorname{tr}_B \left(\hat{K}_{l_1} \hat{\rho}_A \hat{K}_{l_2}^\dagger \otimes \ket{f_{l_1}}\bra{f_{l_2}} \right) \\
  =& \sum_{l_1, l_2} \operatorname{tr}(\ket{f_{l_1}}\bra{f_{l_2}}) \hat{K}_{l_1} \hat{\rho}_A \hat{K}_{l_2}^\dagger
\end{align*}
$$

where we can use

$$
\begin{align*}
  \operatorname{tr}(\ket{f_{l_1}}\bra{f_{l_2}}) =& \sum_b \braket{f_b|f_{l_1}} \braket{f_{l_2}|f_b} \\
  =& \sum_b \delta_{bl_1} \delta_{l_2} b = \delta_{l_1 l_2}
\end{align*}
$$

leading to

$$
  \operatorname{tr}_B \left(\hat{V}(\hat{\rho}_A \otimes \hat{\rho}_B) \hat{V}^\dagger \right) = \sum_l \hat{K}_l \hat{\rho}_A \hat{K}_l^\dagger = \hat{K}(\hat{\rho}_A)
$$

This verifies $\eqref{equation-8}$, completing the proof.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Let $\mathcal{H}_A$ and $\mathcal{H}_B$ be finite-dimensional Hilbert spaces and let $\hat{K}: \mathcal{D}(\mathcal{H}_A) \to\mathcal{D}_\leq (\mathcal{H}_A)$ have the equivalent representations given in Theorem $\ref{theorem-1}$ with $\hat{V}\in\mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_B)$, $\hat{\rho}_B \in\mathcal{D}(\mathcal{H}_B)$ and $\hat{K}_l \in\mathcal{L}(\mathcal{H}_A)$ for $l\in\set{1,\dots,m}$. For any $\kappa\in (0,1]$ we then have

$$
\begin{align*}
  \hat{V}^\dagger \hat{V} \leq \kappa\hat{I}_{AB} \iff& \sum_l \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A \\
  \iff& \operatorname{tr}\left(\hat{K}(\hat{\rho}^A) \right) \leq \kappa, \forall \hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)
\end{align*}
$$

and equality in one relation is equivalent to equality in the other two relations. In particular, for equality with $\kappa = 1$ we have

$$
\begin{align*}
  \hat{V} \in\mathcal{U}(\mathcal{H}_A \otimes H_B) \iff& \sum_l \hat{K}_l^\dagger \hat{K}_l = \hat{I}_A \\
  \iff& \operatorname{tr}\left(\hat{K}(\rho_A) \right) = 1, \forall \hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)
\end{align*}
$$

<details>
<summary>Proof</summary>

From Theorem $\ref{theorem-1}$ we know that

$$
  \hat{V}^\dagger \hat{V} \leq \kappa\hat{I}_{AB} \iff \sum_l \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A
$$

with equality on one side implying equality on the other and from Lemma $\ref{lemma-1}$ we know that

$$
  \sum_l \hat{K}_l^\dagger \hat{K}_l \leq \kappa\hat{I}_A \iff \operatorname{tr}\left(\hat{K}(\hat{\rho}_A)\right) \leq \kappa, \; \forall\hat{\rho}_A \in\mathcal{D}(\mathcal{H}_A)
$$

where again equality on one side implies equality on the other.
</details>
</MathBox>

# Quantum gates and circuits

## Classical gates

<TableFigure caption="Classical logic gates">
| Name | Symbol | Function | Truth table |
| --- | --- | --- | --- |
| NOT | <img src="/fig/not_gate.svg"/> | $x_1 \mapsto 1 \overset{2}{\oplus} x_1$ | $$\begin{array}{c:c} x_1 & \operatorname{NOT}(x_1) \\ \hline 0 & 1 \\ 1 & 0 \end{array}$$ |
| AND | <img src="/fig/and_gate.svg"/> | $(x_1, x_2) \mapsto x_1 x_2$ | $$\begin{array}{c:c:c} x_1 & x_2 & \operatorname{AND}(x_1, x_2) \\ \hline 0 & 0 & 0 \\ 0 & 1 & 0 \\ 1 & 0 & 0 \\ 1 & 1 & 1 \end{array}$$ |
| OR | <img src="/fig/or_gate.svg"/> | $(x_1, x_2) \mapsto x_1 \overset{2}{\oplus} x_2 \overset{2}{\oplus} x_1 x_2$ | $$\begin{array}{c:c:c} x_1 & x_2 & \operatorname{OR}(x_1, x_2) \\ \hline 0 & 0 & 0 \\ 0 & 1 & 1 \\ 1 & 0 & 1 \\ 1 & 1 & 1 \end{array}$$ |
| XOR | <img src="/fig/xor_gate.svg"/> | $(x_1, x_2) \mapsto x_1 \overset{2}{\oplus} x_2$ | $$\begin{array}{c:c:c} x_1 & x_2 & \operatorname{XOR}(x_1, x_2) \\ \hline 0 & 0 & 0 \\ 0 & 1 & 1 \\ 1 & 0 & 1 \\ 1 & 1 & 0 \end{array}$$ |
| ID | | $x_1 \mapsto x_1$ | $$\begin{array}{c:c} x_1 & \operatorname{ID}(x_1) \\ \hline 0 & 0 \\ 1 & 1 \end{array}$$ |
| FALSE | | $x_1 \mapsto 0$ | $$\begin{array}{c:c} x_1 & \operatorname{FALSE}(x_1) \\ \hline 0 & 0 \\ 1 & 0 \end{array}$$ |
| TRUE | | $x_1 \mapsto 1$ | $$\begin{array}{c:c} x_1 & \operatorname{TRUE}(x_1) \\ \hline 0 & 1 \\ 1 & 1 \end{array}$$ |
| COPY | | $x_1 \mapsto (x_1, x_1)$ | $$\begin{array}{c:c} x_1 & \operatorname{TRUE}(x_1) \\ \hline 0 & (0,0) \\ 1 & (1,1) \end{array}$$ |
</TableFigure>

<MathBox title='Classical logic gate' boxType='definition'>
A classical logic gate is a function $g:\set{0,1}^n \to \set{0,1}$ that maps an $n$-bit input to a single output bit. An extended classical logic gate generalizes this concept to multiple outputs as a function $g: \set{0,1}^n \to\set{0,1}^m$ given by

$$
  (x_1,\dots,x_n) \mapsto (g_1(x_1,\dots,x_n),\dots,g_m(x_1,\dots,x_n))
$$

where each $g_j$ is an elementary gate. 

A classical gate $g$ is *reversible* if it is a bijection.
</MathBox>

<MathBox title='Binary addition' boxType='definition'>
For $u,v\in\set{0,1}$ we define binary addition as

$$
  u \overset{2}{\oplus} v := (u + v) \mod 2
$$
</MathBox>

<MathBox title='Logical circuits' boxType='definition' tag='definition-1'>
We denote by $\mathcal{F}[g_1,\dots,g_K]$ the set og all gates which can be constructed from $g_1,\dots,g_K$. This set is defined by the following construction rules:
1. the $g_1,\dots,g_K$ are elements of this set, i.e. $g_1,\dots,g_K\in\mathcal{F}[g_1,\dots,g_K]$ 
2. padding operations of the form
$$
\begin{align*}
  p_{y_1,\dots,y_l;j_1,\dots,j_l}^{(n)} : \set{0,1}^n to& \set{0,1}^{n+1} \\
  (x_1,\dots,x_n) \mapsto& (x_1,\dots,x_{j_1} - 1, y_{j_1}, x_{j_1 + 1},\dots,x_n)
\end{align*}
$$

which insert pre-determined bit values $y_1,\dots,y_l \ini\set{0,1}$ at pre-determined slots $j_1,\dots,j_l \in\set{1,\dots,n+1}$ are lelemts of the set, that is, for any $l,n\in\N_+, y_1,\dots,y_l\in\set{0,1}$ and pairwise distinct $j_1,\dots,j_l\in\set{1,\dots,n+1}$
$$
  p_{y_1,\dots,y_l;j_1,\dots,j_l}^{(n)} \in\mathcal{F}[g_1,\dots,g_K]
$$

3. restriction and/or re-ordering operations
$$
\begin{align*}
  r_{j_1,\dots,j_}^{(n)} : \set{0,1}^n \to& \set{0,1}^l \\
  (x_1,\dots,x_n) \mapsto& (x_{j_1},\dots,x_{j_l})
\end{align*}
$$
are elements of the set, that is, for any $l,n\in\N_+$, and pairwise distinct $j_1,\dots,j_k\in\set{1,\dots,l}$
$$
  r_{j_1,\dots,j_}^{(n)} \in\mathcal{F}[g_1,\dots,g_K]
$$

4. compositions of elements of the set belong to the set, that is, for any $h_1:\set{0,1}^n \to\set{0,1}^m$ and $h_2 :\set{0,1}^l \to\set{0,1}^n$ we have that
$$
  h_1, h_2 \in\mathcal{F}[g_1,\dots,g_k] \implies h_1 \circ h_2 \in\mathcal{F}[g_1,\dots,g_K]
$$

5. cartesian products of elements of the set belong to the set, that is, for any $h:\set{0,1}^n \to\set{0,1}^m$ and $k:\set{0,1}^p \to\set{0,1}^q$ we have that
$$
  h, k \in\mathcal{F}[g_1,\dots,g_K] \implies h\times k \in\mathcal{F}[g_1,\dots,g_K]
$$
where $h\times k :\set{0,1}^{n+p} \to \set{0,1}^{m+q}$ with
$$
\begin{align*}
  &h\times k (x_1,\dots,x_{n+p}) \\
  =& (h(x_1,\dots,x_n)_1,\dots,h(x_1,\dots,x_n)_m, k(x_{n+1},\dots,x_{n+p})_1,\dots,k(x_{n+1},\dots,x_{n+p})_q)
\end{align*}
$$

A set $G = \set{g_1,\dots,g_J}$ of classical gates is universal if any gate $g$ can be constructed with gates from $G$, that is, for every gate $g$
$$
  g\in\mathcal{F}[g_1,\dots,g_J], \; g_1,\dots,g_J \in G
$$

When multiple gates are connected the resulting arrays are called classical digital logical circuits.
</MathBox>

<MathBox title='' boxType='lemma'>
For gates $h_1,\dots,h_L,g_1,\dots,g_K$ we have

$$
  h_1,\dots,h_L \in\mathcal{F}[g_1,\dots,g_K] \implies \mathcal{F}[h_1,\dots,h_L]\subset \mathcal{F}[g_1,\dots,g_K]
$$

such that in particular

$$
  \mathcal{F}[\mathcal{F}[g_1,\dots,g_K]] \subset \mathcal{F}[g_1,\dots,g_K]
$$

<details>
<summary>Proof</summary>

The stated inclusion is a direct consequence of Definition $\ref{definition-1}$ since the operations to build any element in $\mathcal{F}[h_1,\dots,h_L]$ from the $h_1,\dots,h_L$ are the same as to build any element in $\mathcal{F}[g_1,\dots,g_K]$ from its elements and since the $h_1,\dots,h_L$ are members of this set.
</details>
</MathBox>

<MathBox title='Toffoli gate' boxType='example'>
For $(x_1,x_2,x_3)\in\set{0,1}^3$ we have

$$
\begin{align*}
  &(\operatorname{ID}\times\operatorname{ID}\times\operatorname{XOR})\circ(\operatorname{ID}\times\operatorname{ID}\times\operatorname{AND}\times\operatorname{ID}) \\
  &\circ r_{1,3,2,4,5}^{(5)} \circ (\operatorname{COPY}\times\operatorname{COPY}\times\operatorname{ID})(x_1,x_2,x_3) \\
  =& (\operatorname{ID}\times\operatorname{ID}\times\operatorname{XOR})\circ(\operatorname{ID}\times\operatorname{ID}\times\operatorname{AND}\times\operatorname{ID}) \\
  &\circ r_{1,3,2,4,5}^{(5)} (x_1,x_1,x_2,x_2,x_3) \\
  =& (\operatorname{ID}\times\operatorname{ID}\times\operatorname{XOR})\circ(\operatorname{ID}\times\operatorname{ID}\times\operatorname{AND}\times\operatorname{ID}) (x_1,x_1,x_2,x_2,x_3) \\
  =& (\operatorname{ID}\times\operatorname{ID}\times\operatorname{XOR}) (x_1,x_1,x_2,x_2,x_3) \\
  =& (x_1,x_2,x_1 x_2 \overset{2}{\oplus} x_3) \\
  =& \operatorname{TOF}(x_1,x_2,x_3)
\end{align*}
$$

Hence,

$$
\begin{align*}
  \operatorname{TOF} =& (\operatorname{ID}\times\operatorname{ID}\times\operatorname{XOR})\circ(\operatorname{ID}\times\operatorname{ID}\times\operatorname{AND}\times\operatorname{ID}) \\
  &\circ r_{1,3,2,4,5}^{(5)} \circ (\operatorname{COPY}\times\operatorname{COPY}\times\operatorname{ID})
\end{align*}
$$

so that $\operatorname{TOF}\in\mathcal{F}[\operatorname{ID},\operatorname{AND},\operatorname{XOR},\operatorname{COPY}]$.
</MathBox>

<MathBox title='' boxType='proposition'>
The classical Toffoli gate is universal and reversible.

<details>
<summary>Proof</summary>

Since every gate $g:\set{0,1}^n \to\set{0,1}^m$ can be decomposed in $m$ gates $g_j : \set{0,1}^n \to\set{0,1}$, where $j\in\set{1,\dots,m}$ it suffices to show universality only for a gate of the form $f:\set{0,1}^n \to\set{0,1}$, which we shall do by induction in $n$.

Consider the base case $n = 1$. From the elementary gates, we see that $\operatorname{ID}$, $\operatorname{FALSE}$, $\operatorname{TRUE}$ and $\operatorname{NOT}$ can be replicated by the various channels of $\operatorname{TO}$ as follows:

$$
\begin{equation}
\begin{split}
  \operatorname{ID}(x_1) =& x_1 = \operatorname{TOF}_1 (x_1, 1, 1) = r_1^{(3)} \circ \operatorname{TOF}\circ p_{1,1;2,3}^{(1)} (x_1) \\
  \operatorname{FALSE}(x_1) =& 0 = \operatorname{TOF}_1 (0,0,0) = r_1^{(3)} \circ \operatorname{TOF}\circ p_{0,0,0;1,2,3}^{(0)} (x_1) \\
  \operatorname{TRUE}(x_1) =& 1 = \operatorname{TOF}_1 (1,0,0) = r_1^{(3)} \circ \operatorname{TOF}\circ p_{1,0,0;1,2,3}^{(1)} (x_1) \\
  \operatorname{NOT}(x_1) =& 1\overset{2}{\oplus} = \operatorname{TOF}_3 (1,1,x_1) = r_1^{(3)} \circ \operatorname{TOF}\circ p_{1,1;1,2}^{(1)} (x_1)
\end{split}
\tag{\label{equation-11}}
\end{equation}
$$

Consequently, every gate $f:\set{0,1}\to\set{0,1}$ can be constructed with $\operatorname{TOF}$. Morevover, the following shows that we can also build $\operatorname{AND}$, $\operatorname{XOR}$, $\operatorname{COPY}^{(1)}$ and $\operatorname{COPY}^{(n)}$ with $\operatorname{TOF}$, i.e.

$$
\begin{equation}
\begin{split}
  \operatorname{AND}(x_1, x_2) =& x_1 x_2 = \operatorname{TOF}_3 (x_1,x_2,0) = r_3^{(3)} \circ \operatorname{TOF}\circ p_{0;3}^{(2)} (x_1, x_2) \\
  \operatorname{XOR}(x_1, x_2) =& x_1 \overset{2}{\oplus} x_2 = \operatorname{TOF}_3 (1,x_1,x_2) = r_3^{(3)} \circ \operatorname{TOF}\circ p_{1;1}^{(2)} (x_1, x_2)
\end{split}
\tag{\label{equation-12}}
\end{equation}
$$

and

$$
\begin{align*}
  \operatorname{COPY}^{(1)}(x_1) =& (x_1, x_2) = (\operatorname{TOF}_3 (x_1,1,0), \operatorname{TOF}_3 (x_1, 1, 0)) \\
  =& r_{1,3}^{(3)} \circ \operatorname{TOF} \circ p_{1,0;2,3}^{(1)} (x_1) \\
  \operatorname{COPY}^{(n)}(x_1,\dots,x_n) =& (x_1,\dots,x_n,x_1,\dots,x_n) \\
  =& r_{1,3,5,\dots,2n-1,2,4,\dots,2n}^{(2n)} \circ \operatorname{COPY}^{(1)} \times\cdots\times \operatorname{COPY}^{(1)} (x_1,\dots,x_n)
\end{align*}
$$

Hence, according to Definition $\ref{definition-1}$, it follows that

$$
\begin{equation}
  \operatorname{ID},\operatorname{FALSE},\operatorname{TRUE},\operatorname{NOT},\operatorname{AND},\operatorname{XOR},\operatorname{COPY}^{(n)}\in\mathcal{F}[\operatorname{TOF}] \tag{\label{equation-14}}
\end{equation}
$$

For the inductive step from $n-1$ to $n$, assume $\operatorname{TOF}$ is universal for gates of the form $g:\set{0,1}^{n-1} \to \set{0,1}$. Let $f:\set{0,1}^n \to\set{0,1}$ be arbitrary. Then, for $x_n \in\set{0,1}$ define

$$
  g_{x_n} (x_1,\dots,x_{n-1}) := f(x_1,\dots,x_{n-1},x_n)
$$

and

$$
\begin{equation}
\begin{split}
  h(x_1,\dots,x_n) := \operatorname{XOR}\left(&\operatorname{AND}(g_0(x_1,\dots,x_{n-1}), \operatorname{NOT}(x_n)), \right. \\
  &\left. \operatorname{AND}(g_1(x_1,\dots,x_{n-1}), x_n) \right)
\end{split}
\tag{\label{equation-13}}
\end{equation}
$$

Due to the induction assumption, $g_0$ and $g_1$ can be built with $\operatorname{TOF}$, and because of $\eqref{equation-11}$ and $\eqref{equation-12}$, we know that $\operatorname{NOT}$, $\operatorname{AND}$ and $\operatorname{XOR}$ can be constructed with $\operatorname{TOF}$. Altogether thus $h$ in $\eqref{}$ can be built with $\operatorname{TOF}$. At the same time, we have $h=f$, since

$$
\begin{equation}
  h(x_1,\dots,x_{n-1},0) =& \operatorname{XOR}\left(&\operatorname{AND}(g_0(x_1,\dots,x_{n-1}), \operatorname{NOT}(0)), \right. \\
  &&\left. \operatorname{AND}(g_1(x_1,\dots,x_{n-1}), 0) \right) \\
  &= \operatorname{XOR}(& g_0(x_1,\dots,x_{n-1}), 0) \\
  =& g_0 (x_1,\dots,x_{n-1}) \\
  =& f(x_1,\dots,x_{n-1},0)
\end{equation}
$$

and

$$
\begin{equation}
  h(x_1,\dots,x_{n-1},1) =& \operatorname{XOR}\left(&\operatorname{AND}(g_0(x_1,\dots,x_{n-1}), \operatorname{NOT}(1)), \right. \\
  &&\left. \operatorname{AND}(g_1(x_1,\dots,x_{n-1}), 1) \right) \\
  &= \operatorname{XOR}(& 0, g_0(x_1,\dots,x_{n-1}), 0) \\
  =& g_0 (x_1,\dots,x_{n-1}) \\
  =& f(x_1,\dots,x_{n-1},1)
\end{equation}
$$

In other words, we have

$$
  f = \operatorname{XOR}\circ(\operatorname{AND}\times\operatorname{AND})\circ((g_0 \times \operatorname{NOT})\times(g_1 \times\operatorname{ID})) \circ \operatorname{COPY}^{(n)}
$$

and because of $\eqref{equation-14}$ and the induction-assumption $g_0, g_1 \in\mathcal{F}[\operatorname{TOF}]$, it follows from Definition $\ref{definition-1}$ that $f\in\operatorname{TOF}$. Consequently, $\operatorname{TOF}$ is universall. The invertibility of $\operatorname{TOF}$ follows fomr

$$
\begin{align*}
  \operatorname{TOF}\circ\operatorname{TOF}(x_1,x_2,x_3) =& \operatorname{TOF}(x_1,x_2,x_3 \overset{2}{\oplus} x_1 x_2) \\
  =& (x_1,x_2,x_3 \overset{2}{\oplus} \underbrace{x_1 x_2 \overset{2}{\oplus} x_1 x_2}_{=0}) \\
  =& (x_1,x_2,x_3)
\end{align*}
$$

which means that $\operatorname{TOF}$ is its own inverse gate and thus reversible.
</details>
</MathBox>

## Quantum gates

<MathBox title='Quantum gate' boxType='definition' tag='definition-2'>
A *quantum $n$-gate* is a unitary operator

$$
  \hat{U}: {}^\P \mathcal{H}^{\otimes n} \to {}^\P \mathcal{H}^{\otimes n}, \; \hat{U}\in\mathcal{U}({}^\P \mathcal{H}^{\otimes n})
$$

For $n = 1$ a gate $\hat{U}$ is called a *unary quantum gate* and for $n = 2$ a *binary quantum gate*.
</MathBox>

### Unary quantum gates

<TableFigure caption="Unary quantum gates">
| Name | Symbol | Operator | Matrix in basis $\set{\ket{0},\ket{1}}$ |
| --- | --- | --- | --- |
| Identity | <img src="/fig/identity_gate.svg"/> | $\hat{I}$ | $$\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$$ |
| Phase-factor | <img src="/fig/phasefactor_gate.svg"/> | $\hat{M}(\alpha) := e^{i\alpha}\hat{I}$ | $$\begin{bmatrix} e^{i\alpha} & 0 \\ 0 & e^{i\alpha} \end{bmatrix}$$ |
| Phase-shift | <img src="/fig/phaseshift_gate.svg"/> | $\hat{P}(\alpha) := \ket{0}\bra{0} + e^{i\alpha}$ | $$\begin{bmatrix} 1 & 0 \\ 0 & e^{i\alpha} \end{bmatrix}$$ |
| Pauli-X or Q-NOT | <img src="/fig/pauli_x_gate.svg"/> | $\hat{X} := \sigma_x$ | $$\begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$$ |
| Pauli-Y | <img src="/fig/pauli_y_gate.svg"/> | $\hat{Y} := \sigma_y$ | $$\begin{bmatrix} 0 & -i \\ i & 0 \end{bmatrix}$$ |
| Pauli-Z | <img src="/fig/pauli_z_gate.svg"/> | $\hat{Z} := \sigma_z$ | $$\begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}$$ |
| Hadamard | <img src="/fig/hadamard_gate.svg"/> | $\hat{H} := \frac{\sigma_x + \sigma_z}{\sqrt{2}}$ | $$\frac{1}{\sqrt{2}}\begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}$$ |
</TableFigure>

### Binary quantum gates

<TableFigure caption="Binary quantum gates">
| Name | Symbol | Operator | Matrix in basis $\set{\ket{0},\ket{1}}$ |
| --- | --- | --- | --- |
| Controlled NOT (C-NOT) | <img src="/fig/controlled_not_gate.svg"/> | $\Lambda^1 (\hat{X}) =\ket{0}\bra{0}\otimes\hat{I} + \ket{1}\hat{1}\otimes\hat{X}$ | $$\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}$$ |
| C-NOT with control in 2nd qubit | <img src="/fig/controlled_note_2nd_qubit_gate.svg"/> | $\Lambda_1 (\hat{X}) = \hat{I}\otimes\ket{0}\bra{0} + \hat{X}\otimes\ket{1}\hat{1} = \hat{H}^{\otimes 2} \Lambda^1 (X) H^{\otimes 2}$ | $$\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 0 & 1 & 0 & 0 \end{bmatrix}$$ |
| Controlled phase-multiplication | <img src="/fig/controlled_phase_multiplication_gate.svg"/> | $\Lambda^1 (\hat{M}(\alpha)) =\ket{0}\bra{0}\otimes\hat{I} + \ket{1}\hat{1}\otimes e^{i\alpha} \hat{I} = \hat{P}(\alpha)$ | $$\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & e^{i\alpha} & 0 \\ 0 & 0 & 0 & e^{i\alpha} \end{bmatrix}$$ |
| C-NOT with $\ket{0}$ | <img src="/fig/controlled_not_down_gate.svg"/> | $\Lambda^{\ket{0}} (\hat{X}) =\ket{1}\bra{1}\otimes\hat{I} + \ket{0}\hat{0}\otimes\hat{X} = (\hat{X}\otimes\hat{I})\Lambda^1 (\hat{X})(\hat{X}\otimes\hat{I}$ | $$\begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}$$ |
| Swap | <img src="/fig/swap_gate.svg"/> | $\hat{S} =\ket{00}\bra{00} + \ket{11}\hat{11} + \ket{01}\hat{10} + \ket{10}\hat{01} = \Lambda^1 (\hat{X}) \Lambda_1 (\hat{X}) \Lambda^1 (X)$ | $$\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}$$ |
| Controlled V | <img src="/fig/controlled_v_gate.svg"/> | $\Lambda^1 (\hat{V}) =\ket{0}\bra{0}\otimes\hat{I} + \ket{1}\hat{1}\otimes\hat{V} = (P(\alpha)\otimes\hat{A})\Lambda^1 (\hat{X}) (\hat{I}\otimes\hat{B})\Lambda^1 (\hat{X}) (\hat{I}\otimes\hat{C})$ where $\hat{V} = \hat{M}(\alpha) \hat{A}\hat{X}\hat{B}\hat{X}\hat{C}$ and $\hat{I} = \hat{A}\hat{B}\hat{C}$ | $$\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & \nu_{00} & \nu_{01} \\ 0 & 0 & \nu_{10} & \nu_{11} \end{bmatrix}$$ |
</TableFigure>

## General quantum gates

</MathBox title='' boxType='definition'>
For $\hat{U}_j \in\mathcal{U}({}^\P \mathcal{H}^{\otimes n_j})$ with $j\in\set{1,\dots,K}$ we by $\mathcal{F}[\hat{U}_1,\dots,\hat{U}_k]$ the set of gates which can be constructed with the $\hat{U}_1,\dots,\hat{U}_k$. This set is defined by the following rules:
1.
$$
  \hat{U}_1,\dots,\hat{U}_K \in\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$
2. for any $n\in\N_+$
$$
  \hat{I}^{\otimes n} \in \mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$
3. for any $\hat{V}_1, \hat{V}_2 \in\mathcal{U}({}^\P \mathcal{H}^{\otimes n})$ we have
$$
  \hat{V}_1, \hat{V}_2 \in \mathcal{F}[\hat{U}_1,\dots,\hat{U}_K] \implies \hat{V}_1 \hat{V}_2 \in\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$
4. for any $\hat{V}_i \in\mathcal{U}({}^\P \mathcal{H}^{\otimes n_i})$ with $i\in\set{1,2}$ we have
$$
  \hat{V}_1, \hat{V}_2 \in\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K] \implies \hat{V}_1 \otimes \hat{V}_2 \in\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$

A set of quantum gates $U = \set{\hat{U}_1,\dots,\hat{U}_J}$ is called universal if any quantum gate $\hat{U}$ can be constructed with gates from $U$, that is, for every quantum gate $\hat{U}$

$$
  \hat{U} \in\mathcal{F}[\hat{U}_1,\dots,\hat{U}_J]
$$

When acting on a system in the state $\hat{\rho}\in\mathcal{D}(\mathcal{H})$ the gate $\hat{U}$ transforms it to a new state $\hat{U}\hat{\rho}\hat{U}^\dagger$.
</MathBox>

<MathBox title='' boxType='lemma'>
For gates $\hat{V}_1,\dots,\hat{V}_L,\hat{U}_1,\dots,\hat{U}_K \in\mathcal{U}({}^\P \mathcal{H}^{\otimes n})$ we have

$$
  \hat{V}_1,\dots,\hat{V}_L \in \mathcal{F}[\hat{U}_1,\dots,\hat{U}_K] \implies \mathcal{F}[\hat{V}_1,\dots,\hat{V}_L] \subset \mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$

such that, in particular

$$
  \mathcal{F}\left[\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]\right] = \mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]
$$

<details>
<summary>Proof</summary>

The stated inclusion is a direct consequence of Definition $\ref{definition-2}$ since the operations to construct any elements in $\mathcal{F}[\hat{V}_1,\dots,\mathcal{V}_L]$ from the $\hat{V}_1,\dots,\hat{V}_L$ are the same as to construct any element in $\mathcal{F}[\hat{U}_1,\dots,\hat{U}_K]$ from its elements and since the $\hat{V}_1,\dots,\hat{V}_L$ are members of this set.
</details>
</MathBox>

<MathBox title='Controlled gate' boxType='definition'>
Let $n, n_a, n_b \in\N_0$ with $n = n_a + n_b$ and let $\ket{a}\in {}^\P \mathcal{H}^{\otimes n_a}$ and $\ket{b}\in {}^\P \mathcal{H}^{\otimes n_b}$ be vectors in the respective computational basis. Moreover, let $\hat{V}\in\mathcal{U}({}^\P \mathcal{H})$. We denote the $(\ket{a},\ket{b})$-controlled $\hat{V}$ by $\Lambda_\ket{b}^\ket{a} (\hat{V})$ and define it as the $n + 1$-gate

$$
\begin{align*}
  \Lambda_\ket{b}^\bra{a} (\hat{V}) :=& \hat{I}^{\otimes n + 1} + \ket{a}\bra{a} \otimes (\hat{V} - \hat{I})\otimes \ket{b}\bra{b} \\
  =& \hat{I}^{\otimes n+1} + \bigotimes_{j=n_a - 1}^0 \ket{a_j} \bra{a_j} \otimes (\hat{V} - \hat{I}) \otimes \bigotimes_{j = n_b - 1}^0 \ket{b_j} \bra{b_j}
\end{align*}
$$

The qubit on which $\hat{V}$ acts is called *target-qubit*. In the special case $a = 2^{n_a} - 1$ and $2^{n_b} - 1$ one has $\ket{a} = \ket{1\dots 1}^{n_a}$ and $\ket{b} = \ket{1\dots 1}^{n_b}$, and we define the abbreviation notation

$$
  \Lambda_{n_b}^{n_a} (\hat{V}) := \Lambda_{\ket{2}^{n_b} - 1}^{\ket{2}^{n_a} - 1} (\hat{V})
$$

as well as in the case $n_a = n$ and $a = 2^n - 1$

$$
  \Lambda^n (\hat{V}) := \Lambda^{\ket{2^n - 1}} (\hat{V})
$$

Likewise, in the case $n_b = n$ and $b = 2^n - 1$ we define

$$
  \Lambda_n (\hat{V}) := \Lambda_{\ket{2^n - 1}} (\hat{V})
$$

In the case $n = 0$ we define

$$
  \Lambda^0 (\hat{V}) := \hat{V} =: \Lambda_0 (\hat{V})
$$
</MathBox>