---
title: 'Classical Mechanics'
subject: 'Physics'
showToc: true
---

# Mechanical systems

The motion of a single particle in $n$-dimensional space is described by a curve $\mathbf{r}: I\subset\R\to\R^n$. It is generally assumed that the force acting on the particle only depends on its position and velocity. Newton's second law requires that the particle's motion satisfies the second-order differential equation

$$
  m\ddot{\mathbf{r}} = F(\mathbf{r}, \mathbf{\dot{r}})
$$

where $F: \R^n \times \R^n \to\R^n$ is the force acting on the particle and $m > 0$ is the particle's mass. Therefore the solutions of this equation describe the possible motions of the particle.

<MathBox title='Mechanical system' boxType='definition'>
A *mechanical system* is a triple (M, \langle\cdot,\cdot\rangle, F), where
- $M$ is a smooth manifold, called the *configuration space*
- $\langle\cdot,\cdot\rangle: T_\mathbf{p} M \times T_\mathbf{p} M \to\R$ is a Riemannian metric on $M$ yielding the *mass operator* $\mu: TM\to T^* M$ defined by
$$
  \mu(\mathbf{v})(\mathbf{w}) = \langle\mathbf{v},\mathbf{w}\rangle,\; \forall \mathbf{v},\mathbf{w}\in T_\mathbf{p} M
$$
where $T_\mathbf{p} M$ is the tangent space at $\mathbf{p}\in M$.
- $F: TM\to T^* M$ is a smooth map satisfying $F(T_\mathbf{p}M) \subset T_\mathbf{p}^* M$ for all $\mathbf{p}\in M$, called the *external force*.

A *motion* of the mechanical system is a solution $\mathbf{x}: U\subset\R \to M$ of the *Newton equation*

$$
  \mu\left(\frac{\mathrm{D}\dot{\mathbf{x}}}{\mathrm{d}t}\right) = F(\dot{\mathbf{x}})
$$

where $\mathrm{D}\dot{\mathbf{x}}/\mathrm{d}t$ is the covariant derivative of $\mathbf{x}$.
</MathBox>

The geodesics of a Riemannian manifold $(M,\langle\cdot,\cdot\rangle)$ are the motions of the mechanical system $(M, \langle\cdot,\cdot\rangle, 0)$ describing a *free particle* on $M$.

<MathBox title='Single particle in $n$-dimensional space' boxType='example'>
For the mechanical system comprising a single particle moving in $n$-\dimensional space, the configuration space is $\R^n$. If we set

$$
  \langle\langle,\mathbf{v},\mathbf{w}\rangle\rangle := m\langle\mathbf{v},\mathbf{w}\rangle,\; \forall \mathbf{v},\mathbf{w}\in\R^n
$$

where $\langle\cdot,\cdot\rangle$ is the Euclidean inner product in $\R^n$, then the Levi-Civita connection of $\langle\langle\mathbf{v},\mathbf{w}\rangle\rangle$ will still be the trivial connection, and

$$
  \frac{\mathbf{D}\dot{\mathbf{x}}}{\mathrm{d}t} = \ddot{\mathbf{x}}
$$

Setting

$$
  F(\mathbf{x}, \mathbf{v})(\mathbf{w}) := \langle F(\mathbf{x},\mathbf{v}),\mathbf{w}\rangle,\; \forall \mathbf{v},\mathbf{w}\in\R^n \tag{\label{equation-1}}
$$

we see that for $\mathbf{v}\in\R^n$

$$
\begin{align*}
  &\mu\left(\frac{\mathrm{D}\dot{\mathbf{x}}}{\mathrm{d}t} \right) = F(\mathbf{x}, \dot{\mathbf{x}}) \\
  \iff& \mu\left(\frac{\mathrm{D}\dot{\mathbf{x}}}{\mathrm{d}t} \right)(\mathbf{v}) = F(\mathbf{x}, \dot{\mathbf{x}})(\mathbf{v}) \\
  \iff& m\langle\ddot{\mathbf{x}, \mathbf{v}}\rangle = \langle F(\mathbf{x},\dot{\mathbf{x}}), \mathbf{v}\rangle \\
  \iff& m\ddot{x} = F(\mathbf{x}, \dot{\mathbf{x}})
\end{align*}
$$

Hence the motions of the particle are the motions of the mechanical system $(\R^n , \langle\langle\cdot,\cdot\rangle\rangle, F)$ with defined by $\eqref{equation-1}$.
</MathBox>

<MathBox title='Positional and conservative forces' boxType='definition'>
Let $(M, \langle\cdot,\cdot\rangle, F)$ be a mechanical system. The external force $F$ is called
- *positional* if $F(\mathbf{v})$ depends only on $\pi(\mathbf{v})$, where $\pi:TM\to M$ is the natural projection
- *conservative* if there exists a function $U: M\to\R$, called *potential energy*, such that $F(\mathbf{v}) = -(\mathrm{d}U)_{\pi(\mathbf{v})}$ for all $\mathbf{v}\in TM$.
</MathBox>

Note that any conservative force is positional. A mechanical system whose exterior force is conservative is called a *conservative mechanical system*.

<MathBox title='Kinetic energy' boxType='definition'>
Let $(M, \langle\cdot,\cdot\rangle, F)$ be a mechanical system. The external *kinetic energy* is the differentiable map $K:TM\to\R$ given by

$$
  K(\mathbf{v}) = \frac{1}{2}\langle\mathbf{v},\mathbf{v}\rangle,\; \mathbf{v}\in TM
$$
</MathBox>

<MathBox title='Conservation of energy' boxType='theorem'>
In a conservative mechanical system $(M, \langle\cdot,\cdot\rangle, -\mathrm{d}U)$, the *mechanical energy* $E(t) = K(\dot{\mathbf{r}}(t)) + U(\mathbf{r}(t))$ is constant along any motion $\mathbf{r}: I\subset\R\to M$.

<details>
<summary>Proof</summary>

$$
\begin{align*}
  \frac{\mathrm{d}E}{\mathrm{d}t}(t) =& \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{1}{2}\langle \dot{\mathbf{r}}(t), \dot{\mathbf{r}}(t) \rangle + U(\mathbf{r}(t)) \right) \\
  =& \left\langle \frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}(t), \dot{\mathbf{r}}(t) \right\rangle + (\mathrm{d}U)_{\mathbf{r}(t)}\dot{\mathbf{r}}(t) \\
  =& \mu\left(\frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}\right)(\dot{\mathbf{r}}) - F(\dot{\mathbf{r}})(\dot{\mathbf{r}}) = 0
\end{align*}
$$
</details>
</MathBox>

The motions of any conservative system can be suitably reinterpreted as the geodesics of a certain metric.

<MathBox title='Jacobi metric' boxType='definition'>
Let $(M, \langle\cdot,\cdot\rangle, -\mathrm{d}U)$ be a conservative mechanical system and $h\in\R$ such that

$$
  M_h := \Set{\mathbf{p}\in M | U(\mathbf{p}) < h} \neq\emptyset
$$

The *Jacobi metric* on the manifold $M_h$ is given by

$$
  \langle\langle\mathbf{v},\mathbf{w}\rangle\rangle := 2[h - U(\mathbf{p})]\langle\mathbf{v},\mathbf{w}\rangle
$$

for all $\mathbf{v},\mathbf{w}\in T_\mathbf{p}M_h$ and $\mathbf{p}\in M$.
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-1'>
Let $(M, \langle\cdot,\cdot\rangle)$ be a Riemannian manifold with Levi-Civita connection $\nabla$ and let $\langle\langle\cdot,\cdot\rangle\rangle = e^{2\rho} \langle\cdot,\cdot\rangle$ be a metric conformally related to $\langle\cdot,\cdot\rangle$ where $\rho\in C^\infty (M)$. Then the Levi-Civita connection $\tilde{\nabla}$ of $\langle\langle\cdot,\cdot\rangle\rangle$ is given by

$$
  \tilde{\nabla}_\mathbf{X} \mathbf{Y} = \nabla_\mathbf{X} \mathbf{Y} + \mathrm{d}\rho(\mathbf{X}) \mathbf{Y} + \mathrm{d}\rho(\mathbf{Y})\mathbf{X} - \langle\mathbf{X},\mathbf{Y}\rangle \operatorname{grad}(\rho)
$$

for all $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, where the gradient is taken with respect to $\langle\cdot,\cdot\rangle$.

<details>
<summary>Proof</summary>

The Koszul formula gives for $\mathbf{Z}\in\mathfrak{X}(M)$

$$
\begin{align*}
  2\langle\langle \tilde{\nabla}_\mathbf{X} \mathbf{Y}, \mathbf{Z} \rangle\rangle =& \mathbf{X}\langle\langle\mathbf{Y},\mathbf{Z}\rangle\rangle + \mathbf{Y}\langle\langle\mathbf{X},\mathbf{Z}\rangle\rangle - \mathbf{Z}\langle\langle\mathbf{X},\mathbf{Y}\rangle\rangle\\
  &- \langle\langle[\mathbf{X},\mathbf{Z}],\mathbf{Y}\rangle\rangle - \langle\langle[\mathbf{Y},\mathbf{Z}], \mathbf{X}\rangle\rangle + \langle\langle[\mathbf{X},\mathbf{Y}],\mathbf{Z}\rangle\rangle
\end{align*}
$$

The expansion of the first term $\tilde{\nabla}_\mathbf{X} \mathbf{Y}, \mathbf{Z} \rangle\rangle$ is

$$
\begin{align*}
  \tilde{\nabla}_\mathbf{X} \mathbf{Y}, \mathbf{Z} \rangle\rangle =& \mathbf{X} \cdot\left(e^{2\rho} \langle\mathbf{Y},\mathbf{Z}\rangle\right) \\
  =& e^{2\rho} \mathbf{X} \cdot \langle\mathbf{Y},\mathbf{Z}\rangle + 2\mathrm{d}\rho(\mathbf{X}) e^{2\rho}\langle\mathbf{Y},\mathbf{X}\rangle
\end{align*}
$$

Expanding $\mathbf{Y}\langle\langle\mathbf{X},\mathbf{Z}\rangle\rangle$ and $\mathbf{Z}\langle\langle\mathbf{X},\mathbf{Y}\rangle\rangle$ similarly, we get

$$
\begin{align*}
  2\langle\langle \tilde{\nabla}_\mathbf{X} \mathbf{Y}, \mathbf{Z} \rangle\rangle =& 2e^{2\rho} \langle\nabla_\mathbf{X} \mathbf{Y}, \mathbf{Z}\rangle + 2\mathrm{d}\rho(\mathbf{X})e^{2\rho} \langle\mathbf{Y},\mathbf{Z}\rangle \\
  &+ 2\mathrm{d}\rho(\mathbf{Y})e^{2\rho} \langle\mathbf{X},\mathbf{Z}\rangle - 2\mathrm{d}\rho(\mathbf{Z}) e^{2\rho}\langle\mathbf{X},\mathbf{Y}\rangle \\
  =& 2\langle\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle\rangle + 2\langle\langle\mathrm{d}\rho(\mathbf{X})\mathbf{Y},\mathbf{Z}\rangle\rangle \\
  &+ 2\langle\langle\mathrm{d}\rho(\mathbf{Y})\mathbf{X}, \mathbf{Z}\rangle\rangle - 2e^{2\rho}\langle\operatorname{grad}(\rho), \mathbf{Z}\rangle\rangle\langle\mathbf{X},\mathbf{Y}\rangle
\end{align*}
$$

Since

$$
  2e^{2\rho}\langle\operatorname{grad}(\rho), \mathbf{Z}\rangle\rangle = \langle\langle\operatorname{grad}(\rho),\mathbf{Z}\rangle\rangle
$$

and $\mathbf{Z}$ is arbitrary we obtain

$$
  \tilde{\nabla}_\mathbf{X} \mathbf{Y} = \nabla_\mathbf{X} \mathbf{Y} + \mathrm{d}\rho(\mathbf{X}) \mathbf{Y} + \mathrm{d}\rho(\mathbf{Y})\mathbf{X} - \langle\mathbf{X},\mathbf{Y}\rangle \operatorname{grad}(\rho)
$$
</details>
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-2'>
A curve $\mathbf{r}: I\subset\R\to M$ is a reparametrized geodesic of a Riemannian manifold $(M,\langle\cdot,\cdot\rangle)$ if and only if it satisfies

$$
  \frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t} = f(t)\dot{\mathbf{r}}
$$

for some differentiable function $f:I\to\R$.

<details>
<summary>Proof</summary>

Let $s: I\to J$ be a diffeomorphism nad $\boldsymbol{\gamma}: J\to M$ the reparametrization of $\mathbf{r}: I\to M$ defined by

$$
  \mathbf{r}(t) := \boldsymbol{\gamma(s(t))}
$$

The velocity is

$$
  \dot{\mathbf{r}}(t) = \dot{\boldsymbol{\gamma}}(s(t)) \frac{\mathrm{d}s}{\mathrm{d}t}(t) \tag{\label{equation-2}}
$$

and consequently

$$
\begin{align*}
  \nabla_{\dot{\mathbf{r}}} \dot{\mathbf{r}} =& \nabla_{\dot{\mathbf{r}}}\left(\frac{\mathrm{d}s}{\mathrm{d}t}\dot{\boldsymbol{\gamma}} \right)\dot{\boldsymbol{\gamma}} + \left(\frac{\mathrm{d}s}{\mathrm{d}t} \right) \nabla_{(\mathrm{d}s/\mathrm{d}t)\dot{\boldsymbol{\gamma}}} \dot{\boldsymbol{\gamma}} \\
  =& \frac{\mathrm{d}}{\mathrm{d}t} \left(\ln\left|\frac{\mathrm{d}s}{\mathrm{d}t}\right| \right)\dot{\mathbf{r}} + \left(\frac{\mathrm{d}s}{\mathrm{d}t} \right)^2 \nabla_{\dot{\boldsymbol{\gamma}}}\dot{\boldsymbol{\gamma}}
\end{align*}
$$

Thus, if $\mathbf{r}$ is a reparametrization of a geodesic $\boldsymbol{\gamma}$, then $\mathbf{r}$ satisfies

$$
  \nabla_{\dot{\mathbf{r}}} \dot{\mathbf{r}} = f(t)\dot{\mathbf{r}}
$$

with

$$
  f(t) = \frac{\mathrm{d}}{\mathrm{d}t}\left(\ln\left|\frac{\mathrm{d}s}{\mathrm{d}t}\right|\right)
$$

Conversely, if $\mathbf{r}$ satisfies $\eqref{equation-2}$, then the reparametrization $\boldsymbol{\gamma}$ of $\mathbf{r}$ determined by

$$
  s(t) = \int \exp\left(\int f(t)\;\mathrm{d}t \right)\mathrm{d}t
$$

is a geodesic.
</details>
</MathBox>

<MathBox title='Jacobi theorem' boxType='theorem'>
The motions of a conservative mechanical system $(M,\langle\cdot,\cdot\rangle, -\mathrm{d}U)$ with mechanical energy $h$ are, up to reparametrization, geodesics of the Jacobi metric on $M_h$.

<details>
<summary>Proof</summary>

Let $\mathbf{r}: I\subseteq\R \to M$ be a motion of $(M,\langle\cdot,\cdot\rangle, -\mathrm{d}U)$ with mechanical energy $h$. Then lemma $\ref{lemma-1}$ gives

$$
  \frac{\tilde{\mathrm{D}\dot{\mathbf{r}}}}{\mathrm{d}t} = \frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t} + 2\mathrm{d}\rho(\dot{\mathbf{r}}) \dot{\mathbf{r}} - \langle\dot{\mathbf{r}},\dot{\mathbf{r}}\rangle \operatorname{grad}(\rho)
$$

where $\tilde{\mathrm{D}}/\mathrm{d}t$ is the covariant derivative along $\mathbf{r}$ with respect to the Jacobi metric and $e^{2\rho} = 2(h - U)$. The Newton equation gives

$$
  \mu\left(\frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}\right) = -\mathrm{d}U \iff \frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t} = -\operatorname{grad}(U) = e^{2\rho} \operatorname{grad}(\rho)
$$

By conservation of energy, we have

$$
  \langle\dot{\mathbf{r}},\dot{\mathbf{r}}\rangle = 2K = 2(h - U) = e^{2\rho}
$$

Consequently, we have

$$
  \frac{\tilde{\mathbf{D}}\dot{\mathbf{r}}}{\mathrm{d}t} = 2\mathrm{d}\rho(\dot{\mathbf{r}})\dot{\mathbf{r}}
$$

which by lemma $\ref{lemma-2}$ means that $\mathbf{r}$ is a reparametrized geodesic of the Jacobi metric.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $(M,\langle\cdot,\cdot\rangle,F)$ be a mechanical system. If $(x^i)_{i=1}^n$ are local coordinates on $M$, and $(x^1,\dots,x^n,v^1,\dots,v^n)$ are the local coordinates induces on $TM$, then

$$
  \mu\left(\frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}\right) = \sum_{i=1}^n \left[\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial K}{\partial v^i} (\mathbf{x}(t), \dot{\mathbf{x}}(t)) \right) - \frac{\partial K}{\partial x^i} (\mathbf{x}(t), \dot{\mathbf{x}}(t)\right]\mathrm{d}x^i
$$

In particular, if $F = -\mathrm{d}U$ is conservative then the equations of motions are

$$
  \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial K}{\partial v^i}(\mathbf{x}(t), \dot{\mathbf{x}}(t)) \right) - \frac{\partial K}{\partiall x^i}(\mathbf{x}(t), \dot{\mathbf{x}}(t)) = -\frac{\partial U}{\partial x^i}(\mathbf{x}(t))
$$

for $i = 1,\dots,n$.

<details>
<summary>Proof</summary>

Recall that the local coordinates $(x^1,\dots,x^n,v^1,\dots,v^n)$ on $TM$ parametrize the vector

$$
  \sum_{i=1}^n v^i \frac{\partial}{\partial x^i}
$$

which is tangent to $M$ at the point with coordinates $(x^i)_{i=1}^n$. Thus, we have

$$
  K(x^1,\dots,x^n,v^1,\dots,v^n) = \frac{1}{2}\sum_{i,j=1}^n g_{ij} (x^1,\dots,x^n) v^i v^j
$$

where

$$
  g_{ij} = \left\langle\frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j}\right\rangle
$$

are the components of the metric in this coordinate system. Consequently

$$
  \frac{\partial K}{\partial v^i} = \sum_{j=1}^n g_{ij} v^j
$$

and hence

$$
  \frac{\partial K}{\partial v^i} (\mathbf{x}(t), \dot{\mathbf{x}}(t)) = \sum_{j=1}^n g_{ij}(\mathbf{x}(t))\dot{\mathbf{x}}^j (t)
$$

leading to

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial K}{\partial v^i} (\mathbf{x}(t), \dot{\mathbf{x}}(t))\right) =& \sum_{j=1}^n g_{ij}(\mathbf{x}(t)) \ddot{x}^j (t) \\
  &+ \sum_{j,k=1}^n \frac{\partial g_{ij}}{\partial x^k} (\mathbf{x}(t))\dot{x}^k (t) \dot{x}^j(t)
\end{align*}
$$

Moreover

$$
  \frac{\partial K}{\partial x^i} = \frac{1}{2} \sum_{j,k=1}^n \frac{\partial g_{ij}}{\partial x^i} v^j v^k
$$

and hence

$$
  \frac{\partial K}{\partial x^i}(\mathbf{x}(t), \dot{\mathbf{x}}(t)) = \frac{1}{2}\sum_{j,k = 1}^n \frac{\partial g_{jk}}{\partial x^i}(\mathbf{x}(t))\dot{x}^j (t) \dot{x}^k (t)
$$

We conclude that

$$
\begin{align*}
  & \frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{\partial K}{\partial v^i} (\mathbf{x}(t), \dot{\mathbf{x}}(t))\right) - \frac{\partial K}{\partial x^i}(\mathbf{x}(t), \dot{\mathbf{x}}(t)) \\
  =& \sum_{j=1}^n g_{ij}(\mathbf{x}(t))\ddot{x}^j (t) + \sum_{j,k=1}^n \left( \frac{\partial g_{ij}}{\partial x^k}(\mathbf{x}(t)) - \frac{1}{2}\frac{\partial g_{jk}}{\partial x^i}(\mathbf{x}(t)) \right)\dot{x}^j (t) \dot{x}^k (t)
\end{align*}
$$

On the other hand, if $\mathbf{v},\mathbf{w}\in T_\mathbf{p} M$ are written as

$$
  \mathbf{v} = \sum_{i=1}^n v^i \frac{\partial}{\partial x^i} \quad \mathbf{w} = \sum_{i=1}^n w^i \frac{\partial}{\partial x^i}
$$

then we have

$$
  \mu(\mathbf{v})(\mathbf{w}) = \sum_{i,j=1}^n g_{ij}v^i w^j = \sum_{i,j=1}^n g_{ij} v^i \;\mathrm{d}x^j (\mathbf{w})
$$

and hence

$$
  \mu(\mathbf{v}) = \sum_{i,j=1}^n g_{ij} v^i \;\mathrm{d}x^j = \sum_{i,j=1}^n g_{ij} v^j \;\mathrm{d}x^i
$$

Thus

$$
  \mu\left(\frac{\mathbf{D}\dot{\mathbf{r}}}{\mathrm{d}t}(t)\right) = \sum_{i,j=1}^n g_{ij}(\mathbf{x}(t))\left(\ddot{x}^j (t) + \sum_{k,l=1}^n \Gamma_{kl}^j (\mathbf{x}(t))\dot{x}^k (t) \dot{x}^l (t) \right)\mathrm{d}x^i
$$

Since

$$
\begin{align*}
  \sum_{j=1}^n g_{ij} \Gamma_{kl}^j = \frac{1}{2} \sum_{j,m=1}^n g_{ij} g^{jm} \left(\frac{\partial g_{ml}}{\partial x^k} + \frac{\partial g_{mk}}{\partial x^l} - \frac{\partial g_{kl}}{\partial x^m}\right) \\
  =& \frac{1}{2}\left(frac{\partial g_{il}}{\partial x^k} + \frac{\partial g_{ik}}{\partial x^l} - \frac{\partial g_{kl}}{\partial x^i}\right)
\end{align*}
$$

we have

$$
\begin{align*}
  &\sum_{j,k,l=1}^n g_{ij}(\mathbf{x}(t)) \Gamma_{kl}^j (\mathbf{x}(t)) \dot{x}^k (t) \dot{x}^l (t) \\
  =& \frac{1}{2}\sum_{k,l=1}^n \left(frac{\partial g_{il}}{\partial x^k}(\mathbf{x}(t)) + \frac{\partial g_{ik}}{\partial x^l}(\mathbf{x}(t)) - \frac{\partial g_{kl}}{\partial x^i}(\mathbf{x}(t)) \right)\dot{x}^k (t) \dot{x}^l (t) \\
  =& \sum_{j,k=1}^n \left(frac{\partial g_{ij}}{\partial x^k}(\mathbf{x}(t)) - \frac{1}{2}\frac{\partial g_{jk}}{\partial x^i}(\mathbf{x}(t))\right) \dot{x}^j (t) \dot{x}^k (t)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Particle in a cental field' boxType='example'>
Consider a particle of mass $m > 0$ moving in $\R^2$ under the influence of a conservative force whose potential energy $U$ depends only on the distance $r = \sqrt{x^2 + y^2}$ to the origin, i.e. $U = u(r)$. The equations of motions are most easily solved when written in polar coordinates $(r,\theta)$ defined by

$$
\begin{align*}
  x =& r\cos(\theta) \\
  y =& r\sin(\theta)
\end{align*}
$$

Since

$$
\begin{align*}
  \mathrm{d}x = \cos(\theta)\;\mathrm{d}r - r\sin(\theta)\;\mathrm{d}\theta \\
  \mathrm{d}y = \sin(\theta);\mathrm{d}r + r\cos(\theta)\mathrm{d}\theta
\end{lign*}
$$

is is easily seen that the Euclicean metric takes the form

$$
\begin{align*}
  \langle\cdot,\cdot\rangle =& \mathrm{d}x\otimes\mathrm{d}x + \mathrm{d}y\otimes\mathrm{d}y \\
  =& \mathrm{d}r\otimes\mathrm{d}r + r^2 \mathrm{d}\theta\otimes\mathrm{d}\theta 
\end{align*}
$$

and hence

$$
  K(r,\theta, v^r, v^\theta) = \frac{1}{2}m\left[(v^r)^2 + r^2 (v^\theta)^2 \right]
$$

Thus, we have

$$
\begin{align*}
  \frac{\partial K}{\partial v^r} =& mv^r \\
  \frac{\partial K}{\partial v^\theta} =& mr^2 v^\theta \\
  \frac{\partial K}{\partial r} =& mr(v^\theta)^2 \\
  \frac{\partial K}{\partial \theta} = 0
\end{align*}
$$

and the Newton equations are written

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d}t}(m\dot{r}) - mr\dot{\theta}^2 =& -u'(r) \\
  \frac{\mathrm{d}}{\mathrm{d}t}(mr^2 \dot{\theta}) =& 0
\end{align*}
$$

Notice that the angular momentum

$$
  p_\theta := mr^2 \dot{\theta}
$$

is constant along the motion. This conservation law follows from the fact that both $K$ and $U$ are independent of $\theta$. 
</MathBox>

# Holonomic constraints

<MathBox title='Holonomic constraint' boxType='definition'>
A *holonomic constraint* on a mechanical system $(M,\langle\cdot,\cdot\rangle, F)$ is a submanifold $N\subset M$ with $\dim(N) < \dim(M)$. A curve $\mathbf{r}: I\subset\R \to M$ is *compatible* with $N$ if $\mathbf{r}(t)\in N$ for all $t\in I$.
</MathBox>

<MathBox title='Reaction force' boxType='definition'>
A *reaction force* on a mechanical system with holonomic constraint $(M,\langle\cdot,\cdot\rangle, F, N)$ is a map $R: TN\to T^* M$ satisfying $R(T_\mathbf{p}N) \subset T_\mathbf{p}^* M$ for all $\mathbf{p}\in N$ such that, for each $\mathbf{v}\in TN$, there is a solution $\mathbf{r}: I\subset\R \to N$ of the *generalized Newton equation*

$$
  \mu\left(\frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}\right) = (F + R)(\dot{\mathbf{r}})
$$

with initial condition $\dot{\mathbf{r}}(0) = \mathbf{v}$.
</MathBox>


<MathBox title="d'Alembert principle" boxType='definition'>
A reaction force in a mechanical systme with holonomic constraint $(M,\langle\cdot,\cdot\rangle, F, N)$ satisfy the *d'Alember principle* if

$$
  \mu^{-1}(R(\mathbf{v})) \in (T_\mathbf{p} N)^\perp
$$

for all $\mathbf{v}\in T_\mathbf{p} N$ and $\mathbf{p} N$. In this case, the reaction force is said to be *perfect*.
</MathBox>

The variation of the kinetic energy of a solution of the generalized Newton equation is

$$
\begin{align*}
  \frac{\mathrm{d}K}{\mathrm{d}t} =& \left\langle \frac{\mathrm{D}\dot{\mathbf{r}}}{\mathrm{d}t}, \dot{\mathbf{r}} \right\rangle =& F(\dot{\mathbf{r}})(\dot{\mathbf{r}}) + R(\dot{\mathbf{r}})(\dot{\mathbf{r}}) \\
  =& F(\dot{\mathbf{r}})(\dot{\mathbf{r}}) + \left\langle \mu^{-1} (R(\dot{\mathbf{r}})), \dot{\mathbf{r}}\right\rangle
\end{align*}
$$

Thus, a reaction force is perfect if and only if it neither creates nor dissipates energy along any motion compatible with the constraint.

<MathBox title="d'Alembert principle" boxType='definition'>
Given any mechanical system with holonomic contraint $(M,\langle\cdot,\cdot\rangle,F,N)$, there exists a unique reaction force $R:TN\to T^* M$ satisfying the d'Alembert principle. The solution of the generalized Newton equation

$$
  \mu\left( \frac{\mathrm{D}\mathbf{r}}{\mathrm{d}t} \right) = (F + R)(\dot{\mathbf{r}})
$$

are exactly the motions of the mechanical system $(N, \langle\langle\cdot,\cdot\rangle, F|_N)$ where $\langle\langle\cdot,\cdot\rangle\rangle$ is the metric induced on $N$ by $\langle\cdot,\cdot\rangle$ and $F|_N$ is the restriction of $F$ to $N$. In particular, if $F = -\mathrm{d}U$ is conservative then $F|_N = -\mathrm{d}(U|_N)$.

<details>
<summary>Proof</summary>

Recall that if $\tilde{\nabla}$ is the Levi-Civita connection of $(M,\langle\cdot,\cdot\rangle)$ and $\nabla$ is the Levi-Civita connection of $(N,\langle\langle\cdot,\cdot\rangle\rangle)$ then

$$
  \nabla_\mathbf{X} \mathbf{Y} = (\tilde{\nabla}_\tilde{\mathbf{X}} \tilde{\mathbf{Y}})^\top,\; \mathbf{X},\mathbf{Y}\in\mathfrak{X}(N)
$$

where $\tilde{\mathbf{X}}, \tilde{\mathbf{Y}}$ are the extensions of $\mathbf{X}, \mathbf{Y}$ to $\mathfrak{X}(M)$. On sidenote, $\mathbf{v} = \mathbf{v}^\top + \mathbf{v}^\perp$ designates the unique decomposition arising from the splitting $T_\mathbf{p}M = T_\mathbf{p}N \oplus (T_\mathbf{p} N)^\perp$ for each $\mathbf{p}\in N$. The second fundamental for of $N$

$$
  B(\mathbf{X},\mathbf{Y}) = \tilde{\nabla}_{\tilde{\mathbf{X}}} \tilde{\mathbf{Y}} - \nabla_\mathbf{X} \mathbf{Y} = (\tilde{\nabla}_{\tilde{\mathbf{X}}} \tilde{\mathbf{Y}})^\perp
$$

is well defined, and $B(\mathbf{X},\mathbf{Y})_\mathbf{p} \in (T_\mathbf{p} N)^\perp$ is a symmetric bilinear function of $\mathbf{X_p}, \mathbf{Y_p} \in T_\mathbf{p} N$ for all $\mathbf{p}\in N$.

Assuming there is a perfect reaction force $R$, the solutions of the generalized Newton equation must satisfy

$$
  \tilde{\nabla}_{\dot{\mathbf{r}}} \dot{\mathbf{r}} = \mu^{-1} (F(\dot{\mathbf{r}})) + \mu^{-1} (R(\dot{\mathbf{r}}))
$$

Since by hypothesis $\mu^{-1} R$ is orthogonal to $N$, the component of this equation tangent to $N$ yields

$$
  \nabla_{\dot{\mathbf{r}}} \dot{\mathbf{r}} = \mu_N^{-1} (F|_N (\dot{\mathbf{r}}))
$$

where $\mu_N : TN \to T^* N$ is the mass operator on $N$. For any $\mathbf{v} \in TN$ we have

$$
\begin{align*}
  \left{\langle\langle} \left(\mu^{-1} (F(\dot{\mathbf{r}})\right)^\top, \mathbf{v}\right{\rangle\rangle} =& \left\langle \mu^{-1} F(\dot{\mathbf{r}}), \mathbf{v} \rigth\rangle \\
  =& F(\dot{\mathbf{r}})(\mathbf{v}) = F|_N (\dot{\mathbf{r}})(\mathbf{v}) \\
  =& \langle\langle \mu_N^{-1} (F|_N (\dot{\mathbf{r}})), \mathbf{v} \rangle\rangle
\end{align*}
$$

Hence, $\mathbf{r}$ is a motion of $(N, \langle\langle\cdot,\cdot\rangle\rangle, F|_N)$.

On the other hand, the component of the generalized Newton equation orthogonal to $N$ yields

$$
  B(\dot{\mathbf{r}}, \dot{\mathbf{r}}) = [\mu^{-1}(F(\dot{\mathbf{r}}))]^\perp + \mu^{-1} (R(\dot{\mathbf{r}}))
$$

Thus, if $R$ exists it must satisfy

$$
  R(\mathbf{v}) = \mu(B(\mathbf{v},\mathbf{v})) - \mu\left[(\mu^{-1}(F(\mathbf{v})))^\perp \right],\; \forall\mathbf{v}\in TN \tag{\label{equation-3}}
$$

This proves uniqueness. To prove existence, define $R$ throught $\eqref{equation-3}$, which guarantees that $\mu^{-1} (R(\mathbf{v})) \in (T_\mathbf{p} N)^\perp$ for all $\mathbf{v}\in T_\mathbf{p} N$ and $\mathbf{p}\in N$. Given $\mathbf{v}\in TN$, let $\mathbf{r}: I\subset\R \to N$ be the motion of the mechanical system $(N,\langle\langle\cdot,\cdot\rangle\rangle, F|_N)$ with initial condition $\mathbf{v}$. Then

$$
\begin{align*}
  \tilde{nabla}_{\dot{\mathbf{r}}} \dot{\mathbf{r}} =& \nabla_{\dot{\mathbf{r}}} \dot{\mathbf{r}} + B(\dot{\mathbf{r}}, \dot{\mathbf{r}}) \\
  =& \mu_N^{-1} (F|_N (\dot{\mathbf{r}})) + (\mu^{-1}(F(\dot{\mathbf{r}})))^\perp + \mu^{-1}(R(\dot{\mathbf{r}})) \\
  =& (\mu^{-1} F(\dot{\mathbf{r}}))^\perp + (\mu^{-1}(F(\dot{\mathbf{r}})))^\perp + \mu^{-1}(R(\dot{\mathbf{r}})) \\
  =& \mu^{-1}(F(\dot{\mathbf{r}})) + \mu^{-1}(R(\dot{\mathbf{r}}))
\end{align*}
$$
</details>
</MathBox>