---
title: 'Fourier Analysis'
subject: 'Mathematics'
showToc: true
---

# Fourier series

The set of exponential functions $\Set{ e_n := e^{inx} = \cos nx + i\sin nx : n \in\Z }$ is an orthogonal basis for the Hilbert space $L^2\left([-\pi, \pi ]\right)$ of square integrable functions with an inner product given by

$$
	\langle f, g \rangle := \int_{-\pi}^\pi f(x)\overline{g(x)}\;\mathrm{d}x \quad f, g \in L^2\left([-\pi, \pi ]\right)
$$

This is easily shown by calculating the inner product

$$
	\left\langle e_m, e_n \right\rangle = \int_{-\pi}^\pi e^{imx} e^{-inx}\;\mathrm{d}x = \int_{-\pi}^\pi e^{i(m - n)x}\;\mathrm{d}x = \left.\frac{1}{i(n - m)}e^{i(m - n)x}\right|_{-\pi}^\pi = 2\pi \delta_{nm}
$$

The Fourier series of $f \in L^2\left([-\pi, \pi ]\right)$ is an expansion of $f$ in terms of this exponential basis

$$
	f(x) = \frac{1}{2\pi}\sum_{n=-\infty}^\infty \left\langle f, e_n \right\rangle e_n = \sum_{n=-\infty}^\infty \frac{1}{2\pi}\left\langle f, e^{inx} \right\rangle e^{inx} = \sum_{n=-\infty}^\infty c_n e^{inx} \\
$$

Writing out the coefficients $c_n$ gives

$$
\begin{align*}
	c_n &:= \frac{1}{2\pi}\left\langle f, e^{inx} \right\rangle = \frac{1}{2\pi}\int_{-\pi}^\pi f(x) e^{-inx}\;\mathrm{d}x = \frac{1}{2\pi}\int_{-\pi}^\pi f(x) \left[\cos(nx) - i \sin(nx) \right]\;\mathrm{d}x \\
	&= \frac{1}{2\pi} \langle f(x), \cos nx\rangle - \frac{1}{2\pi} \langle f(x), \sin nx\rangle = \alpha_n + i\beta_n
\end{align*}
$$

The Fourier series of $f$ can thus be rewritten as

$$
\begin{align*}
	f(x) &= \sum_{n=-\infty}^\infty c_n e^{inx} \\
	&= \sum_{n=-\infty}^\infty \left( \alpha_k + i\beta_k \right) \left(\cos nx + i\sin nx \right) \\
	&= \left(\alpha_0 + i\beta_0 \right) + \sum_{n=1}^\infty \left[\left(\alpha_{-n} + \alpha_{n} \right)\cos nx + \left(\beta_{-n} - \beta_n \right)\sin nx\right] + i\sum_{n=1}^\infty \left[\left(\beta_{-n} + \beta_{n} \right)\cos nx + \left(\alpha_{-n} - \alpha_n \right)\sin nx\right]
\end{align*}
$$

If $f$ is real-valued, then $\alpha_{-k} = \alpha_{k}$, $\beta_{-k} = -\beta_{k}$ and $\beta_0 = 0$, so that the Fourier transform reduces to

$$
	f(x) = \frac{a_0}{2} + \sum_{n=1}^\infty \left[a_n \cos nx + b_n\sin nx \right]
$$

with 

$$
	a_n = 2\alpha_n = \frac{1}{\pi} \int_{-\pi}^\pi f(x)\cos(nx)\;\mathrm{d}x \quad b_n = 2\beta_n = \frac{1}{\pi} \int_{-\pi}^\pi f(x)\sin(nx)\;\mathrm{d}x
$$

The Fourier series for an $L$-periodic function $f\in L^2\left([0, L]\right)$ can be similarly found using the orthogonal basis $\Set{ e_n := e^{\frac{i2\pi n x}{L}} }$ giving

$$
	f(x) = \frac{a_0}{2} + \sum_{n=1}^\infty \left[ a_n \cos\left( \frac{2\pi n x}{L} \right) + b_n \sin\left( \frac{2\pi n x}{L} \right) \right] = \sum_{n=-\infty}^\infty c_n e^{\frac{i2\pi n x}{L}}
$$

with coefficients

$$
	c_n = \frac{1}{L}\langle f(x), e_n \rangle = \frac{1}{L}\int_0^L f(x)e^{-\frac{i2\pi n x}{L}}\;\mathrm{d}x
$$

## Parseval's identity

# Fourier transform

The Fourier transform integral is the limit of Fourier series as the periodicity goes to infinity. Consider a Fourier series of a function $f \in L^2\left([-L/2, L/2] \right)$

$$
	f(x) = \sum_{n=-\infty}^\infty c_n e^{\frac{i2\pi n x}{L}} \quad c_n = \frac{1}{L}\langle f(x), e_n \rangle = \frac{1}{L}\int_{-L/2}^{L/2} f(x)e^{-\frac{i2\pi n x}{L}}\;\mathrm{d}x
$$

Defining $\xi = \frac{n}{L}$ and $\Delta\xi = \frac{1}{L}$. Taking the limit $L\to\infty  \iff \Delta\xi\to 0$ we get

$$
	f(x) = \lim_{\Delta\xi \to 0} \sum_{n=-\infty}^\infty \Delta\xi \int_{-\frac{1}{2\xi}}^{\frac{1}{2\xi}} f(\xi) e^{-i2\pi \xi x}\;\mathrm{d}\xi e^{i2\pi n \Delta\xi x} = \lim_{\Delta\xi\to 0}\sum_{n=-\infty}^\infty \Delta\xi \langle f(x), e^{i2\pi \xi x} \rangle e^{i 2\pi n \Delta\xi x}
$$

Defining $\omega = \frac{n\pi}{L}$ and $\Delta\omega = \frac{\pi}{L}$. Taking the limit $L\to\infty$ or $\Delta\omega\to 0$ we get

$$
	f(x) = \lim_{\Delta\omega\to 0} \sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi} \int_{-\frac{\pi}{\Delta\omega}}^{\frac{\pi}{\Delta\omega}} f(\xi) e^{-i\omega\xi}\;\mathrm{d}\xi e^{in\Delta\omega x} = \lim_{\Delta\omega\to 0}\sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi}\langle f(x), e_i\omega x \rangle e^{in\Delta\omega x}
$$

In this limit, the summation with weight $\Delta\xi$ becomes a Riemann integral. The Fourier transform of $f$, denoted $\mathcal{F}\left[ f(x) \right] = \hat{f}(\omega)$ is defined as the inner product $\langle f(x), e^{i2\pi\xi x}\rangle$ resulting in

$$
\begin{align*}
	f(x) &= \mathcal{F}^{-1}\left[ \hat{f}(\xi) \right] = \int_{-\infty}^\infty \hat{f}(\xi) e^{i2\pi\xi x}\;\mathrm{d}\xi \\
	\hat{f}(\xi) &= \mathcal{F}\left[ f(x) \right] = \int_{-\infty}^\infty f(x) e^{-i2\pi\xi x}\;\mathrm{d}x
\end{align*}
$$

Both integrals converge as long as $f$ and $\hat{f}$ are integrable, i.e. $f, \hat{f}\in L^1 (-\infty, \infty)$. When the independent variable $x$ represents time, denoted $t\in\R$, the transform variable $\xi$ represents frequency, denoted $f\in\R$. In terms of angular frequency $\omega = 2\pi f$, the Fourier transform takes the form

$$
	\hat{f}(\omega) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty} f(t) e^{-i \omega t}\;\mathrm{d}x \quad \forall \omega\in\R
$$

## Properties

<MathBox title='Linearity of Fourier transforms' boxType='proposition'>
The Fourier transform is a linear operator, so that for $f, g\in L^1 (\R^n, \mathbb{C})$ and $\alpha, \beta\in\mathbb{C}$, we have

$$
\begin{gather*}
	\mathcal{F}\left[\alpha f(x) + \beta g(x) \right] = \alpha\mathcal{F}\left[ f(x) \right] + \beta\mathcal{F}\left[ g(x) \right] \\
	\mathcal{F}^{-1}\left[\alpha \hat{f}(x) + \beta \hat{g}(x) \right] = \alpha\mathcal{F}^{-1}\left[ \hat{f}(x) \right] + \beta\mathcal{F}^{-1}\left[ \hat{g}(x) \right] \\
\end{gather*}
$$
</MathBox>

<MathBox title='Shifting property' boxType='proposition'>
Let $f, \hat{f} \in L^1\left(\R\right)$ be integrable functions. The Fourier transform of a translation in $f$ is given by

$$
	\mathcal{F}\left[ f(x - x_0) \right] = e^{-i2\pi x_0 \xi}\hat{f}(\xi)
$$

The inverse Fourier transform of a modulation in $\hat{f}$ is given by

$$
	\mathcal{F}^{-1}\left[ \hat{f}(\xi - \xi_0) \right] = f(x)e^{-i2\pi\xi_0 x}
$$
</MathBox>

<MathBox title='Fourier transform of derivatives' boxType='proposition'>
Let $f:\R\to\mathbb{C}$ be an absolutely continuous differentiable function, and suppose $f, f' \in L^1(\R)$ are integrable. The Fourier transform of the derivative $f'$ is given by

$$
	\hat{f}'(\xi) = \mathcal{F}\left[ \frac{\mathrm{d}}{\mathrm{d}x} f(x) \right] = i2\pi\xi \hat{f}(\xi)
$$

The Fourier transform for the $n$th derivative $f^{(n)}$ is given by

$$
	\hat{f}^{(n)}(\xi) = \mathcal{F}\left[ \frac{\mathrm{d}^n}{\mathrm{d}x^n} f(x) \right] = (i2\pi\xi)^n \hat{f}(\xi)
$$

<details>
<summary>Proof</summary>

Integrating by parts gives

$$
\begin{align*}
	\mathcal{F}\left[ \frac{\mathrm{d}}{\mathrm{d}x} f(x) \right] &= \int_{-\infty}^\infty \overbrace{f'(x)}^{\mathrm{d}v}e^{-i2\pi\xi x}\;\mathrm{d}x \\
	&= \underbrace{f(x)e^{-i2\pi\xi x}}_{uv}|_{-\infty}^\infty - \int_{-\infty}^\infty \underbrace{f(x)}_{u} \left(-i2\pi\xi e^{-i2\pi\xi x}\right)\;\mathrm{d}x \\
	&= i2\pi\xi \int_{-\infty}^\infty f(x)e^{-i2\pi\xi x}\;\mathrm{d}x \\
	&= i2\pi\xi\mathcal{F}\left[ f(x) \right]
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Convolution theorem' boxType='theorem'>
Let $f, g \in L^1(\R)$ be integrable functions. The Fourier transform of the convolution

$$
	h(x) := (f*g)(x) = \int_{-\infty}^\infty f(y)g(x - y)\;\mathrm{d}y
$$

is given by

$$
	\hat{h}'(\xi) = \hat{f}(\xi)\cdot\hat{g}(\xi)
$$

<details>
<summary>Proof</summary>

Taking the inverse Fourier transform of the product of $\hat{f}$ and $\hat{g}$ gives

$$
\begin{align*}
	\mathcal{F}\left[ \hat{f}(\xi) \hat{g}(\xi) \right] &= \int_{-\infty}^\infty \hat{f}(\xi)\hat{g}(\xi)e^{i2\pi\xi x}\;\mathrm{d}\xi \\
	&= \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi x}\left[ \int_{-\infty}^\infty g(y) e^{-i2\pi\xi y}\;\mathrm{d}y \right]\;\mathrm{d}\xi \\
	&= \int_{-\infty}^\infty g(y)\hat{f}(\xi) e^{i2\pi\xi(x - y)}\;\mathrm{d}\xi\mathrm{d}y \\
	&= \int_{-\infty}^\infty g(y) \underbrace_{\left[ \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi(x - y)}\;\mathrm{d}\xi \right]}_{f(x - y)}\;\mathrm{d}y \\
	&= \int_{-\infty}^\infty g(y)f(x - y)\;\mathrm{d}y \\
	&= g*f = f*g
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Parseval-Plancherel theorem' boxType='theorem'>
Let $f, g \in L^1(\R)\cap L^2(\R)$, then the following identity holds (Parseval's theorem)

$$
	\langle f, g \rangle = \int_{-\infty}^\infty f(x)\overline{g(x)}\;\mathrm{d}x = \int_{-\infty}^\infty \hat{f}(\xi)\overline{\hat{g}(\xi)}\;\mathrm{d}x
$$

In the special case $g = f$, this identity reduces to (Plancherel's theorem)

$$
	\lVert f \rVert_{L^2}^2 = \int_{-\infty}^\infty |f(x)|^2\;\mathrm{d}x = \int_{-\infty}^\infty \left|\hat{f}(\xi)\right|^2\;\mathrm{d}\xi
$$
</MathBox>

## Uncertainty principle

<MathBox title='Schwartz space' boxType='definition'>
The Schwartz space on $\R^n$ is the space of all smooth functions whose derivatives are rapidly decreasing

$$
\begin{align*}
	\mathcal{S}\left(\R^n, \mathbb{C}\right) &:= \Set{ f\in C^\infty (\R^n, \mathbb{C}) | \forall \alpha, \beta \in \N^n \;: \lVert f \rVert_{\alpha, \beta} < \infty } \subset L^1\left(\R^n, \mathbb{C}\right) \\
	\lVert f \rVert_{\alpha, \beta} &:= \sup_{x\in\R^n} \left| x^\alpha \left(D^\beta f \right)(x) \right|
\end{align*}
$$

The Fourier transform defines an automorphism on Schwartz spaces, i.e. $f\in\mathcal{S}\left(\R^n, \mathbb{C}\right) \implies \hat{f}\in \mathcal{S}\left(\R^n, \mathbb{C}\right)$
</MathBox>

<MathBox title='Uncertainty principle' boxType='theorem'>
For any Schwartz function $f\in\mathcal{S}(\R)$ and any $x_0, \xi_0 \in\R$, the following inequality holds

$$
	\lVert f(x) \rVert_{L^2} \leq 4\pi \left\lVert (x - x_0) f(x) \right\rVert_{L^2}\cdot\left\lVert (\xi - \xi_0) \hat{f}(x) \right\rVert_{L^2}
$$

If $f$ is normalized, i.e. $\lVert f(x) \rVert_{L^2} = 1$, then the inequality can be written

$$
	\left\lVert (x - x_0) f(x) \right\rVert_{L^2}^2 \cdot\left\lVert (\xi - \xi_0) \hat{f}(x) \right\rVert_{L^2}^2 \geq \frac{1}{16\pi^2}
$$

<details>
<summary>Proof</summary>

Applying integration by parts on $\lVert f \rVert_{L^2}^2$ gives

$$
\begin{align*}
	\lVert f \rVert_{L^2}^2 &= \int_{-\infty}^\infty |f(x)|^2\;\mathrm{d}x = \int_{-\infty}^\infty f(x)\overline{f(x)}\;\mathrm{d}x \\
	&= \left. x|f(x)|^2 \right|_{-\infty}^\infty - \int_{-\infty}^\infty x\left[ f'(x)\overline{f(x)} + f(x)\overline{f'(x)} \right]\;\mathrm{d}x \\
	&= - 2\int_{-\infty}^\infty x\Re\left[ f'(x)\overline{f'(x)} \right]\;\mathrm{d}x \\
	&\leq 2 \lVert x f(x) \rVert_{L_2} \cdot \left\lVert f'(x) \right\rVert_{L_2}
\end{align*}
$$

Where we have used that $\lim_{|x|\to\infty} \left| xf(x)^2 \right| = 0$ since $f$ is Schwartz, and the Cauchy-Schwartz inequality. Using Plancherel's identity and the Fourier transform derivation rule give

$$
	\left\lVert \overline{f'(x)} \right\rVert_{L_2} = \left\lVert f'(x) \right\rVert_{L_2} = \left\lVert \hat{f}'(\xi) \right\rVert_{L_2} = \left\lVert (i2\pi\xi)\hat{f}(\xi) \right\rVert_{L_2} = 2\pi\left\lVert \xi\hat{f}(\xi) \right\rVert_{L_2}
$$

Combining the results gives a special case of the uncertainty principle

$$
	\lVert f \rVert_{L^2}^2 \leq 4\pi \lVert x f(x) \rVert_{L^2} \cdot \left\lVert \xi \hat{f}(\xi) \right\rVert_{L^2}
$$

To prove the uncertainty principly in its full generality, we define the function

$$
	g(x) = e^{-i2\pi\xi_0 x} f(x + x_0) \;\textrm{ so that }\; \hat{g}(x) = e^{i2\pi x_0 \xi} \hat{f}(\xi + \xi_0)
$$

For this function $g$, we have

$$
\begin{align*}
	\lVert g \rVert_{L^2}^2 &= \int_{-\infty}^\infty \left| e^{-i2\pi\xi_0 x} f(x + x_0) \right|^2 \;\mathrm{d}x = \int_{-\infty}^\infty \left| f(t) \right|^2 \;\mathrm{d}t = \lVert f \rVert_{L^2}^2 \\
	\lVert u g(u) \rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| u e^{-i2\pi\xi_0 u} f(u + x_0) \right|^2 \;\mathrm{d}u \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| (x - x_0) f(x) \right|^2 \;\mathrm{d}x \right)^{1/2} = \lVert (x - x_0)f(x) \rVert_{L^2} \\
	\lVert t\hat{g}(t) \rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| t e^{i2\pi x_0 t} \hat{f}(t + \xi_0) \right|^2 \;\mathrm{d}t \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| \left(\xi - \xi_0 \right) \hat{f}(\xi_0) \right|^2 \;\mathrm{d}\xi \right)^{1/2} = \left\lVert \left(\xi - \xi_0\right) \hat{f}(\xi) \right\rVert_{L^2}
\end{align*}
$$

Substituting $g$ into the specialized uncertainty inequality above yields the desired result.
</details>
</MathBox>

The equality holds in the uncertainty principle if we get an equality when applying the Cauchy-Schwartz inequality. This implies we must have $f'(x) = \lambda xf(x)$ for some scalar $\lambda$. This differential equation has the general solution

$$
	f(x) = \alpha e^{-\frac{\lambda}{2} x^2} \quad \lambda > 0,\; |\alpha|^2 = \sqrt\frac{\lambda}{\pi}\lVert f \rVert_{L^2}^2
$$

# Discrete Fourier transform

<MathBox title='Discrete Fourier transform (DFT)' boxType='definition'>
The discrete Fourier transform of a complex sequence $\Set{ f_n }_{n=0}^N \subseteq\mathbb{C}$ produces a complex sequence $\left\{ F_k }_{k=0}^{N-1}$ where

$$
	\mathcal{F}\Set{ f_k } = F_k = \sum_{n=0}^{N-1} x_n \cdot e^{-\frac{i2\pi}{N}kn}
$$

The inverse transform is defined by

$$
	f_n = \frac{1}{N} \sum_{n=0}^{N-1} X_k \cdot e^{\frac{i2\pi}{N}kn}
$$
</MathBox>

## Fast Fourier transform


# Short-time Fourier transform

<MathBox title='Short-time Fourier transform (STFT)' boxType='definition'>
The short-time Fourier transform of an integrable function $f:\R\to\mathbb{C}$ is defined by

$$
	\mathcal{F}\left[ f(\tau) \right] = \hat{f}_g(t, \omega) = \int_{-\infty}^\infty f(\tau) \overline{g(\tau - t)} e^{-i \omega x}\;\mathrm{d}\tau = \langle f(\tau), g_{t,\omega}(\tau) \rangle 
$$

where $g_{t, \omega}(\tau) = e^{i\omega t}g(\tau - t)$ and $g(t)$ is the kernel (window). The Gabor transform is a special case of the STFT with a Gaussian kernel of the form

$$
	g(t) = e^{-\frac{(t - \tau)^2}{a^2}}
$$

The inverse STFT transform is given by

$$
	f(t) = \mathcal{F}^{-1}\left[ \hat{f}_g (t, \omega) \right] = \frac{1}{2\pi\lVert g\rVert^2} \int_{-\infty}^\infty\int_{-\infty}^\infty \hat{f}_g (\tau, \omega)g(t - \tau)e^{i\omega t}\;\mathrm{d}\omega \mathrm{d}t
$$
</MathBox>

## Discrete

The discrete version of the STFT can be formed by discretizing time and frequency

$$
	\tau = j\Delta t \quad \nu = k \Delta\omega \quad j, k \in\N
$$

The discretized kernel function becomes

$$
	g_{j, k} = e^{i2\pi k\Delta\omega t} g(t - k\Delta t)
$$

and the discrete STFT is

$$
	\hat{f}_{j, k} = \langle f, g_{j,k}\rangle = \int_{-\infty}^\infty f(\tau)\overline{g_{j, k}(\tau)}\;\mathrm{d}\tau
$$

# Wavelet transform

Wavelets extend the concepts in Fourier analysis to more general orthogonal bases, and partially overcome the uncertainty principle by exploiting multi-resolution decomposition. This multi-resolution approach enables different time and frequency fidelities in different frequency bands.

<MathBox title='Wavelet' boxType='definition'>

A function $\psi\in L^2(\R)$ is called an orthonormal wavelet if it generates a basis for $L^2(\R)$. The basis is constructed as a family of functions by means of translations and dilations of $\psi$

$$
	\Set{\psi_{a,b}(t) = \frac{1}{\sqrt{a}}\left( \frac{t - b}{a} \right) |dle| b \in\R,\; a\R^+ }
$$

In terms of dyadic translations and dilations with $a = 2^{-j}$ and $b = k2^{-j}$ for $j, k \in \Z$, we get

$$
	\langle \psi_{jk}, \psi_{lm} \rangle = \int_{-\infty}^\infty \psi_{jk}(x)\overline{\psi_{lm}(x)}\;\mathrm{d}x = \delta_{jl}\delta_{km}
$$
</MathBox>

<MathBox title='Wavelet transform' boxType='definition'>
Suppose $\psi\in L^2 (\R)$ is an orthonormal wavelet satisfying the boundedness property

$$
	C_\psi = \int_{-\infty}^\infty \frac{\left| \hat{\psi}(\omega) \right|^2}{|\omega |}\mathrm{d}\omega < \omega
$$

The wavelet transform of a function $f\in L^1(\R$ is defined as

$$
	\mathcal{W}_\psi \left[ f(t) \right](a, b) = \langle f, \psi_{a, b} \rangle = \int_{-\infty}^\infty f(t)\overline{\psi_{a,b}(t)}\;\mathrm{d}t = \frac{1}{\sqrt{|a|}}\int_{-\infty}^\infty f(t)\overline{\psi\left(\frac{t - b}{a}\right)}\;\mathrm{d}t
$$

The inverse wavelet transform is

$$
	f(t) = \frac{1}{C_\psi} \int_0^\infty \int_{-\infty}^\infty \mathcal{W}_\psi [f](a, b) \psi_{a, b}(t)\frac{1}{a^2}\;\mathrm{d}a\mathrm{d}b
$$

Every function $f\in L^2(\R)$ may be expanded in the wavelet basis as (using dyadic translations and dialtions)

$$
	f(t) = \sum_{j=-\infty}^\infty \sum_{k=-\infty}^\infty \psi_{jk}(t)
$$

where the wavelet coefficients $c_{jk}$ are given by

$$
	c_{jk} = \langle f(t), \psi_{j, k} \rangle = \mathcal{W}_\psi[f(t)]\left(2^{-j}, k2^{-j} \right)
$$
</MathBox>

## Haar wavelet

$$
	\psi(t) = \begin{cases} 
		1 &\quad 0\leq t < \frac{1}{2} \\
		-1 &\quad \frac{1}{2}\leq t < 1 \\
		0 &\quad \textrm{otherwise}
	\end{cases}
$$

## Mexican hat wavelet

$$
\begin{align*}
	\psi(t) &= (1 - t^2)e^{-\frac{t^2}{2}} \\
	\hat{\psi(\omega)} &= \sqrt{2\pi}\omega^2 e^{-\frac{\omega^2}{2}}
\end{align*}
$$