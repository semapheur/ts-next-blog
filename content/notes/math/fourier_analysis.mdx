---
title: 'Fourier Analysis'
subject: 'Mathematics'
showToc: true
---

# Trigonometric sum formulas

<MathBox title='' boxType='lemma' tag='lemma-1'>
If $x\in\R\setminus\set{2\pi n}_{n\in\Z}$, then

$$
\begin{equation}
	\frac{1}{2} + \sum_{k=1}^n \cos(kx) = \frac{1}{2} \frac{\sin\left[\left(n + \frac{1}{2}\right)x\right]}{\sin\left(\frac{1}{2}x \right)} \tag{\label{equation-2}}
\end{equation}
$$

<details>
<summary>Proof</summary>

Writing the left side of $\eqref{equation-2}$ as a geometric sum of trigonometric exponential functions, we get

$$
\begin{align*}
	\frac{1}{2} + \sum_{k=1}^n \cos(kx) =& \frac{1}{2} + \sum_{k=1}^n \frac{1}{2} (e^{ikx} + e^{ikx}) = \frac{1}{2} \sum_{k=-n}^n e^{ikx} \\
	=& \frac{1}{2} e^{-inx} \sum_{k=0}^{2n} e^{ikx}
\end{align*}
$$

Applying the geometric sum formula $\sum_{k=0}^n q^k = \frac{1 - q^{n+1}}{1 - q}$ with $q = e^{ix}$, we obtain

$$
\begin{align*}
	\frac{1}{2}e^{-inx} \sum_{k=0}^{2n} e^{ikx} =& \frac{1}{2}e^{-inx} \frac{1 - e^{i(2n+1)x}}{1 - e^{ix}} \\
	=& \frac{1}{2}\frac{e^{-inx} - e^{i(n+1)x}}{1 - e^{ix}} \frac{-e^{-ix/2}}{-e^{-ix/2}} \\
	=& \frac{1}{2} \frac{e^{i\left(n + 1/2\right)x} - e^{-i\left(n + 1/2\right)x}}{e^{ix/2} - e^{-ix/2}} \frac{\frac{1}{2i}}{\frac{1}{2i}} \\
	=& \frac{1}{2} \frac{\sin\left[\left(n + \frac{1}{2}\right)x\right]}{\sin\left(\frac{1}{2}x \right)}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-2'>
If $x\in(0,2\pi)$, then

$$
	\sum_{k=1}^\infty \frac{\sin(kx)}{k} = \frac{\pi - x}{2}
$$

<details>
<summary>Proof</summary>

Noting that $\sin(kx)/k = \int_{\pi}^x \cos(kt)\;\d t$ and applying Lemma $\ref{lemma-1}$, we get

$$
\begin{align*}
	\sum_{k=1}^n \frac{\sin(kx)}{k} =& \sum_{k=1}^n \int_\pi^x \cos(kt) \;\d t = \int_\pi^x \sum_{k=1}^n \cos(kt)\;\d t \\
	=& \int_\pi^x \left(\frac{1}{2} \frac{\sin\left[\left(n + \frac{1}{2}\right)x\right]}{\sin\left(\frac{1}{2}x \right)} - \frac{1}{2} \right)\;\d t \\
	=& \underbrace{\int_\pi^x \frac{\sin\left[\left(n + \frac{1}{2}\right)t\right]}{2\sin\left(\frac{1}{2}t\right)}\;\d t}_{f_n (x)} - \frac{1}{2}(x - \pi)
\end{align*}
$$

Integrating the first term, $f_n$, by parts with 

$$
\begin{aligned}
	u =& \frac{1}{2\sin\left(\frac{1}{2}t\right)} \\
	u' =& -\frac{1}{2} \frac{\frac{1}{2}\cos(\frac{1}{2}t)}{\sin^2 (\frac{1}{2}t)}
\end{aligned}\quad
\begin{aligned}
	v' =& \sin\left[\left(n + \frac{1}{2}\right)t\right] \\
	v =& -\frac{1}{n + \frac{1}{2}} \cos\left[\left(n + \frac{1}{2}\right)t\right]
\end{aligned}
$$

we get

$$
\begin{align*}
	f_n (x) =& \left. -\frac{1}{n + \frac{1}{2}} \cos\left[\left(n + \frac{1}{2}\right)t\right] \right|_\pi^x \\
	&- \int_\pi^x \frac{1}{n + \frac{1}{2}} \frac{(-1)\cos\left[\left(n + \frac{1}{2}\right) t \right]\cos\left(\frac{1}{2}t\right)}{(-4)\sin^2 \left(\frac{1}{2}t\right)} \;\d t \\
	=& \frac{1}{n + \frac{1}{2}} \left(\frac{-\cos\left[\left(n + \frac{1}{2}\right) x \right]}{2\sin\left(\frac{1}{2}x \right)} \right. \\
	&- \left. \frac{1}{4}\int_\pi^x \frac{\cos\left[\left(n + \frac{1}{2}\right) t \right]\cos\left(\frac{1}{2}t\right)}{\sin^2 \left(\frac{1}{2}t\right)}\right) \\
	=& \frac{1}{n + \frac{1}{2}} \left(a(x) + b(x) \right)
\end{align*}
$$

To show uniform convergence, we require that $\lVert f_n \rVert_\infty \xrightarrow{n\to 0}$, where $\lVert\cdot\rVert_\infty$ is the supremum norm. For $\epsilon > 0$, choose $x\in[\epsilon, 2\pi - \epsilon]$. Then, by the triangle inequality we get

$$
\begin{align*}
	\lVert f_n \rVert_\infty \tleq& \frac{1}{n + \frac{1}{2}} (\left \lVert a \rVert_\infty + \lVert b \rVert_\infty \right) \\
	\leq& \frac{1}{n + \frac{1}{2}} \left(\frac{1}{2\delta} + \frac{1}{4\delta^2} \pi \right) \xrightarrow{n\to\infty} 0 
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition' tag='proposition-3'>
If $x\in[0,2\pi]$, then

$$
	\sum_{k=1}^\infty \frac{\cos(kx)}{k^2} = \frac{(x - \pi)^2}{4} - \frac{\pi^2}{12}
$$

<details>
<summary>Proof</summary>

Applying Lemma $\ref{lemma-2}$ and noting that $\sin(kx)/k = -\int_{x_0}^x \cos(kt)/k^2 \;\d t$, we get for $\epsilon > 0$ and $x, x_0 \in [\epsilon, 2\pi - \epsilon]$

$$
\begin{align*}
	\int_{x_0}^x \sum_{k=1}^\infty \frac{\sin(kt)}{k}\;\d t =& \int_{x_0}^x \frac{\pi - t}{2}\;\d t = \left. \frac{(\pi - t)^2}{4}\right|_{x_0}^x \\
	=& -\frac{(x - \pi)^2}{4} + \underbrace{\frac{(x_0 - \pi)^2}{4}}_{C_0}
\end{align*}
$$

By uniform convergence, we have

$$
\begin{align*}
	\int_{x_0}^x \sum_{k=1}^\infty \frac{\sin(kt)}{k}\;\d t =& \sum_{k=1}^\infty \int_{x_0}^x \frac{\sin(kx)}{k}\;\d t \\
	=& \sum_{k=1}^\infty \left.-\frac{-\cos(kt)}{k^2}\right|_{x_0}^x \\
	=& -\sum_{k=1}^\infty \frac{\cos(kx)}{k^2} + \underbrace{\sum_{k=1}^\infty \frac{\cos(kx_0)}{k^2}}_{C_1} 
\end{align*}
$$

Combining the results, we get

$$
\begin{equation}
	\sum_{k=1}^\infty \frac{\cos(kx)}{k^2} = \frac{(x - \pi)^2}{4} + C \tag{\label{equation-3}}
\end{equation}
$$

By Weierstrass M-test, the left-hand side of $\eqref{equation-3}$ is uniformly convergent on $[0,2\pi]$ since $\left|\frac{\cos(kx)}{k^2}\right|\leq \frac{1}{k^2}$. It follows that

$$
	[0,2\pi] \ni x \mapsto \sum_{k=1}^\infty \frac{\cos(kx)}{k^2}
$$

is continuous. Furthermore, the right-hand side of $\eqref{equation-3}$ is also continous for $x\in[0,2\pi]$. Thus, $\eqref{equation-3}$ is uniformly convergent on $[0,2\pi]$.

Integrating $\eqref{equation-1}$, we find

$$
	\int_0^{2\pi} \sum_{k=1}^\infty \frac{\cos(kx)}{k^2} \;\d x = \int_0^{2\pi} \left( \frac{(x - \pi)^2}{4} + C \right)\;\d x = \underbrace{\left. \frac{(x - \pi)^3}{12}\right|_0^{2\pi}}_{=\pi^3 / 6} + 2\pi C
$$

By uniform convergence the left-hand integral can be written

$$
	\int_0^{2\pi} \sum_{k=1}^\infty \frac{\cos(kx)}{k^2} \;\d x = \sum_{k=1}^\infty \int_0^{2\pi} \frac{\cos(kx)}{k^2} \;\d x = 0
$$

which follows since $\cos(kx)$ is integrated over a full period $2\pi$. Hence it follows that $C = -\pi^2 / 12$, completing the proof.
</details>
</MathBox>

# Trigonometric polynomials

<MathBox title='Periodic function' boxType='definition'>
Let $k\in\R$. A function $f:\R\to\mathbb{F}$ is $k$-periodic if $f(x + k) = f(x)$ for all $x\in\R$. The set of all $k$-period real functions is denoted

$$
	\mathcal{F}_k (\R,\R) = \Set{f:\R\to\mathbb{F} | f(x + k) = f(x)\; \forall x\in\R}
$$
</MathBox>

<MathBox title='' boxType='proposition'>
The set of $2\pi$-periodic functions $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ given by

$$
	\mathcal{U} := \set{x\mapsto\sin(nx)}_{n\in\N_+} \cup \set{x\mapsto\cos(nx)}_{n\in\N}
$$

is linearly independent. The space spanned by $\mathcal{U}$ is denoted $P_{2\pi} := \operatorname{span}(\mathcal{U})$.
</MathBox>

<MathBox title='Trigonometric polynomial' boxType='definition'>
Let $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ be given by

$$
	\mathcal{U} := \set{x\mapsto\sin(nx)}_{n\in\N_+} \cup \set{x\mapsto\cos(nx)}_{n\in\N}
$$

A linear combination of $f\in\operatorname{span}(\mathcal{U})$ for $f:\R\to\R$ is called a (real) trigonometric polynomial and takes the form

$$
	f(x) = a_0 + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \cos(kx),\; a_k, b_k \in\R
$$

If $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\mathbb{C})$, the linear combination is called a complex trigonometric polynomial and takes the form

$$
	f(x) = \sum_{k=-n}^n c_k e^{ikx},\; c_k \in \mathbb{C}
$$
</MathBox>

<MathBox title='Trigonometric basis is orthogonal' boxType='proposition'>
Let $\mathcal{F}_{2\pi} (\R,\R)$ be equipped with the inner product

$$
	\langle f, g\rangle := \frac{1}{2\pi} \int_{-\pi}^\pi f(x)g(x)\;\d x,\; f,g\in\mathcal{F}_{2\pi}
$$

The set of $2\pi$-periodic functions $\mathcal{B}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ given by

$$
	\mathcal{B} := \set{x\mapsto\sin(kx)}_{k\in\N_+} \cup \set{x\mapsto\cos(kx)}_{k\in\N}
$$

forms an orthogonal basis for $\mathcal{F}_{2\pi}$.


<details>
<summary>Proof</summary>

We calculate the inner product for all possible combinations from $\mathcal{B}$. For $x\mapsto 1$ we trivially have

$$
	\langle x\mapsto 1, x\mapsto 1 \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi 1\;\d x = 1
$$

Next

$$
\begin{align*}
	\langle x\mapsto 1, x\mapsto\cos(kx) \rangle =& \frac{1}{2\pi} \int_{-\pi}^\pi \cos(kx)\;\d x \\
	=& \frac{1}{2\pi k} [\sin(kx)]_{-\pi}^\pi = 0
\end{align*}
$$

Since $x\mapsto\cos(kx)\sin(lx)$ for $m,n\in\N$ is an odd function, it follows that

$$
\begin{align*}
	\langle x\mapsto\cos(kx), x\mapsto\sin(lx) \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \cos(kx)\sin(lx)\;\d x = 0
\end{align*}
$$

Noting that $\cos(x) = \frac{1}{2}(e^{ix} + e^{-ix})$, we get for $k\neq l$

$$
\begin{align*}
	&\langle x\mapsto\cos(kx), x\mapsto\cos(lx)\rangle \\ 
	=& \frac{1}{8\pi} \int_{-\pi}^{\pi} e^{i(k+l)x} + e^{-i(k+l)x} + e^{i(k-l)x} + e^{-i(k-l)x}\;\d x \\
	=& \frac{1}{4\pi}\left[\frac{1}{k+l}\frac{1}{2i} (e^{i(k+l)x} + e^{-i(k+l)x}) +  \frac{1}{k-l}\frac{1}{2i}\left(e^{i(k-l)} + e^{-i(k-l)}\right) \right]_{-\pi}^{\pi} \\
	=& \frac{1}{4\pi} \left[\frac{1}{k+l} \sin[(k+l)x] + \frac{1}{k-l}\sin[(k-l)x] \right]_{-\pi}^\pi = 0
\end{align*}
$$

Similarly, we find

$$
	\langle x\to\sin(kx), x\to\sin(lx)\rangle = \int_{-\pi}^\pi \sin(kx) \sin(lx)\;\d x = 0
$$

This shows that $\langle f,g\rangle = 0$ for $f,g\in\mathcal{U}$ with $f\neq g$.
</details>
</MathBox>

<MathBox title='Complex trigonometric basis is orthogonal' boxType='proposition'>
Let $\mathcal{F}_{2\pi} (\R,\mathbb{C})$ be equipped with the inner product

$$
	\langle f, g\rangle := \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)}g(x)\;\d x,\; f,g\in\mathcal{F}_{2\pi}
$$

The set of $2\pi$-periodic functions $\mathcal{E}\subseteq\mathcal{F}_{2\pi} (\R,\mathbb{C})$ given by

$$
	\mathcal{E} := \Set{e_k := e^{ikx} = \cos(kx) + i\sin(kx)}_{k\in\Z}
$$

forms an orthogonal basis for $\mathcal{F}_{2\pi}$.

<details>
<summary>Proof</summary>

This is easily shown by calculating the inner product

$$
\begin{align*}
	\left\langle e_k, e_k \right\rangle =& \frac{1}{2\pi} \int_{-\pi}^\pi e^{-ikx} e^{ilx}\;\d x = \int_{-\pi}^\pi e^{i(l - k)x}\;\d x \\
	=& \left.\frac{1}{i2\pi(l - k)}e^{i(l - k)x}\right|_{-\pi}^\pi = \delta_{kl}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Orthonormal trigonometric bases' boxType='proposition' tag='proposition-1'>
1. The basis $\mathcal{B}_1 = \set{x\mapsto\sqrt{2}\cos(nx)}_{n\in\N} \cup \set{x\mapsto\sqrt{2}\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_1 := \frac{1}{2\pi} \int_{-\pi}^\pi f(x)g(x)\;\d x
$$
2. The basis $\mathcal{B}_2 = \set{x\mapsto 1} \cup \set{x\mapsto\frac{1}{\sqrt{\pi}}\cos(nx)}_{n\in\N_+} \cup \set{x\mapsto\frac{1}{\sqrt{\pi}}\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_2 := \int_{-\pi}^\pi f(x)g(x)\;\d x
$$
3. The basis $\mathcal{B}_3 =  \set{x\mapsto 1/\sqrt{2}} \cup \set{x\mapsto\cos(nx)}_{n\in\N_+} \cup \set{x\mapsto\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_3 := \frac{1}{\pi}\int_{-\pi}^\pi f(x)g(x)\;\d x
$$

<details>
<summary>Proof</summary>

We start by calculating $\lVert x\mapsto\sin(nx) \rVert^2 = \langle x\mapsto\sin(nx), x\mapsto\sin(nx) \rangle_1$. Using integration by parts we find

$$
\begin{align*}
	\int_{-\pi}^\pi \sin^2 (nx) \;\d x =& \int_{-\pi}^\pi \underbrace{\sin(nx)}_{u} \underbrace{\sin(nx)}_{v' } \\
	=& \underbrace{\left[\sin(nx)\left(-\frac{1}{n} \right)\cos(nx)\right]_{-\pi}^\pi}_{=0} - \int_{-\pi}^\pi n\cos(nx) \left(-\frac{1}{n}\right) \cos(nx) \;\d x \\
	=& \int_{-\pi}^\pi \cos^2 (nx)^2 \; \d x = \int_{-\pi}^\pi 1 - \sin^2 (nx) \;\d x
\end{align*}
$$

We can rewrite this as

$$
\begin{gather}
	2 \int_{-\pi}^\pi \sin^2 (nx) \;\d x = \int_{-\pi}^\pi 1 \;\d x = 2\pi \\
	\implies \int_{-\pi}^\pi \sin^2 (nx) \;\d x = \pi
	\implies \lVert x\mapsto\sin(nx) \rVert^2 = \frac{1}{2}
\end{gather}
$$

It follows that $\mathbf{x} \mapsto \sqrt{2}\sin(nx)$ has unit norm. A similar calculation shows that $\mathbf{x} \mapsto \sqrt{2}\cos(nx)$ has unit norm. Hence, $\mathcal{B}_1$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_1$.

Since $\int_{-\pi}^\pi \sin^2(nx) \;\d x = \int_{-\pi}^\pi \cos^2 (nx) \;\d x = \pi$ it follows that $\mathcal{B}_2$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_2$, and that $\mathcal{B}_3$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_3$.
</details>
</MathBox>

## Integrable functions

<MathBox title='Integrable periodic function' boxType='definition'>
Let $k\in\R$. A $k$-period function $f\in \mathcal{F}_k (\R,\mathbb{F})$ is $n$-integrable if

$$
	\int_{-k/2}^{k/2} |f(x)|^n \;\d x < \infty
$$

The set of all integrable $k$-periodic functions is denoted

$$
	\mathcal{L}_k^n (\R,\R) = \Set{f\in\mathcal{F}_k (\R, \mathbb{F}) | \int_{-k/2}^{k/2} |f(x)|^n \;\d x < \infty}
$$

and forms a vector space, which is not a normed space. To form a normed space, we define the equivalence relation $f\sim g :\iff \lVert f-g\rVert_n = 0$ with respect to the norm

$$
	\lVert f \rVert_n := \left(\int_{-k/2}^{k/2} |f(x)|^n \;\d x\right)^{1/n}
$$

The quotient space $L_k^n (\R,\mathbb{C}) := \mathcal{L}_k^n (\R, \mathbb{F}) / \sim$ is a normed space with norm

$$
	\lVert [f] \rVert_n := \lVert f \rVert_n
$$

In particular, we have

$$
	L_{2\pi}^1 (\R, \mathbb{F}) \supset L_{2\pi}^1 (\R, \mathbb{F}) \supset\cdots\supset L_{2\pi}^\infty \supset \mathcal{P}_{2\pi} = \operatorname{span}(\set{x\mapsto\cos(mx)}_{m\in\N} \cup \set{x\mapsto\sin(mx)}_{m\in\N_+})
$$
</MathBox>

# Fourier series

<MathBox title='Fourier series in $L^2$' boxType='definition'>
Let $f\in L_{2\pi}^2 (\R,\R)$ be a square integrable $2\pi$-periodic function with respect to the inner product

$$
	\langle f, g\rangle = \frac{1}{\pi} \int_{-\pi}^\pi f(x)g(x) \;\d x
$$

If $\mathcal{U}_n = \operatorname{span}(\mathcal{B}_n)$ for $n\in\N$ is a finite-dimensional subspace spanned by the trigonometric basis

$$
	\mathcal{B}_n = \set{x \mapsto 1/\sqrt{2}} \cup \set{\cos(kx)}_{k=1}^n \cup \set{\sin(kx)}_{k=1}^n
$$

the orthogonal projection of $f$ onto $\mathcal{U}_n$ is given by

$$
	\mathcal{F}_n (f)(x) = \tilde{a}_0 \frac{1}{\sqrt{2}} + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \sin(kx)
$$

with

$$
\begin{align*}
	\tilde{a}_0 =& \left\langle x\mapsto \frac{1}{\sqrt{2}}, f \right\rangle = \frac{1}{\pi} \int_{-\pi}^\pi \frac{1}{\sqrt{2}} f(x) \;\d x \\
	a_k =& \langle x\mapsto\cos(kx), f \rangle = \frac{1}{\pi} \int_{-\pi}^\pi \cos(kx) f(x) \;\d x \\
	b_k =& \langle x\mapsto\sin(kx), f \rangle = \frac{1}{\pi} \int_{-\pi}^\pi \sin(kx) f(x) \;\d x
\end{align*}
$$

The map $n\mapsto \mathcal{F}_n (f)(x)$ is the Fourier series of $f$
</MathBox>

Fourier series can also be expressed in terms of trigonometric exponential functions. If 

$$
\begin{align*}
	\mathcal{B}_n =& \Set{x \mapsto \frac{1}{\sqrt{2}}} \cup \Set{\cos(kx)}_{k=1}^n \cup \Set{\sin(kx)}_{k=1}^n \\
	\mathcal{E}_n =& \Set{x\mapsto e^{ikx} = \cos(kx) + i\sin(kx)}_{k=-n}^n, \; n\in\N
\end{align*}
$$

then

$$
	\operatorname{span}(\mathcal{B}_n) = \operatorname{span}(\mathcal{E}_n)
$$

and

$$
	\frac{\tilde{a}_0}{\sqrt{2}} + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \sin(kx) = \sum_{k=-n}^n c_k e^{ikx}
$$

with

$$
	c_k = \begin{cases}
		\frac{1}{2} \left(a_k + \frac{b_k}{i} \right), \quad& k > 0 \\
		\tilde{a_0} \frac{1}{\sqrt{2}}, \quad& k = 0 \\
		\frac{1}{2} \left(a_{-k} - \frac{b_{-k}}{i} \right), \quad& k < 0
	\end{cases}
$$

<MathBox title='Complex Fourier series in $L^2$' boxType='definition'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{C})$ be a square integrable $2\pi$-periodic function with respect to the inner product

$$
	\langle f, g\rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)}g(x) \;\d x
$$

If $\mathcal{U}_n = \operatorname{span}(\mathcal{E}_n)$ for $n\in\N$ is a finite-dimensional subspace spanned by the trigonometric exponential basis

$$
	\mathcal{E}_n = \Set{x\mapsto e^{ikx}}_{k=-n}^n,
$$

the orthogonal projection of $f$ onto $\mathcal{U}_n$ is given by

$$
	\mathcal{F}_n (f)(x) = \sum_{k=-n}^n c_k e^{ikx}
$$

with

$$
	c_k = \langle x \mapsto e^{ikx}, f \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi e^{-ikx} f(x) \;\d x
$$

The map $n\mapsto \mathcal{F}_n (f)$ is the complex Fourier series of $f$.
</MathBox>

If $f \in L_{2\pi}^2 (\R,\mathbb{C})$ is a $2\pi$-periodic square integrable function, its complex Fourier series is given by

$$
	\mathcal{F}_n (f)(x) = \sum_{k=-n}^n \langle x\mapsto e^{ikx}, f\rangle e^{ikx} = \sum_{k=-n}^n c_k e^{ikx},\; n\in\N
$$

Assuming $L_{2\pi}^2 (\R,\mathbb{C})$ is equipped with the inner product

$$
	\langle f, g\rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)}g(x) \;\d x
$$

we can write out the complex coefficients $c_k\in\mathbb{C}$ as

$$
\begin{align*}
	c_k =& \left\langle f, e^{ikx} \right\rangle = \frac{1}{\pi}\int_{-\pi}^\pi e^{-ikx} f(x) \;\d x \\ 
	=& \frac{1}{\pi}\int_{-\pi}^\pi \left[\cos(kx) - i \sin(kx) \right]f(x)\;\d x \\
	=& \langle x\mapsto \cos(kx), f \rangle - i\langle x\mapsto \sin(kx), f \rangle = \alpha_k - i\beta_k
\end{align*}
$$

The complex Fourier series of $f$ can thus be rewritten as

$$
\begin{align*}
	\mathcal{F}_n (f)(x) =& \sum_{k=-n}^n c_n e^{inx} = \sum_{k=-n}^n \left( \alpha_k - i\beta_k \right) \left(\cos kx + i\sin kx \right) \\
	=& \left(\alpha_0 - i\beta_0 \right) + \sum_{k=1}^n \left[\left(\alpha_{-k} + \alpha_{k} \right)\cos kx + \left(\beta_{-k} - \beta_k \right)\sin kx\right] \\
	&+ i\sum_{k=1}^n \left[\left(\beta_{-k} + \beta_{k} \right)\cos kx + \left(\alpha_{-k} - \alpha_k \right)\sin kx\right]
\end{align*}
$$

If $f$ is real-valued, then $\alpha_{-k} = \alpha_{k}$, $\beta_{-k} = -\beta_{k}$ and $\beta_0 = 0$, so that the Fourier series reduces to

$$
	\mathcal{F}_n (f)(x) = \frac{a_0}{\sqrt{2}} + \sum_{k=1}^n \left[a_k \cos(kx) + b_k \sin(kx) \right]
$$

with 

$$
\begin{align*}
	a_k =& 2\alpha_k = \frac{1}{\pi} \int_{-\pi}^\pi \cos(kx)f(x)\;\d x \\
	b_k =& 2\beta_k = \frac{1}{\pi} \int_{-\pi}^\pi \sin(kx)f(x)\;\d x
\end{align*}
$$

The Fourier series for a $p$-periodic function $f\in L_p^2 (\R, \mathbb{C})$ can be similarly found using the orthogonal basis $\Set{ e_k := x\mapsto\exp\left(i\frac{2\pi k}{p}x\right)}_{k\in\Z}$ giving

$$
\begin{align*}
	\mathcal{F}_n (f) =& \frac{a_0}{\sqrt{2}} + \sum_{k=1}^n \left[ a_k \cos\left( \frac{2\pi k}{p} x\right) + b_k \sin\left( \frac{2\pi k}{p} x\right) \right] \\
	=& \sum_{k=-n}^\infty c_k \exp\left(i\frac{2\pi k}{p}x\right)
\end{align*}
$$

with coefficients

$$
	c_n = \langle e_k, f \rangle = \frac{1}{p}\int_0^L \exp\left(i\frac{2\pi k}{p}x\right) f(x)\;\d x
$$

<MathBox title='Geometric properties of Fourier series' boxType='proposition' tag='proposition-2'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{C})$ have complex Fourier series 

$$
	\mathcal{F}_n (f) = \sum_{k=-n}^n \langle x\mapsto e^{ikx}, f\rangle e^{ikx} = \sum_{k=-n}^n c_k e^{ikx}
$$

with respect to the inner product

$$
	\langle f, g \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)} g(x) \;\d x,\; f,g\in L_{2\pi}^2 (\R,\mathbb{C})
$$

then

1. $\lVert f - \mathcal{F}_n (f)\rVert^2 = \lVert f \rVert^2 - \sum_{k=-n}^n |c_k|^2$
2. **Bessel's inequality:** $\sum_{k=-n}^n |c_k|^2 \leq \lVert f \rVert^2$ for all $n\in\N$
		- Consequently $\sum_{k=-\infty}^\infty |c_k|^2 \leq \lVert f \rVert^2$ and $c_k \xrightarrow{k\to\infty} 0$
3. **Parseval's identity:** 
$$
	\lim_{n\to\infty} \lVert f - \mathcal{F}_n (f) \rVert = 0 \iff \sum_{k=-\infty}^\infty |c_k|^2 = \lVert f \rVert^2
$$

It follows directly from Parseval's identity that any $f\in L_{2\pi}^2 (\R,\mathbb{F})$ can be written $f = \mathcal{F}_n (f) + r_n$ with $\lVert r_n \rVert \xrightarrow{n\to\infty} 0$.

<details>
<summary>Proof</summary>

**(1):** By the Pythagorean theorem we have

$$
\begin{gather*}
	\lVert f \rVert^2 = \lVert \mathcal{F}_n (f) \rVert^2 + \lVert f - \mathcal{F}_n (f) \rVert^2 \\
	\implies \lVert f - \mathcal{F}_n (f)\rVert^2 = \lVert f \rVert^2 - \lVert f - \mathcal{F}_n (f) \rVert^2
\end{gather*}
$$

Since $\Set{x\mapsto e^{ikx}}_{k\in\Z}$ is orthonormal with respect to the the inner product, it follows that 

$$
\begin{align*}
	\lVert \mathcal{F}_n (f) \rVert^2 =& \langle \mathcal{F}_n (f), \mathcal{F}_n (f) \rangle \\
	=& \left\langle \sum_{k=-n}^n c_k e^{ikx}, \sum_{\ell=-n}^n c_k e^{i\ell x} \right\rangle \\
	=& \sum_{k=-n}^n \sum_{\ell = -n}^n c_k \overline{c_\ell} \underbrace{\langle e^{ikx}, e^{i \ell x} \rangle}_{=\delta_{k\ell}} \\
	=& \sum_{k=-n}^n |c_k|^2
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition' tag='proposition-6'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{C})$ have complex Fourier series 

$$
	\mathcal{F}_n (f) = \sum_{k=-n}^n \langle x\mapsto e^{ikx}, f\rangle e^{ikx} = \sum_{k=-n}^n c_k e^{ikx}
$$

with respect to the inner product

$$
	\langle f, g \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)} g(x) \;\d x,\; f,g\in f,g\in L_{2\pi}^2 (\R,\mathbb{C})
$$

then the following are equivalent:
1. **Parseval's identity:** $\lVert f \rVert^2 = \sum_{k=-\infty}^\infty |\langle x\mapsto e^{ikx}, f \rangle|^2$
2. The orthonormal system $\mathcal{E} = \Set{x\mapsto e^{ikx}}_{k\in\Z}$ is complete, i.e. 
$$
	\lim_{n\to\infty} \left\lVert f - \sum_{k=-n}^n e^{ikx} \langle x\mapsto e^{ikx}, f \rangle \right\rVert = 0
$$
3. The orthonormal system $\mathcal{E}$ gives the inner product
$$
	\langle f, g \rangle = \sum_{k=-\infty}^\infty \langle f, x\mapsto e^{ikx} \rangle \langle x\mapsto e^{ikx}, g \rangle
$$
4. The orthonormal system $\mathcal{E}$ is total such that $\operatorname{span}(\mathcal{E})$ is dense in $L_{2\pi}^2 (\R, \mathbb{F})$. Equivalently,
$$
\begin{gather*}
	\forall f\in L_{2\pi}^2 (\R,\mathbb{F}) \; \forall \epsilon > 0 \; \exists N\in\N, \; \lambda_1,\dots,\lambda_N \in \mathbb{F}: \\
	\left\lVert f - \sum_{k=-N}^N \lambda_k e^{ikx} \right\rVert < \epsilon
\end{gather*}
$$

Equivalently, we can state $(3)$ as

$$
	\sum_{k=-\infty}^\infty \ket{x\mapsto e^{ikx}}\bra{x\mapsto e^{ikx}} = \mathbf{1}
$$

<details>
<summary>Proof</summary>

We want to express to inner product of $f,g\in L_{2\pi}^2 (\R,\mathbb{F})$ in terms of Fourier coefficients. By Parseval's identity (Proposition $\ref{proposition-2}$) we can write

$$
\begin{align*}
	f =& \mathcal{F}_n (f) + r_n\; \lim_{n\to\infty} \lVert r_n \rVert = 0 \\
	g =& \mathcal{F}_n (g) + \tilde{r}_n\; \lim_{n\to\infty} \lVert \tilde{r}_n \rVert = 0 \\
\end{align*}
$$

By the Cauchy-Schwarz and Bessel inequalities, we have

$$
	|\langle \mathcal{F}_n (g), r_n \rangle| \leq \lVert \mathcal{F}_n (g) \rVert \cdot \lVert r_n \rVert\leq\lVert g \rVert\cdot\lVert r_n \rVert \xrightarrow{n\to\infty} 0
$$

Thus, we can write the inner product of $f$ and $g$ as

$$
\begin{align*}
	\langle f, g \rangle =& \langle \mathcal{F}_n (f) + r_n, \mathcal{F}_n (g) + \tilde{r}_n \rangle \\
	=& \langle \mathcal{F}_n (f), \mathcal{F}_n (g) \rangle + \langle r_n, \mathcal{F}_n (g) \rangle + \langle \mathcal{F}_n (f), \tilde{r}_n \rangle + \langle r_n, \tilde{r}_n \rangle \tag{\label{equation-1}}
\end{align*}
$$

The first term can be expressed as

$$
\begin{align*}
	\langle \mathcal{F}_n (f), \mathcal{F}_n (g) \rangle =& \left\langle \sum_{k=-n}^n e^{ikx} \langle x\mapsto e^{ikx}, f \rangle, \sum_{\ell=-n}^n e^{i\ell x} \langle x\mapsto e^{i\ell x}, g \rangle \right\rangle \\
	=& \sum_{k=-n}^n \sum_{\ell=-n}^n \overline{\langle x\mapsto e^{ikx}, f \rangle} \langle x\mapsto e^{i\ell x} \underbrace{\langle x\mapsto e^{ikx}, x\mapsto e^{i\ell x}}_{=\delta_{k\ell}} \\
	=& \sum_{k=-n}^n \langle f, x\mapsto e^{ikx}\rangle \langle x\mapsto e^{ikx}, g
\end{align*}
$$

Taking the limit $n\to\infty$, the residual terms of $\eqref{equation-1}$ vanish, such that we obtain

$$
	\langle f, g \rangle = \langle \mathcal{F}_n (f) + r_n, \mathcal{F}_n (g) + \tilde{r}_n \rangle \xrightarrow{n\to\infty} \sum_{k=-\infty}^\infty \langle f, x\mapsto e^{ikx}\rangle \langle x\mapsto e^{ikx}, g \rangle
$$
</details>
</MathBox>

## Parseval's identity

<MathBox title="Parseval's identity for simple step functions" boxType='lemma' tag='lemma-3'>
Parseval's identity holds for simple step functions $h_a \in L_{2\pi}^2 (\R,\R)$ defined by

$$
	h_a (x) = \begin{cases}
		1,\quad& x\in[-\pi, a] \\
		0,\quad& x\in(a, \pi)
	\end{cases},\; a\in [-\pi, \pi]
$$

<details>
<summary>Proof</summary>

The Fourier coefficients for $h_a$ is given by

$$
\begin{align*}
	c_k =& \langle x\mapsto e^{ikx}, h_a \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi e^{-ikx} h_a \;\d x = \frac{1}{2\pi} \int_{-\pi}^a e^{-ikx} \;\d x \\
	=& \begin{cases}
		\frac{a + \pi}{2\pi},\quad& k = 0 \\
		\frac{1}{2\pi(-ik)} (e^{-ika} - e^{ik\pi}),\quad& k \neq 0
	\end{cases}
\end{align*}
$$

Taking the square modulus of $c_k$ for $k\neq 0$ yields

$$
\begin{align*}
	|c_k|^2 =& \frac{1}{2\pi (-ik)} (e^{-ika} - e^{ik\pi}) \overline{\frac{1}{2\pi(-ik)} (e^{-ika} - e^{ik\pi})} \\
	=& \frac{1}{4\pi^2 k^2} (e^{-ika} - e^{ik\pi})(e^{ika} - e^{-ik\pi}) \\
	=& \frac{1}{4\pi^2 k^2} (1 - e^{ik(\pi + a)} - e^{-ik(\pi + a)} + 1) \\
	=& \frac{1}{4\pi^2 k^2} (2 - 2\cos[k(\pi + a)]) \\
	=& \frac{1}{2\pi^2 k^2} (1 - \cos[k(\pi + a)])
\end{align*}
$$

Summing over $k = -n,\dots,0,\dots,n$ gives

$$
\begin{align*}
	\sum_{k=-n}^n |c_k|^2 =& \left(\frac{a + \pi}{2\pi}\right)^2 + \frac{1}{2\pi^2} \sum_{\substack{k=-n \\ k\neq 0}}^n \left(\frac{1}{k^2} - \frac{\cos[k(\pi + a)]}{k^2} \right) \\
	=& \left(\frac{a + \pi}{2\pi}\right)^2 + \frac{1}{2\pi} \left(\sum_{k=1}^n \frac{1}{k^2} - \sum_{k=1}^n \frac{\cos[k(\pi + a)]}{k^2} \right)
\end{align*}
$$

Applying Proposition $\ref{proposition-3}$, i.e.

$$
	\sum_{k=1}^\infty \frac{\cos(kx)}{k^2} = \frac{(x - \pi)^2}{4} - \frac{\pi^2}{12},\; x\in[0,2\pi]
$$

we get 

$$
\begin{gather*}
	\sum_{k=1}^\infty \frac{1}{k^2} = \frac{\pi^2}{6} \\
	\sum_{k=1}^\infty \frac{\cos[k(\pi + a)]}{k^2} = \frac{a^2}{4} - \frac{\pi^2}{12}
\end{gather*}
$$

Taking the limit $n\to\infty$, we obtain

$$
\begin{align*}
	\sum_{k=-\infty}^\infty |c_k|^2 =& \left(\frac{a + \pi}{2\pi} \right)^2 + \frac{1}{\pi^2}\left(\frac{\pi^2}{6} - \frac{a^2}{4} + \frac{\pi^2}{12} \right) \\
	=& \left(\frac{a + \pi}{2\pi}\right)^2 + \frac{1}{4} - \frac{a^2}{4\pi} = \frac{2a\pi + \pi^2}{4\pi^2} + \frac{1}{4} \\
	=& \frac{a}{2\pi} + \frac{1}{2} = \frac{1}{2\pi}(a + \pi) = \frac{1}{2\pi} \int_{-\pi}^a 1 \;\d x \\
	=& \langle h_a, h_a \rangle = \lVert h_a \rVert^2
\end{align*}
$$

proving Parseval's identity for $h_a$.
</details>
</MathBox>

<MathBox title="Parseval's identity for simple functions" boxType='proposition'>
Parseval's identity holds for the set of $2\pi$-periodic simple functions $\mathcal{S}_{2\pi} (\R,\mathbb{C}) \subseteq L_{2\pi}^2 (\R,\mathbb{C})$ defined as

$$
	\mathcal{S}_{2\pi} (\R,\mathbb{C}) := \Set{g\in\mathcal{F}_{2\pi}| \exists m\in\N, a_i \in[-\pi,\pi], \lambda_i\in\mathbb{C}: g = \sum_{i=1}^m \lambda_i h_{a_i}}
$$

where $h_a \in L_{2\pi}^2 (\R,\R)$ is a simple step function defined by

$$
	h_a (x) = \begin{cases}
		1,\quad& x\in[-\pi, a] \\
		0,\quad& x\in(a, \pi)
	\end{cases},\; a\in [-\pi, \pi]
$$

<details>
<summary>Proof</summary>

The Fourier coefficients for $g$ are given by 

$$
	c_k = \langle x\mapsto e^{ikx}, g \rangle = \left\langle x\mapsto e^{ikx}, \sum_{i=1}^m \lambda_i h_{a_i} \right\rangle = \sum_{i=1}^m \lambda_i \langle x\mapsto e^{ikx}, h_{a_i} \rangle
$$

Taking the square modulus of $c_k$ gives

$$
\begin{align*}
	|c_k|^2 =& \overline{c_k} c_k = \sum_{j=1}^m \overline{\lambda_j \langle x\mapsto e^{ikx}, h_{a_j}\rangle} \sum_{l=1}^m \lambda_i \langle x\mapsto e^{ikx}, h_{a_l} \rangle \\
	=& \sum_{j=1}^m \sum_{l=1}^m \overline{\lambda_j} \lambda_l \langle h_{a_j}, x\mapsto e^{ikx} \rangle \langle x\mapsto e^{ikx}, h_{a_l} \rangle
\end{align*}
$$

Summing over $k = -n,\dots,0,\dots,n$ gives

$$
	\sum_{k=-n}^n |c_k|^2 = \sum_{i,l=1}^m \overline{\lambda_j} \lambda_l \left(\langle h_{a_j}, x\mapsto e^{ikx} \rangle \langle x\mapsto e^{ikx}, h_{a_l} \right)
$$

By Proposition $\ref{proposition-6}$, we have $\sum_{k=-\infty}^\infty \ket{x\mapsto e^{ikx}}\bra{x\mapsto e^{ikx}} = \mathbf{1}$.From Lemma $\ref{lemma-3}$, we know that Parseval's identity holds for each $h_{a_i}$. Thus, in the limit $n\to\infty$ we obtain

$$
\begin{align*}
	\sum_{k=-\infty}^\infty |c_k|^2 =& \sum_{i,l=1}^m \overline{\lambda_j} \lambda_l \left(\langle h_{a_j}, x\mapsto e^{ikx} \rangle \langle x\mapsto e^{ikx}, h_{a_l} \right) \\
	=& \sum_{i,l=1}^m \overline{\lambda_j} \lambda_l \langle h_{a_j}, h_{a_l} \rangle \\
	=& \left\langle \sum_{j=1}^m \lambda_j h_{a_j}, \sum_{l=1}^m \lambda_l h_{a_l} \right\rangle \\
	=& \langle g, g \rangle = \lVert g \rVert^2
\end{align*}
$$
</details>
</MathBox>

<MathBox title="Square integrable simple periodic functions are dense" boxType='proposition' tag='proposition-4'>
The set of simple $2\pi$-periodic functions $\mathcal{S}_{2\pi} (\R,\mathbb{C})$ is dense in $L_{2\pi} (\R, \mathbb{C})$. That is, for $f\in\mathcal{S}_{2\pi} (\R,\mathbb{C})$ and $\epsilon > 0$, there is a $2\pi$-periodic simple function $g:\R\mathbb{C}$ with $\lVert f - g \rVert < \epsilon$.

<details>
<summary>Proof</summary>

Let $\epsilon > 0$ and suppose $f:[-\pi,\pi]\to\mathbb{C}$ is square integrable. Then there is a continuous function $g:[-\pi,\pi]$ with $\lVert f - g \rVert < \epsilon$. Since the domain $[-\pi,\pi]$ is compact, if follows that $g$ is uniformly continuous. Thus, for $\epsilon > 0$, there is $\delta > 0$ such that

$$
	|x - y| \implies |g(x) - g(y)| < \epsilon
$$

Next, we decompose $[-\pi,\pi]$ into $N\in\N$ open intervals $I_j$ with $\operatorname{length}(I_j) < \delta$. Taking the supremum for each interval $I_j$, i.e. $c_j := \sup\set{g(x)|x\in I_j}$, we can define a simple step function $h(x) = c_j$ for $x\in I_j$. It follows that for $x\in I_j$

$$
	|g(x) - h(x)| = |g(x) - g(y)| < \epsilon ,\; y\in \overline{I}_j
$$

because $|x - y| < \delta$. In total we have

$$
	\lVert f - h \rVert \leq \lVert f - g \rVert + \lVert g - h \rVert = \underbrace{\lVert f - g \rVert}_{<\epsilon} + \left(\int_{-\pi}^\pi \smash[b]{\underbrace{|g(x) - h(x)|^2}_{<\epsilon}} \;\d x \right)^{1/2} < C\epsilon
$$

where $C\in\R$ is a constant.
</details>
</MathBox>

<MathBox title="Parseval's identity" boxType='theorem'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{C})$ have complex Fourier series 

$$
	\mathcal{F}_n (f) = \sum_{k=-n}^n \langle x\mapsto e^{ikx}, f\rangle e^{ikx} = \sum_{k=-n}^n c_k e^{ikx}
$$

with respect to the inner product

$$
	\langle f, g \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{f(x)} g(x) \;\d x,\; f,g\in f,g\in L_{2\pi}^2 (\R,\mathbb{C})
$$

Then

$$
	\lim_{n\to\infty} \lVert f - \mathcal{F}_n (f) \rVert_2 = 0
$$

<details>
<summary>Proof</summary>

Let $\epsilon > 0$ and choose $h \in\mathcal{S}_{2\pi} (\R,\mathbb{C})$ with $\lVert f - h \rVert < \epsilon$. Applying the triangle inequality and Proposition $\ref{proposition-4}$ we get

$$
\begin{align*}
	\lVert f - \mathbb{F}_n (f) \rVert =& \lVert f + h - h - \mathcal{F}_n (f) + \mathcal{F}_n (h) - \mathcal{F}_n (h) \rVert \\
	\tleq& \lVert (f - h) - \mathcal{F}_n (f - h) \rVert + \underbrace{\lVert h - \mathcal{F}_n (h) \rVert}_{\xrightarrow{n\to\infty 0}} 
\end{align*}
$$

Note that $\mathcal{F}_n (f - h)$ is the orthogonal projection of $(f - h)$ onto $\operatorname{span}(\set{x\mapsto e^{ikx}}_{k\in\Z})$. The Pythagorean theorem implies that

$$
	\lVert (f - h) - \mathcal{F}_n (f - h) \rVert^2 = \lVert \mathcal{F}_n (f - h)\rVert^2 + \lVert f - h \rVert^2
$$

from which it follows that

$$
	\lVert (f - h) - \mathcal{F}_n (f - h) \rVert \leq \lVert f - h \rVer < \epsilon
$$

Hence, by the sandwhich theorem it follows that

$$
	\lim_{n\to\infty} \lVert f - \mathcal{F}_n (f) \rVert = 0
$$
</details>
</MathBox>

# Fourier transform

The Fourier transform integral is the limit of Fourier series as the periodicity goes to infinity. Consider a Fourier series of a function $f \in L^2\left([-L/2, L/2] \right)$

$$
\begin{gather*}
	f(x) = \sum_{n=-\infty}^\infty c_n e^{\frac{i2\pi n x}{L}} \\
	c_n = \frac{1}{L}\langle f(x), e_n \rangle = \frac{1}{L}\int_{-L/2}^{L/2} f(x)e^{-\frac{i2\pi n x}{L}}\;\d x
\end{gather*}
$$

Defining $\xi = \frac{n}{L}$ and $\Delta\xi = \frac{1}{L}$. Taking the limit $L\to\infty \iff \Delta\xi\to 0$ we get

$$
\begin{align*}
	f(x) =& \lim_{\Delta\xi \to 0} \sum_{n=-\infty}^\infty \Delta\xi \int_{-\frac{1}{2\xi}}^{\frac{1}{2\xi}} f(\xi) e^{-i2\pi \xi x}\;\d\xi e^{i2\pi n \Delta\xi x} \\
	=& \lim_{\Delta\xi\to 0}\sum_{n=-\infty}^\infty \Delta\xi \langle f(x), e^{i2\pi \xi x} \rangle e^{i 2\pi n \Delta\xi x}
\end{align*}
$$

Defining $\omega = \frac{n\pi}{L}$ and $\Delta\omega = \frac{\pi}{L}$. Taking the limit $L\to\infty$ or $\Delta\omega\to 0$ we get

$$
\begin{align*}
	f(x) =& \lim_{\Delta\omega\to 0} \sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi} \int_{-\frac{\pi}{\Delta\omega}}^{\frac{\pi}{\Delta\omega}} f(\xi) e^{-i\omega\xi}\;\d\xi e^{in\Delta\omega x} \\
	=& \lim_{\Delta\omega\to 0}\sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi}\langle f(x), e_i\omega x \rangle e^{in\Delta\omega x}
\end{align*}
$$

In this limit, the summation with weight $\Delta\xi$ becomes a Riemann integral. The Fourier transform of $f$, denoted $\mathcal{F}\left[ f(x) \right] = \hat{f}(\omega)$ is defined as the inner product $\langle f(x), e^{i2\pi\xi x}\rangle$ resulting in

$$
\begin{align*}
	f(x) &= \mathcal{F}^{-1}\left[ \hat{f}(\xi) \right] = \int_{-\infty}^\infty \hat{f}(\xi) e^{i2\pi\xi x}\;\d\xi \\
	\hat{f}(\xi) &= \mathcal{F}\left[ f(x) \right] = \int_{-\infty}^\infty f(x) e^{-i2\pi\xi x}\;\d x
\end{align*}
$$

Both integrals converge as long as $f$ and $\hat{f}$ are integrable, i.e. $f, \hat{f}\in L^1 (-\infty, \infty)$. When the independent variable $x$ represents time, denoted $t\in\R$, the transform variable $\xi$ represents frequency, denoted $f\in\R$. In terms of angular frequency $\omega = 2\pi f$, the Fourier transform takes the form

$$
	\hat{f}(\omega) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty} f(t) e^{-i \omega t}\;\d x \quad \forall \omega\in\R
$$

## Properties

<MathBox title='Linearity of Fourier transforms' boxType='proposition'>
The Fourier transform is a linear operator, so that for $f, g\in L^1 (\R^n, \mathbb{C})$ and $\alpha, \beta\in\mathbb{C}$, we have

$$
\begin{gather*}
	\mathcal{F}\left[\alpha f(x) + \beta g(x) \right] = \alpha\mathcal{F}\left[ f(x) \right] + \beta\mathcal{F}\left[ g(x) \right] \\
	\mathcal{F}^{-1}\left[\alpha \hat{f}(x) + \beta \hat{g}(x) \right] = \alpha\mathcal{F}^{-1}\left[ \hat{f}(x) \right] + \beta\mathcal{F}^{-1}\left[ \hat{g}(x) \right] \\
\end{gather*}
$$
</MathBox>

<MathBox title='Shifting property' boxType='proposition'>
Let $f, \hat{f} \in L^1\left(\R\right)$ be integrable functions. The Fourier transform of a translation in $f$ is given by

$$
	\mathcal{F}\left[ f(x - x_0) \right] = e^{-i2\pi x_0 \xi}\hat{f}(\xi)
$$

The inverse Fourier transform of a modulation in $\hat{f}$ is given by

$$
	\mathcal{F}^{-1}\left[ \hat{f}(\xi - \xi_0) \right] = f(x)e^{-i2\pi\xi_0 x}
$$
</MathBox>

<MathBox title='Fourier transform of derivatives' boxType='proposition'>
Let $f:\R\to\mathbb{C}$ be an absolutely continuous differentiable function, and suppose $f, f' \in L^1(\R)$ are integrable. The Fourier transform of the derivative $f'$ is given by

$$
	\hat{f}'(\xi) = \mathcal{F}\left[ \frac{\d}{\d x} f(x) \right] = i2\pi\xi \hat{f}(\xi)
$$

The Fourier transform for the $n$th derivative $f^{(n)}$ is given by

$$
	\hat{f}^{(n)}(\xi) = \mathcal{F}\left[ \frac{\d^n}{\d x^n} f(x) \right] = (i2\pi\xi)^n \hat{f}(\xi)
$$

<details>
<summary>Proof</summary>

Integrating by parts gives

$$
\begin{align*}
	\mathcal{F}\left[ \frac{\d}{\d x} f(x) \right] &= \int_{-\infty}^\infty \overbrace{f'(x)}^{\d v}e^{-i2\pi\xi x}\;\d x \\
	&= \underbrace{f(x)e^{-i2\pi\xi x}}_{uv}|_{-\infty}^\infty - \int_{-\infty}^\infty \underbrace{f(x)}_{u} \left(-i2\pi\xi e^{-i2\pi\xi x}\right)\;\d x \\
	&= i2\pi\xi \int_{-\infty}^\infty f(x)e^{-i2\pi\xi x}\;\d x \\
	&= i2\pi\xi\mathcal{F}\left[ f(x) \right]
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Convolution theorem' boxType='theorem'>
Let $f, g \in L^1(\R)$ be integrable functions. The Fourier transform of the convolution

$$
	h(x) := (f*g)(x) = \int_{-\infty}^\infty f(y)g(x - y)\;\d y
$$

is given by

$$
	\hat{h}'(\xi) = \hat{f}(\xi)\cdot\hat{g}(\xi)
$$

<details>
<summary>Proof</summary>

Taking the inverse Fourier transform of the product of $\hat{f}$ and $\hat{g}$ gives

$$
\begin{align*}
	\mathcal{F}\left[ \hat{f}(\xi) \hat{g}(\xi) \right] &= \int_{-\infty}^\infty \hat{f}(\xi)\hat{g}(\xi)e^{i2\pi\xi x}\;\d\xi \\
	&= \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi x}\left[ \int_{-\infty}^\infty g(y) e^{-i2\pi\xi y}\;\d y \right]\;\d\xi \\
	&= \int_{-\infty}^\infty g(y)\hat{f}(\xi) e^{i2\pi\xi(x - y)}\;\d\xi\d y \\
	&= \int_{-\infty}^\infty g(y) \underbrace_{\left[ \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi(x - y)}\;\d\xi \right]}_{f(x - y)}\;\d y \\
	&= \int_{-\infty}^\infty g(y)f(x - y)\;\d y \\
	&= g*f = f*g
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Parseval-Plancherel theorem' boxType='theorem'>
Let $f, g \in L^1(\R)\cap L^2(\R)$, then the following identity holds (Parseval's theorem)

$$
	\langle f, g \rangle = \int_{-\infty}^\infty f(x)\overline{g(x)}\;\d x = \int_{-\infty}^\infty \hat{f}(\xi)\overline{\hat{g}(\xi)}\;\d x
$$

In the special case $g = f$, this identity reduces to (Plancherel's theorem)

$$
	\lVert f\rVert_{L^2}^2 = \int_{-\infty}^\infty |f(x)|^2\;\d x = \int_{-\infty}^\infty \left|\hat{f}(\xi)\right|^2\;\d\xi
$$
</MathBox>

## Uncertainty principle

<MathBox title='Schwartz space' boxType='definition'>
The Schwartz space on $\R^n$ is the space of all smooth functions whose derivatives are rapidly decreasing

$$
\begin{align*}
	\mathcal{S}\left(\R^n, \mathbb{C}\right) &:= \Set{ f\in C^\infty (\R^n, \mathbb{C}) | \forall \alpha, \beta \in \N^n \;: \lVert f\rVert_{\alpha, \beta} < \infty } \subset L^1\left(\R^n, \mathbb{C}\right) \\
	\lVert f\rVert_{\alpha, \beta} &:= \sup_{\mathbf{x}\in\R^n} \left| \mathbf{x}^\alpha \left(D^\beta f \right)(\mathbf{x}) \right|
\end{align*}
$$

The Fourier transform defines an automorphism on Schwartz spaces, i.e. $f\in\mathcal{S}\left(\R^n, \mathbb{C}\right) \implies \hat{f}\in \mathcal{S}\left(\R^n, \mathbb{C}\right)$
</MathBox>

<MathBox title='Uncertainty principle' boxType='theorem'>
For any Schwartz function $f\in\mathcal{S}(\R)$ and any $x_0, \xi_0 \in\R$, the following inequality holds

$$
	\lVert f(x)\rVert_{L^2} \leq 4\pi \left\| (x - x_0) f(x) \right\|_{L^2}\cdot\left\| (\xi - \xi_0) \hat{f}(x) \right\|_{L^2}
$$

If $f$ is normalized, i.e. $\lVert f(x)\rVert_{L^2} = 1$, then the inequality can be written

$$
	\left\| (x - x_0) f(x) \right\|_{L^2}^2 \cdot\left\| (\xi - \xi_0) \hat{f}(x) \right\|_{L^2}^2 \geq \frac{1}{16\pi^2}
$$

<details>
<summary>Proof</summary>

Applying integration by parts on $\lVert f\rVert_{L^2}^2$ gives

$$
\begin{align*}
	\lVert f\rVert_{L^2}^2 &= \int_{-\infty}^\infty |f(x)|^2\;\d x = \int_{-\infty}^\infty f(x)\overline{f(x)}\;\d x \\
	&= \left. x|f(x)|^2 \right|_{-\infty}^\infty - \int_{-\infty}^\infty x\left[ f'(x)\overline{f(x)} + f(x)\overline{f'(x)} \right]\;\d x \\
	&= - 2\int_{-\infty}^\infty x\Re\left[ f'(x)\overline{f'(x)} \right]\;\d x \\
	&\leq 2 \lVert x f(x)\rVert_{L_2} \cdot \left\| f'(x) \right\|_{L_2}
\end{align*}
$$

Where we have used that $\lim_{|x|\to\infty} \left| xf(x)^2 \right| = 0$ since $f$ is Schwartz, and the Cauchy-Schwartz inequality. Using Plancherel's identity and the Fourier transform derivation rule give

$$
	\left\| \overline{f'(x)} \right\|_{L_2} = \left\| f'(x) \right\|_{L_2} = \left\| \hat{f}'(\xi) \right\|_{L_2} = \left\| (i2\pi\xi)\hat{f}(\xi) \right\|_{L_2} = 2\pi\left\| \xi\hat{f}(\xi) \right\|_{L_2}
$$

Combining the results gives a special case of the uncertainty principle

$$
	\lVert f\rVert_{L^2}^2 \leq 4\pi \lVert x f(x)\rVert_{L^2} \cdot \left\| \xi \hat{f}(\xi) \right\|_{L^2}
$$

To prove the uncertainty principly in its full generality, we define the function

$$
	g(x) = e^{-i2\pi\xi_0 x} f(x + x_0) \;\textrm{ so that }\; \hat{g}(x) = e^{i2\pi x_0 \xi} \hat{f}(\xi + \xi_0)
$$

For this function $g$, we have

$$
\begin{align*}
	\lVert g\rVert_{L^2}^2 &= \int_{-\infty}^\infty \left| e^{-i2\pi\xi_0 x} f(x + x_0) \right|^2 \;\d x = \int_{-\infty}^\infty \left| f(t) \right|^2 \;\d t = \lVert f\rVert_{L^2}^2 \\
	\lVert u g(u)\rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| u e^{-i2\pi\xi_0 u} f(u + x_0) \right|^2 \;\d u \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| (x - x_0) f(x) \right|^2 \;\d x \right)^{1/2} = \lVert (x - x_0)f(x)\rVert_{L^2} \\
	\lVert t\hat{g}(t)\rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| t e^{i2\pi x_0 t} \hat{f}(t + \xi_0) \right|^2 \;\d t \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| \left(\xi - \xi_0 \right) \hat{f}(\xi_0) \right|^2 \;\d\xi \right)^{1/2} = \left\| \left(\xi - \xi_0\right) \hat{f}(\xi) \right\|_{L^2}
\end{align*}
$$

Substituting $g$ into the specialized uncertainty inequality above yields the desired result.
</details>
</MathBox>

The equality holds in the uncertainty principle if we get an equality when applying the Cauchy-Schwartz inequality. This implies we must have $f'(x) = \lambda xf(x)$ for some scalar $\lambda$. This differential equation has the general solution

$$
	f(x) = \alpha e^{-\frac{\lambda}{2} x^2} \quad \lambda > 0,\; |\alpha|^2 = \sqrt\frac{\lambda}{\pi}\lVert f\rVert_{L^2}^2
$$

# Discrete Fourier transform

<MathBox title='Discrete Fourier transform (DFT)' boxType='definition'>
The discrete Fourier transform of a complex sequence $\Set{ f_n }_{n=0}^N \subseteq\mathbb{C}$ produces a complex sequence $\Set{ F_k }_{k=0}^{N-1}$ where

$$
	\mathcal{F}\Set{ f_k } = F_k = \sum_{n=0}^{N-1} x_n \cdot e^{-\frac{i2\pi}{N}kn}
$$

The inverse transform is defined by

$$
	f_n = \frac{1}{N} \sum_{n=0}^{N-1} X_k \cdot e^{\frac{i2\pi}{N}kn}
$$
</MathBox>

## Fast Fourier transform


# Short-time Fourier transform

<MathBox title='Short-time Fourier transform (STFT)' boxType='definition'>
The short-time Fourier transform of an integrable function $f:\R\to\mathbb{C}$ is defined by

$$
	\mathcal{F}\left[ f(\tau) \right] = \hat{f}_g(t, \omega) = \int_{-\infty}^\infty f(\tau) \overline{g(\tau - t)} e^{-i \omega x}\;\d\tau = \langle f(\tau), g_{t,\omega}(\tau) \rangle 
$$

where $g_{t, \omega}(\tau) = e^{i\omega t}g(\tau - t)$ and $g(t)$ is the kernel (window). The Gabor transform is a special case of the STFT with a Gaussian kernel of the form

$$
	g(t) = e^{-\frac{(t - \tau)^2}{a^2}}
$$

The inverse STFT transform is given by

$$
	f(t) = \mathcal{F}^{-1}\left[ \hat{f}_g (t, \omega) \right] = \frac{1}{2\pi\| g\|^2} \int_{-\infty}^\infty\int_{-\infty}^\infty \hat{f}_g (\tau, \omega)g(t - \tau)e^{i\omega t}\;\d\omega \d t
$$
</MathBox>

## Discrete

The discrete version of the STFT can be formed by discretizing time and frequency

$$
	\tau = j\Delta t \quad \nu = k \Delta\omega \quad j, k \in\N
$$

The discretized kernel function becomes

$$
	g_{j, k} = e^{i2\pi k\Delta\omega t} g(t - k\Delta t)
$$

and the discrete STFT is

$$
	\hat{f}_{j, k} = \langle f, g_{j,k}\rangle = \int_{-\infty}^\infty f(\tau)\overline{g_{j, k}(\tau)}\;\d\tau
$$

# Wavelet transform

Wavelets extend the concepts in Fourier analysis to more general orthogonal bases, and partially overcome the uncertainty principle by exploiting multi-resolution decomposition. This multi-resolution approach enables different time and frequency fidelities in different frequency bands.

<MathBox title='Wavelet' boxType='definition'>

A function $\psi\in L^2(\R)$ is called an orthonormal wavelet if it generates a basis for $L^2(\R)$. The basis is constructed as a family of functions by means of translations and dilations of $\psi$

$$
	\Set{\psi_{a,b}(t) = \frac{1}{\sqrt{a}}\left( \frac{t - b}{a} \right) | b \in\R,\; a\R^+ }
$$

In terms of dyadic translations and dilations with $a = 2^{-j}$ and $b = k2^{-j}$ for $j, k \in \Z$, we get

$$
	\langle \psi_{jk}, \psi_{lm} \rangle = \int_{-\infty}^\infty \psi_{jk}(x)\overline{\psi_{lm}(x)}\;\d x = \delta_{jl}\delta_{km}
$$
</MathBox>

<MathBox title='Wavelet transform' boxType='definition'>
Suppose $\psi\in L^2 (\R)$ is an orthonormal wavelet satisfying the boundedness property

$$
	C_\psi = \int_{-\infty}^\infty \frac{\left| \hat{\psi}(\omega) \right|^2}{|\omega |}\d\omega < \omega
$$

The wavelet transform of a function $f\in L^1(\R$ is defined as

$$
	\mathcal{W}_\psi \left[ f(t) \right](a, b) = \langle f, \psi_{a, b} \rangle = \int_{-\infty}^\infty f(t)\overline{\psi_{a,b}(t)}\;\d t = \frac{1}{\sqrt{|a|}}\int_{-\infty}^\infty f(t)\overline{\psi\left(\frac{t - b}{a}\right)}\;\d t
$$

The inverse wavelet transform is

$$
	f(t) = \frac{1}{C_\psi} \int_0^\infty \int_{-\infty}^\infty \mathcal{W}_\psi [f](a, b) \psi_{a, b}(t)\frac{1}{a^2}\;\d a\d b
$$

Every function $f\in L^2(\R)$ may be expanded in the wavelet basis as (using dyadic translations and dialtions)

$$
	f(t) = \sum_{j=-\infty}^\infty \sum_{k=-\infty}^\infty \psi_{jk}(t)
$$

where the wavelet coefficients $c_{jk}$ are given by

$$
	c_{jk} = \langle f(t), \psi_{j, k} \rangle = \mathcal{W}_\psi[f(t)]\left(2^{-j}, k2^{-j} \right)
$$
</MathBox>

## Haar wavelet

$$
	\psi(t) = \begin{cases} 
		1 &\quad 0\leq t < \frac{1}{2} \\
		-1 &\quad \frac{1}{2}\leq t < 1 \\
		0 &\quad \textrm{otherwise}
	\end{cases}
$$

## Mexican hat wavelet

$$
\begin{align*}
	\psi(t) &= (1 - t^2)e^{-\frac{t^2}{2}} \\
	\hat{\psi(\omega)} &= \sqrt{2\pi}\omega^2 e^{-\frac{\omega^2}{2}}
\end{align*}
$$