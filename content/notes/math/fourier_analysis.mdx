---
title: 'Fourier Analysis'
subject: 'Mathematics'
showToc: true
---

# Trigonometric polynomials

<MathBox title='Periodic function' boxType='definition'>
Let $k\in\R$. A function $f:\R\to\mathbb{F}$ is $k$-periodic if $f(x + k) = x$ for all $x\in\R$. The set of all $k$-period real functions is denoted

$$
	\mathcal{F}_k (\R,\R) = \Set{f:\R\to\mathbb{F} | f(x + k) = f(x)\; \forall x\in\R}
$$
</MathBox>

<MathBox title='' boxType='proposition'>
The set of $2\pi$-periodic functions $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ given by

$$
	\mathcal{U} := \set{x\mapsto\sin(nx)}_{n\in\N_+} \cup \set{x\mapsto\cos(nx)}_{n\in\N}
$$

is linearly independent. The space spanned by $\mathcal{U}$ is denoted $P_{2\pi} := \operatorname{span}(\mathcal{U})$.
</MathBox>

<MathBox title='Trigonometric polynomial' boxType='definition'>
Let $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ be given by

$$
	\mathcal{U} := \set{x\mapsto\sin(nx)}_{n\in\N_+} \cup \set{x\mapsto\cos(nx)}_{n\in\N}
$$

A linear combination of $f\in\operatorname{span}(\mathcal{U})$ for $f:\R\to\R$ is called a (real) trigonometric polynomial and takes the form

$$
	f(x) = a_0 + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \cos(kx),\; a_i, b_i \in\R
$$

If $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\mathbb{C})$, the linear combination is called a complex trigonometric polynomial and takes the form

$$
	f(x) = \sum_{k=-n}^n c_k e^{ikx},\; c_k \in \mathbb{C}
$$
</MathBox>

<MathBox title='Trigonometric basis is orthogonal' boxType='proposition'>
Let $\mathcal{F}_{2\pi} (\R,\R)$ be equipped with the inner product

$$
	\langle f, g\rangle := \frac{1}{2\pi} \int_{-\pi}^\pi f(x)g(x)\;\d x,\; f,g\in\mathcal{F}_{2\pi}
$$

The set of $2\pi$-periodic functions $\mathcal{U}\subseteq\mathcal{F}_{2\pi} (\R,\R)$ given by

$$
	\mathcal{U} := \set{x\mapsto\sin(nx)}_{n\in\N_+} \cup \set{x\mapsto\cos(nx)}_{n\in\N}
$$

forms an orthogonal basis.


<details>
<summary>Proof</summary>

We calculate the inner product for all possible combinations from $\mathcal{U}$. For $x\mapto 1$ we trivially have

$$
	\langle x\mapsto 1, x\mapsto 1 \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi 1\;\d x = 1
$$

Next

$$
	\langle x\mapsto 1, x\mapto\cos(nx) \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \cos(nx)\;\d x = \frac{1}{2\pi n} [\sin(n x)]_{-\pi}^\pi = 0
$$

Since $x\mapsto\cos(mx)\sin(nx)$ for $m,n\in\N$ is an odd function, it follows that

$$
\begin{align*}
	\langle x\mapto\cos(mx), x\mapsto\sin(nx) \rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \cos(mx)\sin(kx)\;\d x = 0
\end{align*}
$$

Noting that $\cos(x) = \frac{1}{2}(e^{ix} + e^{-ix})$, we get for $m\neq n$

$$
\begin{align*}
	\langle x\to\cos(mx), x\to\cos(nx)\rangle =& \frac{1}{8\pi} \int_{-\pi}^{\pi} e^{i(m+n)x} + e^{-i(m+n)x} + e^{i(m-n)x} + e^{-i(m-n)x}\;\d x \\
	=& \frac{1}{4\pi}\left[\frac{1}{m+n}\frac{1}{2i} (e^{i(m+n)x} + e^{-i(m+n)x}) +  \frac{1}{m-n}\frac{1}{2i}\left(e^{i(m-n)} + e^{-i(m-n)}\right) \right]_{-\pi}^{\pi} \\
	=& \frac{1}{4\pi} \left[\frac{1}{m+n} \sin[(m+n)x] + \frac{1}{m-n}\sin[(m-n)x] \right]_{-\pi}^\pi = 0
\end{align*}
$$

Similarly, we find

$$
	\langle x\to\sin(mx), x\to\sin(nx)\rangle = \int{-\pi}^\pi \sin(nx) \sin(mx)\;\d x = 0
$$

This shows that $\langle f,g\rangle = 0$ for $f,g\in\mathcal{U}$ with $f\neq g$.
</details>
</MathBox>

<MathBox title='Orthonormal trigonometric bases' boxType='proposition' tag='proposition-1'>
1. The basis $\mathcal{B}_1 = \set{x\mapsto\sqrt{2}\cos{nx}}_{n\in\N} \cup \set{x\mapsto\sqrt{2}\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_1 := \frac{1}{2\pi} \int_{-\pi}^\pi f(x)g(x)\;\d x
$$
2. The basis $\mathcal{B}_2 = \set{x\mapsto 1} \cup \set{x\mapsto\frac{1}{\sqrt{\pi}}\cos{nx}}_{n\in\N_+} \cup \set{x\mapsto\frac{1}{\sqrt{\pi}}\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_2 := \int_{-\pi}^\pi f(x)g(x)\;\d x
$$
3. The basis $\mathcal{B}_3 =  \set{x\mapsto 1/\sqrt{2}} \cup \set{x\mapsto\cos{nx}}_{n\in\N_+} \cup \set{x\mapsto\sin(nx)}_{n\in\N_+}$ is orthonormal with respect to the inner product
$$
	\langle f, g \rangle_3 := \frac{1}{\pi}\int_{-\pi}^\pi f(x)g(x)\;\d x
$$

<details>
<summary>Proof</summary>

We start by calculating $\lVert x\mapsto\sin(nx) \rVert^2 = \langle x\mapsto\sin(nx), x\mapsto\sin(nx) \rangle_1$. Using integration by parts we find

$$
\begin{align*}
	\int_{-\pi}^\pi \sin^2 (nx) \;\d x =& \int_{-\pi}^\pi \underbrace{\sin(nx)}_{u} \underbrace{\sin(nx)}_{v' } \\
	=& \underbrace{\left[\sin(nx)\left(-\frac{1}{n} \right)\cos(nx)\right]_{-\pi}^\pi}_{=0} - \int_{-\pi}^\pi n\cos(nx) \left(-\frac{1}{n}\right) \cos(nx) \;\d x \\
	=& \int_{-\pi}^\pi \cos^2 (nx)^2 \; \d x = \int_{-\pi}^\pi 1 - \sin^2 (nx) \;\d x
\end{align*}
$$

We can rewrite this as

$$
\begin{gather}
	2 \int_{-\pi}^\pi \sin^2 (nx) \;\d x = \int_{-\pi}^\pi 1 \;\d x = 2\pi \\
	\implies \int_{-\pi}^\pi \sin^2 (nx) \;\d x = \pi
	\implies \lVert x\mapsto\sin(nx) \rVert^2 = \frac{1}{2}
\end{gather}
$$

It follows that $\mathbf{x} \mapsto \sqrt{2}\sin(nx)$ has unit norm. A similar calculation shows that $\mathbf{x} \mapsto \sqrt{2}\cos(nx)$ has unit norm. Hence, $\mathcal{B}_1$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_1$.

Since $\int_{-\pi}^\pi \sin^2(nx) \;\d x = \int_{-\pi}^\pi \cos^2 (nx) \;\d x = \pi$ it follows that $\mathcal{B}_2$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_2$, and that $\mathcal{B}_3$ is orthonormal with respect to $\langle\cdot,\cdot\rangle_3$.
</details>
</MathBox>

## Integrable functions

<MathBox title='Integrable periodic function' boxType='definition'>
Let $k\in\R$. A $k$-period function $f\in \mathcal{F}_k (\R,\mathbb{F})$ is $n$-integrable if

$$
	\int_{-k/2}^{k/2} |f(x)|^n \;\d x < \infty
$$

The set of all integrable $k$-periodic functions is denoted

$$
	\mathcal{L}_k^n (\R,\R) = \Set{f\in\mathcal{F}_k (\R, \mathbb{F}) | \int_{-k/2}^{k/2} |f(x)|^n \;\d x < \infty}
$$

and forms a vector space, which is not a normed space. To form a normed space, we define the equivalence relation $f\sim g :\iff \lVert f-g\rVert_n = 0$ with respect to the norm

$$
	\lVert f \rVert_n := \left(\int_{-k/2}^{k/2} |f(x)|^n \;\d x\right)^{1/n}
$$

The quotient space $L_k^n (\R,\mathbb{C}) := \mathcal{L}_k^n (\R, \mathbb{F}) / \sim$ is a normed space with norm

$$
	\lVert [f] \rVert_n := \lVert f \rVert_n
$$

In particular, we have

$$
	L_{2\pi}^1 (\R, \mathbb{F}) \supset L_{2\pi}^1 (\R, \mathbb{F}) \supset\cdots\supset L_{2\pi}^\infty \supset \mathcal{P}_{2\pi} = \operatorname{span}(\set{x\mapsto\cos(mx)}_{m\in\N} \cup \set{x\mapsto\sin(mx)}_{m\in\N_+})
$$
</MathBox>

# Fourier series

Let $\mathcal{B}_n = \set{x \mapsto 1/\sqrt{2}} \cup \set{\cos(kx)}_{k=1}^n \cup \set{\sin(kx)}_{k=1}^n$ be a finite trigonometric basis for $n\in\N$. By Proposition $\ref{proposition-1}$, this is an orthonormal system in $L_{2\pi}^2 (\R,\mathbb{F})$ with respect to the inner product

$$
	\langle f, g\rangle = \frac{1}{\pi} \int_{-\pi}^\pi \overline{f(x)}g(x) \;\d x
$$

If $\mathcal{U}_n = \operatorname{span}(\mathcal{B}_n)$ is a finite-dimensional subspace defined by $\mathcal{B}_n$, the orthogonal projection of a square integrable $2\pi$-periodic function $f\in L_{2\pi}^2 (\R,\mathbb{F})$ onto $\mathcal{U}_n$ is given by

$$
	\mathcal{F}_n (f) = \frac{1}{\sqrt{2}}\langle x\mapsto \frac{1}{\sqrt{2}}, f \rangle \sum_{k=1}^n \cos(kx) \langle x\mapsto\cos(kx), f \rangle + \sum_{k=1}^n \sin(kx) \langle x\mapsto\sin(kx), f \rangle
$$

<MathBox title='Fourier series in $L^2$' boxType='definition'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{F})$ be a square integrable $2\pi$-periodic function. For any $n\in\N$ define

$$
	\mathcal{F}_n (f)(x) = \tilde{a}_0 \frac{1}{\sqrt{2}} + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \sin(kx)
$$

with

$$
\begin{align*}
	\tilde{a_0} =& \langle x\mapsto \frac{1}{\sqrt{2}}, f \rangle = \frac{1}{\pi} \int_{-\pi}^\pi \frac{1}{\sqrt{2}} f(x) \;\d x \\
	a_k =& \langle x\mapsto x\mapsto\cos(kx), f \rangle = \frac{1}{\pi} \int_{-\pi}^\pi \cos(kx) f(x) \;\d x \\
	b_k =& \langle x\mapsto x\mapsto\sin(kx), f \rangle = \frac{1}{\pi} \int_{-\pi}^\pi \sin(kx) f(x) \;\d x
\end{align*}
$$

The map $n\mapsto \mathcal{F}_n (f)(x)$ is the Fourier series of $f$
</MathBox>

Fourier series can also be expressed in terms of trigonometric exponential functions. If $\mathcal{B}_n = \set{x \mapsto 1/\sqrt{2}} \cup \set{\cos(kx)}_{k=1}^n \cup \set{\sin(kx)}_{k=1}^n$ and $\mathcal{E}_n = \set{x\mapsto e^{ikx}}_{k=-n}^n$ for $n\in\N$, then

$$
	\operatorname{span}(\mathcal{B}_n) = \operatorname{span}(\mathcal{E}_n)
$$

and

$$
	\tilde{a}_0 \frac{1}{\sqrt{2}} + \sum_{k=1}^n a_k \cos(kx) + \sum_{k=1}^n b_k \sin(kx) = \sum_{k=-n}^n c_k e^{ikx}
$$

with

$$
	c_k = \begin{cases}
		\frac{1}{2} \left(a_k + \frac{b_k}{i} \right), \quad& k > 0 \\
		\tilde{a_0} \frac{1}{\sqrt{2}}, \quad& k = 0 \\
		\frac{1}{2} \left(a_{-k} - \frac{b_{-k}}{i} \right), \quad& k < 0
	\end{cases}
$$

If $\mathcal{U}_n = \operatorname{span}(\mathcal{E}_n)$ is a finite-dimensional subspace defined by $\mathcal{E}_n$, the orthogonal projection of a square integrable $2\pi$-periodic function $f\in L_{2\pi}^2 (\R,\mathbb{F})$ onto $\mathcal{U}_n$ is given by

$$
	\mathcal{F}_n (f) = \sum_{k=-n}^n e^{ikx} \langle x \mapsto e^{ikx}, f \rangle
$$

<MathBox title='Complex Fourier series in $L^2$' boxType='definition'>
Let $f\in L_{2\pi}^2 (\R,\mathbb{F})$ be a square integrable $2\pi$-periodic function. For any $n\in\N$ define


$$
	\mathcal{F}_n (f)(x) = \sum_{k=-n}^n c_k e^{ikx}
$$

with

$$
	c_k = \frac{1}{2\pi} \int_{-\pi}^\pi e^{-ikx} f(x) \;\d x
$$

The map $n\mapsto \mathcal{F}_n (f)$ is the complex Fourier series of $f$.
</MathBox>

The set of exponential functions $\Set{ e_n := e^{inx} = \cos nx + i\sin nx : n \in\Z }$ is an orthogonal basis for the Hilbert space $L^2\left([-\pi, \pi ]\right)$ of square integrable functions with an inner product given by

$$
	\langle f, g \rangle := \int_{-\pi}^\pi f(x)\overline{g(x)}\;\d x \quad f, g \in L^2\left([-\pi, \pi ]\right)
$$

This is easily shown by calculating the inner product

$$
	\left\langle e_m, e_n \right\rangle = \int_{-\pi}^\pi e^{imx} e^{-inx}\;\d x = \int_{-\pi}^\pi e^{i(m - n)x}\;\d x = \left.\frac{1}{i(n - m)}e^{i(m - n)x}\right|_{-\pi}^\pi = 2\pi \delta_{nm}
$$

The Fourier series of $f \in L^2\left([-\pi, \pi ]\right)$ is an expansion of $f$ in terms of this exponential basis

$$
	f(x) = \frac{1}{2\pi}\sum_{n=-\infty}^\infty \left\langle f, e_n \right\rangle e_n = \sum_{n=-\infty}^\infty \frac{1}{2\pi}\left\langle f, e^{inx} \right\rangle e^{inx} = \sum_{n=-\infty}^\infty c_n e^{inx} \\
$$

Writing out the coefficients $c_n$ gives

$$
\begin{align*}
	c_n :=& \frac{1}{2\pi}\left\langle f, e^{inx} \right\rangle = \frac{1}{2\pi}\int_{-\pi}^\pi f(x) e^{-inx}\;\d x \\ 
	=& \frac{1}{2\pi}\int_{-\pi}^\pi f(x) \left[\cos(nx) - i \sin(nx) \right]\;\d x \\
	=& \frac{1}{2\pi} \langle f(x), \cos nx\rangle - \frac{1}{2\pi} \langle f(x), \sin nx\rangle = \alpha_n + i\beta_n
\end{align*}
$$

The Fourier series of $f$ can thus be rewritten as

$$
\begin{align*}
	f(x) =& \sum_{n=-\infty}^\infty c_n e^{inx} \\
	=& \sum_{n=-\infty}^\infty \left( \alpha_k + i\beta_k \right) \left(\cos nx + i\sin nx \right) \\
	=& \left(\alpha_0 + i\beta_0 \right) + \sum_{n=1}^\infty \left[\left(\alpha_{-n} + \alpha_{n} \right)\cos nx + \left(\beta_{-n} - \beta_n \right)\sin nx\right] \\
	&+ i\sum_{n=1}^\infty \left[\left(\beta_{-n} + \beta_{n} \right)\cos nx + \left(\alpha_{-n} - \alpha_n \right)\sin nx\right]
\end{align*}
$$

If $f$ is real-valued, then $\alpha_{-k} = \alpha_{k}$, $\beta_{-k} = -\beta_{k}$ and $\beta_0 = 0$, so that the Fourier transform reduces to

$$
	f(x) = \frac{a_0}{2} + \sum_{n=1}^\infty \left[a_n \cos nx + b_n\sin nx \right]
$$

with 

$$
\begin{align*}
	a_n =& 2\alpha_n = \frac{1}{\pi} \int_{-\pi}^\pi f(x)\cos(nx)\;\d x \\
	b_n =& 2\beta_n = \frac{1}{\pi} \int_{-\pi}^\pi f(x)\sin(nx)\;\d x
\end{align*}
$$

The Fourier series for an $L$-periodic function $f\in L^2\left([0, L]\right)$ can be similarly found using the orthogonal basis $\Set{ e_n := e^{\frac{i2\pi n x}{L}} }$ giving

$$
\begin{align*}
	f(x) =& \frac{a_0}{2} + \sum_{n=1}^\infty \left[ a_n \cos\left( \frac{2\pi n x}{L} \right) + b_n \sin\left( \frac{2\pi n x}{L} \right) \right] \\
	=& \sum_{n=-\infty}^\infty c_n e^{\frac{i2\pi n x}{L}}
\end{align*}
$$

with coefficients

$$
	c_n = \frac{1}{L}\langle f(x), e_n \rangle = \frac{1}{L}\int_0^L f(x)e^{-\frac{i2\pi n x}{L}}\;\d x
$$

<MathBox title='Geometric properties of Fourier series' boxType='proposition' tag='proposition-2'>
If $f\in L_{2\pi}^2 (\R, \mathbb{F})$ and $\mathcal{F}_n (f) = \sum_{k=-n}^n c_k e^{ikx}$ with $c_k = \langle x\mapsto e^{ikx}, f\rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{e^{ikx}} f(x) \;\d x$, then

1. $\lVert f - \mathcal{F}_n (f)\rVert^2 = \lVert f \rVert^2 - \sum_{k=-n}^n |c_k|^2$
2. **Bessel's inequality:** $\sum_{k=-n}^n |c_k|^2 \leq \lVert f \rVert^2$ for all $n\in\N$
		- Consequently $\sum_{k=-\infty}^\infty |c_k|^2 \leq \lVert f \rVert^2$ and $\lim_{k\to\infty} c_k = 0$
3. **Parseval's identity:** $\lim_{n\to\infty} \lVert f - \mathcal{F}_n (f) \rVert = 0 \iff \sum_{k=-\infty}^\infty |c_k|^2 = \lVert f \rVert^2$

It follows directly from Parseval's identity that any $f\in L_{2\pi}^2 (\R,\mathbb{F})$ can be written $f = \mathcal{F}_n (f) + r_n$ with $\lVert f_n \rVert \xrightarrow{n\to\infty} 0$.

<details>
<summary>Proof</summary>

**(1):** By the Pythagorean theorem we have

$$
\begin{gather*}
	\lVert f \rVert^2 = \lVert \mathcal{F}_n (f) \rVert^2 + \lVert f - \mathcal{F}_n (f) \rVert^2 \\
	\implies \lVert f - \mathcal{F}_n (f)\rVert^2 = \lVert f \rVert^2 - \lVert f - \mathcal{F}_n (f) \rVert^2
\end{gather*}
$$

Since $\Set{x\mapsto e^{ikx}}_{k\in\Z}$ is orthonormal with respect to the the inner product, it follows that 

$$
\begin{align*}
	\lVert \mathcal{F}_n (f) \rVert^2 =& \langle \mathcal{F}_n (f), \mathcal{F}_n (f) \rangle \\
	=& \left\langle \sum_{k=-n}^n c_k e^{ikx}, \sum_{\ell=-n}^n c_k e^{i\ell x} \right\rangle \\
	=& \sum_{k=-n}^n \sum_{\ell = -n}^n c_k \overline{c_\ell} \underbrace{\langle e^{ikx}, e^{i \ell x} \rangle}_{=\delta_{k\ell}} \\
	=& \sum_{k=-n}^n |c_k|^2
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
If $f\in L_{2\pi}^2 (\R,\mathbb{F})$ with $\mathcal{F}_n (f) = \sum_{k=-n}^n c_k e^{ikx}$ with $c_k = \langle x\mapsto e^{ikx}, f\rangle = \frac{1}{2\pi} \int_{-\pi}^\pi \overline{e^{ikx}} f(x) \;\d x$, then the the following are equivalent
1. **Parseval's identity:** $\lVert f \rVert^2 = \sum_{k=-\infty}^\infty |\langle x\mapsto e^{ikx}, f \rangle|^2$
2. The orthonormal system $\mathcal{E} = \Set{x\mapsto e^{ikx}}_{k\in\Z}$ is complete, i.e. 
$$
	\lim_{n\to\infty} \lVert f - \sum_{k=-n}^n e^{ikx} \langle x\mapsto e^{ikx}, f \rangle \rVert = 0
$$
3. The orthonormal system $\mathcal{E}$ gives the inner product
$$
	\langle f, g \rangle = \sum_{k=-\infty}^\infty \langle f, x\mapsto e^{ikx} \rangle \langle x\mapsto e^{ikx}, g \rangle
$$
4. The orthonormal system $\mathcal{E}$ is total such that $\operatorname{span}(\set{x\mapsto e^{ikx}}_{k\in\Z})$ is dense in $L_{2\pi}^2 (\R, \mathbb{F})$. Equivalently,
$$
\begin{gather}
	\forall f\in L_{2\pi}^2 (\R,\mathbb{F}) \; \forall \epsilon > 0 \; \exists N\in\N, \; \lambda_1,\dots,\lambda_N \in \mathbb{F}: \\
	\lVert f - \sum_{k=-N}^N \lambda_k e^{ikx} \rVert < \epsilon
\end{gather}
$$

<details>
<summary>Proof</summary>

We want to express to inner product of $f,g\in L_{2\pi}^2 (\R,\mathbb{F})$ in terms of Fourier coefficients. By Parseval's identity (Proposition $\ref{proposition-2}$) we can write

$$
\begin{align*}
	f =& \mathcal{F}_n (f) + r_n\; \lim_{n\to\infty} \lVert r_n \rVert = 0 \\
	g =& \mathcal{F}_n (g) + \tilde{r}_n\; \lim_{n\to\infty} \lVert \tilde{r}_n \rVert = 0 \\
\end{align*}
$$

By the Cauchy-Schwarz and Bessel inequalities, we have

$$
	|\langle \mathcal{F}_n (g), r_n \rangle| \leq \lVert \mathcal{F}_n (g) \rVert \cdot \lVert r_n \rVert\leq\lVert g \rVert\cdot\lVert r_n \rVert \xrightarrow{n\to\infty} 0
$$

Thus, we can write the inner product of $f$ and $g$ as

$$
\begin{align*}
	\langle f, g \rangle =& \langle \mathcal{F}_n (f) + r_n, \mathcal{F}_n (g) + \tilde{r}_n \rangle \\
	=& \langle \mathcal{F}_n (f), \mathcal{F}_n (g) \rangle + \langle r_n, \mathcal{F}_n (g) \rangle + \langle \mathcal{F}_n (f), \tilde{r}_n \rangle + \langle r_n, \tilde{r}_n \rangle \tag{\label{equation-1}}
\end{align*}
$$

The first term can be expressed as

$$
\begin{align*}
	\langle \mathcal{F}_n (f), \mathcal{F}_n (g) \rangle =& \left\langle \sum_{k=-n}^n e^{ikx} \langle x\mapsto e^{ikx}, f \rangle, \sum_{\ell=-n}^n e^{i\ell x} \langle x\mapsto e^{i\ell x}, g \rangle \right\rangle \\
	=& \sum_{k=-n}^n \sum_{\ell=-n}^n \overline{\langle x\mapsto e^{ikx}, f \rangle} \langle x\mapsto e^{i\ell x} \underbrace{\langle x\mapsto e^{ikx}, x\mapsto e^{i\ell x}}_{=\delta_{k\ell}} \\
	=& \sum_{k=-n}^n \langle f, x\mapsto e^{ikx}\rangle \langle x\mapsto e^{ikx}, g
\end{align*}
$$

Taking the limit $n\to\infty$, the residual terms of $\eqref{equation-1}$ vanish, such that we obtain

$$
	\langle f, g \rangle = \langle \mathcal{F}_n (f) + r_n, \mathcal{F}_n (g) + \tilde{r}_n \rangle \xrightarrow{n\to\infty} \sum_{k=-\infty}^\infty \langle f, x\mapsto e^{ikx}\rangle \langle x\mapsto e^{ikx}, g \rangle
$$
</details>
</MathBox>

# Fourier transform

The Fourier transform integral is the limit of Fourier series as the periodicity goes to infinity. Consider a Fourier series of a function $f \in L^2\left([-L/2, L/2] \right)$

$$
\begin{gather*}
	f(x) = \sum_{n=-\infty}^\infty c_n e^{\frac{i2\pi n x}{L}} \\
	c_n = \frac{1}{L}\langle f(x), e_n \rangle = \frac{1}{L}\int_{-L/2}^{L/2} f(x)e^{-\frac{i2\pi n x}{L}}\;\d x
\end{gather*}
$$

Defining $\xi = \frac{n}{L}$ and $\Delta\xi = \frac{1}{L}$. Taking the limit $L\to\infty \iff \Delta\xi\to 0$ we get

$$
\begin{align*}
	f(x) =& \lim_{\Delta\xi \to 0} \sum_{n=-\infty}^\infty \Delta\xi \int_{-\frac{1}{2\xi}}^{\frac{1}{2\xi}} f(\xi) e^{-i2\pi \xi x}\;\d\xi e^{i2\pi n \Delta\xi x} \\
	=& \lim_{\Delta\xi\to 0}\sum_{n=-\infty}^\infty \Delta\xi \langle f(x), e^{i2\pi \xi x} \rangle e^{i 2\pi n \Delta\xi x}
\end{align*}
$$

Defining $\omega = \frac{n\pi}{L}$ and $\Delta\omega = \frac{\pi}{L}$. Taking the limit $L\to\infty$ or $\Delta\omega\to 0$ we get

$$
\begin{align*}
	f(x) =& \lim_{\Delta\omega\to 0} \sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi} \int_{-\frac{\pi}{\Delta\omega}}^{\frac{\pi}{\Delta\omega}} f(\xi) e^{-i\omega\xi}\;\d\xi e^{in\Delta\omega x} \\
	=& \lim_{\Delta\omega\to 0}\sum_{n=-\infty}^\infty \frac{\Delta\omega}{2\pi}\langle f(x), e_i\omega x \rangle e^{in\Delta\omega x}
\end{align*}
$$

In this limit, the summation with weight $\Delta\xi$ becomes a Riemann integral. The Fourier transform of $f$, denoted $\mathcal{F}\left[ f(x) \right] = \hat{f}(\omega)$ is defined as the inner product $\langle f(x), e^{i2\pi\xi x}\rangle$ resulting in

$$
\begin{align*}
	f(x) &= \mathcal{F}^{-1}\left[ \hat{f}(\xi) \right] = \int_{-\infty}^\infty \hat{f}(\xi) e^{i2\pi\xi x}\;\d\xi \\
	\hat{f}(\xi) &= \mathcal{F}\left[ f(x) \right] = \int_{-\infty}^\infty f(x) e^{-i2\pi\xi x}\;\d x
\end{align*}
$$

Both integrals converge as long as $f$ and $\hat{f}$ are integrable, i.e. $f, \hat{f}\in L^1 (-\infty, \infty)$. When the independent variable $x$ represents time, denoted $t\in\R$, the transform variable $\xi$ represents frequency, denoted $f\in\R$. In terms of angular frequency $\omega = 2\pi f$, the Fourier transform takes the form

$$
	\hat{f}(\omega) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty} f(t) e^{-i \omega t}\;\d x \quad \forall \omega\in\R
$$

## Properties

<MathBox title='Linearity of Fourier transforms' boxType='proposition'>
The Fourier transform is a linear operator, so that for $f, g\in L^1 (\R^n, \mathbb{C})$ and $\alpha, \beta\in\mathbb{C}$, we have

$$
\begin{gather*}
	\mathcal{F}\left[\alpha f(x) + \beta g(x) \right] = \alpha\mathcal{F}\left[ f(x) \right] + \beta\mathcal{F}\left[ g(x) \right] \\
	\mathcal{F}^{-1}\left[\alpha \hat{f}(x) + \beta \hat{g}(x) \right] = \alpha\mathcal{F}^{-1}\left[ \hat{f}(x) \right] + \beta\mathcal{F}^{-1}\left[ \hat{g}(x) \right] \\
\end{gather*}
$$
</MathBox>

<MathBox title='Shifting property' boxType='proposition'>
Let $f, \hat{f} \in L^1\left(\R\right)$ be integrable functions. The Fourier transform of a translation in $f$ is given by

$$
	\mathcal{F}\left[ f(x - x_0) \right] = e^{-i2\pi x_0 \xi}\hat{f}(\xi)
$$

The inverse Fourier transform of a modulation in $\hat{f}$ is given by

$$
	\mathcal{F}^{-1}\left[ \hat{f}(\xi - \xi_0) \right] = f(x)e^{-i2\pi\xi_0 x}
$$
</MathBox>

<MathBox title='Fourier transform of derivatives' boxType='proposition'>
Let $f:\R\to\mathbb{C}$ be an absolutely continuous differentiable function, and suppose $f, f' \in L^1(\R)$ are integrable. The Fourier transform of the derivative $f'$ is given by

$$
	\hat{f}'(\xi) = \mathcal{F}\left[ \frac{\d}{\d x} f(x) \right] = i2\pi\xi \hat{f}(\xi)
$$

The Fourier transform for the $n$th derivative $f^{(n)}$ is given by

$$
	\hat{f}^{(n)}(\xi) = \mathcal{F}\left[ \frac{\d^n}{\d x^n} f(x) \right] = (i2\pi\xi)^n \hat{f}(\xi)
$$

<details>
<summary>Proof</summary>

Integrating by parts gives

$$
\begin{align*}
	\mathcal{F}\left[ \frac{\d}{\d x} f(x) \right] &= \int_{-\infty}^\infty \overbrace{f'(x)}^{\d v}e^{-i2\pi\xi x}\;\d x \\
	&= \underbrace{f(x)e^{-i2\pi\xi x}}_{uv}|_{-\infty}^\infty - \int_{-\infty}^\infty \underbrace{f(x)}_{u} \left(-i2\pi\xi e^{-i2\pi\xi x}\right)\;\d x \\
	&= i2\pi\xi \int_{-\infty}^\infty f(x)e^{-i2\pi\xi x}\;\d x \\
	&= i2\pi\xi\mathcal{F}\left[ f(x) \right]
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Convolution theorem' boxType='theorem'>
Let $f, g \in L^1(\R)$ be integrable functions. The Fourier transform of the convolution

$$
	h(x) := (f*g)(x) = \int_{-\infty}^\infty f(y)g(x - y)\;\d y
$$

is given by

$$
	\hat{h}'(\xi) = \hat{f}(\xi)\cdot\hat{g}(\xi)
$$

<details>
<summary>Proof</summary>

Taking the inverse Fourier transform of the product of $\hat{f}$ and $\hat{g}$ gives

$$
\begin{align*}
	\mathcal{F}\left[ \hat{f}(\xi) \hat{g}(\xi) \right] &= \int_{-\infty}^\infty \hat{f}(\xi)\hat{g}(\xi)e^{i2\pi\xi x}\;\d\xi \\
	&= \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi x}\left[ \int_{-\infty}^\infty g(y) e^{-i2\pi\xi y}\;\d y \right]\;\d\xi \\
	&= \int_{-\infty}^\infty g(y)\hat{f}(\xi) e^{i2\pi\xi(x - y)}\;\d\xi\d y \\
	&= \int_{-\infty}^\infty g(y) \underbrace_{\left[ \int_{-\infty}^\infty \hat{f}(\xi)e^{i2\pi\xi(x - y)}\;\d\xi \right]}_{f(x - y)}\;\d y \\
	&= \int_{-\infty}^\infty g(y)f(x - y)\;\d y \\
	&= g*f = f*g
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Parseval-Plancherel theorem' boxType='theorem'>
Let $f, g \in L^1(\R)\cap L^2(\R)$, then the following identity holds (Parseval's theorem)

$$
	\langle f, g \rangle = \int_{-\infty}^\infty f(x)\overline{g(x)}\;\d x = \int_{-\infty}^\infty \hat{f}(\xi)\overline{\hat{g}(\xi)}\;\d x
$$

In the special case $g = f$, this identity reduces to (Plancherel's theorem)

$$
	\lVert f\rVert_{L^2}^2 = \int_{-\infty}^\infty |f(x)|^2\;\d x = \int_{-\infty}^\infty \left|\hat{f}(\xi)\right|^2\;\d\xi
$$
</MathBox>

## Uncertainty principle

<MathBox title='Schwartz space' boxType='definition'>
The Schwartz space on $\R^n$ is the space of all smooth functions whose derivatives are rapidly decreasing

$$
\begin{align*}
	\mathcal{S}\left(\R^n, \mathbb{C}\right) &:= \Set{ f\in C^\infty (\R^n, \mathbb{C}) | \forall \alpha, \beta \in \N^n \;: \lVert f\rVert_{\alpha, \beta} < \infty } \subset L^1\left(\R^n, \mathbb{C}\right) \\
	\lVert f\rVert_{\alpha, \beta} &:= \sup_{x\in\R^n} \left| x^\alpha \left(D^\beta f \right)(x) \right|
\end{align*}
$$

The Fourier transform defines an automorphism on Schwartz spaces, i.e. $f\in\mathcal{S}\left(\R^n, \mathbb{C}\right) \implies \hat{f}\in \mathcal{S}\left(\R^n, \mathbb{C}\right)$
</MathBox>

<MathBox title='Uncertainty principle' boxType='theorem'>
For any Schwartz function $f\in\mathcal{S}(\R)$ and any $x_0, \xi_0 \in\R$, the following inequality holds

$$
	\lVert f(x)\rVert_{L^2} \leq 4\pi \left\| (x - x_0) f(x) \right\|_{L^2}\cdot\left\| (\xi - \xi_0) \hat{f}(x) \right\|_{L^2}
$$

If $f$ is normalized, i.e. $\lVert f(x)\rVert_{L^2} = 1$, then the inequality can be written

$$
	\left\| (x - x_0) f(x) \right\|_{L^2}^2 \cdot\left\| (\xi - \xi_0) \hat{f}(x) \right\|_{L^2}^2 \geq \frac{1}{16\pi^2}
$$

<details>
<summary>Proof</summary>

Applying integration by parts on $\lVert f\rVert_{L^2}^2$ gives

$$
\begin{align*}
	\lVert f\rVert_{L^2}^2 &= \int_{-\infty}^\infty |f(x)|^2\;\d x = \int_{-\infty}^\infty f(x)\overline{f(x)}\;\d x \\
	&= \left. x|f(x)|^2 \right|_{-\infty}^\infty - \int_{-\infty}^\infty x\left[ f'(x)\overline{f(x)} + f(x)\overline{f'(x)} \right]\;\d x \\
	&= - 2\int_{-\infty}^\infty x\Re\left[ f'(x)\overline{f'(x)} \right]\;\d x \\
	&\leq 2 \lVert x f(x)\rVert_{L_2} \cdot \left\| f'(x) \right\|_{L_2}
\end{align*}
$$

Where we have used that $\lim_{|x|\to\infty} \left| xf(x)^2 \right| = 0$ since $f$ is Schwartz, and the Cauchy-Schwartz inequality. Using Plancherel's identity and the Fourier transform derivation rule give

$$
	\left\| \overline{f'(x)} \right\|_{L_2} = \left\| f'(x) \right\|_{L_2} = \left\| \hat{f}'(\xi) \right\|_{L_2} = \left\| (i2\pi\xi)\hat{f}(\xi) \right\|_{L_2} = 2\pi\left\| \xi\hat{f}(\xi) \right\|_{L_2}
$$

Combining the results gives a special case of the uncertainty principle

$$
	\lVert f\rVert_{L^2}^2 \leq 4\pi \lVert x f(x)\rVert_{L^2} \cdot \left\| \xi \hat{f}(\xi) \right\|_{L^2}
$$

To prove the uncertainty principly in its full generality, we define the function

$$
	g(x) = e^{-i2\pi\xi_0 x} f(x + x_0) \;\textrm{ so that }\; \hat{g}(x) = e^{i2\pi x_0 \xi} \hat{f}(\xi + \xi_0)
$$

For this function $g$, we have

$$
\begin{align*}
	\lVert g\rVert_{L^2}^2 &= \int_{-\infty}^\infty \left| e^{-i2\pi\xi_0 x} f(x + x_0) \right|^2 \;\d x = \int_{-\infty}^\infty \left| f(t) \right|^2 \;\d t = \lVert f\rVert_{L^2}^2 \\
	\lVert u g(u)\rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| u e^{-i2\pi\xi_0 u} f(u + x_0) \right|^2 \;\d u \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| (x - x_0) f(x) \right|^2 \;\d x \right)^{1/2} = \lVert (x - x_0)f(x)\rVert_{L^2} \\
	\lVert t\hat{g}(t)\rVert_{L^2} &= \left( \int_{-\infty}^\infty \left| t e^{i2\pi x_0 t} \hat{f}(t + \xi_0) \right|^2 \;\d t \right)^{1/2} \\
	&= \left( \int_{-\infty}^\infty \left| \left(\xi - \xi_0 \right) \hat{f}(\xi_0) \right|^2 \;\d\xi \right)^{1/2} = \left\| \left(\xi - \xi_0\right) \hat{f}(\xi) \right\|_{L^2}
\end{align*}
$$

Substituting $g$ into the specialized uncertainty inequality above yields the desired result.
</details>
</MathBox>

The equality holds in the uncertainty principle if we get an equality when applying the Cauchy-Schwartz inequality. This implies we must have $f'(x) = \lambda xf(x)$ for some scalar $\lambda$. This differential equation has the general solution

$$
	f(x) = \alpha e^{-\frac{\lambda}{2} x^2} \quad \lambda > 0,\; |\alpha|^2 = \sqrt\frac{\lambda}{\pi}\lVert f\rVert_{L^2}^2
$$

# Discrete Fourier transform

<MathBox title='Discrete Fourier transform (DFT)' boxType='definition'>
The discrete Fourier transform of a complex sequence $\Set{ f_n }_{n=0}^N \subseteq\mathbb{C}$ produces a complex sequence $\Set{ F_k }_{k=0}^{N-1}$ where

$$
	\mathcal{F}\Set{ f_k } = F_k = \sum_{n=0}^{N-1} x_n \cdot e^{-\frac{i2\pi}{N}kn}
$$

The inverse transform is defined by

$$
	f_n = \frac{1}{N} \sum_{n=0}^{N-1} X_k \cdot e^{\frac{i2\pi}{N}kn}
$$
</MathBox>

## Fast Fourier transform


# Short-time Fourier transform

<MathBox title='Short-time Fourier transform (STFT)' boxType='definition'>
The short-time Fourier transform of an integrable function $f:\R\to\mathbb{C}$ is defined by

$$
	\mathcal{F}\left[ f(\tau) \right] = \hat{f}_g(t, \omega) = \int_{-\infty}^\infty f(\tau) \overline{g(\tau - t)} e^{-i \omega x}\;\d\tau = \langle f(\tau), g_{t,\omega}(\tau) \rangle 
$$

where $g_{t, \omega}(\tau) = e^{i\omega t}g(\tau - t)$ and $g(t)$ is the kernel (window). The Gabor transform is a special case of the STFT with a Gaussian kernel of the form

$$
	g(t) = e^{-\frac{(t - \tau)^2}{a^2}}
$$

The inverse STFT transform is given by

$$
	f(t) = \mathcal{F}^{-1}\left[ \hat{f}_g (t, \omega) \right] = \frac{1}{2\pi\| g\|^2} \int_{-\infty}^\infty\int_{-\infty}^\infty \hat{f}_g (\tau, \omega)g(t - \tau)e^{i\omega t}\;\d\omega \d t
$$
</MathBox>

## Discrete

The discrete version of the STFT can be formed by discretizing time and frequency

$$
	\tau = j\Delta t \quad \nu = k \Delta\omega \quad j, k \in\N
$$

The discretized kernel function becomes

$$
	g_{j, k} = e^{i2\pi k\Delta\omega t} g(t - k\Delta t)
$$

and the discrete STFT is

$$
	\hat{f}_{j, k} = \langle f, g_{j,k}\rangle = \int_{-\infty}^\infty f(\tau)\overline{g_{j, k}(\tau)}\;\d\tau
$$

# Wavelet transform

Wavelets extend the concepts in Fourier analysis to more general orthogonal bases, and partially overcome the uncertainty principle by exploiting multi-resolution decomposition. This multi-resolution approach enables different time and frequency fidelities in different frequency bands.

<MathBox title='Wavelet' boxType='definition'>

A function $\psi\in L^2(\R)$ is called an orthonormal wavelet if it generates a basis for $L^2(\R)$. The basis is constructed as a family of functions by means of translations and dilations of $\psi$

$$
	\Set{\psi_{a,b}(t) = \frac{1}{\sqrt{a}}\left( \frac{t - b}{a} \right) | b \in\R,\; a\R^+ }
$$

In terms of dyadic translations and dilations with $a = 2^{-j}$ and $b = k2^{-j}$ for $j, k \in \Z$, we get

$$
	\langle \psi_{jk}, \psi_{lm} \rangle = \int_{-\infty}^\infty \psi_{jk}(x)\overline{\psi_{lm}(x)}\;\d x = \delta_{jl}\delta_{km}
$$
</MathBox>

<MathBox title='Wavelet transform' boxType='definition'>
Suppose $\psi\in L^2 (\R)$ is an orthonormal wavelet satisfying the boundedness property

$$
	C_\psi = \int_{-\infty}^\infty \frac{\left| \hat{\psi}(\omega) \right|^2}{|\omega |}\d\omega < \omega
$$

The wavelet transform of a function $f\in L^1(\R$ is defined as

$$
	\mathcal{W}_\psi \left[ f(t) \right](a, b) = \langle f, \psi_{a, b} \rangle = \int_{-\infty}^\infty f(t)\overline{\psi_{a,b}(t)}\;\d t = \frac{1}{\sqrt{|a|}}\int_{-\infty}^\infty f(t)\overline{\psi\left(\frac{t - b}{a}\right)}\;\d t
$$

The inverse wavelet transform is

$$
	f(t) = \frac{1}{C_\psi} \int_0^\infty \int_{-\infty}^\infty \mathcal{W}_\psi [f](a, b) \psi_{a, b}(t)\frac{1}{a^2}\;\d a\d b
$$

Every function $f\in L^2(\R)$ may be expanded in the wavelet basis as (using dyadic translations and dialtions)

$$
	f(t) = \sum_{j=-\infty}^\infty \sum_{k=-\infty}^\infty \psi_{jk}(t)
$$

where the wavelet coefficients $c_{jk}$ are given by

$$
	c_{jk} = \langle f(t), \psi_{j, k} \rangle = \mathcal{W}_\psi[f(t)]\left(2^{-j}, k2^{-j} \right)
$$
</MathBox>

## Haar wavelet

$$
	\psi(t) = \begin{cases} 
		1 &\quad 0\leq t < \frac{1}{2} \\
		-1 &\quad \frac{1}{2}\leq t < 1 \\
		0 &\quad \textrm{otherwise}
	\end{cases}
$$

## Mexican hat wavelet

$$
\begin{align*}
	\psi(t) &= (1 - t^2)e^{-\frac{t^2}{2}} \\
	\hat{\psi(\omega)} &= \sqrt{2\pi}\omega^2 e^{-\frac{\omega^2}{2}}
\end{align*}
$$