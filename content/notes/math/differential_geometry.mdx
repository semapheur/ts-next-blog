---
title: 'Differential Geometry'
subject: 'Mathematics'
showToc: true
---

In the following discussions, the term "smooth" means infinitely differentiable, or $C^\infty$. If $M$ is a smooth manifold, $\mathcal{F} = C^\infty (M)$ denotes the ring of smooth functions on $M$.

# Connections

<MathBox title='Connection on vector bundles' boxType='definition'>
Let $\pi: E\to M$ be a smooth vector bundle over a smooth manifold $M$ and let $\Gamma(E)$ denote the space of smooth sections of $E$. A *connection* on $E$ is a map

$$
  \nabla:\mathfrak{X}(M)\times\Gamma(E)\to\Gamma(E)
$$

written $(\mathbf{X}, \mathbf{Y}) \mapsto\nabla_\mathbf{X} \mathbf{Y}$, satisfying the following properties
1. $\nabla_\mathbf{X} \mathbf{Y}$ is linear over $C^\infty (M)$ in $\mathbf{X}$.
$$
  \nabla_{f\mathbf{X}_1 + g\mathbf{X}_2} \mathbf{Y} = f\nabla_{\mathbf{X}_1} \mathbf{Y} + g\nabla_{\mathbf{X}_2} \mathbf{Y},\, f,g\in C^\infty (M)
$$
2. $\nabla_\mathbf{X} \mathbf{s}$ is linear over $\R$ in $\mathbf{Y}$
$$
  \nabla_\mathbf{X} (a\mathbf{Y}_1 + b\mathbf{Y}_2) = a\nabla_\mathbf{X} \mathbf{Y}_1 + b\nabla_\mathbf{X} \mathbf{Y}_2,\, a,b\in\R
$$
2. **Leibniz rule:**
$$
  \nabla_\mathbf{X} (f\mathbf{Y}) = f\nabla_\mathbf{X} \mathbf{Y} + (\mathbf{X}f)\mathbf{Y},\, f\in C^\infty (M)
$$

The expression $\nabla_\mathbf{X} \mathbf{Y}$ is called the *covariant derivative* of $\mathbf{Y}$ in the direction of $\mathbf{X}$.

<details>
<summary>Details</summary>

Since $\mathbf{X}f = (\mathrm{d}f)(\mathbf{X})$, the Leibniz rule can be written as

$$
  \nabla_\mathbf{X} (f\mathbf{Y}) = (\mathrm{d}f)(\mathbf{X})\mathbf{Y} + f\nabla_\mathbf{X} \mathbf{Y}
$$

or, suppressing $\mathbf{X}$,

$$
  \nabla (fY) = \mathrm{d}f\cdot\mathbf{Y} + f\nabla\mathbf{Y}
$$
</details>
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-1'>
Let $M$ be a smooth manifold. If $\nabla$ is a connection in a bundle $E$, $\mathbf{X}\in\mathfrak{X}(M)$, $\mathbf{Y}\in\Gamma(M)$ and $\mathbf{p}\in M$, then $\nabla_\mathbf{X}|_\mathbf{p}$ depends only on the values of $\mathbf{X}$ and $\mathbf{Y}$ in an arbitrarily small neighbourhood of $\mathbf{p}$. Specifically, if $\mathbf{X} = \tilde{\mathbf{X}}$ and $\mathbf{Y} = \tilde{\mathbf{Y}}$ on a neighbourhood of $\mathbf{p}$, then $\nabla_\mathbf{X}|_\mathbf{p} = \nabla_{\tilde{\mathbf{X}}} \tilde{\mathbf{Y}}|_\mathbf{p}$.

<details>
<summary>Proof</summary>

First consider $\mathbf{Y}$. Replacing $\mathbf{Y}$ by $\mathbf{Y} - \tilde{\mathbf{Y}}$, it clearly suffices to show that $\nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p} = 0$ if $\mathbf{Y}$ vanishes on a neighbourhood $U$ of $\mathbf{p}$.

Choose a bump function $\varphi\in C^\infty (M)$ with support in $U$ such that $\varphi(\mathbf{p}) = 1$. The hypothesis that $\mathbf{Y}$ vanishes on $U$ implies that $\varphi\mathbf{Y} \equiv 0$ on all of $M$, so $\nabla_\mathbf{X} (\varphi\mathbf{Y}) = \nabla_\mathbf{X} (0\cdot \varphi\mathbf{Y}) = 0\nabla_\mathbf{X} (\varphi\mathbf{Y}) = 0$. Thus for any $\mathbf{X}\in\mathfrak{X}(M)$, the Leibniz rule gives

$$
  0 = \nabla_\mathbf{X} (\varphi\mathbf{Y}) = (\mathbf{X}\varphi)\mathbf{Y} + \varphi(\nabla_\mathbf{X} \mathbf{Y})
$$

Now $\mathbf{Y} \equiv 0$ on the support of $\varphi$, so the first term on the right is identically zero. Evaluating the equation at $\mathbf{p}$ shows that $\nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p} = 0$. The argument for $\mathbf{X}$ is similar.
</details>
</MathBox>

<MathBox title='' boxType='lemma' tag='lemma-2'>
Let $M$ be a smooth manifold. If $\nabla$ is a connection in a bundle $E$, $\mathbf{X}\in\mathfrak{X}(M)$, $\mathbf{Y}\in\Gamma(M)$ and $\mathbf{p}\in M$, then $\nabla_\mathbf{X}|_\mathbf{p}$ depends only on the values of $\mathbf{Y}$ in an arbitrarily small neighbourhood of $\mathbf{p}$ and the value of $\mathbf{X}$ at $\mathbf{p}$.

<details>
<summary>Proof</summary>

By linearity, it suffices to show that $\nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p} = 0$ whenever $\mathbf{X_p} = 0$. Choose a coordinate neighbourhood $U$ of $\mathbf{p}$, and write $\mathbf{X} = \sum_i X^i \boldsymbol{\partial_i}$ in coordinates on $U$, with $X^i (\mathbf{p}) = 0$. Then for any $\mathbf{Y}\in\Gamma(M)$

$$
  \nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p} = \nabla_{\sum_i X^i \boldsymbol{\partial}_i} \mathbf{Y}|_\mathbf{p} = \sum_i X^i (\mathbf{p}) \nabla_{\boldsymbol{\partial}_i} \mathbf{Y}|_\mathbf{p} = 0
$$

In the first equality we used $\ref{lemma-1}$, which allows us to evaluate $\nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p}$ by computing locally in $U$. In the second, we used linearity of $\nabla_\mathbf{X} \mathbf{Y}$ over $C^\infty (M)$ in $\mathbf{X}$.
</details>
</MathBox>

Lemma $\ref{lemma-2}$ allows us to write $\nabla_\mathbf{X_\mathbf{p}} \mathbf{Y}$ in place of $\nabla_\mathbf{X} \mathbf{Y}|_\mathbf{p}$. This can be interpreted as a directional derivative of $\mathbf{Y}$ at $\mathbf{p}$ in the direction of the vector $\mathbf{X_p}$.

## Affine connections

<MathBox title='Affine connection' boxType='definition'>
An *affine connection* on a smooth manifold $M$ is a connection in the tangent bundle $TM$, i.e. a map
 
$$
  \nabla: \mathfrak{X}(M)\times\mathfrak{X}(M)\to\mathfrak{X}(M)
$$

written $\nabla_\mathbf{X} \mathbf{Y}$ for $\nabla(\mathbf{X},\mathbf{Y})$, satisfying the following properties:

1. $\nabla_\mathbf{X} \mathbf{Y}$ is linear over $C^\infty (M)$ in $\mathbf{X}$.
$$
  \nabla_{f\mathbf{X}_1 + g\mathbf{X}_2} \mathbf{Y} = f\nabla_{\mathbf{X}_1} \mathbf{Y} + g\nabla_{\mathbf{X}_2} \mathbf{Y},\, f,g\in C^\infty (M)
$$
2. $\nabla_\mathbf{X} \mathbf{X}$ is linear over $\R$ in $\mathbf{Y}$
$$
  \nabla_\mathbf{X} (a\mathbf{Y}_1 + b\mathbf{Y}_2) = a\nabla_\mathbf{X} \mathbf{Y}_1 + b\nabla_\mathbf{X} \mathbf{Y}_2,\, a,b\in\R
$$
2. **Leibniz rule:**
$$
  \nabla_\mathbf{X} (f\mathbf{Y}) = f\nabla_\mathbf{X} \mathbf{Y} + (\mathbf{X}f)\mathbf{Y},\, f\in C^\infty (M)
$$
</MathBox>

Although the definition of a linear connection resembles the characterization of $\binom{2}{1}$-tensor fields given by the tensor characterization lemma, a linear connection is not a tensor field because it is not linear over $C^\infty (M)$ in $\mathbf{Y}$, but instead satisfies the Leibniz rule.

The directional derivative $\mathrm{D}_\mathbf{X}$ of a vector field $\mathbf{Y}$ on $\R^n$ is an affine connection on $\R^n$ called the *Euclidean connection* on $\R^n$.

### Christoffel symbols

<MathBox title='Christoffel symbols' boxType='proposition'>
Let $M$ be a smooth $n$-manifold and $\Set{\mathbf{E}_i}_{i=1}^n$ a local frame for $TM$ on an open subset $U\subset M$. In terms of this frame, an affine connection $\nabla$ on $M$ can be expanded as

$$
\begin{equation}
  \nabla_{E_i} \mathbf{E_j} = \Gamma_{ij}^k \mathbf{E}_k,\, \forall i, j=1,\dots,n \tag{\label{equation-1}}
\end{equation}
$$

The $n^3$ functions $\Gamma_{ij}^k$ on $U$ are called the *Christoffel symbols* of $\nabla$ with respect to this frame.
</MathBox>

<MathBox title='' boxType='lemma'>
Let $M$ be a smooth $n$-manifold, $\nabla$ an affine connection on $M$ and $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(M)$. If $\mathbf{X} = \sum_{i=1}^n X^i \mathbf{E}_i$ and $\mathbf{Y} = \sum_{j=1}^n Y^j \mathbf{E}_j$ for a local frame $\Set{\mathbf{E}_i}_{i=1}^n$ on $TM$, then

$$
\begin{equation}
  \nabla_\mathbf{X} \mathbf{Y} = \sum_{i,j,k=1}^n (\mathbf{X}Y^k + X^i Y^k \Gamma_{ij}^k) \mathbf{E}_k \tag{\label{equation-2}}
\end{equation}
$$

<details>
<summary>Proof</summary>

$$
\begin{align*}
  \nabla_\mathbf{X} \mathbf{Y} =& \nabla_\mathbf{X} \left(\sum_{j=1}^n Y^j \mathbf{E}_j \right) \\
  =& \sum_{j=1}^n (\mathbf{X}Y^j)\mathbf{E}_j + Y^j \nabla_{X^i \mathbf{E}_i} \mathbf{E}_j \\
  =& \sum_{i,j=1}^n (\mathbf{X}Y^j)\mathbf{E}_j + X^i Y^j \nabla_{\mathbf{E}_i} \mathbf{E}_j \\
  =& \sum_{i,j,k=1}^n \mathbf{X}Y^k \mathbf{E}_k + X^i Y^j \Gamma_{ij}^k \mathbf{E}_k \\
  =& \sum_{i,j,k=1}^n (\mathbf{X}Y^k + X^i Y^j \Gamma_{ij}^k) \mathbf{E}_k
\end{align*}
$$
</details>
</MathBox>

Let $\nabla$ be an affine connection on a smooth manifold $M$ and let $(U,(x^i)_{i=1}^n)$ be a coordinate open set in $M$. Then $\nabla_{\boldsymbol{\partial}_i} \partial/\partial x^j $ is a linear combination of $\left(\frac{\partial}{\partial x^i}\right)$, so there exist numbers $\Gamma_{ij}^k$ at each point such that

$$
  \nabla_{\boldsymbol{\partial}_i} = \sum_{k=1}^n \Gamma_{ij}^k \frac{\partial}{\partial x^k}
$$

where the $n^3$ functions $\Gamma_{ij}^k$ are the *Christoffel symbols* of the connection $\nabla$ on $U$. By the Leibniz rule and linearity over $C^\infty (M)$ in the first argument of a connection, the Christoffel symbols completely describe a connection on $U$.

### Torsion tensor

<MathBox title='Torsion of affine connections' boxType='definition'>
Let $\nabla$ be an affine connection on a smooth manifold $M$. The *torsion* of $\nabla$ is bilinear map $T:\mathfrak{X}(M)\times\mathfrak{X}(M)\to\mathfrak{X}(M)$ defined by

$$
  T(\mathbf{X},\mathbf{Y}) := \nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y}\mathbf{X} - [\mathbf{X},\mathbf{Y}]
$$

where $[\mathbf{X},\mathbf{Y}] = \mathbf{XY} - \mathbf{YX}$ is the Lie bracket.

A connection $\nabla$ is *torsion-free* if its torsion is zero.
</MathBox>

Since the Lie bracket is skew-symmetric, i.e. $[\mathbf{X},\mathbf{Y}] = -[\mathbf{Y},\mathbf{X}]$, it follows that the torsion is also skew-symmetric:

$$
\begin{align*}
  T(\mathbf{Y}, \mathbf{X}) =& \nabla_\mathbf{Y}\mathbf{X} - \nabla_\mathbf{X}\mathbf{Y} - [\mathbf{Y},\mathbf{X}] \\
  =& -(\nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y}\mathbf{X} - [\mathbf{X},\mathbf{Y}]) = -T(\mathbf{X}, \mathbf{Y})
\end{align*}
$$

<MathBox title='Coordinate representation of the torsion tensor' boxType='proposition'>
Let $\nabla$ be an affine connection on a smooth manifold $M$. The *torsion* $T:\mathfrak{X}(M)\times\mathfrak{X}(M)\to\mathfrak{X}(M)$ is a $\binom{1}{2}$-tensor field on $M$ given in local coordinates by

$$
  T = \sum_{i,j,k=1}^n (\Gamma_{ij}^k - \Gamma_{ji}^k)\;\mathrm{d}x^i \otimes \mathrm{d}x^j \otimes \frac{\partial}{\partial x^k}
$$

<details>
<summary>Proof</summary>

Recall from the properties of the Lie bracket that if $f,g\in C^\infty (M)$, then

$$
  [f\mathbf{X}, g\mathbf{Y}] = fg[\mathbf{X},\mathbf{Y}] + f(\mathbf{X}g)\mathbf{Y} - g(\mathbf{Y}f)\mathbf{X}
$$

By the tensor characterization lemma, we need to show that $T$ is linear over $C^\infty (M)$ in its arguments. For any $f \in C^\infty(M)$ applied on the first argument we have

$$
\begin{align*}
  T(f\mathbf{X}, \mathbf{Y}) =& \nabla_{f\mathbf{X}} \mathbf{Y} - \nabla_\mathbf{Y} (f\mathbf{X}) - [f\mathbf{X}, \mathbf{Y}] \\
  =& f\nabla_{\mathbf{X}} \mathbf{Y} - (f\nabla_\mathbf{Y} \mathbf{X} + \cancel{(\mathbf{Y} f)\mathbf{X}}) \\
  &- (f[\mathbf{X}, \mathbf{Y}] + (f\underbrace{\mathbf{X}(1)}_{=0})\mathbf{Y} - \cancel{(\mathbf{Y}f)\mathbf{X}}) \\
  =& f (\nabla_\mathbf{X} \mathbf{Y} - \nabla_\mathbf{Y} - [\mathbf{X}, \mathbf{Y}]) \\
  =& fT(\mathbf{X},\mathbf{Y})
\end{align*}
$$

and similarly for the second argument. Since both $\nabla$ and $[\cdot,\cdot]$ are linear over $\R$ in their arguments, it follows that $T$ is a tensor.

Since $T(\mathbf{X}, \mathbf{Y})$ is a smooth vector field, its action on a function $f\in C^\infty (M)$ is determined locally. That is, for any subset $U\subseteq M$ we $T(\mathbf{X},\mathbf{Y})f|_U = T(\mathbf{X},\mathbf{Y})(f|_U)$. Thus, it suffices to compute in single smooth chart $(U, (x^i)_{i=1}^n)$.

Recall that the coordinate formula for the Lie bracket is

$$
  [\mathbf{X}, \mathbf{Y}] = \sum_{i=1}^n (\mathbf{X}Y^i - \mathbf{Y}X^i)\frac{\partial}{\partial x^i}
$$

The torsion $T(\mathbf{X}, \mathbf{Y})$ has the following coordinate expression

$$
\begin{align*}
  T(\mathbf{X},\mathbf{Y})f =& \sum_{i,j,k=1}^n (\mathbf{X}Y^k + X^i Y^j \Gamma_{ij}^k) \frac{\partial f}{\partial x^k} \\
  &- (\mathbf{Y}X^k + Y^i X^j \Gamma_{ij}^k) \frac{\partial f}{\partial x^k} \\
  &- (\mathbf{X}Y^k - \mathbf{Y}X^k)\frac{\partial f}{\partial x^k} \\
  =& \sum_{i,j,k=1}^n (X^i Y^j \Gamma_{ij}^k - Y^i X^j \Gamma_{ij}^k)\frac{\partial f}{\partial x^k} \\
  =& \sum_{i,j,k=1}^n X^i Y^j (\Gamma_{ij}^k - \Gamma_{ji}^k)\frac{\partial f}{\partial x^k}
\end{align*}
$$

This shows that $T$ is a $\binom{1}{2}$-tensor field on $M$ written as

$$
  T = \sum_{i,j,k=1}^n (\Gamma_{ij}^k - \Gamma_{ji}^k)\;\mathrm{d}x^i \otimes \mathrm{d}x^j \otimes \frac{\partial}{\partial x^k}
$$

</details>
</MathBox>

<MathBox title='' boxType='proposition'>
An affine connection $\nabla$ on a manifold is torsion-free if and only if in every coordinate chart $(U,(x^i)_{i=1}^n)$ the Christoffel symbol $\Gamma_{ij}^k$ is symmetric in $i$ and $j$

$$
  \Gamma_{ij}^k = \Gamma_{ji}^k
$$

A torsion-free connection is also called a symmetric connection.

<details>
<summary>Proof</summary>

Let $(U,\Set{x^i}_{i=1}^n)$ be a coodinate open set. Since partial differentiation is independent of the order of differentiation

$$
  \left[\frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^i} \right] = 0
$$

By torsion-freeness

$$
  \nabla_{\boldsymbol{\partial}_i} \frac{\partial}{\partial x_j} - \nabla_{\boldsymbol{\partial}_j} \frac{\partial}{\partial x_i} =  \left[\frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^i} \right] = 0
$$

In terms of Christoffel symbols

$$
  \sum_{k=1}^n \Gamma_{ij}^k \frac{\partial}{\partial x^k} - \sum_{k=1}^n \Gamma_{ji}^k \frac{\partial}{\partial x^k} = 0
$$

Since $\Set{\frac{\partial}{\partial x^i}}_{i=1}^n$ are linearly independent at each point, $\Gamma_{ij}^k = \Gamma_{ji}^k$.

Conversely, suppose $\Gamma_{ij}^k = \Gamma_{ji}^k$ in the coordinate chart $(U,\Set{x^i}_{i=1}^n)$. Then,

$$
  T\left(\frac{\partial}{\partial x^i},\frac{\partial}{\partial x^i}\right) = \nabla_{\boldsymbol{\partial}_i} \frac{\partial}{\partial x_j} - \nabla_{\boldsymbol{\partial}_j} \frac{\partial}{\partial x_i} = 0
$$

Since $T$ is a bilinear function on $T_\mathbf{p}M$ for $\mathbf{p}\in M$, this proves that $T(\mathbf{X},\mathbf{Y})_\mathbf{p} := T(\mathbf{X}_\mathbf{p},\mathbf{Y}_\mathbf{p} = 0$ for all $\mathbf{X}_\mathbf{p},\mathbf{Y}_\mathbf{p}\in T_\mathbf{p}M$. Thus, for all $X,Y\in\mathfrak{X}(M)$, we have $T(\mathbf{X},\mathbf{Y}) = 0$.
</details>
</MathBox>

### Torsion and curvature

<MathBox title='Torsion and curvature of affine connections' boxType='definition'>
Let $\nabla$ be an affine connection on a smooth manifold $M$. The *torsion* of $\nabla$ is bilinear map $T:\mathfrak{X}(M)\times\mathfrak{X}(M)\to\mathfrak{X}(M)$ defined by

$$
  T(\mathbf{X},\mathbf{Y}) := \nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y} - [\mathbf{X},\mathbf{Y}]
$$

A connection $\nabla$ is *torsion-free* if its torsion is zero.

The *curvature* of $\nabla$ is a bilinear map $R:\mathfrak{X}(M)\times\mathfrak{X}(M)\to\operatorname{end}(\mathfrak{X}(M))$ defined by

$$
\begin{align*}
  R(\mathbf{X},\mathbf{Y}) =& [\nabla_\mathbf{X}, \nabla_\mathbf{Y}] - \nabla_{[\mathbf{X},\mathbf{Y}]} \\
  =& \nabla_\mathbf{X} \nabla_\mathbf{Y} - \nabla_\mathbf{Y} \nabla_\mathbf{X} - \nabla_{[\mathbf{X},\mathbf{Y}]}
\end{align*}
$$
</MathBox>

An affine connection $\nabla$ on a smooth manifold $M$ gives rise to a linear map $\mathfrak{X}(M)\to\operatorname{end}_\R (\mathfrak{X}(M))$ by $\mathbf{X}\mapsto\nabla_\mathbf{X}$. Here both vector spaces $\mathfrak{X}(M)$ and $\operatorname{end}_\R (\mathfrak{X}(M))$ are Lie algebras. The curvature measures the deviation of the map $\mathbf{X}\mapsto\nabla_\mathbf{X}$ from being a Lie algebra homomorphism.

<MathBox title='Torsion and curvature of affine connections' boxType='definition'>
Let $\mathcal{F} = C^\infty (M)$ be the ring of smooth functions on $M$. Suppose $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(M)$ are smooth vector fields on a smooth manifold $M$ with affine connection $\nabla$.
1. The torsion $T(\mathbf{X},\mathbf{Y})$ is $\mathcal{F}$-linear in $\mathbf{X}$ and $\mathbf{Y}$
2. The curvature $R(\mathbf{X},\mathbf{Y})\mathbf{Z}$ is $\mathcal{F}$-linear in $\mathbf{X}$, $\mathbf{Y}$ and $\mathbf{Z}$

<details>
<summary>Proof</summary>

**(2):** Recall from the properties of the Lie bracket that if $f,g\in \mathcal{F} = C^\infty (M)$, then

$$
  [f\mathbf{X}, g\mathbf{Y}] = fg[\mathbf{X},\mathbf{Y}] + f(\mathbf{X}g)\mathbf{Y} - g(\mathbf{Y}f)\mathbf{X}
$$

By the definition of curvature

$$
  R(f\mathbf{X},\mathbf{Y})\mathbf{Z} = \nabla_{f\mathbf{X}} \nabla_\mathbf{Y} \mathbf{Z} - \nabla_\mathbf{Y} \nabla_{f\mathbf{X}} \mathbf{Z} - \nabla_{[f\mathbf{X},\mathbf{Y}]}\mathbf{Z}
$$

By the $\mathcal{F}$-linearity of $\nabla$ in $\mathbf{X}$, the first term is $f\nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z}$, and by the Leibniz rule, the second term is

$$
  \nabla_\mathbf{Y} (f\nabla_\mathbf{X} \mathbf{Z}) = (\mathbf{Y}f)\nabla_\mathbf{X} \mathbf{Z} + f\nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{Z}
$$

The last term is

$$
\begin{align*}
  \nabla_{[f\mathbf{X},\mathbf{Y}]} \mathbf{Z} =& \nabla_{f[\mathbf{X},\mathbf{Y}] - (\mathbf{Y}f)x} \mathbf{Z} \\
  =& f\nabla_{[\mathbf{X},\mathbf{Y}]} \mathbf{Z} - (\mathbf{Y}f)\nabla_\mathbf{X} \mathbf{Z}
\end{align*}
$$

since $\mathbf{X}(1) = 0$. Combining the three terms gives

$$
\begin{align*}
  R(f\mathbf{X},\mathbf{Y})\mathbf{Z} =& f(\nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z} - \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{Z} - \nabla_{[\mathbf{X},\mathbf{Y}]} Z) \\
  =& fR(\mathbf{X},\mathbf{Y})\mathbf{Z}
\end{align*}
$$

Because $R(\mathbf{X},\mathbf{Y})$ is skew-symmetric in $\mathbf{X}$ and $\mathbf{Y}$, $\mathcal{F}$-linearity in $\mathbf{Y}$ follows from $\mathcal{F}$-linearity in the first argument

$$
  R(\mathbf{X},f\mathbf{Y}) = -R(f\mathbf{Y},\mathbf{X}) = -fR(\mathbf{Y},\mathbf{X}) = fR(\mathbf{X},\mathbf{Y})
$$
</details>
</MathBox>

## Existence of affine connections

<MathBox title='Affine connection in local coordinates' boxType='lemma'>
Suppose $M$ is a smooth $n$-manifold covered by a single coordinate chart $(U, (x^i)_{i=1}^n)$. There is an injective correspondence between linear connections on $M$ and choices of $n^3$ Christoffel symbols $\Gamma_{ij}^k$ on by the rule

$$
\begin{equation}
  \nabla_\mathbf{X} \mathbf{Y} = \left(X^i \frac{\partial Y^k}{\partial x^i} + X^i Y^j \Gamma_{ij}^k \right)\frac{\partial}{\partial x^k} \tag{\label{equation-3}}
\end{equation}
$$

<details>
<summary>Proof</summary>

Note that $\eqref{equation-3}$ is equivalent to $\eqref{equation-2}$ when $E_i = \partial/\partial x^i$ is a coordinate frame, so for every connection the Christoffel symbols $\Set{\Gamma_{ij}^k}$ defined by $\eqref{equation-1}$ satisfy $\eqref{equation-3}$. Moreover, given $\Set{\Gamma_{ij}^k}$, it is straightforward to check that $\eqref{equation-3}$ satisfy the affine connection properties.
</details>
</MathBox>

Note that a linear combination of affine connections is necessarilty a connection. Let $\nabla^0$ and $\nabla^1$ be two connections on a vector bundle $E$ over $M$. By the Leibniz rule, for any vector field $\mathbf{X}\in\mathfrak{X}(M)$, section $\mathbf{Y}\in\Gamma(E)$ and function $f\in C^\infty (M)$

$$
\begin{align*}
  \nabla_\mathbf{X}^0 (f\mathbf{Y}) =& (\mathbf{X}f)\mathbf{Y} + f\nabla_\mathbf{X}^0 \mathbf{Y} \\
  \nabla_\mathbf{X}^1 (f\mathbf{Y}) =& (\mathbf{X}f)\mathbf{Y} + f\nabla_\mathbf{X}^1 \mathbf{Y} 
\end{align*}
$$

Thus

$$
  (\nabla_\mathbf{X}^0 + \nabla_\mathbf{X}^1)(f\mathbf{Y}) = 2(\mathbf{X}f)\mathbf{Y} + f(\nabla_\mathbf{X}^0 + \nabla_\mathbf{X}^1)\mathbf{Y}
$$

Because of the extra factor of $2$ the sum of two connections does not satisfy the Leibniz rule and so is not a connection. However, if we multiply by $\nabla_\mathbf{X}^0 (f\mathbf{Y})$ by $1-t$ and $\nabla_\mathbf{X}^1 (f\mathbf{Y})$ by $t$, then $(1-t)\nabla_\mathbf{X}^0 + t\nabla_\mathbf{X}^1$ satisfies the Leibniz rule.

<MathBox title='' boxType='proposition'>
Any finite linear combination $\sum t_i \nabla^i$ of connections $\nabla^i$ is a connection provided that the coefficients add up to $1$, i.e. $\sum_i t_i = 1$. Such a linear combination is called *convex*.
</MathBox>

<MathBox title='Existence of connections on vector bundles' boxType='theorem'>
Every smooth vector bundle $E$ over a smooth manifold $M$ has an affine connection.

<details>
<summary>Proof</summary>

Fix a trivializing open cover $\Set{U_\alpha}$ for $E$ and a partition of unity $\Set{\rho_\alpha}$ subordinate to $\Set{U_\alpha}$. On each $U_\alpha$, the vector bundle $E|_{U_\alpha}$ is trivial and so has a connection $\nabla^\alpha$. For $\mathbf{X}\in\mathfrak{X}(M)$ and $\mathbf{Y}\in\Gamma(E)$, define

$$
  \nabla_\mathbf{X} \mathbf{Y} = \sum_\alpha \rho_\alpha \nabla_\mathbf{X}^\alpha \mathbf{Y}|_{U_\alpha}
$$

Although this looks like an infinite sum, it is in fact a finite sum in a neighbourhood of each point $\mathbf{p}\in M$, for by the local finiteness of $\Set{\operatorname{supp}(\rho_\alpha)}$, there is an open neighbourhood $U$ of $\mathbf{p}$ intersecting only finitely many of the sets $\operatorname{supp}(\rho_\alpha)$. This means that on $U$ all except finitely many of the $\rho_\alpha$ are zero and so $\sum_\alpha \rho_\alpha \nabla_\mathbf{X}^\alpha \mathbf{s}_\alpha$ is a finite sum on $U$ with $\sum_\alpha \rho_\alpha = 1$.

By checking the open set $U$, it is easy to show that $\nabla_\mathbf{X} \mathbf{s}$ is linear over $C^\infty (M)$ in $\mathbf{X}$, and linear over $\R$ in $\mathbf{Y}$. For $f\in C^\infty (M)$ we have

$$
\begin{align*}
  \nabla_\mathbf{X} (f\mathbf{Y}) =& \sum_\alpha \rho_\alpha \nabla_\mathbf{X}^\alpha (f\mathbf{Y}) \\
  =& \sum_\alpha \rho_\alpha ((\mathbf{X}f)\mathbf{Y} + f\nabla_\mathbf{X}^\alpha \mathbf{Y}) \\
  =& (\mathbf{X}f)\mathbf{Y} + f\sum_\alpha \rho_\alpha \nabla_\mathbf{X}^\alpha \mathbf{Y} \\
  =& (\mathbf{X}f)\mathbf{Y} + f\nabla_\mathbf{X} \mathbf{Y}
\end{align*}
$$
</details>
</MathBox>

## Covariant derivative of tensor fields

A connection $\nabla$ on the tangent bundle $TM$ of a smooth manifold $M$ induces a covariant derivative on all tensor fields.

<MathBox title='Covariant derivative on covariant bundles' boxType='proposition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$ and let $\mathbf{X}\in\mathfrak{X}(M)$ be a smooth vector field on $M$. If $\omega\in \Lambda^1 (M)$ is a smooth $1$-form then $\nabla_\mathbf{X} \omega$ defined by

$$
\begin{equation}
  (\nabla_\mathbf{x}\omega)(\mathbf{Y}) := \mathbf{X}(\omega(\mathbf{Y})) - \omega(\nabla_\mathbf{X}\mathbf{Y}) \tag{\label{equation-6}}
\end{equation}
$$

is a smooth $1$-form on $M$.

<details>
<summary>Proof</summary>

By the tensor criterion it suffices to that $\nabla_\mathbf{X} \omega$ is linear over $C^\infty (M)$ in $\mathbf{Y}$. From $\eqref{equation-6}$ and the Leibniz rule of $\nabla$ in $\mathbf{Y}$, we have for $f\in C^\infty (M)$

$$
\begin{align*}
  (\nabla_\mathbf{X} \omega)(f\mathbf{Y}) =& \mathbf{X}(f\omega(\mathbf{Y})) - \omega(\nabla_\mathbf{X} f\mathbf{Y}) \\
  =& (\mathbf{X}f)\omega(\mathbf{Y}) + f\mathbf{X}(\omega(\mathbf{Y})) - \omega((\mathbf{X}f)\mathbf{Y}) - f\omega(\nabla_\mathbf{X}\mathbf{Y}) \\
  =& f(\nabla_\mathbf{X} \omega)(\mathbf{Y})
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Covariant derivative on covariant bundles in local coordinates' boxType='proposition'>
Let $M$ be a smooth $n$-manifold with a connection $\nabla$. If $\omega\in\Lambda^1 (M)$ is a $1$-form and $\mathbf{X}\in\mathfrak{X}(M)$ is a vector field, then on a chart $(U, (x^i)_{i=1}^n)$

$$
  \nabla_\mathbf{X}\omega = \left(X^i \frac{\partial\omega_k}{\partial x^i} - X^i \omega_j \Gamma_{ik}^j \right)\;\mathrm{d}x^k
$$
</MathBox>

Let $\nabla$ be an affine connection on a smooth manifold $M$. There is a unique connection in each tensor bundle $\mathcal{T}_q^p M$, also denoted $\nabla$. In particular
- On $\mathcal{T}^1_0 (M) = TM$, $\nabla$ agrees with the given affine connection
- On $\mathcal{T}_0^0 (M) = M$, $\nabla$ is given by ordinary differentiation of functions
$$
  \nabla_\mathbf{X} f = X\mathbf{f},\; \mathbf{X}\in\mathfrak{X}(M),\, f\in C^\infty (M)
$$

<MathBox title='Covariant derivative of tensor fields' boxType='proposition' tag='proposition-6'>
Let $M$ be a smooth $n$-manifold with a connection $\nabla$. If $\mathbf{X}\in\mathfrak{X}(M)$ is a smooth vector field on $M$ and $F \in \mathcal{T}_q^p (M)$ is a smooth $\binom{p}{q}$-tensor field on $M$, then $\nabla_\mathbf{X} F$ defined by

$$
\begin{equation}
\begin{split}
  (\nabla_\mathbf{X}F)&(\omega^1,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  :=& \mathbf{X}(F(\omega_1,\dots,\omega^q,\mathbf{Y}_1),\dots,\mathbf{Y}_p) \\
  &- \sum_{i=1}^p F(\omega_1,\dots,\nabla_\mathbf{X} \omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  &- \sum_{j=1}^q F(\omega_1,\dots,\omega^q,\mathbf{Y}_1,\dots,\nabla_\mathbf{X} \mathbf{Y}_j,\dots,\mathbf{Y}_p)
\end{split}\tag{\label{equation-7}}
\end{equation}
$$

for $\omega_i\in\Lambda^1 (M)$, $\mathbf{Y}_j\in\mathfrak{X}(M)$, is a smooth $\binom{p}{q}$-tensor field on $M$.

<details>
<summary>Proof</summary>

By the tensor criterion, it suffices to check that and $\nabla_\mathbf{X} F$ is linear over $C^\infty (M)$ in its arguments. Applying $f\in C^\infty (M)$ on $\omega_i$ in the definition of $\nabla_\mathbf{X}$ F, the first term on the right side of $\eqref{equation-7}$ becomes

$$
\begin{equation}
\begin{split}
  &\mathbf{X}(F(\omega_1,\dots,f\omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p)) \\
  =& (\mathbf{X}f)F(\omega_1,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  &+ f\mathbf{X}(F(\omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p))
\end{split}\tag{equation-8}
\begin{equation}
$$

and the $i$-term contravariant term becomes

$$
\begin{equation}
\begin{split}
  &F(\omega_1,\dots,\nabla_\mathbf{X} f\omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  =& F(\omega_1,\dots,(\mathbf{X}f)\omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  &+ fF(\omega_1,\dots,\nabla_\mathbf{X} \omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  =& (\mathbf{X}f)F(\omega_1,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p) \\
  &+ fF(\omega_1,\dots,\nabla_\mathbf{X} \omega_i,\dots,\omega^q,\mathbf{Y}_1,\dots,\mathbf{Y}_p)
\end{split}\tag{equation-9}
\end{equation}
$$

The first terms of $\eqref{equation-8}$ and $\eqref{equation-9}$ cancel out, while all the remaining terms are linear over $C^\infty (M)$ in the $i$th argument.

Similary, the right-hand side of $\eqref{equation-7}$ is linear over $C^\infty (M)$ in the argument $\mathbf{Y}_j$.
</details>
</MathBox>

<MathBox title='Covariant derivative of tensor products' boxType='proposition'>
Let $M$ be a smooth manifold and let $\mathcal{T}_q^p (M)$ be the bundle of $\binom{p}{q}$-tensors on $M$. Suppose $\nabla$ is a connection on M and $\mathbf{X}\in\mathfrak{X}(M)$ is a smooth vector field on $M$. The covariant derivative 

$$
  \nabla_\mathbf{X}: \Gamma\left(\bigoplus_{p,q=0}^\infty \mathcal{T}_q^p (M)\right) \to \Gamma\left(\bigoplus_{p,q=0}^\infty \mathcal{T}_q^p (M)\right)
$$

satisfies the following product rule for any two tensor fields $T_1, T_2$

$$
  \nabla_\mathbf{X} (T_1 \otimes T_2) = (\nabla_\mathbf{X} T_1) \otimes T_2 + T_1 \otimes \nabla_\mathbf{X} T_2
$$
</MathBox>

### Total covariant derivative of tensor fields

<MathBox title='Total covariant derivative of tensor fields' boxType='proposition'>
If $\nabla$ is an affine connection on a smooth manifold $M$, and $F\in\mathcal{T}_q^p (M)$ is a $\binom{p}{q}$-tensor field on $M$, the map

$$
  \nabla F: \left(\prod_{i=1}^q \Lambda^1 (M)\right) \times \left(\prod_{j=1}^{p+1} \mathfrak{X}(M) \right) \to C^\infty (M)
$$

given by

$$
  \nabla F(\omega^1,\dots,\omega^q, \mathbf{Y}_1,\dots,\mathbf{Y}_p, \mathbf{X}) = \nabla_\mathbf{X} F(\omega^1,\dots,\omega^q, \mathbf{Y}_1,\dots,\mathbf{Y}_p)
$$

defines a $\binom{p+1}{q}$-tensor field called the *total covariant derivative* of $F$.

<details>
<summary>Proof</summary>

This follows immediately from the tensor characterization lemma. By proposition $\ref{proposition-6}$, $\nabla_\mathbf{X} F$ is a tensor field, so it is multilinear over $C^\infty (M)$ in its $p + q$ arguments. Additionally, it is linear over $C^\infty (M)$ in $\mathbf{X}$ by definition of a connection.
</details>
</MathBox>

Let $f\in C^\infty (M)$ be a smooth function on a smooth manifold $M$. Then the total covariant derivative $\nabla f \in \mathcal{T}^1 (M) = \Lambda^1$ is just the $1$-form $\mathrm{d}f$, because both tensors have the same action on vectors

$$
  \langle\nabla f, \mathbf{X}\rangle = \nabla_\mathbf{X} f = \mathbf{X}f = \langle \mathrm{d}f, \mathbf{X}\rangle,\; \mathbf{X}\in\mathfrak{X}(M)
$$

The $2$-tensor $\nabla^2 f = \nabla(\nabla f)$ is called the covariant Hessian of $f$.

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold. Then for any $f\in C^\infty (M)$ and $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, the covariant Hessian $\nabla^2 f : \mathfrak{X}(M) \times \mathfrak{X}(M) \to C^\infty (M)$ is given by

$$
  \nabla^2 f(\mathbf{X},\mathbf{Y}) = \mathbf{Y}(\mathbf{X}f) - (\nabla_\mathbf{Y} \mathbf{X})f
$$
</MathBox>

When we write the components of a total covariant derivative in terms of coordinates, we use a semicolon to separate indices resulting from differentiation from the preceding indices. For example, if $\mathbf{Y} = Y^i \boldsymbol{\partial}_i$ is a vector field, the components of the $\binom{1}{1}$-vector field $\nabla\mathbf{Y}$ are written ${Y^i}_{;j}$, so that

$$
  \nabla \mathbf{Y} = {Y^i}_{;j} \frac{\partial}{\partial x^i} \otimes \mathrm{d}x^j
$$

with

$$
  {Y^i}_{;j} = \frac{\partial Y^i}{\partial x^j} + Y^k \Gamma_{jk}^i
$$

<MathBox title='' boxType='proposition'>
Let $\nabla$ be an affine connection on a smooth $n$-manifold $M$. The components of the total covariant derivative of a $\binom{p}{q}$-tensor field $F$ with respect to a chart $(U,(x^i)_{i=1}^n)$ are given by

$$
  F_{i_1 \dots i_p;m}^{j_1 \dots j_q} = \boldsymbol{\partial}_m  F_{i_1 \dots i_p}^{j_1\dots j_q} + \sum_{s=1}^q  F_{i_1 \dots i_p}^{j_1 \dots k \dots j_q} \Gamma_{mk}^{j_s} - \sum_{s=1}^p  F_{i_1 \dots k \dots i_p}^{j_1 \dots j_q} \Gamma_{mi_s}^k
$$
</MathBox>

## Covariant derivative along a curve

<MathBox title='Smooth curve in a manifold' boxType='definition'>
A *smooth curve* in smooth a manifold $M$ is a smooth map $\gamma: I\subseteq\R \to M$ where the interval $I$ can be both open and closed. A *curve segment* is a curve whose domain is a closed, bounded interval $[a,b]\subset\R$ 

The *velocity* of $\gamma$ at $t_0 \in I$ is defined as the tangent vector

$$
  \gamma'(t_0) := \mathrm{d}\gamma\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) \in T_{\gamma(t_0)}M
$$

where $\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0}$ is the standard coordinate basis vector in $T_{t_0}\R$. This tangent vector acts on functions by

$$
\begin{align*}
  \gamma' (t_0)f =& \mathrm{d}\gamma\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) = \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} (f\circ\gamma) \\
  =& (f\circ\gamma)'(t_0)
\end{align*}
$$
</MathBox>

<MathBox title='Vector field along a curve' boxType='definition'>
Let $M$ be a smooth manifold. A *vector field along a curve* $\gamma: I\subset\R \to M$ is a smooth map 

$$
  V: I \to\bigsqcup_{t\in I} T_{\gamma(t)} M
$$

such that $\mathbf{V}(t) \in T_{\gamma(t)}M$ for every $t\in I$. Such a vector field $\mathbf{V}(t)$ is smooth if for any smooth function $f:M\to\R$ on $M$, the composition $\mathbf{V}(t)f$ is smooth as a function of $t$. The vector space of all smooth vector fields along the curve $\gamma$ is denoted $\Gamma(TM|_{\gamma(t)})$.
</MathBox>

For a smooth vector field $\mathbf{V}(t) = \sum_{i=1}^n v^i(t) \frac{\partial}{\partial x^i}$ along a smooth curve $\gamma: I\to\R^n$ in $\R^n$, the derivative $\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t} = \sum_{i=1}^n \dot{v}^i (t) \frac{\partial}{\partial x^i}$ satisfies the following properties
1. $\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}$ is linear over $\R$ in $\mathbf{V}$
2. **Leibniz rule:** for any smooth function $f$ on $[a,b]$
$$
  \frac{\mathrm{d}(f\mathbf{V})}{\mathrm{d}t} = \frac{\mathrm{d}f}{\mathrm{d}t}\mathbf{V} + f\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}
$$
3. if $\mathbf{V}$ is induced from a smooth vector field $\tilde{\mathbf{V}}$ on $\R^n$, in the sense that $\mathbf{V}(t) = \tilde{\mathbf{V}}_{c(t)}$ and $\mathrm{D}$ is the directional derivative in $\R^n$, then
$$
  \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t} = \mathrm{D}_{c'(t)}\tilde{\mathbf{V}}
$$

It turns out that to every connection $\nabla$ on a manifold $M$ one can associate a way of differentiating vector fields along a curve having the same properties as $\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}$.

<MathBox title='Covariant derivative of vector fields along curves' boxType='proposition' tag='proposition-11'>
Let $M$ be a smooth $n$-manifold with an affine connection $\nabla$. For each smooth curve $\gamma: I\subset\R\to M$, $\nabla$ determines a unique map

$$
  \mathrm{D}_t := \frac{\mathrm{D}}{\mathrm{d}t}: \Gamma(TM|_{\gamma(t)})\to\Gamma(TM|_{\gamma(t)})
$$

with the following properties
1. **Linearity over $\R$:** for any $\mathbf{V},\mathbf{W}\in\Gamma(TM|_{\gamma(t)})$ and $a,b\in\R$ 
$$
  \frac{\mathrm{D}}{\mathrm{d}t} (a\mathbf{V} + b\mathbf{W}) = a\frac{\mathbf{D}\mathbf{V}}{\mathrm{d}t} + b\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t}
$$
2. **Leibniz rule:** for any smooth function $f\in C^\infty (I)$
$$
  \frac{\mathrm{D}(f\mathbf{V})}{\mathrm{d}t} = \frac{\mathrm{d}f}{\mathrm{d}t}\mathbf{V} + f\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}
$$
3. **Compatibility with the connection:** if $\mathbf{V}$ is induced from a smooth vector field $\tilde{\mathbf{V}}$ on $M$, in the sense that $\mathbf{V}(t) = \tilde{\mathbf{V}}_{\gamma(t)}$, then
$$
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}(t) = \nabla_{\gamma'(t)} \tilde{\mathbf{V}} 
$$

For any $\mathbf{V}\in\Gamma(TM|_{\gamma(t)})$, we call $\mathrm{D}_t \mathbf{V}$ the *covariant derivative* (associated to $\nabla$) of the vector field $\mathbf{V}$ along the curve $c$ in $M$.

<details>
<summary>Proof</summary>

To prove uniqueness, suppose such a covariant derivative $\mathrm{D}_t$ exists and let $t_0 \in I$ be arbitrary. For any $\mathbf{V}\in\Gamma(TM|_{\gamma(t)})$, an argument similar to lemma $\ref{lemma-1}$ shows that the value of $\mathrm{D}_t \mathbf{V}$ at $t_0$ depends only on the values of $\mathbf{V}$ in any interval $(t_0 - \varepsilon, t_0 + \varepsilon)$ containing $t_0$. In a chart $(U, (x^i)_{i=1}^n)$ containing $\gamma(t_0)$, the vector field $\mathbf{V}$ along $\gamma$ can written as a linear combination

$$
  \mathbf{V}(t) = \sum_{i=1}^n V^i (t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}
$$

Then, by the properties of $\mathrm{D}_t$ and since $\boldsymbol{\partial}_i$ is extendible

$$
\begin{equation}
\begin{split}
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}(t_0) =& \sum_{i=1}^n \frac{\mathrm{D}}{\mathrm{d}t} \left(V^i(t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)}\right) \\
  =& \sum_{i=1}^n \frac{\mathrm{d}V^i}{\mathrm{d}t}(t_0) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)} + V^i(t_0) \frac{\mathrm{D}}{\mathrm{d}t}\left(\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)} \right) \\
  =& \sum_{i=1}^n \dot{V}^i(t_0) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)} + V^i(t_0) \nabla_{\gamma'(t_0)} \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)} \\
  =& \sum_{i,j,k=1}^n \left(\dot{V}^k(t_0) + V^j(t_0) \dot{\gamma}^i(t_0) \Gamma_{ij}^k (\gamma(t_0)) \right)\left.\frac{\partial}{\partial x^k}\right|_{\gamma(t_0)}
\end{split}\tag{\label{equation-4}}
\end{equation}
$$

This shows that $\mathrm{D}_t$ is unique if it exists.

For existence, if $\gamma(I)$ is contained in a single chart, we define $\mathrm{D}_t \mathbf{V}$ by $\eqref{equation-4}$. It is easily verified that $\mathrm{D}_t \mathbf{V}$ satisfiess the requisite properties. In the general case, we can cover $\gamma(I)$ with coordinate charts and define $\mathrm{D}_t \mathbf{V}$ by $\eqref{equation-4}$ in each chart, and uniqueness implies the various definitions agree whenever two or more charts overlap.
</details>
</MathBox>

<MathBox title='' boxType='theorem'>
Let $M$ be a Riemannian $n$-manifold, $\nabla$ an affine connection on $M$, and $\gamma:I\subset\R\to M$ a smooth curve in $M$. If $\nabla$ is metric compatible, then for any smooth vector fields $\mathbf{V},\mathbf{W}$ along $\gamma$

$$
  \frac{\mathrm{d}}{\mathrm{d}t}\langle V,\mathbf{W}\rangle = \left\langle \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t},\mathbf{W} \right\rangle + \left\langle V,\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t} \right\rangle
$$

<details>
<summary>Proof</summary>

It suffices to check this equality locally, so let $U$ be an open set on which an orthonormal frame $\Set{\mathbf{E}_i}_{i=1}^n$ exist. With respect to this frame

$$
\begin{align*}
  V =& \sum_{i=1}^n v^i (t)\mathbf{E}_{i,\gamma(t)} \\
  W =& \sum_{j=1}^n w^i (t)\mathbf{E}_{j,\gamma(t)}
\end{align*}
$$

for some $C^\infty$ functions $v^i, w^j$ on $[a,b]$. Then

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d}t}\langle V,\mathbf{W}\rangle =& \frac{\mathrm{d}}{\mathrm{d}t}\sum_{i,j=1}^n v^i w^j \\
  =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}w^i + \sum_{i=1}^n v^i \frac{\mathrm{d}w^i}{\mathrm{d}t}
\end{align*}
$$

By the defining properties of a covariant derivative

$$
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}\mathbf{E}_{i,\gamma(t)} + v^i \frac{\mathrm{D}\mathbf{E}_{i,\gamma(t)}}{\mathrm{d}t} \\
  =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}\mathbf{E}_{i,\gamma(t)} + v^i \nabla_{c'(t)}\mathbf{E}_{i,\gamma(t)}
$$

Similarly,

$$
  \frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t} =& \sum_{j=1}^n \frac{\mathrm{d}w^j}{\mathrm{d}t}\mathbf{E}_{j,\gamma(t)} + \sum_{j=1}^n \nabla_{c'(t)}\mathbf{E}_{j,\gamma(t)}
$$

Thus

$$
\begin{align*}
  \left\langle \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t},\mathbf{W} \right\rangle + \left\langle V,\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t} \right\rangle =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}w^i + \sum_{i,j=1}^n v^i w^j \langle \nabla_{c'(t)}\mathbf{E}_{i,\gamma(t)}, \mathbf{E}_{j,\gamma(t)}\rangle \\
  &+ \sum_{i=1}^n v^i \frac{\mathrm{d}w^i}{\mathrm{d}t} + \sum_{i,j=1}^n v^i w^j \langle \mathbf{E}_{i,\gamma(t)},\nabla_{c'(t)}\mathbf{E}_{j,\gamma(t)}\rangle 
\end{align*}
$$

Since $\Set{\mathbf{E}_i}_{i=1}^n$ are orthonormal vector fields on $U$ and $\nabla$ is metric compatible

$$
  \langle \nabla_{c'(t)}\mathbf{E}_{i,\gamma(t)}, \mathbf{E}_{j,\gamma(t)}\rangle + \langle \mathbf{E}_{i,\gamma(t)},\nabla_{c'(t)}\mathbf{E}_{j,\gamma(t)}\rangle = c'(t)\langle\mathbf{E}_i,\mathbf{E}_j \rangle = c'(t)\delta_{ij} = 0
$$

Hence

$$
\begin{align*}
  \left\langle \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t},\mathbf{W} \right\rangle + \left\langle V,\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t} \right\rangle =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}w^i + \sum_{i=1}^n v^i \frac{\mathrm{d}w^i}{\mathrm{d}t}\mathbf{E}_{j,\gamma(t)} \\
  =& \frac{\mathrm{d}}{\mathrm{d}t}\langle V,\mathbf{W}\rangle
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='example'>
If $\nabla$ is the directional derivative on $\R^n$ and $\mathbf{V}(t) = \sum_{i=1} V^i (t) \frac{\partial}{\partial x^i}$ is a vector field along a smooth curve $\gamma(t)$ in $\R^n$, then the covariant derivative is

$$
\begin{align*}
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} =& \sum_{i=1}^n \frac{\mathrm{d}V^i}{\mathrm{d}t}\frac{\partial}{\partial x^i} + \sum_{i=1}^n V^i \mathrm{D}_{\gamma'(t)} \frac{\partial}{\partial x^i} \\
  =& \sum_{i=1} \frac{\mathrm{d}V^i}{\mathrm{d}t}\frac{\partial}{\partial x^i} = \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}
\end{align*}
$$

Since $\mathrm{D}_{\gamma'(t)}\frac{\partial}{\partial x^i} = 0$.
</MathBox>

### Connection-preserving diffeomorphisms

Although it is in general not possible to push forward a vector field except under a diffeomorphism, it is always possible to push forward a vector field along a curve under any smooth map. Let $f:M\to\tilde{M}$ be a smooth map (not necessarily a diffeomorphism) of manifolds, and $c:[a,b]\to M$ be a smooth curve in $M$. The *pushforward* of the vector fields $\mathbf{V}(t)$ along $c$ in $M$ is the vector field $(\mathrm{d}F \mathbf{V})(t)$ along the image curve $f\circ c$ in $\tilde{M}$ defined by

$$
  (\mathrm{d}F \mathbf{V})(t) = \mathrm{d}F_{\gamma(t)}(\mathbf{V}(t))
$$

Denote by $(M,\nabla)$ a smooth manifold with an affine connection $\nabla$. A smooth diffeomorphism $F:(M,\nabla)\to(\tilde{M},\tilde{\nabla})$ *preserves the connection* if for all $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$,

$$
  \mathrm{d}F (\nabla_\mathbf{X} \mathbf{Y}) = \tilde{\nabla}_{\mathrm{d}F \mathbf{X}} \mathrm{d}F \mathbf{Y}
$$

In this terminology, an isometry of Riemannian manifolds preserves the Riemannian connection.

<MathBox title='' boxType='proposition'>
Suppose $F:(M,\nabla)\to(\tilde{M},\tilde{\nabla})$ is a connection-preserving diffeomorphism, $\gamma(t)$ a smooth curve in $M$, and $\frac{\mathrm{D}}{\mathrm{d}t}$, $\frac{\tilde{\mathrm{D}}}{\mathrm{d}t}$ the covariant derivatives along $\gamma$ in $M$ and $f\circ\gamma$ in $\tilde{M}$, respectively. If $\mathbf{V}(t)$ is a vector field along $\gamma$ in $M$, then

$$
  \mathrm{d}F \left(\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}\right) = \frac{\tilde{\mathrm{D}}(\mathrm{d}F (\mathbf{V}))}{\mathrm{d}t}
$$

<details>
<summary>Proof</summary>

Choose a neighbourhood $U$ of $\gamma(t)$ on which there is a frame $\Set{\mathbf{e}_i}_{i=1}^n$ and write $\mathbf{V}(t) = \sum_{i=1}^n V^i (t)\mathbf{E}_{i,\gamma(t)}$. Then $\tilde{\mathbf{e}}_i := \mathrm{d}F \mathbf{E}_i$ for $i=1,\dots,n$ is a frame on the neighbourhood $F(U)$ of $F(\gamma(t))$ in $\tilde{M}$ and

$$
  (\mathrm{d}F \mathbf{V})(t) = \sum_{i=1}^n V^i (t)\tilde{\mathbf{E}}_{i,(F\circ\gamma)(t)}
$$

By definition of the covariant derivative

$$
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}(t) = \sum_{i=1}^n \frac{\mathrm{d}V^i}{\mathrm{d}t}(t)\mathbf{e}_{i,\gamma(t)} + V^i (t)\nabla_{\gamma'(t)}\mathbf{e}_i
$$

Because $F$ preserves the connection

$$
\begin{align*}
  \left( \mathrm{d}F \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} \right)(t) =& \sum_{i=1}^n \frac{\mathrm{d}V^i}{\mathrm{d}t} \mathrm{d}F_{\gamma(t)}(\mathbf{e}_{i,\gamma(t)}) + V^i(t) \tilde{\nabla}_{\mathrm{d}F \gamma'(t)} \mathrm{d}F \mathbf{e}_i \\
  =& \sum_{i=1}^n \frac{\mathrm{d}V^i}{\mathrm{d}t}\tilde{\mathbf{e}}_{i,(F\circ\gamma)(t)} + V^i (t) \tilde{\nabla}_{(F\circ\gamma)'(t)} \tilde{\mathbf{e}}_i \\
  =& \left(\frac{\tilde{D}}{\mathrm{d}t} \mathrm{d}F \mathbf{V} \right)(t)
\end{align*}
$$
</details>
</MathBox>

## Connections on a vector bundle

<MathBox title='Induced connection on a trivial bundle' boxType='example'>
Let $E$ be a trivial bundle of rank $r$ over a smooth manifold $M$. There is a bundle isomorphism $\phi:E\to M\times\R^r$, called a *trivialization* for $E$ over $M$. The trivialization $\phi: E \xrightarrow{\sim} M\times\R^r$ induces a connection on $E$ as follows. If $\Set{\mathbf{v}_i}_{i=1}^r$ is a basis for $\R^r$, then $s_i: p\mapsto (\mathbf{p},\mathbf{v}_i)$ for $i=1,\dots,r$ define a global frame fro the product bundle $M\times\R^r$ over $M$, and $\mathbf{e}_i = \phi^{-1} \circ s_i$ define a global frame for $E$ over $M$. Every section $\mathbf{s}\in\Gamma(E)$ can be written uniquely as a linear combination

$$
  \mathbf{s} = \sum_{i=1}^r h^i \mathbf{e}_i,\; h^i \in\mathcal{F} = C^\infty
$$

We can define a connection $\nabla$ on $E$ by declaring the sections $\mathbf{e}_i$ to be flat and applying the Leibniz rule and $\R$-linearity to define the connection

$$
  \nabla_\mathbf{X} \mathbf{s} = \nabla_\mathbf{X} \left(\sum_{i=1}^r h^i \mathbf{e}_i \right) = \sum_{i=1}^r (Xh^i)\mathbf{e}_i
$$

The connection $\nabla$ on a trivial bundle induced by a trivialization depends on the trivialization, for the flat section for $\nabla$ are presicely the section of $E$ corresponding to the constant sections of $M\times\R^r$ under the trivialization.
</MathBox>

## Directional derivatives in Euclidean space

Suppose $\mathbf{X_p} = \sum_{i=1}^n a^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}$ is a tangent vector at point $\mathbf{p}\in\R^n$ and $f:\R^n \to\R$ is a smooth function defined in a neighbourhood of $\mathbf{p}$. The *directional derivative* of $f$ at $\mathbf{p}$ along $\mathbf{X_p}$, denoted $\mathrm{D}_{\mathbf{X_p}} f$ is

$$
\begin{align*}
  \mathrm{D}_{\mathbf{X_p}} f =& \lim_{t\to 0} \frac{f(\mathbf{p} + t\mathbf{a}) - f(\mathbf{p})}{t} = \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(\mathbf{p} + t\mathbf{a}) \\
  =& \sum_{i=1}^n \left.\frac{\partial f}{\partial x^i}\right|_{\mathbf{p}} \cdot \left.\frac{\mathrm{d}x^i}{\mathrm{d} t}\right|_{t=0} = \sum_{i=1}^n \left.\frac{\partial f}{\partial x^i}\right|_{\mathbf{p}} \cdot a^i \\
  =& \left( \sum_{i=1}^n a^i \left.\frac{\partial}{\partial x^i}\right|_{\mathbf{p}} \right)f = \mathbf{X_p} f
\end{align*}
$$

We can in fact use any curve $c(t)$ with initial point $c(0) = \mathbf{p}$ and initial vector $c'(0) = \mathbf{X_p}$ to compute the directional derivative of $f$ at $\mathbf{p}$

$$
\begin{align*}
  \mathrm{D}_{\mathbf{X_p}} f =& \mathbf{X_p} f = c'(0) f \\
  =& c_* \left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0}\right) f \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(c(t))
\end{align*}
$$

The directional derivative at $\mathbf{p}$ of a smooth vector field $\mathbf{Y} = \sum_{i=1}^n b^i \frac{\partial}{\partial x^i}$ in $\R^n$ along $\mathbf{X_p}$ is

$$
  \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} = \sum_{i=1}^n (\mathbf{X_p} b^i) \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}
$$

This shows that $\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}$ is $\R$-linear in $\mathbf{X_p}$.

When $\mathbf{X}$ is a smooth vector field on $\R^n$, we define the vector field $\mathrm{D}_\mathbf{X} \mathbf{Y}$ on $\R^n$ by

$$
  (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathbf{p} = \mathrm{D}_{\mathbf{X_p}} \mathbf{Y},\; \forall \mathbf{p}\in\R^n
$$

If $\mathbf{X}$ and $\mathbf{Y}$ are smooth vector fields on $\R^n$, then so is $\mathrm{D}_\mathbf{X} \mathbf{Y}$. Let $\mathfrak{\R^n}$ be the vector space of all smooth vector fields on $\R^n$. The directional derivative in $\R^n$ gives a bilinear map

$$
  \mathrm{D}: \mathfrak{X}(\R^n)\times\mathfrak{X}(\R^n)\to\mathfrak{X}(\R^n)
$$

which we write as $\mathrm{D}_\mathbf{X} \mathbf{Y}$ instead of $\mathrm{D}(\mathbf{X},\mathbf{Y})$. Let $\mathcal{F} = C^\infty(\R^n)$ be the ring of smooth functions on $\R^n$. Then $\mathfrak{X}(\R^n)$ is both a vector space over $\R$ and a module over $\mathcal{F}$.

<MathBox title='Properties of the directional derivative of smooth vector fields' boxType='proposition'>
Let $\mathcal{F} = C^\infty(\R^n)$ be the ring of smooth functions on $\R^n$. For smooth vector fields $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(\R^n)$, the directional derivative $\mathrm{D}_\mathbf{X} \mathbf{Y}$ satisfies the following properties
1. $\mathrm{D}_\mathbf{X} \mathbf{Y}$ is $\mathcal{F}$-linear in $\mathbf{X}$ and $\R$-linear in $\mathbf{Y}$
2. **Leibniz rule:** if $f$ is a smooth function on $\R^n$, then
$$
  \mathrm{D}_\mathbf{X} (f\mathbf{Y}) = (\mathbf{X}f)\mathbf{Y} + f\mathrm{D}_\mathbf{X} \mathbf{Y}
$$

<details>
<summary>Proof</summary>

**(1):** Let $f$ be a smooth function on $\R^n$ and $\mathbf{p}$ an arbitrary point on $\R^n$. Then

$$
\begin{align*}
  (\mathrm{D}_{f\mathbf{X}} \mathbf{Y})_\mathbf{p} =& \mathbf{D}_{f(\mathbf{p})\mathbf{X_p}} \mathbf{Y} \\
  =& f(\mathbf{p})\mathrm{D}_{\mathbf{X_p}} \mathbf{Y} \\
  =& (f\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathbf{p}
\end{align*}
$$

For $\mathbf{Z}\in\mathfrak{X}(\R^n)$, we have

$$
  (\mathrm{D}_{\mathbf{X} + \mathbf{Z}} \mathbf{Y})_\mathbf{p} = \mathrm{D}_{\mathbf{X_p}} + \mathbf{Z}_\mathbf{p} \mathbf{Y} = \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} + \mathrm{D}_{\mathbf{Z}_\mathbf{p}} \mathbf{Y} = (\mathrm{D}_\mathbf{X} + \mathrm{D}_\mathbf{Z})_\mathbf{p} 
$$

This proves that $\mathrm{D}_\mathbf{X} \mathbf{Y}$ is $\mathcal{F}$-linear in $\mathbf{X}$. The $\R$-linearity is clear from the directional derivative formula of $\mathbf{Y} = \sum_{i=1}^n b^i \frac{\partial}{\partial x^i}$ along $\mathbf{X_p}$

$$
  \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} = \sum_{i=1}^n (\mathbf{X_p} b^i) \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}
$$

**(2):** Suppose $\mathbf{Y} = \sum_{i=1}^n b^i \frac{\partial}{\partial x^i}$ where $b^i \in C^infty (\R^n)$. Then

$$
\begin{align*}
  (\mathrm{D}_\mathbf{X} (f\mathbf{Y}))_\mathbf{p} =& \sum_{i=1}^n \mathbf{X_p} (fb^i) \left.\frac{\partial}{\partial x^i}\right|_{\mathbf{p}} \\
  =& \sum_{i=1}^n (\mathbf{X_p} f) b^i (\mathbf{p}) \left.\frac{\partial}{\partial x^i}\right|_{\mathbf{p}} + \sum_{i=1}^n f(\mathbf{p}) \mathbf{X_p} b^i \left.\frac{\partial}{\partial x^i}\right|_{\mathbf{p}} \\
  =& (\mathbf{X_p} f) \mathbf{Y}_\mathbf{p} + f(\mathbf{p})\mathbf{D}_{\mathbf{X_p}}\mathbf{Y} \\
  =& ((\mathbf{X}f)\mathbf{Y} + f\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathbf{p}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
If $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(\R^n)$ are smooth vector fields over $\R^n$ then

$$
  \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathbf{D}_\mathbf{Y} \mathbf{X} = [\mathbf{X}, \mathbf{Y}] = \mathcal{L}_\mathbf{X} \mathbf{Y}
$$

where $[\mathbf{X}, \mathbf{Y}]$ is the Lie bracket and $\mathcal{L}_\mathbf{X} \mathbf{Y}$ is the Lie derivative of $\mathbf{Y}$ with respect to $\mathbf{X}$.
</MathBox>

<MathBox title='Torsion of directional derivatives' boxType='proposition'>
Let $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(\R^n)$ be smooth vector fields over $\R^n$. The *torsion* of the directional derivative $\mathrm{D}$ is defined as 

$$
  T(\mathbf{X},\mathbf{Y}) := \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}]
$$
</MathBox>

For each smooth vector field $\mathbf{X}\in\mathfrak{X}(\R^n)$, the directional derivative $\mathrm{D}_\mathbf{X}: \mathfrak{X}(\R^n)\to\mathfrak{X}(\R^n)$ is an $\R$-linear endomorphism. This gives rise to a map $\mathfrak{X}(\R^n) \to\operatorname{end}_\R (\mathfrak{X}(\R^n))$ by $\mathbf{X}\mapsto\mathrm{D}_\mathbf{X}$. The vector space $\mathfrak{X}(\R^n)$ of smooth vector fields on $\R^n$ is a Lie algebra under the Lie bracket of vector fields. For any vector space $V$, the endomorphism ring $\operatorname{end}_\R (\mathbf{V})$ of endormorphisms of $V$ is also a Lie algebra, with Lie bracket

$$
  [A, B] = A \circ B - B \circ A,\; A,B \in\operatorname{end}(\mathbf{V})
$$

This shows that the map $\mathbf{X}\mapsto \mathrm{D}_\mathbf{X}$ is an $\R$-linear map of Lie algebras. A measure fo the deviation of the linear map $\mathbf{X}\mapsto\mathrm{D}_\mathbf{X}$ from being a Lie homomorphism is given by the function

$$
  R(\mathbf{X},\mathbf{Y}) = [\mathrm{D}_\mathbf{X}, \mathrm{D}_\mathbf{Y}] - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]} = \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]} \in\operatorname{end}_\R (\mathfrak{X}(M))
$$

called the *curvature* of $\mathrm{D}$.

<MathBox title='' boxType='proposition'>
Let $\mathrm{D}$ be the directional derivative in $\R^n$ and $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(\R^n)$ smooth vector fields on $\R^n$. Then
1. **Zero torsion:** $T(\mathbf{X},\mathbf{Y}) = \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}] = 0$
2. **Zero curvature:** $R(\mathbf{X},\mathbf{Y}) = \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]}\mathbf{Z} = 0$
3. **Compatibility with the metric:** $\mathbf{X}\langle \mathbf{Y},\mathbf{Z} \rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} \mathbf{Z}\rangle$

<details>
<summary>Proof</summary>

**(2):** Let $\mathbf{Z} = \sum_{i=1}^n c^i \frac{\partial}{\partial x^i} \in\mathfrak{X}(\R^n)$, then
$$
  \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} = \mathrm{D}_\mathbf{X} \left(\sum_{i=1}^n\mathbf{Y} (c^i) \frac{\partial}{\partial x^i} \right) = \sum_{i=1} (\mathbf{XY}c^i)\frac{\partial}{\partial x^i}
$$

By symmetry,

$$
  \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} = \sum_{i=1}^n (\mathbf{YX}c^i)\frac{\partial}{\partial x^i}
$$

So

$$
\begin{align*}
  \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} =& \sum_{i=1}^n (\mathbf{XY} - \mathbf{YX})c^i \frac{\partial}{\partial x^i} \\
  =& \mathbf{D}_{[\mathbf{X},\mathbf{Y}]} Z
\end{align*}
$$

**(3):** Let $\mathbf{Y} = \sum_{i=1}^n b^i \frac{\partial}{\partial x^i} \in\mathfrak{X}(\R^n)$ and $\mathbf{Z} = \sum_{i=1}^n c^i \frac{\partial}{\partial x^i}\in\mathfrak{X}(\R^n)$, then

$$
\begin{align*}
  \mathbf{X}\langle\mathbf{X},\mathbf{Z} \rangle =& \mathbf{X}\left(\sum_{i=1}^n b^i c^i \right) \\
  =& \sum_{i=1}^n (\mathbf{X}b^i)c^i + \sum_{i=1}^n b^i(\mathbf{X}c^i) \\
  =& \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{Z} \rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} \mathbf{Z}\rangle
\end{align*}
$$
</details>
</MathBox>

### Vector fields along a curve

<MathBox title='Vector field along a curve' boxType='definition'>
Suppose that $c:[a,b]\to M$ is a parametrized curve in a manifold $M$. A vector field along $c$ is the assignment a tangent vector $\mathbf{V}(t) \in T_{c(t)}M$ to each $t\in[a,b]$. Such a vector field is smooth if for every smooth function $f$ on $M$, the function $\mathbf{V}(t)f$ is smooth as a function of $t$.
</MathBox>

<MathBox title='Velocity vector field' boxType='example'>
The velocity vector field $c'(t)$ of a parametrized curve $c$ is defined by

$$
  c'(t) = c_{*,t}\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_t \right) \in T_{c(t)}M
$$

It is a vector field along $c$.
</MathBox>

<MathBox title='Velocity vector field' boxType='example'>
If $\tilde{\mathbf{V}}$ is a vector field on $M$ and $c:[a,b]\to M$ is a parametrized curve in $M$, then $\tilde{\mathbf{V}}$ induces a vector field $\mathbf{V}$ along $c$ by

$$
  \mathbf{V}(t) = \tilde{\mathbf{V}}_{c(t)}
$$

Now suppose $c:[a,b]\to\R^n$ is a curve in $\R^n$ and $\mathbf{V}$ is a smooth vector field along $c$. Then $\mathbf{V}(t)$ can be written as a linear combination of the standard basis vectors

$$
  \mathbf{V}(t) = \sum_{i=1}^n v^i (t) \left.\frac{\partial}{\partial x^i}\right|_{c(t)}
$$

Differentiating with respect to $t$ gives

$$
  \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}(t) = \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t}(t) \left.\frac{\partial}{\partial x^i}\right|_{c(t)}
$$

which is also a smooth vector field along $c$.
</MathBox>

<MathBox title='Vector field along a curve' boxType='proposition'>
Let $c:[a,b]\to\R^n$ be a curve in $\R^n$ and let $\mathbf{V}(t)$ and $\mathbf{W}(t)$ be smooth vector fields along $c$. Then

$$
  \frac{\mathrm{d}}{\mathrm{d}t}\langle \mathbf{V}(t),\mathbf{W}(t) \rangle = \left\langle\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t},\mathbf{W}\right\rangle + \left\langle\mathbf{V}, \frac{\mathrm{d}\mathbf{W}}{\mathrm{d}t}\right\rangle
$$
</MathBox>

### Vector fields along a submanifold

<MathBox title='Vector field along a submanifold' boxType='proposition'>
Let $M$ be a submanifold of a manifold $\tilde{M}$. A vector field $\mathbf{X}$ *on* $M$ assigns to each $\mathbf{p}\in M$ a tangent vector $\mathbf{X_p} \in T_\mathbf{p} M$. A vector field $\mathbf{X}$ *along* $M$ in $\tilde{M}$ assigns to each $\mathbf{p}\in M$ a tangent vector $\mathbf{X_p} \in T_\mathbf{p} M$. A vector field $\mathbf{X}$ along $M$ is smooth if for every smooth function $f$ on $\tilde{M}$, the function $\mathbf{X}f$ is smooth on $M$.

The set of all small smooth vector fields on a submanifold $M$ in a manifold $\tilde{M}$ is denoted $\Gamma(T\tilde{M}|_M)$. It is a module over the ring $\mathcal{F} = C^\infty (M)$ of smooth functions on $M$.
</MathBox>

### Directional derivatives on a submanifold of $\R^n$

Suppose $M$ is a regular submanifold of $\R^n$. At any point $\mathbf{p}\in M$, if $\mathbf{X_p}\in T_\mathbf{p} M$ is a tangent vector at $\mathbf{p}$ and $\mathbf{Y} = \sum_{i=1}^n b^i \frac{\partial}{\partial x^i}$ is a vector field along $M$ in $\R^n$, then the directional derivative $\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}$ is defined as

$$
  \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} = \sum_{i=1}^n (\mathbf{X_p} b^i) \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}
$$

As $\mathbf{p}$ varies over $M$, this allows us to associate to a smooth vector field $\mathbf{X}$ on $M$ and a smooth vector field $\mathbf{Y}$ along $M$, a smooth vector field $\mathrm{D}_\mathbf{X} \mathbf{Y}$ along $M$ by

$$
  \mathrm{D}_\mathbf{X} \mathbf{Y} = \sum_{i=1}^n (X b^i) \frac{\partial}{\partial x^i} \in \Gamma(T\R^n |_M)
$$

For any $\mathbf{p}\in M$, we have $(\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathbf{p} = \mathbf{D}_{\mathbf{X_p}} \mathbf{Y}$ by definition. It follows that there is an $\R$-bilinear map $\mathrm{D}:\mathfrak{X}(M)\times\Gamma(T\R^n |_M) \to\Gamma(T\R^n |_M)$ by $\mathrm{D}(\mathbf{X},\mathbf{Y}) = \mathrm{D}_\mathbf{X} \mathbf{Y}$ called the directional derivative on $M$. Because of the asymmetry between $\mathbf{X}$ and $\mathbf{Y}$, where $\mathbf{X}$ is a vector field on $M$ while $\mathbf{Y}$ is a vector field along $M$, the torsion $T(\mathbf{X},\mathbf{Y}) := \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}]$ no longer makes sense. Otherwise, $\mathrm{D}$ satisfies the same properties as the directional derivative $\mathrm{D}$ on $\R^n$. 

<MathBox title='' boxType='proposition'>
Let $\mathcal{F} = C^\infty (M)$ be the ring of smooth functions on $M$. Suppose $M$ is a regular submanifold of $\R^n$ and $\mathrm{D}$ is the directional derivative
1. $\mathrm{D}(\mathbf{X},\mathbf{Y}) = \mathrm{D}_\mathbf{X} \mathbf{Y}$ is $\mathcal{F}$-linear in $\mathbf{X}$ and $\R$-linear in $\mathbf{Y}$
2. **Leibniz rule:** if $f\in C^\infty (M)$, then
$$
  \mathrm{D}(\mathbf{X},f\mathbf{Y}) = \mathrm{D}_\mathbf{X} (f\mathbf{Y}) = (\mathbf{X}f)\mathbf{Y} + f\mathrm{D}_\mathbf{X} \mathbf{Y}
$$
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose $M$ is a regular submanifold of $\R^n$ and $\mathrm{D}$ is the directional derivative on $M$
1. **Zero curvature:** If $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ and $Z\in\Gamma(T\R^n |_M)$, then
$$
  \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]} \mathbf{Z} = 0
$$
2. **Compatibility with the metric:** If $\mathbf{X}\in\mathfrak{X}(M)$ and $\mathbf{Y},\mathbf{Z}\in\Gamma(T\R^n |_M)$, then
$$
  \mathbf{X}\langle\mathbf{Y},\mathbf{Z}\rangle = \langle\mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} \mathbf{Z}\rangle
$$
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose $\tilde{\mathbf{V}}$ is a smooth vector field along a regular submanifold $M$ in $\R^n$ and $c:[a,b]\to M$ is a smooth curve in $M$. Then $\tilde{\mathbf{V}}$ induces a vector field $\mathbf{V}$ along $c$:

$$
  \mathbf{V}(t) = \tilde{\mathbf{V}}_{c(t)} \in T_{c(t)}\R^n
$$

Differentiation with respect to $t$ of a vector field along a curve is the directional derivative in the tangent direction

$$
  \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t} = \mathrm{D}_{c'(t)}\tilde{\mathbf{V}}
$$

<details>
<summary>Proof</summary>

Let $\mathbf{V}(t) = \sum_{i=1}^n v^i (t) \left.\frac{\partial}{\partial x^i}\right|_{c(t)}$ and $\tilde{\mathbf{V}}_\mathbf{p} = \sum_{i=1}^n \tilde{v}^i (\mathbf{p}) \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}$ for $\mathbf{p}\in M$. Since $\mathbf{V}(t) = \tilde{\mathbf{V}}_{c(t)}$, it follows that $v^i = \tilde{v}^i \circ c$. By the definition of $c'(t)$

$$
  c'(t)\tilde{v}^i = c_* \left(\frac{\mathrm{d}}{\mathrm{d}t}\right)\tilde{v}^i = \frac{\mathrm{d}}{\mathrm{d}t}(\tilde{v}^i \circ c) = \frac{\mathrm{d}}{\mathrm{d}t}v^i
$$

Thus,

$$
\begin{align*}
  \mathbf{D}_{c'(t)} \tilde{\mathbf{V}} =& \sum_{i=1}^n (c'(t)\tilde{v}^i) \left.\frac{\partial}{\partial x^i}|_{c(t)} \\
  =& \sum_{i=1}^n \frac{\mathrm{d}v^i}{\mathrm{d}t} \left.\frac{\partial}{\partial x^i}\right|_{c(t)} = \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}
\end{align*}
$$
</details>
</MathBox>

# Geodesics

<MathBox title='Acceleration' boxType='definition'>
Let $M$ be a smooth manifold. The *acceleration* of a smooth curve $\gamma:I\subset\R\to M$ in $M$ is the covariant derivative of its velocity, i.e. the vector field $\mathrm{D}_t \gamma$ along $\gamma$.
</MathBox>

<MathBox title='Geodesic' boxType='definition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$. A smooth curve $\gamma:I\subset\R\to M$ in $M$ is *geodesic* relative to $\nabla$ if its acceleration is zero, i.e. 

$$
  \frac{\mathrm{D}\gamma'}{\mathrm{d}t} (t) = 0,\; \forall t\in I
$$

The geodesic is *maximal* if its domain $I$ cannot be extended to a larger interval.
</MathBox>

<MathBox title='Geodesic equations' boxType='proposition' tag='proposition-22'>
Let $M$ be a smooth $n$-manifold with an affine connection $\nabla$, and suppose $\gamma:I\subset\R \to M$ is a smooth curve in $M$. If $(U, \varphi = (x^i)_{i=1}^n)$ is a chart about $\gamma(t)\in M$ for any $t \in I$, then $\gamma$ is geodesic if and only if the components of $(\varphi\circ\gamma)(t) = (y^i(t) = x^i[\gamma(t)])_{i=1}^n$ satisfy the system of differential equations

$$
  \frac{\mathrm{d}^2 y^k}{\mathrm{d}t^2} (t) + \sum_{i,j=1}^n \frac{\mathrm{d}y^i}{\mathrm{d}t}(t) \frac{\mathrm{d}y^j}{\mathrm{d}t}(t) \Gamma_{ij}^k (y(t))  = 0,\; k = 1,\dots,n
$$

or in compact notation

$$
  \ddot{y}^k + \dot{y}^i \dot{y}^j \Gamma_{ij}^k = 0,\; k = 1,\dots,n
$$

These are known as the geodesic equations.

<details>
<summary>Proof</summary>

In terms of the chart $(U, \varphi = (x^i)_{i=1}^n)$, the curve $\gamma$ is given by the linear combination

$$
  \gamma(t) = \sum_{i=1}^n x^i(\gamma(t)) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} = \sum_{i=1}^n y^i(t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}
$$

The velocity $\gamma'$ takes the form

$$
\begin{align*}
  \gamma'(t) =& \sum_{i=1}^n \frac{\mathrm{d}y^i}{\mathrm{d}t}(t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} \\
  =& \sum_{i=1}^n \dot{y}^i (t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}
\end{align*}
$$

The acceleration $\mathrm{D}_t \gamma'$ becomes

$$
\begin{align*}
  \frac{\mathrm{D}\gamma'}{\mathrm{d}t}(t) =& \sum_{i=1}^n \frac{\mathrm{D}}{\mathrm{d}t}\left( \sum_{i=1}^n \dot{y}^i(t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} \right) \\
  =& \sum_{i=1}^n \frac{\mathrm{d} \dot{y}^i}{\mathrm{d}t}(t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} + \dot{y}^i (t) \frac{\mathrm{D}}{\mathrm{d}t}\left(\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}\right) \\
  =& \sum_{i=1}^n \ddot{y}^i (t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} + \dot{y}^i (t) \nabla_{\dot{y}^i \boldsymbol{\partial_i|_{\gamma(t)}}} \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)} \\
  =& \sum_{i,j,k=1} \left[ \ddot{y}^k (t) + \dot{y}^i(t) \dot{y}^j(t) \Gamma_{ij}^k (y(t)) \right] \left.\frac{\partial}{\partial x^k}\right|_{\gamma(t)}
\end{align*}
$$

Since $\gamma$ is geodesic if $\mathrm{D}_t \gamma'(t) \equiv 0$, it follows that $\gamma$ is a geodesic if and only if

$$
  \ddot{y}^k + \dot{y}^i \dot{y}^k \Gamma_{ij}^k = 0,\; k = 1,\dots,n
$$
</details>
</MathBox>

<MathBox title='Picard-Lindelöf theorem (existence and uniqueness of first-order ODEs)' boxType='theorem' tag='theorem-3'>
Let $I\subset\R$ be an interval, and for $1\leq j$, $k\leq n$ let $a_j^k : I\to\R$ be arbitrary smooth functions. The first order linear initial-value problem

$$
\begin{align*}
  \dot{V}^k (t) =& a_j^k(t) V^j(t) \\
  V^k (t_0) =& b^k
\end{align*}
$$

has a unique solution on all of $I$ for any $t_0 \in I$ and any initial vector $\mathbf{b} = (b^i)_{i=1}^n \in \R^n$
</MathBox>

<MathBox title='Existence and uniqueness of geodesics' boxType='theorem' tag='theorem-4'>
Let $M$ be a smooth $n$-manifold with an affine connection $\nabla$. For any point $\mathbf{p}\in M$, any tangent vector $\mathbf{v}\in T_\mathbf{p}M$ and any $t_0 \in\R$, there is an open interval $I\subset\R$ containing $t_0$ and a geodesic $\gamma:I\to M$ satisfying

$$
  \gamma(t_0) = \mathbf{p}, \quad \gamma'(t_0) = \mathbf{v}
$$

Any two such geodesics agree on their common domain.

<details>
<summary>Proof</summary>

Choose a chart $(U, (x^i)_{i=1}^n)$ about $\mathbf{p}\in M$. By proposition $\ref{proposition-22}$, $\gamma:I \to U$ is a geodesic if and only if its component functions $\hat{\gamma}(t) = (\gamma^i (t))_{i=1}^n$ satisfy the geodesic equations

$$
  \ddot{\gamma}^k (t) + \dot{\gamma}^i(t) \dot{\gamma}^j(t) \Gamma_{ij}^k (\hat{\gamma}(t)) = 0,\; k=1,\dots,n
$$

This is a second-order system of ordinary differential equations (ODEs) for the functions $\gamma^k (t)$. Substituting $u^i = \dot{\gamma}^i$, we can convert it to an equivalent first-order system in twice the number of variables

$$
\begin{align*}
  \dot{\gamma}^k(t) =& u^k(t) \\
  \dot{u}^k (t) = -u^i(t) u^j(t) \Gamma_{ij}^k (\hat{\gamma}(t))
\end{align*}
$$

By theorem $\ref{theorem-3}$, for any $(\mathbf{p},\mathbf{v})\in U\times\R^n$, there exists $\varepsilon > 0$ and a unique solution $\eta: (t_0 - \varepsilon, t_0 + \varepsilon) \to U\times\R^n$ to this system satisfying the initial condition $\eta(t_0) = (\mathbf{p},\mathbf{v})$. If we write the component functions of $\eta$ at $\eta(t) = (\gamma^i(t), u^i(t))$, then we can easily check that the curve $\hat{hat}(t) = (\gamma^i(t))_{i=1}^n$ in $U$ satisfy the existence claim.

To prove uniqueness, suppose $\gamma,\sigma: I\to M$ are geodesics defined on an open interval with $\gamma(t_0) = \sigma(t_0)$ and $\gamma'(t_0) = \sigma'(t_0)$. By the uniqueness part the ODE theorem, they agree on some neighbourhood of $t_0$. Let $\beta$ be the supremum of numbers $b$ such that the agree on $[t_0, nb]$. If $\beta\in I$, then by continuity $\gamma(\beta) = \sigma(\beta)$ and $\gamma'(\beta) = \sigma'(\beta)$, and applying local uniqueneses in a neigbourhood of $\beta$, we conclude that they agree on a slightly larger interval, which is a contradiction. Arguing similarly to the left of $t_0$, we conclude that they agree on all of $I$.
</details>
</MathBox>

It follows from the uniqueness statement of theorem $\ref{theorem-4}$ that for any $\mathbf{p}\in M$ and $\mathbf{v}\in T_\mathbf{p}M$, there is a unique maximal geodesic $\gamma:I\to M$ with $\gamma(0) = \mathbf{p}$ and $\dot{\gamma}(0) = \mathbf{v}$, defined on some open interval $I$; just let $I$ be the union of all open intervals on which such a geodesic is defined, and observe that the various geodesics agree where they overlap. This maximal geodesic is denoted $\gamma_\mathbf{v}$. (The initial point $\mathbf{p}$ can be recovered from $\mathbf{v}$ by $\mathbf{p} = \pi(\mathbf{v})$, where $\pi:TM\to M$ is the natural projection.)

Let $\gamma_\mathbf{v}(t,\mathbf{q})$ be the unique maximal geodesic with initial point $\mathbf{q}$ and initial vector $\mathbf{v}\in T_\mathbf{q}M$. Then

$$
  \gamma_\mathbf{v} (kt) = \gamma_{k\mathbf{v}}(t),\; k\in\R
$$

<MathBox title='' boxType='proposition'>
Let $M$ and $\tilde{M}$ be smooth manifolds with respective connections $\nabla$ and $\tilde{\nabla}$. A connection-preserving diffeomorphism $F:(M,\nabla) \to (\tilde{M},\tilde{\nabla})$ takes geodesic to geodesics.

<details>
<summary>Proof</summary>

Suppose $\gamma:I\subset\R\to M$ is a geodesic in $M$ with velocity vector field $\gamma'$. If $\tilde{\mathbf{T}}(t) = (F\circ\gamma)'(t)$ is the tangent vector field of $F\circ\gamma$, then

$$
  \tilde{\mathbf{T}}(t) = \mathrm{d}F \left(\mathrm{d}\gamma \left(\frac{\mathrm{d}}{\mathrm{d}t} \right)\right) = \mathrm{d}F (\gamma'(t)) = \mathrm{d}F (\mathbf{T})
$$

Let $\mathrm{D}_t$ and $\tilde{\mathrm{D}}_t$ be the covariant derivatives along $\gamma(t)$ and $(F\circ \gamma)(t)$, respectively. Then $\mathrm{D}_t T \equiv 0$, because $\gamma(t)$ is a geodesic. If follows that

$$
  \frac{\tilde{\mathrm{D}}\tilde{\mathbf{T}}}{\mathrm{d}t} = \mathrm{d}fF\left(\frac{\mathrm{D}\mathbf{T}}{\mathrm{d}t}\right) = \mathrm{d}F(0) = 0
$$

Hence, $F\circ\gamma$ is a geodesic in $M$.
</details>
</MathBox>

## Parallel translation

A parallel vector field along a curve is an analogue of a constant vector field in $\R^n$.

<MathBox title='Parallel vector field' boxType='definition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$. A smooth vector field $\mathbf{V}\in\mathfrak{X}(M)$ along a curve $\gamma:I\subset\R\to M$ is *parallel* along $\gamma$ with respect to $\nabla$ if $\mathbf{D}_t \mathbf{V} \equiv 0$. A vector field $\mathbf{V}\in\mathfrak{X}(M)$ on $M$ is *parallel* if it is parallel along every curve.
</MathBox>

<MathBox title='Parallel translation' boxType='theorem' tag='theorem-5'>
Let $M$ be a smooth $n$-manifold with an affine connection $\nabla$. For any curve $\gamma:I\subset\R\to M$, $t_0 \in I$, and a vector $\mathbf{V}_0 \in T_{\gamma(t_0)} M$, there is a unique parallel vector field $\mathbf{V}$ along $\gamma$ such that $\mathbf{V}(t_0) = \mathbf{V}_0$.

<details>
<summary>Proof</summary>

Assume first $\gamma(I)$ is contained in a single coordinate chart $(U, (x^i)_{i=1}^n)$. In this chart, $\mathbf{V}$ is given by the linear combination

$$
  \mathbf{V}(t) = \sum_{i=1}^n V^i (t) \left.\frac{\partial}{\partial x^i}\right|_{\gamma(t)}
$$


Then by proposition $\ref{proposition-11}$

$$
\begin{align*}
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} = \sum_{i,j,k=1}^n \left(\dot{V}^k(t) + V^j(t) \dot{\gamma}^i(t) \Gamma_{ij}^k (\gamma(t)) \right)\left.\frac{\partial}{\partial x^k}\right|_{\gamma(t)}
\end{align*}
$$

Since $\mathbf{V}$ is parallel along $\gamma$ if $\mathrm{D}_t \mathbf{V} \equiv 0$, it follows that $\mathbf{V}$ is parallel along $\gamma$ if and only if

$$
  \dot{V}^k (t) = -V^j (t) \dot{gamma}^i (t) \Gamma_{ij}^k  (\gamma(t)),\; k=1,\dots,n
$$

This a first-order linear system of ODEs. By theorem $\ref{theorem-3}$, there is a unique solution on all of $I$ with any initial condition $\mathbf{V}(t_0) = \mathbf{V}_0$.

Now assume $\gamma(I)$ is not covered by a single chart. Let $\beta$ denote the supremum of all $b > t_0$ for which there is a unique parallel translate on $[t_0, b]$. Clearly, $\beta > t_0$, since for $b$ close enough to $t_0$, $\gamma[t_0, b]$ is contained in a single chart and the above argument applies. Then a unique parallel translate $\mathbf{V}$ exists on $[t_0, \beta)$. If $\beta\in I$, choose coordinates on an open set containing $\gamma(\beta-\delta,\beta+\delta)$ for some positive $\delta$ (assuming $\gamma$ has been extended to an open interval if necessary). Then there exists a unique parallel vector field $\tilde{\mathbf{V}}$ on $(\beta - \delta, \beta + \delta)$ satisfying the initial condition $\tide{\mathbf{V}}(\beta - \delta/2) = \mathbf{V}(\beta - \delta/2)$. By uniqueness, $\mathbf{V} = \tilde{\mathbf{V}}$ on their common domain, and therefore $\tilde{\mathbf{V}}$ is an extension of $\mathbf{V}$ past $\beta$, which is a contradiction.
</details>
</MathBox>

<MathBox title='Parallel transport' boxType='definition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$ and suppose $\gamma:I\subset\R\to M$ is a curve in $M$. For $t_0, t\in I$ we define the map

$$
  P_\gamma (t, t_0): T_{\gamma(t_0)}M \to T_{\gamma(t)}
$$

by $P_\gamma (t, t_0) \mathbf{V}_0 = \mathbf{V}(t)$ where $\mathbf{V}$ a parallel vector field along $\gamma$ with $\mathbf{V}(t_0) = \mathbf{V}_0$. The collection of maps $P_\gamma (t, t_0)$ for $t, t_0 \in I$ is called *parallel transport* along $\gamma$.
</MathBox>

<MathBox title='Properties of parallel transport' boxType='definition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$ and suppose $\gamma:I\subset\R\to M$ is a curve in $M$. The parallel transport map $P_\gamma (t, s): T_{\gamma(s)}M \to T_{\gamma(t)}$ for $s,t\in I$ has the following properties
1. $P_\gamma (t, s)$ is linear for all $s,t\in I$
2. For all $r,s,t \in I$ we have
$$
  P_\gamma (t, s) \circ P_\gamma (s,t) = P_\gamma (t,r)
$$
In particular, $P_\gamma (t,t) = \mathrm{id}_{T_{\gamma(t) M}}$
3. If $J\subset\R$ is an interval and $\sigma:J\to I$ is a smooth map, then
$$
  P_{\gamma\circ\sigma} (t, s) = P_\gamma (\sigma(t), \sigma(s)),\; s,t\in J
$$

<details>
<summary>Proof</summary>

**(1):** This follows from the fact that a parallel vector field along $\gamma$ is preserved under vector addition and scalar multiplication.

**(2):** This follows directly from the uniqueness statement in theorem $\ref{theorem-5}$.

**(3):** Fix $s\in J$ and $\mathbf{v} \in T_{\gamma(\sigma(s))} M$. Define the vector field $\mathbf{V}$ along $\gamma$ by

$$
  \mathbf{V}(\sigma(t)) = \mathbf{v}
$$

Denote

$$
\begin{align*}
  \tilde{\gamma} :=& \gamma\circ\sigma: J\to M \\
  \tilde{\mathbf{V}} := \mathbf{V}\circ\sigma: I\to\R^n
\end{align*}
$$

Then $\tilde{\mathbf{V}}$ is a vector field along $\tilde{\gamma}$ and, by the chain rule, we have

$$
  \frac{\mathrm{d}}{\mathrm{d}t}\tilde{\mathbf{V}}(t) = \frac{\mathrm{d}}{\mathrm{d}t}\mathbf{V}(\sigma(t)) = \frac{\mathrm{d}\sigma}{\mathrm{d}t}(t) \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}(\sigma(t))
$$

Projecting orthogonally onto the tangent space $T_{\gamma(\sigma(t))}M$ we obtain

$$
  \frac{\mathrm{D}\tilde{\mathbf{V}}}{\mathrm{d}t}(t) = \dot{\sigma}(t)\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}(\sigma(t)) = 0,\; \forall t\in J
$$

Hence $\tilde{\mathbf{V}}$ is the unique parallel vector field along $\tilde{\gamma}$ that satisfies $\tilde{\mathbf{V}}(s) = \mathbf{v}$. Thus

$$
  P_{\tilde{\gamma}}(t,s)\mathbf{v} = \tilde{\mathbf{V}}(t) = \mathbf{V}(\sigma(t)) = P_\gamma (\sigma(t), \sigma(s))\mathbf{v}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$ and suppose $\gamma:I\subset\R\to M$ is a curve in $M$. If $\mathbf{V}_0 \in T_{\gamma(t_0)} M$ is a tangent vector and $\mathbf{V}$ is the parallel translate of $\mathbf{V}_0$ along $\gamma$, then

$$
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t}(t_0) = \lim_{t\to t_0} \frac{P_{t_0, t}^{-1} \mathbf{V}(t) - \mathbf{V}(t_0)}{t - t_0}
$$

where $P_{a,b}:T_{\gamma(a)}M \xrightarrow{\sim} T_{\gamma(b)}M$ is the parallel transport operator.
</MathBox>

### Parallel translation

Let $M$ be a smooth manifold with a connection $\nabla$ and $c:I\subseteq\R\to M$ is a smooth curve. A geodesic is simply a curve $c$ whose tangent vector field $\mathbf{T}(t) = c'(t)$ is parallel along $c$.

Fix a point $\mathbf{p} = c(t_0)$ and a frame $\Set{\mathbf{e}_i}_{i=1}^n$ in a neighbourhood $U$ of $\mathbf{p}\in M$. Let $[\omega_j^i]$ be the matrix of connection forms of $\nabla$ relative to this frame. If $\mathbf{V}(t) = \sum_{i=1} v^i(t) \mathbf{e}_{i,c(t)}$ for $c(t)\in U$, then

$$
\begin{align*}
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} =& \sum_{i=1}^n \dot{v}^i \mathbf{e}_{i,c(t)} + \sum_{i=1}^n v^i \frac{\mathrm{D}\mathbf{e}_{i,c(t)}}{\mathrm{d}t} \\
  =& \sum_{i=1}^n \dot{v}^i \mathbf{e}_{i,c(t)} + \sum_{j=1}^n v^j \nabla_{c'(t)}\mathbf{e}_{j} \\
  =& \sum_{i=1}^n \dot{v}^i \mathbf{e}_{i,c(t)} + \sum_{i,j=1}^n v^j \omega_j^i (c'(t))\mathbf{e}_{i,c(t)} \\
  =& \sum_{i=1} \left(\dot{v} + \sum_{j=1}^n \omega_j^i (c'(t))v^j \right)\mathbf{e}_{i,c(t)}
\end{align*}
$$

Thus $\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} = 0$ if and only if

$$
  \dot{v}^i + \sum_{j=1}^n \omega_j^i (c'(t))v^j = 0,\quad i=1,\dots,n
$$

This is a system if linear first-order ordinary differential equations. By the existence and uniqueness theorem of ordinary equations, there is always a unique solution $V(t)$ on a small interval about $t_0$ with a given $\mathbf{V}(t_0)$.

If $\mathbf{V}(t)$ is parallel along a curve $c:[a,b]\to M$, then we say that $\mathbf{V}(b)$ is obtained from $\mathbf{V}(a)$ by *parallel translation* along $c$ or that $\mathbf{V}(b)$ is the *parallel translate/transport* of $\mathbf{V}(a)$ along $c$. By the uniqueness theorem of ordinary differential equations, $\mathbf{V}(t)$ is uniquely determined by the initial condition $\mathbf{V}(a)$, so if a parallel translation exists along $c$, then it is well defined.

### Existence of parallel translation along a curve

<MathBox title='Parallel vector fields' boxType='definition'>
Let $M$ be a smooth $n$-manifold with a connection $\nabla$ and let $c:[a,b]\to M$ be a smooth curve in $M$. Parallel translation is possible from $c(a)$ to $c(b)$ along $c$, i.e. given a vector $\mathbf{v}_0 \in T_{c(a)}M$, there exists a parallel vector field $\mathbf{V}(t)$ along $c:[a,b]\to M$ such that $\mathbf{V}(a) = \mathbf{v}_0$. Parallel translation along $c$ induces a linear isomorphism $\varphi_{a,b}:T_{c(a)}M \xrightarrow{\sim} T_{c(b)}M$

<details>
<summary>Proof</summary>

Because the parallel transport equation $\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} = 0$ is $\R$-linear in $\mathbf{V}$, a linear combination with constant coefficients or parallel vector fields alon $c$ is again parallel along $c$.

Let $\Set{\mathbf{w}_i}_{i=1}^n$ be a basis for $T_{c(t_0)}M$. For each $i=1,\dots,n$, there is an interval inside $[a,b]$ of length $\varepsilon_i$ about $t_0$ such that a parallel vector field $W_i (t)$ exists along $c:(t_0 - \varepsilon_i, t_0 + \varepsilon_i)\to M$ whose value at $t_0$ is $\mathbf{w}_i$. For $\varepsilon$ equal to the minimum of $\Set{\varepsilon_i}_{i=1}^n$ the $n$ basis vectors for $T_{c(t_0)}M$ can be parallel translated along $c$ over the interval $(t_0 - \varepsilon, t_0 + \varepsilon)$. By taking linear combinations as noted above, we can translate every tangent vector in $T_{c(t_0)}M$ along $c$ over the interval $(t_0 - \varepsilon, t_0 + \varepsilon)$.

For $t_1 \in (t_0 - \varepsilon, t_0 + \varepsilon)$ parallel translation along $c$ produces a linear map $\varphi_{t_0,t_1}: T_{c(t_0)}M\to T_{c(t_1)}M$. Note that a vector field $\mathbf{V}(t)$ is parallel along a curve $c(t)$ if and only if $\mathbf{V}(-t)$ is parallel along $c(-t)$, the reparametrization of $c$ with opposite orientation. This shows that the linear map $\varphi_{t_0,t_1}$ has an inverse $\varphi_{t_1,t_0}$ and is therefore an isomorphism.

Thus for each $t\in[a,b]$ there is an open interval about $t$ over which parallel translation along $c$ is possible. Since $[a,b]$ is compact, it is covered by finitely many such open intervals. Hence, it is possible to parallel translate along $c$ from $c(a)$ to $c(b)$.
</details>
</MathBox>

While a geodesic with a given initial point and initial velocity exists only locally, parallel translation is always possible along the entire length of a smooth curve. In fact, the curve need not even be smooth. By parallel translating over each smooth segment in succession, one can parallel translate over any piecewise smooth curve.

### Parallel translation on a Riemannian manifold

<MathBox title='Parallel translation on Riemannian manifolds preserves length and inner product' boxType='proposition'>
On a Riemannian manifold $M$ parallel translation preserves length and inner product: if $\mathbf{V}(t)$ and $\mathbf{W}(t)$ are parallel vector fields along a smooth curve $c:[a,b]\to M$, then the length $\lVert\mathbf{V}(t)\rVert$ and the inner product $\langle\mathbf{V}(t),W(t)\rangle$ are constant for all $t\in[a,b]$.

<details>
<summary>Proof</summary>

Since $\lVert\mathbf{V}(t)\rVert = \sqrt{\langle\mathbf{V}(t),\mathbf{V}(t)\rangle}$, it suffices to prove that $\langle\mathbf{V}(t),\mathbf{W}(t)\rangle$ is constant. By the product rule for the covariant derivative of a connection compatible with the metric

$$
  \frac{\mathrm{d}}{\mathrm{d}t}\langle\mathbf{V},\mathbf{W}\rangle = \left\langle\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t},\mathbf{W}\right\rangle + \left\langle\mathbf{V},\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t}\right\rangle = 0
$$

since $\frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} = 0$ and $\frac{\mathrm{D}\mathbf{W}}{\mathrm{d}t} = 0$. Thus, $\langle\mathbf{V}(t),\mathbf{W}(t)\rangle$ is constant as a function of $t$.
</details>
</MathBox>

Since the angle $\theta$ between two vectors $\mathbf{u}$ and $\mathbf{v}$ can be defined in terms of length and inner product by

$$
  \cos(\theta) = \frac{\langle\mathbf{u},\mathbf{v}\rangle}{\lVert\mathbf{v}\rVert\cdot\lVert\mathbf{v}\rVert},\; 0\leq\theta\leq\pi
$$

parallel translation also preserves angles.

<MathBox title='Parallel translations on a sphere' boxType='example'>
Let $\gamma_1$ and $\gamma_2$ be two meridians through the north pole $p$ of a sphere $\mathbb{S}^2$ making an angle $\theta$ with each other, and let $v$ be a vector at $p$ tangent to $\gamma_1$. As great circles, both $\gamma_1$ and $\gamma_2$ are geodesics on the sphere. We will parallel translate $v$ along $\gamma_1$ to the equator, along the equator to $\gamma_2$, and then along $\gamma_2$ back to the north pole $p$. Since $\gamma_1$ is a geodesic, its tangent vector field is parallel, so the parallel translate of $v$ to the equator remains parallel to $\gamma_1$ and perpendicular to the equator. Since parallel translation preserves angles, as $v$ is parallel translated along the equator to $\gamma_2$, it remains perpendicular to the equator at all times. When it reaches $\gamma_2$ along the equator, it will be tangent to $\gamma_2$. Parallel translating this vector along $\gamma_2$ back to $p$ results in a tangent vector to $\gamma_2$ at $p$. From this example we see that parallel translating a tangent vector of a manifold around a closed loop need not end in the original vector. This phenomenon is called *holonomy*.
</MathBox>

## Geodesic flow

## Geodesic spray

## Existence of geodesics

<MathBox title='' boxType='theorem'>
Let $M$ be a Riemannian manifold. For any point $\mathbf{p}\in M$, there are a neighbourhood $U$ of $\mathbf{p}$ and numbers $\delta, a > 0$ so that for any $\mathbf{q}\in U$ and $\mathbf{v}\in T_\mathbf{q}M$ with $\lVert\mathbf{v}\rVert < \delta$, there is a unique geodesic $\gamma:(-a,a)\to M$ with $\gamma(0) = \mathbf{q}$ and $\gamma'(0) = \mathbf{v}$. 
</MathBox>

<MathBox title='' boxType='corollary'>
Let $M$ be a Riemannian manifold. For any point $\mathbf{p}\in M$, there are a neighbourhood $U$ of $\mathbf{p}$ and a real number $\varepsilon > 0$ so that for any $\mathbf{q}\in U$ and $\bar{\mathbf{v}}\in T_\mathbf{q}M$ with $\lVert\bar{\mathbf{v}}\rVert < \varepsilon$, there is a unique geodesic $\bar{\gamma}:(-2,2)\to M$ with $\bar{\gamma}(0) = \mathbf{q}$ and $\bar{\gamma}'(0) = \mathbf{v}$.

<details>
<summary>Proof</summary>

Fix $\mathbf{p}\in M$ and find a neighbourhood $U$ of $\mathbf{p}$ and positive numbers $\delta$ and $a$. Set $k = \frac{a}{k}$. Then $\gamma(t)$ is a geodesic on $(-a,a)$ with initial point $\mathbf{q}$ and initial vector $\mathbf{v}$ if and only if $\bar{\gamma}(t) := \gamma(kt)$ is a geodesic on $\left(-\frac{a}{k},\frac{a}{k}\right) = (-2,2)$ with initial point $\mathbf{q}$ and initial vector $\bar{\mathbf{v}} := k\mathbf{v}$. Moreover

$$
  \lVert\mathbf{v}\rVert = \lVert\gamma'(0)\rVert < \delta \iff \lVert\bar{\mathbf{v}}\rVert = \lVert\bar{\gamma}'(0)\rVert = k\lVert\mathbf{v}\rVert < k\delta = \frac{a\delta}{2}
$$

Choose $\varepsilon = \frac{a\delta}{2}$. Then the result follows from the previous proposition.
</details>
</MathBox>

# Riemannian geometry

# Curvature and vector fields

## Tangent vectors

<MathBox title='Tangent vector' boxType='definition'>
Let $M$ be a smooth manifold. A tangent vector at a point $\mathbf{p}\in M$ is a point-derivation $\mathbf{X_p}: C_\mathbf{p}^\infty(M)$ satisfying for all smooth functions $f,g\in C_\mathbf{p}^\infty (M)$:
1. **Linearity:** $\mathbf{X_p}(f + g) = \mathbf{X}_\mathbf{p} (f) + \mathbf{X_p}(g)$
2. If $f$ is a constant function then $\mathbf{X}_\mathbf{p}(f) = 0$
3. **Leibniz rule:** $\mathbf{X_p} (fg) = f(\mathbf{p})\mathbf{X_p}(g) + \mathbf{X_p}(f) g(\mathbf{p})$

The set of all tangent vector at $\mathbf{p}\in M$,  denoted $T_\mathbf{p} M$, is a vector space called the *tangent space* to $M$ at $\mathbf{p}$.
</MathBox>

Let $M$ be a smooth manifold. If $(U, (x^i)_{i=1}^n)$ is a chart in a neighbourhood of a point $\mathbf{p}$, then the set of partial derivative opertors

$$
  \Set{\boldsymbol{\partial}_i \rvert_\mathbf{p} = \left.\frac{\partial}{\partial x^i}\right\rvert_\mathbf{p}}_{i=1}^n
$$

forms a basis for $T_\mathbf{p}M$.

<MathBox title='Differential' boxType='definition'>
If $M$ and $N$ are smooth manifolds with or without boundary and $F:M\to N$ is a smooth map, the differential of $F$ at $\mathbf{p}\in M$ is the map

$$
  \mathrm{d}F_\mathbf{p} : T_\mathbf{p} M \to T_{F(\mathbf{p})}N
$$

defined by

$$
  \mathrm{d}F_\mathbf{p} (\mathbf{X_p}) = \mathbf{X_p}(f\circ F)
$$

for $\mathbf{X_p}\in T_\mathbf{p} M$ and $f\in C_{F(\mathbf{p})}^\infty$.
</MathBox>

## Riemannian manifolds

### Inner product

<MathBox title='Inner product' boxType='definition'>
Let $V$ be an $\mathbb{F}$-vector space. The map $\langle\cdot, \cdot\rangle: V\times V \to\mathbb{F}$ is called an inner product on $V$ if it satisfies for all $\boldsymbol{u},\boldsymbol{v}, \boldsymbol{w}\in V$ and $\alpha, \beta \in\mathbb{F}$

1. **Positive definiteness:** $\langle \boldsymbol{v}, \boldsymbol{v} \rangle \geq 0$ and $\langle \boldsymbol{v}, \boldsymbol{v} \rangle = 0 \iff \boldsymbol{v} = 0$
3. **Conjugate symmetry:** $\langle \boldsymbol{v}, \boldsymbol{w}\rangle = \overline{\langle\boldsymbol{w}, \boldsymbol{v}\rangle}$
    - For $\mathbb{F} = \R$, the inner product is symmetric, i.e. $\langle \boldsymbol{v}, \boldsymbol{w}\rangle = \langle\boldsymbol{w}, \boldsymbol{v}\rangle$
2. **Linearity in the first argument:** $\langle \alpha\boldsymbol{u} + \beta\boldsymbol{v}, \boldsymbol{w} \rangle = \alpha\langle\boldsymbol{u}, \boldsymbol{w}\rangle + \beta\langle\boldsymbol{v}, \boldsymbol{w}\rangle$
    - For $\mathbb{F} = \R$, the symmetry property implies linearity in the second argument as well, making the inner product bilinear.

The pair $(V,\langle\cdot, \cdot\rangle)$ is called an *inner product space*. Note that the inner product can also be defined with linearity the in second argument instead.
</MathBox>

In terms of an inner product allows, we can define the length (norm) of a vector $\mathbf{v}\in V$ by

$$
  \lVert\mathbf{v}\rVert = \sqrt{\langle\mathbf{v},\mathbf{v}\rangle}
$$

and the angle between two non-zero vector $\mathbf{u},\mathbf{v}\in V$ by

$$
  \cos\theta = \frac{\langle\mathbf{u},\mathbf{v}\rangle}{\lVert\mathbf{u}\rVert\cdot\lVert\mathbf{v}\rVert}
$$

<MathBox title='Positive-definite matrices' boxType='definition'>
An $n\times n$ symmetric matrix $\mathbf{A}\in\mathcal{M}_n (\mathbb{F})$ is *positive-definite* if $\mathbf{x}^\top \mathbf{A}\mathbf{x} \geq 0$ for all $\mathbf{x}\in\mathbb{F}^n$. Equality holds if and only $\mathbf{x} = \mathbf{0}$.
</MathBox>

Let $\Set{\mathbf{e}_i}_{i=1}^n$ be a basis for an $n$-dimensional inner product space $V$ and let $\mathbf{A}\in\mathcal{M}_n (\mathbb{F})$ be an $n\times n$ matrix with entries $a_{ij} = \langle\mathbf{e}^i, \mathbf{e}^j\rangle$. The inner product of any two vectors $\mathbf{x} = \sum_{i=1}^n x^i \mathbf{e}^i$ and $\mathbf{y} = \sum_{i=1}^n y^i \mathbf{e}^i$ takes the form

$$
\begin{align*}
  \langle\mathbf{x},\mathbf{y}\rangle =& \left\langle \sum_{i=1}^n x^i \mathbf{e}_i, \sum_{j=1}^n y^j \mathbf{e}_j \right\rangle \\
  =& \sum_{i=1}^n \sum_{j=1}^n a_{ij}x^i y^i = \mathbf{x}^\top \mathbf{Ay}
\end{align*}
$$

To see that this defines an inner product, note that because $\mathbf{A}$ is positive-definite we have $\langle\mathbf{x},\mathbf{x}\rangle = \mathbf{x}^\top \mathbf{A}\mathbf{x} \geq 0$ with equality if and only if $\mathbf{x} = \mathbf{0}$. Because $\mathbf{A}$ is symmetric, we get

$$
\begin{align*}
  \langle \mathbf{y},\mathbf{x}\rangle =& \mathbf{y}^\top \mathbf{Ax} (\mathbf{x}^\top \mathbf{A}^\top \mathbf{y}^\top)^\top \\
  =& (\mathbf{x}^\top \mathbf{Ay})^\top = \mathbf{x}^\top \mathbf{Ay} \\
  =& \langle\mathbf{x},\mathbf{y}\rangle
\end{align*}
$$

Let ${\varepsilon^j}_{j=1}^n$ be the basis of the dual space $V^*$. If 

$$
\begin{align*}
  \langle\mathbf{x},\mathbf{y}\rangle =& \sum_{i,j=1}^n a_{ij}x^i y^j = \sum_{i,j=1}^n a_{ij} \varepsilon^i (\mathbf{x}) \varepsilon^j (\mathbf{y}) \\
  =& \sum_{i,j=1}^n a_{ij} (\varepsilon^i \otimes\varepsilon^j)(\mathbf{x},\mathbf{y}) 
\end{align*}
$$

### Riemannian metric

<MathBox title='Riemannian metric' boxType='definition'>
A Riemannian metric on a smooth manifold $M$ is a smooth symmetric covariant $2$-tensor field $g$ on $M$ that is positive definite at each point. For each $\mathbf{p}\in M$, the 2-form $g_\mathbf{p}$ is an inner product on $T_\mathbf{p} M$, usually denoted

$$
  \langle \mathbf{v}, \mathbf{w} \rangle_g = g_\mathbf{p} (\mathbf{v}, \mathbf{w}),\; \mathbf{v},\mathbf{w}\in T_\mathbf{p} M
$$

In any smooth local coordinates $(x^i)$, a Riemannian metric can be written

$$
  g = g_{ij}\;\mathrm{d}x^i \otimes \mathrm{d}x^j
$$

where $(g_{ij})$ is a symmetric positive definite matrix of smooth functions, i.e. $g_{ij} = g_{ji}$. The symmetry of $g$ allows us to write $g$ in terms of symmetric products

$$
\begin{align*}
  g =& g_{ij}\;\mathrm{d}x^i \otimes \mathrm{d}x^j \\
  =& \frac{1}{2}(g_{ij}\;\mathrm{d}x^i \otimes \mathrm{d}x^j + g_{ji}\;\mathrm{d}x^i \otimes \mathrm{d}x^j) \\
  =& \frac{1}{2}(g_{ij}\;\mathrm{d}x^i \otimes \mathrm{d}x^j + g_{ij}\;\mathrm{d}x^j \otimes \mathrm{d}x^i) \\
  =& g_{ij} \;\mathrm{d}x^i\;\mathrm{d}x^j
\end{align*}
$$
</MathBox>

<MathBox title='Metric-preserving maps' boxType='definition'>
A smooth map $F:(M,g) \to (M, h)$ of Riemannian manifolds is *metric-preserving* if for all $\mathbf{p}\in M$ and tangent vectors $\mathbf{u},\mathbf{v}\in T_\mathbf{p} M$

$$
  \langle \mathbf{u},\mathbf{v}\rangle_\mathbf{p} = \langle F_* \mathbf{u}, F_* \mathbf{v} \rangle_{F_* (\mathbf{p})}
$$

An *isometry* is a metric-preserving diffeomorphism.
</MathBox>

## Curves

<MathBox title='Regular curves' boxType='definition'>
A parametrized curve $c:[a,b]\subseteq\R \to M$ in a smooth manifold $M$ is *regular* if its velocity $c'(t)$ is nonzero for all $t\in[0,1]$. In other words, a regular curve in $M$ is an immersion $[a,b]\to M$.
</MathBox>

<MathBox title='Piecewise smooth curves' boxType='definition'>
A parametrized curve $c:[a,b]\subseteq\R \to M$ in a smooth manifold $M$ is *piecewise smooth* if there exist numbers

$$
  a = t_0 < \cdots < t_r = b
$$

such that $c$ is smooth on $[t_i, t_{i+1}]$ for $i = 0,\dots,r-1$.
</MathBox>

The speed of a curve $c:[a,b]\to M$ in a Riemannian manifold $M$ is defined as the magnitude $\lVert c'(t) \rVert$ of its velocity $c'(t)$. The arc length of the curve is

$$
  \ell = \int_a^b \lVert c'(u) \rVert\;\mathrm{d}u
$$

For each $t\in[a,b]$, let $s(t)$ be the arc length of the curve $c$ restricted to $[a,t]$

$$
  s(t) = \int_a^t \lVert c'(u) \rVert\;\mathrm{d}u
$$

The function $s:[a,b]\to[0,\ell]$ is the arc length function of the curve $c$. By the fundamental theorem of calculus, the derivative of $s$ with respect to $t$ is $s'(t) = \lVert c'(t) \rVert$, the speed of $c$.

<MathBox title='Regular curves have diffeomorphic arc length functions' boxType='proposition'>
Let $M$ be a Riemannian manifold. The arc length function $s:[a,b]\to[0,\ell]$ of a regular curve $c:[a,b]\to M$ has a smooth inverse.

<details>
<summary>Proof</summary>

Because $c(t)$ is regular, $s'(t) = \lVert c'(t) \rVert$ is never zero, i.e. $s'(t) > 0$ for all $t\in[a,b]$. This implies that $s(t)$ is a monotonically increasing function, and so has an inverse $t(s)$. By the inverse function theorem, $t$ is a smooth function of $s$.
</details>
</MathBox>

Given a regular curve $c:[a,b]\to M$, we can write $t\in[a,b]$ as a smooth function of the arc length $s$ to get the arc length parametrization $\gamma(s) = c(t(s))$.

<MathBox title='' boxType='proposition'>
A curve is parametrized by arc length if and only if it has unit speed and its parameter starts at $0$.

<details>
<summary>Proof</summary>

The speed of a curve $c:[a,b]\to M$ in a Riemannian manifold $M$ can be computed as the rate of change of the arc length $s$ with respect to $t\in[a,b]$

$$
  \frac{\mathrm{d}s}{\mathrm{d}t} = \lVert c'(t) \rVert
$$

Let $\gamma(s)$ be the arc length reparametrization of $c$. Since $s(a) = 0$, the parameter $s$ starts at $0$. By the chain rule, the velocity of $\gamma$ is

$$
  \gamma'(s) = c'(t(s))t'(s)
$$

Thus, the speed of $\gamma$ is

$$
  \lVert\gamma'(s) \rVert = \lVert c'(t(s)) \rVert \cdot |t'(s)| = \frac{\mathrm{d}s}{\mathrm{d}t}\left|\frac{\mathrm{d}t}{\mathrm{d}s}\right| = \left|\frac{\mathrm{d}s}{\mathrm{d}t} \frac{\mathrm{d}t}{\mathrm{d}s}\right| = 1
$$

Conversely, if a curve $c(t)$ has unit speed, then its arc length is

$$
  s(t) = \int_a^t \lVert c'(u) \rVert\;\mathrm{d}u = \int_a^t 1\;\mathrm{d}u = t - a
$$

If $a = 0$, then $s = t$. So a unit-speed curve starting at $t = 0$ is parametrized by arc length.
</details>
</MathBox>

<MathBox title='Arc length parametrization of a circle' boxType='example'>
The curve $c:[0,2\pi]\to\R^2$ given by $c(t) = (a\cos t, a\sin t)$ for $a > 0$ is regular. Its image is the circle of radius $a$ centered at the origin. Its arc length function is

$$
\begin{align*}
  s =& \int_0^t \lVert c'(u) \rVert\;\mathrm{d}u = \int_0^t \left\lVert\begin{bmatrix} -a\sin t \\ a\cos t \end{bmatrix}\right\rVert\;\mathrm{d}u \\
  =& \int_0^t a\;\mathrm{d}u = at
\end{align*}
$$

Hence, $t = \frac{s}{a}$ and the arc length parametrization is

$$
  \gamma(s) = \left(a \cos\frac{s}{a}, a\sin\frac{s}{a} \right)
$$
</MathBox>

### Signed curvature of a plane curve

Consider a plane curve $\gamma:[0,\ell]\to\R^2$ parametrized by the arc length $s$. Then the velocity vector $\mathbf{T}(s) = \gamma'(s)$ has unit length and is tangent to the curve at the point $\mathbf{p} = \gamma(s)$. A reasonable measure of curvature at $\mathbf{p}$ is the magnitude of the derivative

$$
  \mathbf{T}'(s) = \frac{\mathrm{d}\mathbf{T}}{\mathrm{d}s}(s) = \gamma''(s)
$$

since the faster $\mathbf{T}$ changes, the more the curve bends. However, in order to distinguish the directions in which the curve can bend, we will define a curvature with a sign.

There are two unit vectors in the plane perpendicular to $\mathbf{T}(s)$ at $\mathbf{p}$. We can choose either one to be $\mathbf{n}(s)$, but usually $\mathbf{n}(s)$ is chosen so that the pair $(\mathbf{T}(s),\mathbf{n}(s))$ is oriented positively in the plane, i.e. counterclockwise.

Since $\mathbf{T}$ has unit length, we have $\langle\mathbf{T},\mathbf{T}\rangle = 1$. Applying the product rule, we get

$$
  \langle\mathbf{T}',\mathbf{T}\rangle + \langle\mathbf{T},\mathbf{T}'\rangle = 2 \langle\mathbf{T}',\mathbf{T}\rangle = 0
$$

Thus, $\mathbf{T}'$ is orthogonal to $\mathbf{T}$ and so it must be a multiple of $\mathbf{n}$. The scalar $\kappa\in\R$ such that

$$
  \mathbf{T}' = \kappa\mathbf{n}
$$

is called the *(signed) curvature* of the plane curve at $\mathbf{p} = \gamma(s)$. We can also write

$$
  \kappa = \langle \mathbf{T}', \mathbf{n}\rangle = \langle\gamma'', \mathbf{n}\rangle
$$

The sign of the curvature depends on the choice of $\mathbf{n}$; it indicates whether the curve is bending towards or away from $\mathbf{n}$.

<MathBox title='Curvature of a circle' boxType='example'>
The circle of radius $a$ centered at the origin has arc length parametrization

$$
  \gamma(s) = \left(a \cos\frac{s}{a}, a\sin\frac{s}{a} \right),\; 0 \leq s \leq 2\pi a
$$

The unit tangent vector to the curve is

$$
  \mathbf{T}(s) = \gamma'(s) = \begin{bmatrix} -\sin\frac{s}{a} \\ \cos\frac{s}{a} \end{bmatrix}
$$

Its derivative is 

$$
  \mathbf{T}'(s) = \gamma''(s) = \begin{bmatrix} -\frac{1}{a}\cos\frac{s}{a} \\ -\frac{1}{a}\sin\frac{s}{a} \end{bmatrix}
$$

We choose the unit normal $\mathbf{n}$ so that the pair $(\mathbf{T},\mathbf{n})$ is oriented counterclockwise. This means $\mathbf{n}$ is obtained from $\mathbf{T}$ by multiplying the rotation matrix

$$
  \operatorname{rot}\left(\frac{\pi}{2}\right) = \begin{bmatrix} 
    \cos\frac{\pi}{2} & -\sin\frac{\pi}{2} \\
    \sin\frac{\pi}{2} & \cos\frac{\pi}{2}
  \end{bmatrix} = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}
$$

Hence

$$
  \mathbf{n} = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix} \mathbf{T} = \begin{bmatrix} -\cos\frac{s}{a} \\ -\sin\frac{s}{a} \end{bmatrix}
$$

So $\mathbf{T}' = \frac{1}{a}\mathbf{n}$, which shows that the signed curvature $\kappa(s)$ of a circe of radius $a$ is $\frac{1}{a}$, independent of $s$. This accords with the intuition that the larger the radius of a circle, the smaller the curvature.
</MathBox>

### Orientation and curvature

A curve whose endpoints are fixed has two possible arc length parametrizations, depending on how the curve is oriented. If the arc length of the curve if $\ell$, the two parametrizations $\gamma(s)$ and $\tilde{\gamma}(s)$ are related by

$$
  \tilde{\gamma}(s) = \gamma(\ell - s)
$$

Differentiating with respect to the arc length $s$ gives

$$
  \tilde{\mathbf{T}}(s) := \tilde{\gamma}(s) = -\gamma'(\ell - s) = -\mathbf{T}(\ell - s)
$$

and $\tilde{\gamma}''(s) = \gamma''(\ell - s)$. Rotating the tangent vector $\tilde{\mathbf{T}}(s)$ by $90\degree$ amounts to multiplying $\tilde{\mathbf{T}}(s)$ in the left by the rotation matrix $\operatorname{rot}\left(\frac{\pi}{2}\right)$. Thus

$$
  \tilde{\mathbf{n}}(s) = \operatorname{rot}\left( \frac{\pi}{2} \right)\tilde{\mathbf{T}}(s) = -\operatorname{rot}\left(\frac{\pi}{2}\right)\mathbf{T}(\ell - s) = -\mathbf{n}(\ell - s)
$$

It follows that the signed curvature of $\tilde{\gamma}(s) = \gamma(\ell - s)$ is

$$
  \tilde{\kappa}(s) = \langle\tilde{\gamma}''(s),\tilde{\mathbf{n}}(s)\rangle = \langle\gamma''(\ell - s),-\mathbf{n}(\ell - s)\rangle = -\kappa(\ell - s)
$$

## Curvature of surfaces in $\R^3$

### Principal, mean and Guassian curvature

Recall that a *regular submanifold* of a manifold $\tilde{M}$ is a subset of the manifold $\tilde{M}$ locally defined by the vanishing of coordinate functions. A surface in $\R^3$ is a 2-dimensional regular submanifold of $\R^3$. Let $\mathbf{p}$ be a point on a surface $M$ in $\R^3$. A *normal vector* to $M$ at $\mathbf{p}$ is a vector $\mathbf{N}_\mathbf{p}\in T_\mathbf{p}\R^3$ that is orthogonal to the tangent plane $T_\mathbf{p} M$. A *normal vector field* on $M$ is a function $\mathbf{N}$ that assigns to each $\mathbf{p}\in M$ a normal vector $\mathbf{N}_\mathbf{p}$ at $\mathbf{p}$. If $\mathbf{N}$ is a normal vector field on $M$, then at each point $\mathbf{p}\in M$, we can write

$$
  \mathbf{N}_\mathbf{p} = \sum_{i=1}^3 a^i (\mathbf{p}) \left.\frac{\partial}{\partial x^i}\right|_{\mathbf{p}}
$$

The normal vector field $\mathbf{N}$ on $M$ is smooth if the coefficient functions $a^i$ are smooth functions on $M$.

Consider the unit normal vector $\mathbf{N}_\mathbf{p}$ at $\mathbf{p}$. Under the canonical identification of $T_\mathbf{p} \R^3$ with $\R^3$, every plane $P$ through $\mathbf{N}_\mathbf{p}$ slice the surface $M$ along a plane curve $P\cap M$ through $\mathbf{p}$.

By the transversality theorem, the intersection $P\cap M$, being transversal, is smooth. We call such a plane curce a *normal section* of the surface through $\mathbf{p}$. Assuming that the normal section have smooth parametrizations, we can compute the curvature of a normal section with respect to $\mathbf{N}_\mathbf{p}$.

Each unit tangent vector $\mathbf{X_p}$ to the surface $M$ at $\mathbf{p}$ determines together with $\mathbf{N}_\mathbf{p}$ a plane that slices $M$ along a normal section. Moreover, the unit tangent vector $\mathbf{X_p}$ determines an orientation of the normal section. Let $\gamma(s)$ be the arc length parametrization of this normal section with initial point $\gamma(0) = \mathbf{p}$ and initial vector $\gamma'(0) = \mathbf{X_p}$. Note that $\gamma(s)$ is completely determined by the unit tangent vector $\mathbf{X_p}$. Define the *normal curvature* of the normal section $\gamma'(s)$ at $\mathbf{p}$ with respect to $\mathbf{N}_\mathbf{p}$ by

$$
  \kappa(\mathbf{X_p}) = \langle\gamma''(0), \mathbf{N}_\mathbf{p}\rangle
$$

Since the set of all unit vectors in $T_\mathbf{p} M$ is a circle, it follows that $\kappa:\mathbb{S}^1 \to\R$. Clearly, $\kappa(-\mathbf{X_p}) = \kappa(\mathbf{X_p})$ for $\mathbf{X_p}\in \mathbb{S}^1$, because replacing a unit tangent vector by its negative simply reverses the orientation of the normal section, which reverses the sign of the first derivative $\gamma'(s)$ but does not change the sign of the second derivative $\gamma''(s)$.

The maximum and minimum values $\kappa_1,\kappa_2$ of the function $\kappa$ are the *principal curvatures* of the surface at $\mathbf{p}$. Their average $H = \frac{(\kappa_1 + \kappa_2)}{2}$ is the *mean curvature*, and their product $K = \kappa_1 \kappa_2$ is the *Gaussian curvature*. A unit direction $\mathbf{X_p}\in T_\mathbf{p}M$ along which a principal curvature occurs is called a *principal direction*. Note that if $\mathbf{X_p}$ is a principal direction, then so is $-\mathbf{X_p}$, since $\kappa(-\mathbf{X_p}) = \kappa(\mathbf{X_p})$. If $\kappa_1$ and $\kappa_2$ are equal, then every unit vector in $T_\mathbf{p} M$ is a principal direction.

Using $-\mathbf{N}_\mathbf{p}$ instead of $\mathbf{N}_\mathbf{p}$ reverses the sign of all the normal curvatures at $\mathbf{p}$. This will change the sign of the mean curvature, but it leaves the Gaussian curvature invariant. Thus, the Gaussian curvature is independent of the choice of the unit normal vector field $\mathbf{N}$.

### Normal vector fields

Recall that a point $\mathbf{p}\in\R^n$ is a *regular point* of a function $f:\R^n \to\R$ if the differential $f_{*,\mathbf{p}}: T_\mathbf{p}\R^n \to T_{f(\mathbf{p})}\R$ is surjective, equivalently, if at least one partial derivative $\frac{\partial f}{\partial x^i}(\mathbf{p})$ is nonzero. A point $q\in\R$ is a *regular value* if its inverse image $f^{-1}(q)$ consists entirely of regular points; otherwise, it is a *singular value*.

A *hypersurface* in $\R^n$ is the zero set $Z(f)$ of a smooth function $f$ on $\R^n$. Consider a hypersurface $M$ in $\R^3$ defined as the zero set of the smooth function $f(x,y,z)$. We assume that the partial derivatives $f_x, f_y, f_z$ dot not vanish simultaneously on $M$. Then $0$ is a regular value of $f$, and $M = f^{-1}(0)$ is a regular level set. By the regular level set theorem, $M$ is a regular submanifold of $\R^3$.

As a submanifold of $\R^3$, it follows that $M$ inherits a Riemannian metric from the Euclidean metric on $\R^3$. Let $B = \operatorname{grad}(f) = \langle f_x, f_y, f_z \rangle$ be the gradient vector field of $f$ on $M$.

<MathBox title='' boxType='proposition'>
If $0$ is a regular value of the smooth function $f$ on $\R^3$, then $\mathbf{N} = \operatorname{grad}(f)$ is a nowhere-vanishing normal vector field along the smooth hypersurface $M = Z(f)$.

<details>
<summary>Proof</summary>

Let $\mathbf{p}\in M$ and $\mathbf{X_p}\in T_\mathbf{p}M$. It suffices to show that $\langle \mathbf{N}_\mathbf{p},\mathbf{X_p}\rangle = 0$. Choose a curve $c(t) = (x(t), y(t), z(t))$ in $M$ with $c(0) = \mathbf{p}$ and $c'(0) = \mathbf{X_p}$. Since $c(t)$ lies on $M$, then $f(c(t)) = 0$ for all $t$. By the chain rule

$$
\begin{align*}
  0 =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(c(t)) \\
  =& f_x (\mathbf{p})x'(0) + f_y (\mathbf{p}) y'(0) + f_z (\mathbf{p}) z'(0)
\end{align*}
$$

Hence

$$
  \langle \mathbf{N}_\mathbf{p}, \mathbf{X_p} \rangle = \langle\operatorname{grad}(f)(\mathbf{p}), c'(0)\rangle = 0
$$
</details>
</MathBox>

By dividing $\operatorname{grad}(f)$ by its magnitude, we obtain a smooth unit normal vector field along the hypersurface $M$. Since a smooth surface in $\R^3$, orientable or not, is locally the zero set of a coordinate function, it follows from this proposition that a smooth unit normal vector field exits locally along any smooth surface in $\R^3$.

### The shape operator

Let $\mathbf{p}$ be a point on a surface $M$ in $\R^3$ and let $\mathbf{N}$ be a smooth unit normal vector field on $M$. For any tangent vector $\mathbf{X_p}\in T_\mathbf{p}M$, define

$$
  L_\mathbf{p}(\mathbf{X_p}) := -\mathrm{D}_{\mathbf{X_p}} \mathbf{N}
$$

This directional derivative makes sense, since $\mathbf{N}$ is defined along some curve with initial vector $\mathbf{X_p}$. The negative sign in $L_\mathbf{p}$ assures that other formulas will be sign-free. Applying the vector $\mathbf{X_p}$ to $\langle \mathbf{N},\mathbf{N}\rangle \equiv 1$ gives

$$
\begin{align*}
  0 =& \mathbf{X_p}\langle \mathbf{N},\mathbf{N}\rangle \\
  =& \langle \mathrm{D}_{\mathbf{X_p}} \mathbf{N},\mathbf{N}_\mathbf{p}\rangle + \langle \mathbf{N}_\mathbf{p}, \mathbf{D}_{\mathbf{X_p}}\mathbf{N} \rangle \\
  =& 2\langle \mathbf{D}_{\mathbf{X_p}} \mathbf{N},\mathbf{N}_\mathbf{p}\rangle
\end{align*}
$$

Thus, $\mathbf{D}_{\mathbf{X_p}} N$ is perpendicular to $\mathbf{N}_\mathbf{p}$ at $\mathbf{p}$ and is therefore in the tangent plane $T_\mathbf{p} M$. So $L_\mathbf{p}:T_\mathbf{p}M \to T_\mathbf{p}M$ is a linear map called the *shape operator* or the *Weingarten map* of the surface $M$ at $\mathbf{p}$. Note that the shape operator depends on the unit normal vector field $\mathbf{N}$ and the point $\mathbf{p}$. With the unit normal vector field $\mathbf{N}$ on $M$ fixed, as the point $\mathbf{p}$ varies in $M$, there is a different shape operator $L_\mathbf{p}$ at each $\mathbf{p}$.

<MathBox title='' boxType='lemma'>
Let $M$ be a surface in $\R^3$ have a smooth unit normal vector field $\mathbf{N}$. For $\mathbf{X},\mathbf{Y}\in\mathfrak{M}$

$$
  \langle L(\mathbf{X}),\mathbf{Y} \rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle
$$

<details>
<summary>Proof</summary>

Since $\mathbf{Y}$ is tangent to $M$, the inner product $\langle\mathbf{Y},\mathbf{N} \rangle$ is identically zero on $U$. Differentiating the equation $\langle\mathbf{Y},\mathbf{N} \rangle \equiv 0$ with respect to $\mathbf{X}$ yields

$$
\begin{align*}
  0 = \mathbf{X} \langle\mathbf{Y},\mathbf{N} \rangle =& \langle\mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} \mathbf{N} \rangle \\
  =& \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle - \langle\mathbf{Y}, L(\mathbf{X}) \rangle  
\end{align*}
$$

Hence

$$
  \langle L(\mathbf{X}),\mathbf{Y}\rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
The shape operator in $\R^3$ is self-adjoint. That is, for any $\mathbf{X_p}, \mathbf{Y_p} \in T_\mathbf{p}M$

$$
  \langle L(\mathbf{X_p}), \mathbf{Y}\rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle
$$

<details>
<summary>Proof</summary>

Suppose the smooth unit normal vector field $\mathbf{N}$ is defined on a neighbourhood $U$ of $\mathbf{p}$. Let $\mathbf{X},\mathbf{Y}$ be vector fields on $U$ extending the vectors $\mathbf{X_p}, \mathbf{Y_p}$ at $\mathbf{p}$. By the previous lemma

$$
  \langle L(\mathbf{X}),\mathbf{Y} \rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle
$$

Similarly, reversing the roles of $\mathbf{X}$ and $\mathbf{Y}$, we have

$$
  \langle L(\mathbf{Y}),\mathbf{X}\rangle = \langle\mathrm{D}_\mathbf{Y} \mathbf{X},\mathbf{N} \rangle
$$

By the properties of the directional derivative, we have $\mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} = [\mathbf{X},\mathbf{Y}]$. Combining these equations, we get

$$
\begin{align*}
  \langle L(\mathbf{X}),\mathbf{Y}\rangle - \langle L(\mathbf{Y}),\mathbf{X}\rangle =& \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N} \rangle - \langle\mathrm{D}_\mathbf{Y} \mathbf{X},\mathbf{N} \rangle \\
  =& \langle\mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X},\mathbf{N}\rangle \\
  =& \langle[\mathbf{X},\mathbf{Y}],\mathbf{N}\rangle \\
  =& 0
\end{align*}
$$

where the last equality follows since $[\mathbf{X},\mathbf{Y}]$ is a tangent vector field on $M$. Hence

$$
  \langle L(\mathbf{X}),\mathbf{Y} \rangle = \langle L(\mathbf{Y}), \mathbf{X}\rangle = \langle\mathbf{X}, L(\mathbf{Y})\rangle
$$
</details>
</MathBox>

If $T:V\to W$ is a linear map between two vector spaces $V$ and $W$, with respective bases $B_V = \Set{\mathbf{v}_i}_{i=1}^n$ and $B_W = \Set{\mathbf{w}_j}_{j=1}^m$, then

$$
  T(\mathbf{v}_j) = \sum_{i=1}^m a^i_j \mathbf{w}_i,\; j = 1,\dots,n
$$

for a unique matrix $[a^i_j]$, called the *matrix* of the linear map $T$ with respect to the bases $B_V$ and $B_W$. It follows from the previous propositions that the matrix of the shape operator with respect to an orthonormal basis for $T_\mathbf{p} M$ is symmetric, for if $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal basis for $T_\mathbf{p} M$ and

$$
\begin{align*}
  L(\mathbf{e}_1) =& a\mathbf{e}_1 + b\mathbf{e}_2 \\
  L(\mathbf{e}_2) =& h\mathbf{e}_1 + c\mathbf{e}_2
\end{align*}
$$

then

$$
  b = \langle L(\mathbf{e}_1),\mathbf{e}_2\rangle = \langle\mathbf{e}_1, L(\mathbf{e}_2)\rangle = h
$$

Since the eigenvalues of a symmetric matrix are real, the shape operator has real eigenvalues.

### Curvature and the shape operator

<MathBox title='' boxType='proposition'>
Let $M$ be a surface in $\R^3$ having a smooth unit normal vector field $\mathbf{N}$. Suppose $c:[a,b]\to M$ is a curve in $M$ and let $\mathbf{V}(t)$ be a vector field in $M$ along $c$. Then

$$
  \langle L(c'(t)), \mathbf{V}(t)\rangle = \left\langle \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}(t), \mathbf{N}_{c(t)} \right\rangle
$$

<details>
<summary>Proof</summary>

Since $\mathbf{V}(t)$ is tangent to $M$, then $\langle \mathbf{V}(t), \mathbf{N}_{c(t)}\rangle \equiv 0$. Differentiating with respect to $t$ yields

$$
  0 =& \frac{\mathrm{d}}{\mathrm{d}t} \langle \mathbf{V}(t), \mathbf{N}_{c(t)}\rangle \\
  =& \left\langle \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}(t), \mathbf{N}_{c(t)} \right\rangle + \left\langle \mathbf{V}(t), \frac{\mathrm{d}}{\mathrm{d}t}\mathbf{N}_{c(t)} \right\rangle \\
  =& \left\langle \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}(t), \mathbf{N}_{c(t)} \right\rangle + \langle \mathbf{V}(t), \mathrm{D}_{c'(t)}\mathbf{N} \rangle
$$

Thus

$$
  \langle \mathbf{V}(t), L(c'(t)) \rangle = \langle \mathbf{V}(t), -\mathrm{D}_{c'(t)} N\rangle = \left\langle \frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t}, \mathbf{N}_{c(t)} \right\rangle
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a surface in $\R^3$ having a smooth unit normal vector field $\mathbf{N}$. Suppose $\gamma(s)$ is a normal section, parametrized by arc length, determined by a unit tangent vector $\mathbf{X_p} \in T_\mathbf{p} M$ and the unit normal vector $\mathbf{N}_\mathbf{p}$. Then the normal curvature of $\gamma(s)$ with respect to $\mathbf{N}_\mathbf{p}$ at $\mathbf{p}$ is given by the second fundamental form

$$
  \kappa(\mathbf{X_p}) = \langle L(\mathbf{X_p}), \mathbf{X_p}\rangle = \mathrm{II}(\mathbf{X_p}, \mathbf{X_p})
$$

<details>
<summary>Proof</summary>

By definition, $\gamma(0) = \mathbf{p}$ and $\gamma'(0) = \mathbf{X_p}$. Let $\mathbf{T}(s) := \gamma'(s)$ be the unit tangent vector field along $\gamma(s)$. Then the curvature of the normal section $\gamma(s)$ is

$$
\begin{align*}
  \kappa(\gamma'(s)) =& \langle\gamma''(s),\mathbf{N}_{\gamma(s)}\rangle \\
  =& \left\langle\frac{\mathrm{d}T}{\mathrm{d}s},\mathbf{N}_{\gamma(s)}\right\rangle \\
  =& \langle L(\gamma'(s)),\mathbf{T}\rangle \\
  =& \langle L(\mathbf{T}),\mathbf{T}\rangle
\end{align*}
$$

Evaluating at $s = 0$ gives

$$
  \kappa(\mathbf{X_p}) = \langle L(\mathbf{X_p}), \mathbf{X_p}\rangle = \mathrm{II}(\mathbf{X_p},\mathbf{X_p})
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
The principal directions of the surface $M$ in $\R^3$ at $\mathbf{p}$ are the unit eigenvectors of the shape operator $L$; the principal curvatures are the eigenvalues of $L$.

<details>
<summary>Proof</summary>

The principal curvatures at $\mathbf{p}$ are the maxium and minimum values of the function

$$
  \kappa(\mathbf{X_p}) = \mathrm{II}(\mathbf{X_p}, \mathbf{X_p}) = \langle L(\mathbf{X_p}), \mathbf{X_p} \rangle
$$

for $\mathbf{X_p}\in T_\mathbf{p} M$ satisfying $\langle \mathbf{X_p}, \mathbf{X_p}\rangle = 1$. Choose an orthonormal basis $\Set{\mathbf{e}_1,\mathbf{e}_2}$ for $T_\mathbf{p} M$ so that

$$
  \mathbf{X_p} = x\mathbf{e}_1 + y\mathbf{e}_2 = \begin{bmatrix} x \\ y \end{bmatrix} 
$$

Since $L$ is self-adjoint, its matrix relative to the basis $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is a symmetric matrix

$$
  \mathbf{A} = \begin{bmatrix} a & b \\ b & c \end{bmatrix}
$$

meaning that

$$
\begin{align*}
  L(\mathbf{e}_1) =& a\mathbf{e}_1 + b\mathbf{e}_2 \\
  L(\mathbf{e}_2) =& b\mathbf{e}_1 + c\mathbf{e}_2
\end{align*}
$$

In matrix notation

$$
\begin{align*}
  L(\mathbf{X_p}) =& L(x\mathbf{e}_1 + y\mathbf{e}_2) = (ax + by)\mathbf{e}_1 + (bx + cy)\mathbf{e}_2 \\
  =& \begin{bmatrix} ax + by \\ bx + cy \end{bmatrix} = \begin{bmatrix} a & b \\ b & c \end{bmatrix}\cdot\begin{bmatrix} x \\ y \end{bmatrix} = \mathbf{A}\mathbf{X_p}
\end{align*}
$$

It remains to find the extremal values of the function

$$
\begin{align*}
  \kappa(\mathbf{X_p}) =& \langle L(\mathbf{X_p}), \mathbf{X_p}\rangle = \langle \mathbf{A}\mathbf{X_p}, \mathbf{X_p}\rangle \\
  =& \mathbf{X_p}^T \mathbf{A} \mathbf{X_p} \\
  =& ax^2 + 2bxy + cy^2
\end{align*}
$$

subject to the constraint

$$
  f(\mathbf{X_p}) = \langle \mathbf{X_p}, \mathbf{X_p}\rangle = x^2 + y^2 = 1
$$

The gradient of $\kappa$ is

$$
  \operatorname{grad}(\kappa) = \begin{bmatrix} 2ax + 2by \\ 2bx + 2cy \end{bmatrix} = 2\mathbf{A}\mathbf{X_p}
$$

and the gradient of $f$ is $\operatorname{grad}(g) = 2\mathbf{X_p}$. By the method of the Lagrange multiplies, at the maximum or minimum of $\kappa$, the is a scalar $\lambda$ such that

$$
  \operatorname{grad}\kappa = \lambda\operatorname{grad}(f)
$$

or $\mathbf{A}\mathbf{X_p} = \lambda \mathbf{X_p}$. Thus, the maximum and minimum of $\kappa$ occur at the unit eigenvectors of $\mathbf{A}$. These are the principal directions at $\mathbf{p}$.

Let $\mathbf{X_p}$ be a principal direction at $\mathbf{p}$. Then the corresponding principal curvaturre is the normal curvature

$$
\begin{align*}
  \kappa(\mathbf{X_p}) =& \langle L(\mathbf{X_p}), \mathbf{X_p}\rangle = \langle\mathbf{A}\mathbf{X_p}, \mathbf{X_p}\rangle \\
  =& \langle\lambda \mathbf{X_p}, \mathbf{X_p}\rangle = \lambda\langle \mathbf{X_p},\mathbf{X_p}\rangle = \lambda 
\end{align*}
$$

which is the eigenvalue associated to the eigenvector $\mathbf{X_p}$.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
1. The Gaussian curvature of a surface $M$ in $\R^3$ is the determinant of the shape operator.
2. If $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal basis for the tangent space $T_\mathbf{p}M$ of the surface $M$, then the Gaussian curvature at $\mathbf{p}$ is
$$
  K = \langle L(\mathbf{e}_1), \mathbf{e}_1\rangle \langle L(\mathbf{e}_2),\mathbf{e}_2\rangle - \langle L(\mathbf{e}_1), \mathbf{e}_2\rangle \langle L(\mathbf{e}_2), \mathbf{e}_1\rangle
$$

<details>
<summary>Proof</summary>

**(1):** The determinant of a linear map is the product of its eigenvalues. For the shape operator $L$ the eigenvalues are the principal curvatures $\kappa_1, \kappa_2$. So $\det(L) = \kappa_1 \kappa_2 = K$, the Gaussian curvature.

**(2):** If 

$$
\begin{align*}
  L(\mathbf{e}_1) =& a\mathbf{e}_1 + b\mathbf{e}_2 \\
  L(\mathbf{e}_2) =& b\mathbf{e}_1 + c\mathbf{e}_2
\end{align*}
$$

then

$$
\begin{align*}
  a =& \langle L(\mathbf{e}_1), \mathbf{e}_1 \rangle \\
  b =& \langle L(\mathbf{e}_1), \mathbf{e}_2 \rangle = \langle L(\mathbf{e}_2, \mathbf{e}_1) \rangle \\
  c =& \langle L(\mathbf{e}_2), \mathbf{e}_2 \rangle
\end{align*}
$$

The matrix of $L$ relative to the orthonormal basis $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is $\mathbf{A} = \left[\begin{smallmatrix} a & b \\ b & c \end{smallmatrix}\right]$. Hence

$$
\begin{align*}
  \det(L) =& ac - b^2 \\
  =& \langle L(\mathbf{e}_1), \mathbf{e}_1\rangle \langle L(\mathbf{e}_2),\mathbf{e}_2\rangle - \langle L(\mathbf{e}_1), \mathbf{e}_2\rangle \langle L(\mathbf{e}_2), \mathbf{e}_1\rangle
\end{align*}
$$
</details>
</MathBox>

### The first and second fundamental forms

At a point $\mathbf{p}$ of a smooth surface $M$ in $\R^3$, the Euclidean Riemannian metric is a symmetric bilinear form on the tangent space $T_\mathbf{p} M$, called the *first fundamental form* of $M$ at $\mathbf{p}$. If $L: T_\mathbf{p} M\to T_\mathbf{p} M$ is the shape operator, the symmetric bilinear form on $T_\mathbf{p} M$

$$
  \mathrm{II}(\mathbf{X_p}, \mathbf{X_p}) = \langle L(\mathbf{X_p}), \mathbf{X_p}\rangle
$$

is called the *second fundamental form* of the surface $M$ at $\mathbf{p}$. THe first fundamental form is the metric and the second fundamental form is essentially the shape operator. These two fundamental forms encode in the much of the geometry of the surface $M$.

Let $\Set{\mathbf{e}_1,\mathbf{e}_2}$ be a basis for the tangent space $T_\mathbf{p} M$. We set

$$
\begin{align*}
  E :=& \langle\mathbf{e}_1,\mathbf{e}_1\rangle \\
  F :=& \langle\mathbf{e}_1,\mathbf{e}_2\rangle \\
  G :=& \langle\mathbf{e}_2,\mathbf{e}_2\rangle
\end{align*}
$$

If $\mathbf{X_p} = x^1 \mathbf{e}_1 + x^2 \mathbf{e}_2$ and $\mathbf{Y_p} = y^1 \mathbf{e}_1 + y^2 \mathbf{e}_2$, then

$$
\begin{align*}
  \langle \mathbf{X_p}, \mathbf{Y_p}\rangle =& \langle\mathbf{e}_1, \mathbf{e}_2\rangle x^1 y^1 + \langle\mathbf{e}_1,\mathbf{e}_2\rangle x^1 y^2 \\
  &+ \langle\mathbf{e}_2, \mathbf{e}_1 \rangle x^2 y^1 + \langle\mathbf{e}_2,\mathbf{e}_2\rangle x^2 y^2 \\
  =& Ex^1 y^1 + Fx^1 y^2 + Fx^2 y^1 + Gx^2 + y^2 \\
  =& \begin{bmatrix} x^1 & x^2 \end{bmatrix} \begin{bmatrix} E & F \\ F & G \end{bmatrix} \begin{bmatrix} y^1 \\ y^2 \end{bmatrix}
\end{align*}
$$

Thus, the three coefficients $E,F,G$ determine completely the first fundamental form of $M$ at $\mathbf{p}$ relative to $\Set{\mathbf{e}_1,\mathbf{e}_2}$.

Similarly, the three coefficients

$$
\begin{align*}
  e := \mathrm{II}(\mathbf{e}_1, \mathbf{e}_1) \\
  f := \mathrm{II}(\mathbf{e}_1, \mathbf{e}_2) \\
  g := \mathrm{II}(\mathbf{e}_2, \mathbf{e}_2)
\end{align*}
$$

determine completely the second fundamental form of $M$ at $\mathbf{p}$ $\Set{\mathbf{e}_1,\mathbf{e}_2}$

$$
  \mathrm{II}(\mathbf{X_p},\mathbf{X_p}) = \begin{bmatrix} x^1 & x^2 \end{bmatrix}\begin{bmatrix} e & f \\ f & g \end{bmatrix} \begin{bmatrix} y^1 \\ y^2 \end{bmatrix}
$$

As $\mathbf{p}$ varies in an open set $U$, if $\Set{\mathbf{e}_1,\mathbf{e}_2}$ remain a basis of $T_\mathbf{p} M$ at each point, these coefficients are six function on $U$. Classically, $M$ is taken to be a coordinate patch $(U, u, v)$ with $\mathbf{e}_1 = \frac{\partial}{\partial u}$ nad $\mathbf{e}_2 = \frac{\partial}{\partial v}$, and the differential geometry of $M$ is done in the six function $E, F, G, e, f, g$.

<MathBox title='' boxType='theorem'>
Suppose $M$ and $M'$ are two smooth Riemannian manifolds of dimension $2$, and $\varphi:M\to M'$ is a diffeomorphism. Let $E,F,G$ be the coefficients of the first fundamental form relative to a frame $\mathbf{e}_1,\mathbf{e}_2$ on $M$, and $E',F',G'$ the corresponding coefficients relative to $\mathbf{e}'_1 := \varphi_* \mathbf{e}_1$ and $\mathbf{e}'_2 := \varphi_* \mathbf{e}_2$ on $M'$. Then $\varphi$ is an isometry if and only if $E,F,G$ at $\mathbf{p}$ are equal to $E', F', G'$ at $\varphi(\mathbf{p})$, respectively, for all $\mathbf{p}\in M$.

<details>
<summary>Proof</summary>

The diffeomorphism $\varphi$ is an isomorphism if and only if

$$
  \langle \varphi_* \mathbf{X_p}, \varphi_* \mathbf{Y_p} \rangle_{\varphi(\mathbf{p})} = \langle \mathbf{X_p}, \mathbf{Y_p} \rangle_\mathbf{p}
$$

This condition holds if and only if

$$
  \langle \varphi_* \mathbf{e}_i, \varphi_* \mathbf{e}_j \rangle_{\varphi(\mathbf{p})} = \langle \mathbf{e}_i, \mathbf{e}_j \rangle_\mathbf{p}, \forall i,j = 1,2 
$$

that is

$$
\begin{align*}
  E'(\varphi(\mathbf{p})) =& E(\mathbf{p}) \\
  F'(\varphi(\mathbf{p})) =& F(\mathbf{p}) 
  G'(\varphi(\mathbf{p})) =& G(\mathbf{p}) 
\end{align*}
$$
</details>
</MathBox>

### Levi-Civita connection

<MathBox title='Metric compatility for connections' boxType='definition'>
On a Riemannian manifold $M$, a connection $\nabla$ is *metric compatible* if for all $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(M)$

$$
  \mathbf{Z}\langle\mathbf{X},\mathbf{Y}\rangle = \langle\nabla_\mathbf{Z} \mathbf{X},\mathbf{Y}\rangle + \langle\mathbf{X}, \nabla_\mathbf{Z} \mathbf{Y}\rangle
$$
</MathBox>

<MathBox title='Levi-Civita connection' boxType='definition'>
On a Riemannian manifold, a *Levi-Civita connection*, also called a *Riemannian connection*, is an affine connection that is torsion-free and metric compatible.
</MathBox>

<MathBox title='' boxType='lemma'>
A smooth vector field $\mathbf{X}$ on a Riemannian manifold $(M,g)$ is uniquely determined by the values $\langle\mathbf{X},\mathbf{Z}\rangle$ for $\mathbf{Z}\in\mathfrak{X}(M)$.

<details>
<summary>Proof</summary>

We need to show that if $X'\in\mathfrak{X}(M)$ and $\langle \mathbf{X},\mathbf{Z}\rangle = \langle\mathbf{X}',\mathbf{Z}\rangle$ for all $\mathbf{Z}\in\mathfrak{X}(M)$, then $\mathbf{X} = \mathbf{X}'$. With $\mathbf{Y} = \mathbf{X} - \mathbf{X}'$, this is equivalent to showing that if $\langle\mathbf{Y},\mathbf{Z}\rangle = 0$ for all $\mathbf{Z}\in\mathfrak{X}(M)$, then $\mathbf{Y} = 0$. Take $\mathbf{Z} = \mathbf{Y}$. By the positive-definiteness of the inner product at point $\mathbf{p}\in M$

$$
  \langle\mathbf{Y},\mathbf{Y}\rangle = 0 \implies& \langle \mathbf{Y_p}, \mathbf{Y_p}\rangle = 0 \; \forall \mathbf{p}\in M \\
  \implies& \mathbf{Y_p} = 0 \; \forall\mathbf{p}\in M \\
  \implies& \mathbf{Y} = 0
$$
</details>
</MathBox>

<MathBox title='Fundamental theorem of Riemannian manifolds' boxType='theorem'>
On a Riemannian manifold there is a unique Levi-Civita connection.

<details>
<summary>Proof</summary>

Suppose $\nabla$ is a Levi-Civita connection on $M$. By the previous lemma, to specify $\nabla_\mathbf{X} \mathbf{Y}$, it suffices to know $\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle$ for every vector field $\mathbf{Z}\in\mathfrak{X}(M)$. We seek to find a formula for $\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle$ involving only the Riemannian metric and canonical operations on vector fields such as the Lie bracket.

As the Levi-Civita connection is torsion-free and metric compatible, it satifies the two equations

$$
\begin{gather*}
  \nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y} - [\mathbf{X},\mathbf{Y}] = 0 \\
  \mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle = \langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z} \rangle + \langle\mathbf{Y}, \nabla_\mathbf{X} \mathbf{Z} \rangle
\end{gather*}
$$

Cyclically permuting $\mathbf{X},\mathbf{Y},\mathbf{Z}$ in the last equation gives two additional equations

$$
\begin{align*}
  \mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle =& \langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z} \rangle + \langle\mathbf{Y}, \nabla_\mathbf{X} \mathbf{Z} \rangle \\
  \mathbf{Y}\langle \mathbf{Z},\mathbf{X}\rangle =& \langle\nabla_\mathbf{Y} \mathbf{Z}, \mathbf{X}\rangle + \langle\mathbf{Z}, \nabla_\mathbf{Y} \mathbf{X}\rangle \\
  \mathbf{Z}\langle \mathbf{X},\mathbf{Y}\rangle =& \langle\nabla_\mathbf{Z} \mathbf{X},\mathbf{Y} \rangle + \langle\mathbf{X}, \nabla_\mathbf{Z} \mathbf{Y}\rangle
\end{align*}
$$

From the torsion-free equation we can rewrite $\nabla_\mathbf{Y} \mathbf{X}$ in terms of $\nabla_\mathbf{X} \mathbf{Y}$

$$
  \mathbf{Y}\langle\mathbf{Z},\mathbf{X}\rangle = \langle\nabla_\mathbf{Y} \mathbf{Z}, \mathbf{X}\rangle + \langle\mathbf{Z},\nabla_\mathbf{X} \mathbf{Y}\rangle - \langle\mathbf{Z}, [\mathbf{X},\mathbf{Y}]\rangle
$$

Subracting $\mathbf{Z}\langle \mathbf{X},\mathbf{Y}\rangle$ from $\mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle$ and then adding $\mathbf{Y}\langle \mathbf{Z},\mathbf{X}\rangle$, will create terms involving $\nabla_\mathbf{X} \mathbf{Z} - \nabla_\mathbf{Z} \mathbf{X}$ and $\nabla_\mathbf{Y} \mathbf{Z} - \nabla_\mathbf{Z} \mathbf{Y}$, which are equal to $[\mathbf{X},\mathbf{Y}]$ and $[\mathbf{Y},\mathbf{Z}]$ by torsion-freeness

$$
\begin{align*}
  & \mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle + \mathbf{Y}\langle \mathbf{Z},\mathbf{X}\rangle - \mathbf{Z}\langle\mathbf{X},\mathbf{Y}\rangle \\
  =& 2\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle + \langle\mathbf{Y}, \nabla_\mathbf{X} \mathbf{Z} - \nabla_\mathbf{Z} \mathbf{X}\rangle + \langle\mathbf{X}, \nabla_\mathbf{Y} \mathbf{Z} - \nabla_\mathbf{Z} \mathbf{Y}\rangle - \langle\mathbf{Z}, [\mathbf{X},\mathbf{Y}]\rangle \\
  =& 2\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle + \langle\mathbf{Y}, [\mathbf{X},\mathbf{Z}]\rangle + \langle\mathbf{X},[\mathbf{Y},\mathbf{Z}]\rangle - \langle\mathbf{Z},[\mathbf{X},\mathbf{Y}]\rangle
\end{align*}
$$

Solving for $\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle$, we get

$$
\begin{align*}
  2\langle\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle =& \mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle + \mathbf{Y}\langle \mathbf{Z},\mathbf{X}\rangle - \mathbf{Z}\langle\mathbf{X},\mathbf{Y}\rangle \\
  &- \langle\mathbf{X},[\mathbf{Y},\mathbf{Z}]\rangle + \langle\mathbf{Y},[\mathbf{Z},\mathbf{X}]\rangle + \langle\mathbf{Z},[\mathbf{X},\mathbf{Y}]\rangle 
\end{align*}
$$

This formula proves that a Levi-Civita is unique if it exists.
</details>
</MathBox>

The Levi-Civita connection on $\R^n$ with its usual Euclidean metric is the directional derivative $\mathrm{D}$ on $\R^n$.

### Orthogonal projection on a surface in $\R^3$

Suppose $M$ is a smooth surface in $\R^3$, which we do not assume to be orientable. At each point $\mathbf{p}\in M$, let $\mathbf{v}_\mathbf{p}$ be the normal line through $\mathbf{p}$. It is perpendicular to the tangent space $T_\mathbf{p} M$, so there is an orthogonal decomposition

$$
  T_\mathbf{p}\R^3 \cong T_\mathbf{p} M \oplus \mathbf{v}_\mathbf{p}
$$

<MathBox title='Orthogonal projection on a surface in $\R^3$' boxType='definition'>
Let $\operatorname{pr}_\mathbf{p}: T_\mathbf{p}\R^3 \to T_\mathbf{p}M$ be the projection to the tangent space of $M$ at $\mathbf{p}$. If $\mathbf{X}$ is a smooth vector field along $M$ in $\R^3$, then $\mathbf{X_p}\in T_\mathbf{p}\R^3$. The orthogonal projection of $\mathbf{X}$ on M is a vector field $\operatorname{pr}(\mathbf{X})$ on $M$ defined by

$$
  \operatorname{pr}(\mathbf{X})_\mathbf{p} = \operatorname{pr}_\mathbf{p}(\mathbf{X_p}) \in T_\mathbf{p}M
$$
</MathBox>


<MathBox title='' boxType='proposition'>
If $\mathbf{X}$ is a smooth vector field along $M$ in $\R^3$, then the orthogonal projection $\operatorname{pr}(\mathbf{X})$ on $M$ is smooth.

<details>
<summary>Proof</summary>

For each $\mathbf{p}\in M$, there is a neighbourhood $U$ of $\mathbf{p}$ in $M$ on which there is a smooth unit normal vector field $\mathbf{N}$. For $\mathbf{q}\in U$

$$
  \operatorname{pr}_\mathbf{q}(\mathbf{X_q}) = \mathbf{X_q} - \langle\mathbf{X}_\mathbf{q}, \mathbf{N}_\mathbf{q}\rangle\mathbf{N}_\mathbf{q}
$$

Note that $\operatorname{pr}_\mathbf{q}$ does not depend on the choice of the unit normal vector field since $-\mathbf{N}_\mathbf{q}$ would have given the same answer. As $\mathbf{q}$ varies in $U$, we get

$$
  \operatorname{pr}(\mathbf{X}) = \mathbf{X} - \langle\mathbf{X},\mathbf{N}\rangle\mathbf{X}
$$

which shows that $\operatorname{pr}(\mathbf{X})$ is smooth on $U$. Hence $\operatorname{pr}(\mathbf{X})$ is smooth at $\mathbf{p}$. Since $\mathbf{p}$ is an arbitrary ponit of $M$, the vector field $\operatorname{pr}(\mathbf{X})$ is smooth on $M$.
</details>
</MathBox>

According to this proposition, the projection operator is a map

$$
  \operatorname{pr}: \Gamma(T\R^3|_M) \to\mathfrak{X}(M)
$$

### The Levi-Civita connection on a surface in $\R^3$

Consider a smooth, not necessarily orientable surface $M$ in $\R^3$. Given two smooth vector fields $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ and a point $\mathbf{p}\in M$, the directional derivative $\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}$ is not in general tangent to $M$. Define

$$
  (\nabla_\mathbf{X} \mathbf{Y})_\mathbf{p} := \nabla_{\mathbf{X_p}} \mathbf{Y} = \operatorname{pr}_\mathbf{p}(\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}) \in T_\mathbf{p} M
$$

where $\operatorname{pr}_\mathbf{p}: T_\mathbf{p}\R^3 \to T_\mathbf{p}M$ is the orthogonal projection. As $\mathbf{p}$ varies over $M$, then

$$
  \nabla_\mathbf{X} \mathbf{Y} = \operatorname{pr}(\mathrm{D}_\mathbf{X} \mathbf{Y})
$$

which by the previous proposition shows that $\nabla_\mathbf{X} \mathbf{Y}$ is a smooth vector field on $M$, giving a map

$$
  \nabla:\mathfrak{X}(M)\times\mathfrak{X}(M)\to\mathfrak{X}(M)
$$

<MathBox title='' boxType='proposition'>
The Levi-Civita connection on a smooth, not necessarily orientable surface $M$ in $\R^3$ is given by $\nabla_\mathbf{X}\mathbf{Y} = \operatorname{pr}(\mathrm{D}_\mathbf{X} \mathbf{Y})$.
</MathBox>

## Gauss's Theorema Egregium for $\R^3$

Suppose $M$ is a regular submanifold of $\R^n$. For $\mathbf{X}$ a tangent vector field on $M$ and $\mathbf{Z}$ a vector field along $M$ in $\R^n$, the directional derivative $\mathrm{D}_\mathbf{X} \mathbf{Z}$ is a vector field along $M$ in $\R^n$. Since the Levi-Civita connection $\nabla$ of a surface $M$ in $\R^3$ is defined in terms of the directional derivative $\mathrm{D}$ on $M$, it is easy to compare the curvature tensors of $\nabla$ and $\mathrm{D}$. This will lead to a formula for the curvature $R$ of $\nabla$, called the *Gauss curvature equation*.

A vector field $\mathbf{Y}\in\mathfrak{X}(M)$ is also a vector field along $M$ in $\R^3$. Hence, if $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, the directional derivative $\mathrm{D}_\mathbf{X} \mathbf{Y}$ makes sense. Assume $M$ is oriented with a unit normal vector field $\mathbf{N}$. At any point $\mathbf{p}\in M$, the normal component of the vector $\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}$ is $\langle \mathrm{D}_{\mathbf{X_p}} \mathbf{Y}, \mathbf{N}_\mathbf{p}\rangle \mathbf{N}_\mathbf{p}$, and therefore the tangent component is

$$
  \operatorname{pr}(\mathrm{D}_{\mathbf{X_p}} \mathbf{Y}) = \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} - \langle \mathrm{D}_{\mathbf{X_p}} \mathbf{Y}, \mathbf{N}_\mathbf{p}\rangle \mathbf{N}_\mathbf{p}
$$

This is the definition of the Levi-Civita connection $\nabla_{\mathbf{X_p}} \mathbf{Y}$ on $M$. Hence

$$
\begin{align*}
  \mathrm{D}_{\mathbf{X_p}} \mathbf{Y} =& \nabla_{\mathbf{X_p}}\mathbf{Y} + \langle \mathrm{D}_{\mathbf{X_p}} \mathbf{Y}, \mathbf{N}_\mathbf{p}\rangle \mathbf{N}_\mathbf{p} \\
  =& \nabla_{\mathbf{X_p}}\mathbf{Y} + \langle L_\mathbf{p}(\mathbf{X_p}), \mathbf{Y_p}\rangle \mathbf{N}_\mathbf{p}
\end{align*}
$$

Globalizing this equation, we have for $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(M)$

$$
  \mathrm{D}_\mathbf{X} \mathbf{Y} = \nabla_\mathbf{X}\mathbf{Y} + \langle L(\mathbf{X}),\mathbf{Y}\rangle\mathbf{N}
$$

which decomposes the vector field $\mathrm{D}_\mathbf{X} \mathbf{Y}$ into its tangential and normal components.

<MathBox title='Gauss curvature equation' boxType='theorem'>
Let $M$ be an oriented surface in $\R^3$, $\nabla$ its Levi-Civita connection, $R$ the curvature operator of $\nabla$, and $L$ the shape operator on $M$. For $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(M)$, the Gauss curvature equation is given by

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{Z} = \langle L(\mathbf{Y}),\mathbf{Z}\rangle L(\mathbf{X}) - \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{Y})
$$

<details>
<summary>Proof</summary>

Recall that for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ and $Z\in\Gamma(T\R^n |_M)$, we have

$$
  R_\mathrm{D}(\mathbf{X},\mathbf{Y})\mathbf{Z} := \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]}\mathbf{Z} = 0
$$

Decomposing $\mathrm{D}_\mathbf{Y} Z$ into its tangential and normal components we get $\mathrm{D}_\mathbf{Y} \mathbf{Z} = \lambda_Y \mathbf{Z} + \langle L(\mathbf{Y}),\mathbf{Z}\rangle\mathbf{N}$. Thus,

$$
\begin{align*}
  \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} =& \mathrm{D}_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z} + \mathrm{D}_\mathbf{X} (\langle L(\mathbf{Y}),\mathbf{Z}\rangle\mathbf{N}) \\
  =& \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z} + \langle L(\mathbf{X}), \nabla_\mathbf{Y} \mathbf{Z}\rangle \mathbf{N} + \mathbf{X}\langle L(\mathbf{Y}),\mathbf{Z}\rangle \mathbf{N} + \langle L(\mathbf{Y}),\mathbf{Z}\rangle\mathrm{D}_\mathbf{X} \mathbf{N} \\
  =& \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z} - \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{X}) + \langle L(\mathbf{X}),\nabla_\mathbf{Y} \mathbf{Z}\rangle \mathbf{N} + \mathbf{X}\langle L(\mathbf{Y}),\mathbf{Z}\rangle \mathbf{N}  
\end{align*}
$$

Interchanging $\mathbf{X}$ and $\mathbf{Y}$ gives

$$
  \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} = \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{Z} - \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{Y}) + \langle L(\mathbf{Y}), \nabla_\mathbf{X} \mathbf{Z}\rangle \mathbf{N} + \mathbf{Y}\langle L(\mathbf{X}),\mathbf{Z}\rangle\mathbf{N}
$$

Also

$$
  \mathrm{D}_{[\mathbf{X},\mathbf{Y}]} \mathbf{Z} = \nabla_{[\mathbf{X},\mathbf{Y}]}\mathbf{Z} + \langle L([\mathbf{X},\mathbf{Y}]),\mathbf{Z}\rangle\mathbf{N}
$$

Subtracting $\mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{X} \mathbf{Z}$ and $\mathrm{D}_{[\mathbf{X},\mathbf{Y}]} Z$ from $\mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} Z$ shows that $R_\mathrm{D}$ can be decomposed into a tangential and normal component

$$
\begin{align*}
  0 =& R_\mathrm{D}(\mathbf{X},\mathbf{Y})\mathbf{Z} \\
  =& (R(\mathbf{X},\mathbf{Y})\mathbf{Z} - \langle L(\mathbf{Y}),\mathbf{Z}\rangle L(\mathbf{X}) + \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{Y}))\quad\text{(normal component)} \\
  &+ (\langle L(\mathbf{X}), \nabla_\mathbf{Y} \mathbf{Z}\rangle + \mathbf{X}\langle L(\mathbf{Y}),\mathbf{Z}\rangle - \langle L(\mathbf{Y}), \nabla_\mathbf{X} \mathbf{Z}\rangle - \mathbf{Y}\langle L(\mathbf{X}),\mathbf{Z}\rangle - \langle L([\mathbf{X},\mathbf{Y}]),\mathbf{Z}\rangle) N
\end{align*}
$$

The tangential component gives the Gauss curvature equation

$$
  R(\mathbf{X},\mathbf{Y}) = \langle L(\mathbf{Y}),\mathbf{Z}\rangle L(\mathbf{X}) - \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{Y})
$$
</details>
</MathBox>

<MathBox title='Codazzi-Mainardi equation' boxType='theorem'>
Let $M$ be an oriented surface in $\R^3$, $\nabla$ its Levi-Civita connection, $R$ the curvature operator of $\nabla$, and $L$ the shape operator on $M$. For $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(M)$, the Codazzi-Mainardi equation is given by

$$
  \nabla_\mathbf{X} L(\mathbf{Y}) - \nabla_\mathbf{Y} L(\mathbf{X}) - L([\mathbf{X},\mathbf{Y}]) = 0
$$

<details>
<summary>Proof</summary>

Recall that for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ and $Z\in\Gamma(T\R^n |_M)$, we have

$$
  R_\mathrm{D}(\mathbf{X},\mathbf{Y})\mathbf{Z} := \mathrm{D}_\mathbf{X} \mathrm{D}_\mathbf{Y} \mathbf{Z} - \mathrm{D}_\mathbf{Y} \mathrm{D}_\mathbf{X} \mathbf{Z} - \mathrm{D}_{[\mathbf{X},\mathbf{Y}]}\mathbf{Z} = 0
$$

From the proof of the Gauss curvature equation, the normal component of $R_\mathrm{D}$ satisfies

$$
\begin{align*}
  0 =& (\langle L(\mathbf{X}), \nabla_\mathbf{Y} \mathbf{Z}\rangle + \mathbf{X}\langle L(\mathbf{Y}),\mathbf{Z}\rangle - \langle L(\mathbf{Y}), \nabla_\mathbf{X} \mathbf{Z}\rangle \\
  &- \mathbf{Y}\langle L(\mathbf{X}),\mathbf{Z}\rangle - \langle L([\mathbf{X},\mathbf{Y}]),\mathbf{Z}\rangle) N
\end{align*}
$$

By the compatibility of $\nabla$ with the matrix, this simplifies to

$$
  \langle\nabla_\mathbf{X} L(\mathbf{Y}),\mathbf{Z}\rangle - \langle\nabla_\mathbf{Y} L(\mathbf{X}),\mathbf{Z}\rangle - \langle L([\mathbf{X},\mathbf{Y}]),\mathbf{Z}\rangle = 0
$$

Since the equation is true for all $\mathbf{X}$, by the nondegeneracy of the inner product we get

$$
  \nabla_\mathbf{X} L(\mathbf{Y}) - \nabla_\mathbf{Y} L(\mathbf{X}) - L([\mathbf{X},\mathbf{Y}]) = 0
$$
</details>
</MathBox>

<MathBox title="Gauss's Theorema Egregrium for $\R^3$" boxType='theorem'>
Let $M$ be a surface in $\R^3$ and $\mathbf{p}$ a point in $M$.
1. If $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal basis for the tangent plane $T_\mathbf{p}M$, then the Gaussian curvature $K_\mathbf{p}$ of $M$ at $\mathbf{p}$ is
$$
  K_\mathbf{p} = \langle R_\mathbf{p}(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2, \mathbf{e}_1 \rangle
$$
2. The Gaussian curvature is an isometric invariant of smooth surfaces in $\R^3$.

<details>
<summary>Proof</summary>

**(1):** The Gaussian curvature $K_\mathbf{p}$ is given in terms of the shape operator $L$ by

$$
  K_\mathbf{p} = \langle L(\mathbf{e}_1),\mathbf{e}_1\rangle \langle L(\mathbf{e}_2), \mathbf{e}_2\rangle - \langle L(\mathbf{e}_1),\mathbf{e}_2\rangle \rangle L(\mathbf{e}_2), \mathbf{e}_1\rangle
$$

By the Gauss curvature equation,

$$
  R_\mathbf{p}(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2 = \langle L(\mathbf{e}_2), \mathbf{e}_2 \rangle L(\mathbf{e}_1) - \langle L(\mathbf{e}_1),\mathbf{e}_2 \rangle L(\mathbf{e}_2)
$$

Taking the inner product with $\mathbf{e}_1$ gives

$$
\begin{align*}
  \langle R_\mathbf{p} (\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2,\mathbf{e}_1 \rangle =& \langle L(\mathbf{e}_2), \mathbf{e}_2 \rangle \langle L(\mathbf{e}_1),\mathbf{e}_1 \rangle - \langle L(\mathbf{e}_1),\mathbf{e}_2 \rangle \langle L(\mathbf{e}_2), \mathbf{e}_1 \rangle \\
  =& K_\mathbf{p}
\end{align*}
$$
</details>
</MathBox>

### Gaussian curvature in terms of an arbitrary basis

<MathBox title='' boxType='definition'>
Let $M$ be a smooth surface in $\R^3$ and $\mathbf{p}\in M$. If $\mathbf{u},\mathbf{v}$ is any basis for the tangent plane $T_\mathbf{p} M$, then the Gaussian curvature at $\mathbf{p}$ is

$$
  K_\mathbf{p} = \frac{\langle R_\mathbf{p} (\mathbf{u},\mathbf{v})\mathbf{v}, \mathbf{u} \rangle}{\langle \mathbf{u},\mathbf{u}\rangle \langle \mathbf{v},\mathbf{v}\rangle - \langle\mathbf{u},\mathbf{v}\rangle^2}
$$

<details>
<summary>Proof</summary>

Let $\Set{\mathbf{e}_1,\mathbf{e}_2}$ be an orthonormal basis for $T_\mathbf{p} M$ and suppose

$$
\begin{align*}
  \mathbf{u} =& a\mathbf{e}_1 + b\mathbf{e}_2 \\
  \mathbf{v} =& c\mathbf{e}_1 + d\mathbf{e}_2
\end{align*}
$$

By the skew-symmetry of the curvature tensor

$$
  R_\mathbf{p} (\mathbf{u},\mathbf{v}) = (ad-bc)R_\mathbf{p}(\mathbf{e}_1,\mathbf{e}_2)
$$

so that

$$
  \langle R_\mathbf{p}(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle = (ad-bc)^2 \langle R_\mathbf{p}(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2,\mathbf{e}_1 \rangle
$$

On the other hand

$$
\begin{align*}
  &\langle\mathbf{u},\mathbf{u}\rangle\langle\mathbf{v},\mathbf{v}\rangle - \langle\mathbf{u},\mathbf{v}\rangle^2 \\
  =& (a^2 + b^2)(c^2 + d^2) - (ac + bd)^2 \\
  =& (ad - bc)^2
\end{align*}
$$

Hence

$$
\begin{align*}
  K_\mathbf{p} =& \langle R_\mathbf{p}(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2,\mathbf{e}_1\rangle \\
  =& \frac{\langle R_\mathbf{p}(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle}{\langle\mathbf{u},\mathbf{u}\rangle\langle\mathbf{v},\mathbf{v}\rangle - \langle\mathbf{u},\mathbf{v}\rangle^2}
\end{align*}
$$
</details>
</MathBox>

## Generalizations to hypersurfaces in $\R^{n+1}$

### The shape operator of a hypersurface

A *hypersurface* $M$ in $\R^{n+1}$ is a submanifold of codimension $1$. Assume there is a smooth unit normal vector field $\mathbf{N}$ on $M$; note that this is always possible locally on any hypersurface. Recall that the directional derivative $\mathrm{D}$ on $\R^{n+1}$ is the Levi-Civita connection of $\R^{n+1}$.

For any point $\mathbf{p}\in M$ and tangent vector $\mathbf{X_p}\in T_\mathbf{p}M$, since $\langle \mathbf{N},\mathbf{N}\rangle\equiv 1$

$$
  0 = \mathbf{X_p}\langle\mathbf{N},\mathbf{N}\rangle = 2\langle\mathrm{D}_{\mathbf{X_p}} \mathbf{N},\mathbf{N}\rangle
$$

Therefore, $\mathrm{D}_{\mathbf{X_p}}\mathbf{N}$ is tangent to $M$. The *shape operator* $L_\mathbf{p}: T_\mathbf{p}M \to T_\mathbf{p}M$ is defined to be

$$
  L_\mathbf{p}(\mathbf{X_p}) = -\mathrm{D}_{\mathbf{X_p}}\mathbf{N},\; \mathbf{X_p}\in T_\mathbf{p}M
$$

As the point $\mathbf{p}$ varies over $M$, the shape operator globalizes to an $\mathcal{F}$-linear map $L:\mathfrak{X}(M)\to\mathfrak{X}(M)$ given by $L(\mathbf{X})_\mathbf{p} = L_\mathbf{p}(\mathbf{X_p})$.

<MathBox title='Properties of the shape operator on hypersurfaces in $\R^{n+1}$' boxType='definition'>
Let $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ be smooth vector fields on an oriented hypersurface $M$ in $\R^{n+1}$. Then
1. $\langle L(\mathbf{X}),\mathbf{Y}\rangle = \langle\mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N}\rangle$
2. the shape operator is self-adjoint with respect to the Euclidean metric inherited from $\R^{n+1}$
$$
  \langle L(\mathbf{X}),\mathbf{Y}\rangle = \langle\mathbf{X},L(\mathbf{Y})\rangle
$$

<details>
<summary>Proof</summary>

Since $\langle\mathbf{Y},\mathbf{N}\rangle = 0$, by the compatibility of $\mathrm{D}$ with the metric

$$
  0 = \mathbf{X}\langle\mathbf{Y},\mathbf{N}\rangle = \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N}\rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} N\rangle
$$

Hence

$$
  \langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N}\rangle = \langle\mathbf{Y}, -\mathrm{D}_\mathbf{X} N\rangle = \langle\mathbf{Y}, L(\mathbf{X})\rangle
$$

Reversing the roles of $\mathbf{X}$ and $\mathbf{Y}$ gives

$$
  \langle \mathrm{D}_\mathbf{Y} \mathbf{X},\mathbf{N}\rangle = \langle\mathbf{X}, L(\mathbf{Y})\rangle
$$

Since $[\mathbf{X},\mathbf{Y}]$ is tangent to $M$

$$
  \langle [\mathbf{X},\mathbf{Y}],\mathbf{N}\rangle = 0
$$

By torsion-freeness, subtracting $\langle \mathbf{D}_Y \mathbf{X},\mathbf{N}\rangle$ and $\langle [\mathbf{X},\mathbf{Y}],\mathbf{N}\rangle$ from $\langle \mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N}\rangle$ gives

$$
\begin{align*}
  0 =& \langle \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}],\mathbf{N}\rangle \\
  =& \langle\mathbf{Y}, L(\mathbf{X})\rangle - \langle\mathbf{X},L(\mathbf{Y})\rangle
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Principal, mean and Gaussian curvature of hypersurfaces in $\R^{n+1}$' boxType='definition'>
Let $M$ be a hypersurface in $\R^{n+1}$ and $L_\mathbf{p}: T_\mathbf{p}M \to T_\mathbf{p} M$ be the shape operator at a point $\mathbf{p}\in M$. The following curvature measures can be defined on $M$ at $\mathbf{p}$:
1. The *principal curvatures* are the eigenvalues $\lambda_i$ of $L_\mathbf{p}$.
2. The *mean curvature* is the average of the principal curvatures, or the trace of $L_\mathbf{p}$
$$
  H(\mathbf{p}) = \frac{1}{n}\sum_{i=1}^n \lambda_i = \frac{1}{n}\operatorname{tr}(L_\mathbf{p})
$$
3. The *Gaussian curvature* is the product of the principal curvatures, or the determinant of $L_\mathbf{p}$
$$
  K(\mathbf{p}) = \prod_{i=1}^n \lambda_i = \det(L_\mathbf{p})
$$
</MathBox>

### The Levi-Civita connection on a hypersurface

<MathBox title='' boxType='theorem'>
Let $M$ be a hypersurface in $\R^{n+1}$ and $\mathrm{D}$ the directional derivative on $\R^{n+1}$. For $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ the tangential component of $\mathrm{D}_\mathbf{X} \mathbf{Y}$ defines the Levi-Civita connection $\nabla$ of $M$

<details>
<summary>Proof</summary>

Since it is evident that $\nabla$ satisfies the two defining properties of a connection it suffices to check that $\nabla_\mathbf{X} \mathbf{Y}$ is torsion free and metric compatible.

**Torsion-freeness:** Let $T_\mathrm{D}$ and $T_\nabla$ be the torsions of $\mathrm{D}$ and $\nabla$, respectively. By definition, for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$

$$
\begin{align*}
  \mathrm{D}_\mathbf{X} \mathbf{Y} =& \nabla_\mathbf{X}\mathbf{Y} + (\mathrm{D}_\mathbf{X} \mathbf{Y})_{\mathrm{nor}} \\
  \mathrm{D}_\mathbf{Y} \mathbf{X} =& \nabla_\mathbf{Y} \mathbf{X} + (\mathrm{D}_\mathbf{Y} \mathbf{X})_{\mathrm{nor}}
\end{align*}
$$

Since $\mathrm{D}$ is torsion-free, $\mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} = [\mathbf{X},\mathbf{Y}]$. Equating the normal components of both sides, we get $(\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} - (\mathrm{D}_\mathbf{Y} \mathbf{X})_\mathrm{nor} = 0$. Thus,

$$
\begin{align*}
  0 =& T_\mathrm{D}(\mathbf{X},\mathbf{Y}) \\
  =& \mathrm{D}_\mathbf{X} \mathbf{Y} - \mathrm{D}_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}] \\
  =& (\nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}]) + (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} - (\mathrm{D}_\mathbf{Y} \mathbf{X})_\mathrm{nor} \\
  =& \nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}] = T_\nabla (\mathbf{X},\mathbf{Y})
\end{align*}
$$

**Compatibility with the metric:** For $\mathbf{X},\mathbf{Y},\mathbf{Z}\in\mathfrak{X}(M)$

$$
\begin{align*}
  \mathbf{X}\langle \mathbf{Y},\mathbf{Z}\rangle =& \langle\mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{Z}\rangle + \langle\mathbf{Y}, \mathrm{D}_\mathbf{X} \mathbf{Z}\rangle \\
  =& \langle\nabla_\mathbf{X}\mathbf{Y} + (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} \mathbf{Z}\rangle + \langle\mathbf{Y}, \nabla_\mathbf{X} \mathbf{Z} + (\nabla_\mathbf{X} \mathbf{Y})_\mathrm{nor}\rangle \\
  =& \langle \nabla_\mathbf{X} \mathbf{Y},\mathbf{Z} \rangle + \langle\mathbf{Y}, \nabla_\mathbf{X} \mathbf{Z} \rangle
\end{align*}
$$
</details>
</MathBox>

### Fundamental forms

At each point $\mathbf{p}$ of an oriented hypersurface $M\subseteq\R^{n+1}$, there is a sequence of symmetric bilinear maps on $T_\mathbf{p}M$ called the *first*, *second* and *third fundamental forms* and so on

$$
\begin{align*}
  \mathrm{I}(\mathbf{X_p},\mathbf{Y_p}) =& \langle \mathbf{X_p}, \mathbf{Y_p}\rangle \\
  \mathrm{II}(\mathbf{X_p},\mathbf{Y_p}) =& \langle L(\mathbf{X_p}), \mathbf{Y_p}\rangle = \langle \mathbf{X_p}, L(\mathbf{Y_p})\rangle \\
  \mathrm{III}(\mathbf{X_p},\mathbf{Y_p}) =& \langle L^2 (\mathbf{X_p}), \mathbf{Y_p}\rangle = \langle L(\mathbf{X_p}),L(\mathbf{Y_p})\rangle = \langle \mathbf{X_p}, L^2 (\mathbf{Y_p})\rangle, \dots
\end{align*}
$$

For $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, the directional derivative $\mathrm{D}_\mathbf{X} \mathbf{Y}$ decomposes into the sum of a tangential and normal component. The tangential component is the Levi-Civita connection on $M$; the normal component is essentially the second fundamental form.

<MathBox title='' boxType='theorem'>
If $\mathbf{N}$ is a smooth unit normal vector field on the hypersurface $M$ in $\R^{n+1}$ and $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$ are smooth vector fields on $M$, then

$$
  (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} = \mathrm{II}(\mathbf{X},\mathbf{Y})\mathbf{N}
$$

<details>
<summary>Proof</summary>

The normal component $(\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor}$ is a multiple of $\mathbf{N}$, so

$$
\begin{align*}
  \mathrm{D}_\mathbf{X} \mathbf{Y} =& (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{tan} + (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} \\
  =& lambda_X\mathbf{Y} + \lambda\mathbf{N}
\end{align*}
$$

for some $\lambda\in\R$. Taking the inner product of both sides with $\mathbf{N}$ gives

$$
  \langle \mathrm{D}_\mathbf{X},\mathbf{N}\rangle = \lambda\langle\mathbf{N},\mathbf{N}\rangle = \lambda
$$

Hence

$$
\begin{align*}
  (\mathrm{D}_\mathbf{X} \mathbf{Y})_\mathrm{nor} =& \langle\mathrm{D}_\mathbf{X} \mathbf{Y},\mathbf{N}\rangle\mathbf{N} \\
  =& \langle L(\mathbf{X}),\mathbf{Y}\rangle\mathbf{N} \\
  =& \mathrm{II}(\mathbf{X},\mathbf{Y})\mathbf{N}
\end{align*}
$$
</details>
</MathBox>

### The Gauss curvature and Codazzi-Mainardi equations

Let $M$ be an oriented, smooth hypersurface in $\R^{n+1}$, with a smooth unit normal vector field $\mathbf{N}$. The relation between the Levi-Civita connection $\mathrm{D}$ on $\R^{n+1}$ and the Levi-Civita connection on $M$ implies a relation between the curvature $R_\mathrm{D}(\mathbf{X},\mathbf{Y})\mathbf{Z} = 0$ on $\R^{n+1}$ and the curvature $R(\mathbf{X},\mathbf{Y})\mathbf{Z}$ on $M$. The tangential component of this relation gives the Gauss curvature equation

$$
  R(\mathbf{X},\mathbf{Y}) = \langle L(\mathbf{Y}),\mathbf{Z}\rangle L(\mathbf{X}) - \langle L(\mathbf{X}),\mathbf{Z}\rangle L(\mathbf{Y})
$$

and the normal component gives the Codazzi-Mainardi equation

$$
  \nabla_\mathbf{X} L(\mathbf{Y}) - \nabla_\mathbf{Y} L(\mathbf{X}) - L([\mathbf{X},\mathbf{Y}]) = 0
$$

<MathBox title='' boxType='corollary'>
If $M$ is a smooth oriented hypersurface in $\R^{n+1}$ with curvature $R$ and $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, then

$$
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{Y}, \mathbf{X}\rangle = \mathrm{II}(\mathbf{X},\mathbf{X})\mathrm{II}(\mathbf{Y},\mathbf{Y}) - \mathrm{II}(\mathbf{X},\mathbf{Y})^2
$$

<details>
<summary>Proof</summary>

By the Gauss curvature equation

$$
\begin{align*}
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{Y}, \mathbf{X}\rangle =& \langle L(\mathbf{Y}), \mathbf{Y}\rangle \langle L(\mathbf{X}),\mathbf{X}\rangle - \langle L(\mathbf{X}),\mathbf{Y}\rangle\langle L(\mathbf{Y}),\mathbf{X}\rangle \\
  =& \mathrm{II}(\mathbf{X},\mathbf{X})\mathrm{II}(\mathbf{Y},\mathbf{Y}) - \mathrm{II}(\mathbf{X},\mathbf{Y})^2
\end{align*}
$$
</details>
</MathBox>

# Curvature and differential forms

## Curvature of a connection on a vector bundle

The concept of torsion does not make sense for a connection on an arbitrary vector bundle on a smooth manifold $M$ because of the asymmetry of its two arguments. However, curvature still makes sense and is defined, as for affine connections as an $\R$-trilinear map

$$
  R:\mathfrak{X}(M)\times\mathfrak{X}(M) \times\Gamma(E)\to\Gamma(E)
$$

given by

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{s} = \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{s} - \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{s} - \nabla_{[\mathbf{X},\mathbf{Y}]}\mathbf{s}
$$

Let $\mathcal{F} = C^\infty$ be the ring of smooth functions on $M$. As for affine connections, $R(\mathbf{X},\mathbf{Y})\mathbf{s}$ if $\mathcal{F}$-linear in all three arguments and so it is actually defined pointwise. Moreover, because $R_\mathbf{p}(\mathbf{X_p},\mathbf{Y_p})$ is skew-symmetric in $\mathbf{X_p}$ and $\mathbf{Y_p}$, at every point $\mathbf{p}\in M$ there is an alternating bilinear map

$$
  R_\mathbf{p}: T_\mathbf{p}M\times T_\mathbf{p}M \to\hom(E_\mathbf{p},E_\mathbf{p}) =: \operatorname{end}(E_\mathbf{p})
$$

into the endomorphism ring of $E_\mathbf{p}$. This map is the *curvature tensor* of the connection $\nabla$.

### Riemannian bundles

The notion of a Riemannian metric can be generalized to vector bundles. Let $E\to M$ be a smooth vector bundle over a smooth manifold $M$. A *Riemannian metric* on $E$ assigns to each $\mathbf{p}\in M$ an inner product on the fibre $E_\mathbf{p}$. The assignment is required to be smooth in the following sense: if $\mathbf{s}$ and $\mathbf{t}$ are smooth section of $E$, then $\langle\mathbf{s},\mathbf{t}\rangle$ is a smooth function on $M$.

Thus, a Riemannian metric on a smooth manifold $M$ is simply a Riemannian metric on the tangent bundle $TM$. A vector bundle together with a Riemannian metric is called a *Riemannian bundle*.

<MathBox title='' boxType='proposition'>
Let $E$ be a trivial vector bundle of rank $r$ over a smooth manifold $M$, with trivialization $\phi:E\xrightarrow{\sim} M\times\R^r$. The Euclidean inner product on $\R^r$ induces a Riemannian metric on $E$ via the trivialization $\phi$. If $\mathbf{u},\mathbf{v}\in E_\mathbf{p}$, then the fibre map $\phi_\mathbf{p}: E_\mathbf{p}\to\R^r$ is a linear isomorphism and we define

$$
  \langle\mathbf{u},\mathbf{v}\rangle = \langle\phi_\mathbf{p}(\mathbf{u}),\phi_\mathbf{p}(\mathbf{v})\rangle_{\R^r}
$$
</MathBox>

<MathBox title='Existence of a Riemannian bundle' boxType='proposition'>
On any smooth vector bundle $\pi:E\to M$, there is a Riemannian metric.

<details>
<summary>Proof</summary>

Let $\Set{U_\alpha, \varphi_\alpha: E|_{U_\alpha} \xrightarrow{\sim} U_\alpha \times\R^k}$ be a trivializing open cover for $E$. On $E|_{U_\alpha}$ there is a Riemannian metric induced from the trivial bundle $U_\alpha \times\R^k$. Let $\Set{\rho_\alpha}$ be a partition of unity on $M$ subordinate to the open cover $\Set{U_\alpha}$. By the same reasoning as in the proof for the existence of the Riemannian metric, the sum

$$
  \langle\cdot,\cdot\rangle := \sum_\alpha \rho_\alpha \langle\cdot,\cdot\rangle_\alpha
$$

is a finite sum in a neighbourhood of each point of $M$ and is a Riemannian metric on $E$.
</details>
</MathBox>

### Metric connections

A connection $\nabla$ on a Riemannian bundle $E$ is *metric compatible* if for all $\mathbf{X}\in\mathfrak{X}(M)$ and $\mathbf{s},\mathbf{t}\in\Gamma(E)$

$$
  \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle = \langle\nabla_\mathbf{X} \mathbf{s},\mathbf{t}\rangle + \langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle
$$

A connection metric compatible on a Riemannian bundle is also called a *metric connection*.

<MathBox title='' boxType='proposition'>
On a trivial vector bundle $E$ over a smooth manifold $M$ with trivialization $\phi:E\xrightarrow{\sim} M\times\R^r$, the connection $\nabla$ on $E$ induced by the trivialization $\phi$ is compatible with the Riemannian metric on $E$ induced by the trivialization.

<details>
<summary>Proof</summary>

Let $\Set{\mathbf{v}_i}_{i=1}^r$ be an orthonormal basis for $\R^r$ and $\Set{\mathbf{e}_i}_{i=1}^r$ the corresponding global frame for $E$, where $\mathbf{e}_i (\mathbf{p}) = \phi^{-1} (\mathbf{p},\mathbf{v}_i)$. Then $\Set{\mathbf{e}_i}_{i=1}^r$ is an orthonormal flat frame for $E$ with respect to the Riemannian metric and the connection on $E$ induced by $\phi$. If $\mathbf{s} = \sum_{i=1}^r a^i \mathbf{e}_i$ and $\mathbf{t} = \sum_{j=1}^r b^j \mathbf{e}_j$ are smooth sections of $E$, then

$$
\begin{align*}
  \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle =& X\left(\sum_{i=1}^r a^i b^i \right) \\
  =& \sum_{i=1}^r (Xa^i) b^i + \sum_{i=1}^r a^i Xb^i \\
  =& \langle \nabla_\mathbf{X} \mathbf{s},\mathbf{t}\rangle + \langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='lemma'>
Let $E\to M$ be a Riemannian bundle. Suppose $\nabla^1,\dots,\nabla^m$ are connections on $E$ metric compatible and $a_1,\dots,a_m$ are smooth function on $M$ that add up to $1$. Then $\nabla = \sum_{i=1}^m a_i \nabla^i$ is a connection on $E$ metric compatible.

<details>
<summary>Proof</summary>

Note that $\nabla$ is a connection on $E$. It remains to check that $\nabla$ is metric compatible. If $\mathbf{X}\in\mathfrak{X}(M)$ and $\mathbf{s},\mathbf{t}\in\Gamma(E)$, then for all $i=1,\dots,m$

$$
  \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle = \langle\nabla_\mathbf{X}^i \mathbf{s},\mathbf{t}\rangle + \langle\mathbf{s},\nabla_\mathbf{X}^i \mathbf{t}\rangle
$$

because $\nabla^i$ is metric compatible. Multiplying by $a_i$ and summing gives

$$
\begin{align*}
  \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle =& \sum_{i=1}^m a_i \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle \\
  =& \left\langle\sum_{i=1}^m a_i \nabla_\mathbf{X}^i \mathbf{s},\mathbf{t}\right\rangle + \left\langle \mathbf{s},\sum_{i=1}^m a_i \nabla_\mathbf{X}^i \mathbf{t}\right\rangle \\
  =& \langle \nabla_\mathbf{X} \mathbf{s},\mathbf{t}\rangle + \langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
On any Riemannian bundle $E \to M$, there is a connection compatible with the metric.

<details>
<summary>Proof</summary>

Choose a trivializing open cover $\Set{U_\alpha}$ for $E$. For each trivializing open set $U_\alpha$ of the cover, we can find a connection $\nabla^\alpha$ on $E|_{U_\alpha}$ compatible with the metric. Let $\Set{\rho_\alpha}$ be a partition of unity subordinate to the open cover $\Set{U_\alpha}$. Because the collection $\Set{\operatorname{supp}(\rho_\alpha)}$ is locally finite, the sum $\nabla = \sum \rho_\alpha \nabla^\alpha$ is a finite sum in a neighbourhood of each point. Since $\sum \rho_\alpha \equiv 1$, it follows that $\nabla$ is a connection on $E$ compatible with the metric.
</details>
</MathBox>

### Restricting a connection to an open subset

Let $\mathcal{F} = C^\infty (M)$ be the ring of smooth functions on a smooth manifold $M$. A connection $\nabla$ on a vector bundle $E$ over $M$ is $\mathcal{F}$-linear in the second argument, but not $\mathcal{F}$-linear in the second argument. However, it turns out that the $\mathcal{F}$-linearity in the  first argument and the Leibniz rule in the second argument are enough to imply that $\nabla$ is a local operator.

<MathBox title='Existence of connections on vector bundles' boxType='theorem'>
Let $\nabla$ be a connection on a vector bundle $E$ over a smooth manifold $M$, $\mathbf{X}$ be a smooth vector field on $M$ and $\mathbf{s}\in\Gamma(E)$ a smooth section of $E$. If either $\mathbf{X}$ or $\mathbf{s}$ vanishes identically on an open subsets $U$, then $\nabla_\mathbf{X} \mathbf{s}$ vanishes identically on $U$.

<details>
<summary>Proof</summary>

Suppose $\mathbf{X}$ vanishes identically on $U$. Since $\lambda_X \mathbf{s}$ is $\mathcal{F}$-linear in $\mathbf{X}$, then $\nabla_\mathbf{X} \mathbf{s}$ vanishes identically on $U$ for any $\mathbf{s}\in\Gamma(E)$.

Next suppose $\mathbf{s}\equiv 0$ on $U$ and $\mathbf{p}\in U$. Choose a smooth bump function $f$ such that $f\equiv 1$ in a neighbourhood of $\mathbf{p}$ and $\operatorname{supp}(f) \subset U$. By our choice of $f$, the derivative $\mathbf{X_p}$ is zero. Since $\mathbf{s}$ vanishes on the support of $f$, we have $f\mathbf{s} \equiv 0$ on $M$ and so $\nabla_\mathbf{X} (f\mathbf{s}) \eqiuv 0$. Evaluating at $\mathbf{p}$ gives

$$
\begin{align*}
  0 =& (\nabla_\mathbf{X} (f\mathbf{s})) \\
  =& (\mathbf{X}f)_\mathbf{p} \mathbf{s}_\mathbf{p} + f(\mathbf{p})(\nabla_\mathbf{X} \mathbf{s})_\mathbf{p} = (\nabla_\mathbf{X} \mathbf{s})_\mathbf{p}
\end{align*}
$$

Because $\mathbf{p}$ is an arbitrary point of $U$, we conclude that $\nabla_\mathbf{X} \mathbf{s}$ vanishes identicall on $U$
</details>
</MathBox>

In the same way that a local operator can be restricted to any open subset, a connection on a vector bundle can be restricted to any open subset. More precisely, given a connection $\nabla$ on a vector bundle $E$, for every open set $U$ there is a connection

$$
  \nabla^U :=\mathfrak{X}(M)\times\Gamma(U,E) \to\Gamma(U,E)
$$

such that for any global vector field $\bar{\mathbf{X}}\in\mathfrak{X}(M)$ and global sections $\bar{\mathbf{s}}\in\Gamma(E)$,

$$
  \nabla_{\bar{\mathbf{X}}|_U}^U (\bar{\mathbf{s}}|_U) = (\nabla_{\bar{\mathbf{X}}} \bar{\mathbf{s}})|_U
$$

Suppose $\mathbf{X}\in\mathfrak{X}(U)$ and $\mathbf{s}\in\Gamma(U,E)$. For any $\mathbf{p}\in U$, to define $\nabla_\mathbf{X}^U \mathbf{s}\in\Gamma(U,E)$ first pick a global vector field $\bar{\mathbf{X}}$ and a global section $\bar{\mathbf{s}}\in\Gamma(E)$ that agree with $\mathbf{X}$ and $\mathbf{s}$ in a neigbourhood of $\mathbf{p}$. Then define

$$
  (\nabla_\mathbf{X}^U \mathbf{s})(\mathbf{p}) = (\nabla_{\bar{\mathbf{X}}}\mathbf{s})(\mathbf{p})
$$

Because $\nabla_{\bar{\mathbf{X}}} \bar{\mathbf{s}}$ is a local operator in $\bar{\mathbf{X}}$ and in $\bar{\mathbf{s}}$, this definition is independent of the choice of $\bar{\mathbf{X}}$ and $\bar{\mathbf{s}}$. Furthermore, $\nabla^U$ satisfies all the properties of a connection on $E|_U$.

## Connection, curvature and torsion forms

### Connection and curvature forms

Let $\nabla$ be a connection on a smooth rank $r$ vector bundle $\pi:E\to M$. We are interested in describing $\nabla$ locally. On every open subset $U$ of $M$, $\nabla$ restricts to a connection on $E|_U \to U$

$$
  \nabla^U :\mathfrak{X}(U)\times\Gamma(U,E) \to\Gamma(U,E)
$$

Suppose $U$ is a trivializing open set for $E$ and $\Set{\mathbf{e}_i}_{i=1}^r$ is a frame for $E$ over $U$ and let $\mathbf{X}\in\mathfrak{X}(U)$ be a smooth vector field on $U$. Since any section $\mathbf{s}\in\Gamma(U,E)$ is a linear combination $\mathbf{s} = \sum_{i=1}^r a^j \mathbf{e}_j$, the section $\nabla_\mathbf{X} \mathbf{s}$ can be computed from $\nabla_\mathbf{X} \mathbf{e}_j$ by linearity and the Leibniz rule. As a section of $E$ over $U$, $\nabla_\mathbf{X} \mathbf{e}_j$ is a linear combination of the $\mathbf{e}_i$ with coefficients $\omega_j^i$ depending on $\mathbf{X}$

$$
  \nabla_\mathbf{X} \mathbf{e}_j = \sum_{i=1}^r \omega_j^i (\mathbf{X}) \mathbf{e}_i
$$

The $\mathcal{F}$-linearity of $\nabla_\mathbf{X} \mathbf{e}_j$ in $\mathbf{X}$ implies that $\omega_j^i$ is $\mathcal{F}$-linear in $\mathbf{X}$ and so $\omega_j^i$ is a $1$-form on $U$. The $1$-forms $\omega_j^i$ on $U$ are called the *connection forms*, and the matrix $\omega = [\omega_j^i]$ is called the *connection matrix*, of the connection $\nabla$ relative to the frame $\Set{\mathbf{e}_i}_{i=1}^r$ on $U$.

Similarly, for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(U)$, the section $R(\mathbf{X},\mathbf{Y})\mathbf{e}_j$ is a linear combination of $\mathbf{e}_i$

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{e}_j = \sum_{i=1}^r \Omega_j^i (\mathbf{X},\mathbf{Y})\mathbf{e}_i
$$

Since

$$
  R(\mathbf{X},\mathbf{Y}) = \nabla_\mathbf{X} \nabla_\mathbf{Y} - \nabla_\mathbf{Y} \nabla_\mathbf{X} - \nabla_{[\mathbf{X},\mathbf{Y}]}
$$

is alternating and $\mathcal{F}$-bilinear, so is $\Omega_j^i$. The $2$-forms $\Omega_j^i$ are called the *curvature forms*, and the matrix $\Omega = [\Omega_j^i]$ is called the *curvature matrix*, of the connection $\nabla$ relative to the frame $\Set{\mathbf{e}_i}_{i=1}^r$ on $U$.

Recall that if $\alpha$ and $\beta$ are smooth $1$-forms and $\mathbf{X},\mathbf{Y}$ are smooth vector fields on a smooth manifold, then

$$
\begin{align*}
  (\alpha\wedge\beta)(\mathbf{X},\mathbf{Y}) =& \alpha(\mathbf{X})\beta(\mathbf{Y}) - \alpha(\mathbf{Y})\beta(\mathbf{X}) \\
  (\mathrm{d}\alpha)(\mathbf{X},\mathbf{Y}) =& \mathbf{X}\alpha(\mathbf{Y}) - \mathbf{Y}\alpha(\mathbf{X}) - \alpha([\mathbf{X},\mathbf{Y}])
\end{align*}
$$

<MathBox title='Second structural equation' boxType='theorem'>
Let $\nabla$ be a connection on a vector vundle $E\to M$ of rank $r$. Relative to a frame $\Set{\mathbf{e}_i}_{i=1}^r$ for $E$ over a trivializing open set $U$, the curvature forms $\Omega_j^i$ are related to the connection forms $\omega_j^i$ by the *second structural equation*

$$
  \Omega_j^i = \mathrm{d}\omega_j^i + \sum_k \omega_k^i \wedge\omega_j^k
$$

<details>
<summary>Proof</summary>

Let $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(U)$ be smooth vector fields on $U$. Then

$$
\begin{align*}
  \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{e}_j =& \nabla_\mathbf{X} \sum_k (\omega_j^k (\mathbf{Y})\mathbf{e}_k) \\
  =& \sum_k X\omega_j^k (\mathbf{Y}) \mathbf{e}_k + \sum_k \omega_j^k (\mathbf{Y})\nabla_\mathbf{X} \mathbf{e}_k \\
  =& \sum_i \mathbf{X} \omega_j^i (\mathbf{Y})\mathbf{e}_i + \sum_{i,j} \omega_j^k (\mathbf{Y}) \omega_k^i (\mathbf{X})\mathbf{e}_i
\end{align*}
$$

Interchanging $\mathbf{X}$ and $\mathbf{Y}$ gives

$$
  \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{e}_j = \sum_i\mathbf{Y} \omega_j^i (\mathbf{X})\mathbf{e}_i + \sum_{i,k} \omega_j^k (\mathbf{X})\omega_k^i (\mathbf{Y})\mathbf{e}_i
$$

Furthermore

$$
  \nabla_{[\mathbf{X},\mathbf{Y}]}\mathbf{e}_j = \sum_i \omega_j^i ([\mathbf{X},\mathbf{Y}]) \mathbf{e}_i
$$

Hence

$$
\begin{align*}
  R(\mathbf{X},\mathbf{Y})\mathbf{e}_j =& \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{e}_j - \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{e}_j - \nabla_{[\mathbf{X},\mathbf{Y}]}\mathbf{e}_j \\
  =& \sum_i (X\omega_j^i (\mathbf{Y}) - \mathbf{Y}\omega_j^i (\mathbf{X}) - \omega_j^i ([\mathbf{X},\mathbf{Y}]))\mathbf{e}_i \\
  &+ \sum_{i,k} (\omega_k^i (\mathbf{X})\omega_j^k (\mathbf{Y}) - \omega_k^i (\mathbf{Y}) \omega_j^k (\mathbf{X}))\mathbf{e}_i \\
  =& sum_i \mathrm{d}\omega_j^i (\mathbf{X},\mathbf{Y})\mathbf{e}_i + \sum_{i,k} \omega_k^i \wedge \omega_j^k (\mathbf{X},\mathbf{Y})\mathbf{e}_i \\
  =& \sum_{i,k} (\mathrm{d}\omega_j^i + \omega_k^i \wedge \omega_j^k)(\mathbf{X},\mathbf{Y})\mathbf{e}_i
\end{align*}
$$

Comparing this with the definition of the curvature form $\Omega_j^i$ gives

$$
  \Omega_j^i = \mathrm{d}\omega_j^i + \sum_k \omega_k^i \wedge \omega_j^k
$$
</details>
</MathBox>

### Connections on a framed open set

Suppe $E$ is a smooth vector bundle of rank $r$ over a smooth manifold $M$ and $U$ is a an open subset on which there is a smooth frame $\Set{\mathbf{e}_i}_{i=1}^r$ for $E$. We call $U$ a *framed open set* for $E$ for short. A connection $\nabla$ on $E|_U$ determines a unique connection matrix $[\omega_j^i]$ relative to the frame $\Set{\mathbf{e}_i}_{i=1}^r$. Conversely, any matrix of $1$-forms $[\omega_j^i]$ on $U$ determines a connection on $E|_U$ as follows.

Given a matrix $[\omega_j^i]$ of $1$-forms on $U$, and $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(U)$, we set

$$
  \nabla_\mathbf{X} \mathbf{e}_j = \sum_i \omega_j^i (\mathbf{X}) \mathbf{e}_i
$$

and define $\nabla_\mathbf{X} \mathbf{Y}$ by applying the Leibniz rule to $\mathbf{Y} = \sum_{j=1}^r y^j \mathbf{e}_j$

$$
\begin{align*}
  \nabla_\mathbf{X}\mathbf{Y} =& \nabla_\mathbf{X} \left(\sum_{j=1}^r y^j \mathbf{e}_j\right) \\
  =& \sum_{j=1}^r (Xy^j)\mathbf{e}_j + \sum_{i,j=1}^r y^j \omega_j^i (\mathbf{X})\mathbf{e}_i \\
  =& \sum_{i,j=1}^r ((Xy^i) + h^j \omega_j^i (\mathbf{X}))\mathbf{e}_i
\end{align*}
$$

With this definition, $\nabla$ is a connection on $E|_U$.

### Metric connection relative to an orthonormal frame

We have seen that on a framed open set $U$ for a vector bundle $E\to M$, a connection is completely specified by a matrix $[\omega_j^i]$ of $1$-forms on $U$. Suppose now that the vector bundle $E\to M$ is endowed with a Riemannian metric. The defining property of a metric connection can be translated into a condition on the connection matrix $[\omega_j^i]$ relative to an orthonormal frame.

<MathBox title='' boxType='proposition'>
Let $E\to M$ be a Riemannian bundle and $\nabla$ a connection on $E$.
1. If the connection $\nabla$ is metric compatible, then its connection matrix $[\omega_j^i]$ relative to any orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^r$ for $E$ over a trivializing open set $U\subset M$ is skew-symmetric.
2. If every point $\mathbf{p}\in M$ has a trivializing neighbourhood $U$ for $E$ such that the connection matrix $[\omega_j^i]$ relative to an orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^r$ for $E$ over $U$ is skew-symmetric, then the connection $\nabla$ is metric compatible.

<details>
<summary>Proof</summary>

**(1):** Suppose $\nabla$ is metric compatible. For all $\mathbf{X}\in\mathfrak{X}(U)$ and $i,j=1,\dots,r$

$$
\begin{align*}
  0 =& \mathbf{X}\langle\mathbf{e}_i,\mathbf{e}_j\rangle \\
  =& \langle\nabla_\mathbf{X} \mathbf{e}_i, \mathbf{e}_j \rangle + \langle\mathbf{e}_i, \nabla_\mathbf{X}\mathbf{e}_j \rangle \\
  =& \left\langle \sum_{k=1}^r \omega_i^k (\mathbf{X})\mathbf{e}_k, \mathbf{e}_j \right\rangle + \left\langle \mathbf{e}_i, \sum_{k=1}^r \omega_j^k (\mathbf{X})\mathbf{e}_k \right\rangle \\
  =& \sum_{k=1}^r \omega_i^k (\mathbf{X})\delta_{kj} + \sum_{k=1}^r \omega_j^k (\mathbf{X})\delta_{ik} \\
  =& \omega_i^j (\mathbf{X}) + \omega_j^i (\mathbf{X})
\end{align*}
$$

where $\delta_{ik}$ is the Kronecker delta. Hence

$$
  \omega_i^j = -\omega_j^i
$$

**(2):** Note that compatibility with the metric is a local condition, so $\nabla$ is metric compatible if and only if its restriction $\nabla^U$ to any open set $U$ is metric compatible. Suppose $\omega_i^j = -\omega_j^i$, and let $\mathbf{s} = \sum_{i=1}^r a^i \mathbf{e}_i$ and $\mathbf{t} = \sum_{j=1}^r b^j \mathbf{e}_j$ with $a^i, b^j \in C^\infty (U)$. Then

$$
\begin{align*}
  \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle =& X\left(\sum_{i=1}^r a^i b^i \right) = \sum_{i=1}^r (Xa^i)b^i + \sum_{i=1}^r a^i \mathbf{X} b^i \\
  =& \nabla_\mathbf{X} \mathbf{s} =& \nabla_\mathbf{X} \left(\sum_{i=1}^r a^i \mathbf{e}_i\right) = \sum_{i=1}^r (Xa^i)\mathbf{e}_i + \sum_{i=1}^r a^i \nabla_\mathbf{X} \mathbf{e}_i \\
  =& \sum_{i=1}^r (Xa^i)\mathbf{e}_i + \sim_{i,k=1}^r a^i \omega_i^k (\mathbf{X})\mathbf{e}_k \\
  \langle\nabla_\mathbf{X} \mathbf{s}, \mathbf{t}\rangle =& \sum_{i=1}^r (Xa^i)b^i + \sum_{i,j=1}^r a^i \omega_i^j (\mathbf{X}) b_j \\
  \langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle =& \sum_{i=1}^r (Xb^i)a^i + \sum_{i,j=1}^r b^i \omega_i^j (\mathbf{X}) a^j \\
  =& \sum_{i=1}^r (Xb^i)a^i + \sum_{i,j=1}^r a^i b^j \omega_j^i (\mathbf{X})
\end{align*}
$$

The skew-symmetry of $\omega$ yields

$$
  \sum_{i,j=1}^r a^i b^j \omega_i^j (\mathbf{X}) + \sum_{i,j=1}^r a^i b^j \omega_j^i (\mathbf{X}) = 0
$$

Adding $\langle\nabla_\mathbf{X} \mathbf{s},\mathbf{t}\rangle$ and $\langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle$ gives

$$
\begin{align*}
  \langle\nabla_\mathbf{X} \mathbf{s},\mathbf{t}\rangle + \langle\mathbf{s},\nabla_\mathbf{X} \mathbf{t}\rangle =& \sum_{i=1}^r (Xa^i)b^i + \sum_{i=1}^r (Xb^i)a^i \\
  =& \mathbf{X}\langle\mathbf{s},\mathbf{t}\rangle
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
If the connection matrix $[\omega_j^i]$ relative to a frame $\Set{\mathbf{e}_i}_{i=1}^n$ of an affine connecion on a smooth manifold is skew-symmetric, then so is the curvature matrix $[\Omega_j^i]$.

<details>
<summary>Proof</summary>

By the structural equation

$$
\begin{align*}
  \Omega_i^j =& \mathrm{d}\omega_i^j + \sum_{k=1}^n \omega_k^j \wedge \omega_i^k \\
  =& -\mathrm{d}\omega_j^i + \sum_{k=1}^n (-\omega_j^k)\wedge(-\omega_k^i) \\
  =& -\mathrm{d}\omega_j^i - \sum_{k=1}^n \omega_k^i \wedge \omega_j^k \\
  =& -\Omega_j^i
\end{align*}
$$
</details>
</MathBox>

### Connections on the tangent bundle

A connection on the tangent bundle $TM$ of a smooth manifold $M$ is simply an affine connection on $M$. In addition to the curvature tensor $R(\mathbf{X},\mathbf{Y})\mathbf{Z}$, an affine connection has a torsion tensor $T(\mathbf{X},\mathbf{Y})$.

Let $U$ be an open set in $M$ on which the tangent bundle $TM$ has a smooth frame $\Set{\mathbf{e}_i}_{i=1}^n$. If $U$ is a coordinate open set with coordinates $(x^i)_{i=1}^n$, then $\Set{\frac{\partial}{\partial x^i}}_{i=1}^n$ is such a frame, but we will consider the more general setting where $U$ need not be a coordinate open set. Let $\Set{\theta^i}_{i=1}^n$ be the dual frame of $1$-forms on $U$. This means

$$
  \theta^i (\mathbf{e}_j) = \delta_j^i
$$

<MathBox title='' boxType='proposition'>
If $\mathbf{X}$ is a smooth vector field on the open set $U$ in a smooth $n$-manifold $M$, then $\mathbf{X} = \sum_{i=1}^n \theta^i (\mathbf{X})\mathbf{e_i}$.

<details>
<summary>Proof</summary>

Since $\Set{\mathbf{e}_i}_{i=1}^n$ is a frame for the tangent bundle $TM$ over $U$

$$
  \mathbf{X} = \sum_{i=1}^n a^i \mathbf{e}_i
$$

for some smooth functions $a^j \in C^\infty (U)$. Applying $\theta^i$ to both sides gives

$$
  \theta^i (\mathbf{X}) =& \sum_{j=1}^n \theta^i (a^j \mathbf{e}_j) = \sum_{j=1}^n a^j \delta_j^i = a^i
$$

Thus,

$$
  \mathbf{X} = \sum_{i=1}^n \theta^i (\mathbf{X})\mathbf{e}_i
$$
</details>
</MathBox>

For $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(U)$, the torsion $T(\mathbf{X},\mathbf{Y})$ is a linear combination of the frame $\Set{\mathbf{e}_i}_{i=1}^n$ on $U$ allowing us to write

$$
  T(\mathbf{X},\mathbf{Y}) = \sum_{i=1}^n \tau^i (\mathbf{X},\mathbf{Y})\mathbf{e}_i
$$

Since $T(\mathbf{X},\mathbf{Y})$ is alternating and $\mathcal{F}$-bilinear, so are the coefficients $\tau^i$. Thus, the $\tau^i$ are $2$-forms on $U$, called the *torsion forms* of the affine connection $\nabla$ relative to the frame $\Set{\mathbf{e}_i}_{i=1}^n$ on $U$.

<MathBox title='' boxType='theorem'>
Relative to a frame $\Set{\mathbf{e}_i}_{i=1}^n$ for the tangent bundle over an open set $U$ of a smooth $n$-manifold $M$, the torsion and curvature forms of an affine connection on $M$ can be given in terms of the dual $1$-forms and the connection forms
1. **First structural equation:** $\tau^i = \mathrm{d}\theta^i + \sum_{j=1}^n \omega_j^i \wedge\theta^j$
2. **Second structural equation:** $\Omega_j^i = \mathrm{d}\omega_j^i + \sum_{k=1}^n \omega_k^i \wedge \omega_j^k$

<details>
<summary>Proof</summary>

**(1):** Let $\mathbf{X}, \mathbf{Y}\in\mathfrak{X}(U)$ be smooth vector fields on $U$. By the previous proposition we can write $\mathbf{Y} = \sum_{j=1}^n \theta^j (\mathbf{Y}) \mathbf{e}_j$. Then

$$
\begin{align*}
  \nabla_\mathbf{X}\mathbf{Y} =& \nabla_\mathbf{X} \left(\sum_{j=1}^n \theta^j (\mathbf{Y}) \mathbf{e}_j \right) \\
  =& \sum_{j=1}^n (X\theta^j (\mathbf{Y}))\mathbf{e}_j + \sum_{j=1}^n \theta^j (\mathbf{Y}) \nabla_\mathbf{X} \mathbf{e}_j \\
  =& \sum_{j=1}^n (X\theta^j (\mathbf{Y}))\mathbf{e}_j + \sim_{j=1}^n \theta^j (\mathbf{Y}) \omega_j^i (\mathbf{X})\mathbf{e}_i
\end{align*}
$$

By symmetry

$$
  \nabla_\mathbf{Y} \mathbf{X} = \sum_{j=1}^n (Y\theta^j (\mathbf{X}))\mathbf{e}_j + \sum_{j=1}^n \theta^j (\mathbf{X})\omega_j^i (\mathbf{Y})\mathbf{e}_i
$$

By the previous proposition

$$
  [\mathbf{X},\mathbf{Y}] = \sum_{i=1}^n \theta^i ([\mathbf{X},\mathbf{Y}])\mathbf{e}_i
$$

Thus, using Einstein summation convention

$$
\begin{align*}
  T(\mathbf{X},\mathbf{Y}) =& \nabla_\mathbf{X}\mathbf{Y} - \nabla_\mathbf{Y} \mathbf{X} - [\mathbf{X},\mathbf{Y}] \\
  =& \left([X\theta^i(\mathbf{Y}) - \mathbf{Y}\theta^i (\mathbf{X}) - \theta^i([\mathbf{X},\mathbf{Y}])] + [\omega_j^i (\mathbf{X})\theta^j (\mathbf{Y}) - \omega_j^i (\mathbf{Y})\theta^j (\mathbf{X})]\right)\mathbf{e}_i \\
  =& (\mathrm{d}\theta^i + \omega_j^i \wedge \theta^j)(\mathbf{X},\mathbf{Y})\mathbf{e}_i
\end{align*}
$$

Hence

$$
  \tau^i = \mathrm{d}\theta^i + \sum_{j=1}^n \omega_j^i \wedge \theta^j
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a Riemannian manifold and $U$ an open subset on which there is an orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^n$. Let $\Set{\theta^i}_{i=1}^n$ be the dual frame of $1$-forms. Then there exists a unique skew-symmetric matrix $[\omega_j^i]$ of $1$-forms such that

$$
  \mathrm{d}\theta^i + \sum_{j=1}^n \omega_j^i \wedge \theta^j = 0,\; \forall i=1,\dots,n
$$

<details>
<summary>Proof</summary>

Let $[\omega_j^i]$ be the connection matrix of $\nabla$ relative to the orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^n$ on $U$. Because $\nabla$ is metric compatible, the matrix $[\omega_j^i]$ is skew-symmetric. Because $\nabla$ is torsion-free, it satisfies

$$
  \mathrm{d}\theta^i + \sum_{j=1}^n \omega_j^i \wedge\theta^j = 0
$$

This proves the existence of the matrix $[\omega_j^i]$ with the two required properties.

To prove uniqueness, suppose $[\omega_j^i]$ is any skew-symmetric matrix of $1$-forms on $U$ satisfying the hypothesis. Taking the vector bundle $E$ to be the tangent bundle $TM$, then $[\omega_j^i]$ defines an affine connection $\nabla$ on $U$ which is the connection matrix relative to the frame $\Set{\mathbf{e}_i}_{i=1}^n$ on $U$. Because $[\omega_j^i]$ is skew-symmetric, $\nabla$ is metric compatible, and because $[\omega_j^i]$ satisfies the hypothesis, $\nabla$ is torsion-free. Thus, $\nabla$ is the unique Levi-Civita connection on $U$.
</details>
</MathBox>

If $\mathbf{A} = [\alpha_j^i]$ and $\mathbf{B} = [\beta_j^i]$ are matrices of differential forms on $M$ with the number of columns of $\mathbf{A}$ equal to the number of rows of $\mathbf{B}$, then their wedge product $\mathbf{A}\wedge\mathbf{B}$ is the matrix of differential form whose $(i,j)$-entry is

$$
  (\mathbf{A}\wedge\mathbf{B})_j^i = \sum_k \alpha_k^i \wedge \beta_j^k
$$

and $\mathrm{d}\mathbf{A}$ is defined to be $[\mathrm{d}\alpha_j^i]$. In matrix notation we write

$$
  \tau = \begin{bmatrix} \tau^1 \\ \vdots \\ \tau^n \end{bmatrix}, \quad \theta = \begin{bmatrix} \theta^1 \\ \vdots \\ \theta^n \end{bmatrix}, \quad \omega = [\omega_j^i], \quad \Omega = [\Omega_j^i]
$$

Then the first structural equation becomes

$$
  \tau = \mathrm{d}\theta + \omega + \omega\wedge\theta
$$

and the second structural equation becomes

$$
  \Omega = \mathrm{d}\omega + \omega\wedge\omega
$$

## Connection and curvature matrices under a change of frame

Recall that a connection on a vector bundle $E\to M$ can be restricted to a connection over any open subset $U$ of $M$

$$
  \nabla^U : \mathfrak{U}\times\Gamma(U,E) \to\Gamma(U,E)
$$

Suppose there is a frame $B = \Set{\mathbf{e}_i}_{i=1}^r$ for $E$ over $U$. Then the connection matrix $\omega$ of $\nabla$ relative to the frame $B$ is the matrix $[\omega_j^i]$ of $1$-forms defined by

$$
  \nabla_\mathbf{X} \mathbf{e}_j = \sum \omega_j^i (\mathbf{X})\mathbf{e}_i,\; \mathbf{X}\in\mathfrak{U}
$$

For smooth vector fields $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(U)$, the curvature matrix $\Omega$ of the connection $\nabla$ is the matrix $[\Omega_j^i]$ of $2$-forms defined by

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{e}_j = \sum_{i=1}^r \Omega_j^i (\mathbf{X},\mathbf{Y})\mathbf{e}_i
$$

Suppose $\Set{\bar{\mathbf{e}}_i}_{i=1}^r$ is another frame for $E$ over $U$. Let $\bar{\omega} = [\bar{\omega}_j^i]$ and $\bar{\Omega} = [\bar{\Omega}_j^i]$ be the connection and curvature matrices of the connection $\nabla$ relative to this new frame. At each point $\mathbf{p}\in U$, the basis vector $\bar{\mathbf{e}}_\ell (\mathbf{p})$ is a linear combination

$$
  \bar{\mathbf{e}}_\ell (\mathbf{p}) = \sum_{k=1}^r a_\ell^k (\mathbf{p}) \mathbf{e}_k (\mathbf{p})
$$

As sections on $U$

$$
  \bar{\mathbf{e}}_\ell = \sum_{k=1}^r a_\ell^k \mathbf{e}_k
$$

The change of basis matrix $\mathbf{A} = [a_\ell^k]$ is a matrix of functions. As the coefficients of a smooth section with respect to a smooth frame, the $a_\ell^k$ are smooth functions on $U$. At each point $\mathbf{p}$, the matrix $\mathbf{A}(p) = [a_\ell^k (\mathbf{p})]$ is invertible because it is a change of basis matrix. Thus, we can think of $\mathbf{A}$ as a smooth function $U\to\operatorname{GL}_r(\R)$. As row vectors

$$
  [\bar{\mathbf{e}}_1 \cdots \bar{\mathbf{e}}_r] = [\mathbf{e}_1 \cdots \mathbf{e}_r][a_\ell^k]
$$

or in matrix notation

$$
  \bar{\mathbf{e}}_i = \mathbf{eA}
$$

Note that the matrix $\mathbf{A}$ is written on the right of the row vector of sections $\mathbf{e}_i$. The Leibniz rule can be recast in this form as follows.

Suppose $\mathbf{s}$ is a smooth section of the vector bundle $E$ and $f$ is a smooth function on $M$. By the Leibniz rule, for any smooth vector field $\mathbf{X}\in\mathfrak{X}(M)$

$$
\begin{align*}
  \nabla_\mathbf{X} (\mathbf{s}f) =& (\nabla_\mathbf{X}\mathbf{s})f + \mathbf{s}\mathbf{X}(f) \\
  =& (\nabla_\mathbf{X} \mathbf{s})f + \mathbf{s}\mathrm{d}f(\mathbf{X})
\end{align*}
$$

We may view $\nabla\mathbf{s}$ as a function $\mathfrak{X}(M) \to\Gamma(E)$ with $(\nabla\mathbf{s})(\mathbf{X}) = \nabla_\mathbf{X}\mathbf{s}$. Then we may suppress the argument $\mathbf{X}$ and rewrite the Leibniz rule as

$$
  \nabla(\mathbf{s}f) = (\nabla\mathbf{s})f + s\mathrm{d}f,\; \mathbf{s}\in\Gamma(E), f\in C^\infty(M)
$$

<MathBox title='' boxType='theorem'>
Suppose $\mathbf{e}$ and $\bar{\mathbf{e}}$ are two frame for the vector bundle $E$ over $U$ such that $\bar{\mathbf{e}} = \mathbf{eA}$ for some $\mathbf{A}:U\to\operatorname{GL}_r (\R)$. If $\omega$ and $\bar{\omega}$ are the connection matrices and $\Omega$ and $\bar{\Omega}$ are the curvature matrices of a connection $\nabla$ relative to the two frames
1. $\bar{\omega} = \mathbf{A}^{-1} \omega\mathbf{A} + \mathbf{A}^{-1}\mathrm{d}\mathbf{A}$
2. $\bar{\Omega} = \mathbf{A}^{-1} \Omega\mathbf{A}$

<details>
<summary>Proof</summary>

**(1):** We use the recasted Leibniz rule to derive the transformation rule for the connection matrix under a change of frame. Since $\bar{\mathbf{e}} = \mathbf{eA}$, we have $\mathbf{e} = \bar{\mathbf{e}}\mathbf{A}^{-1}$. Recall that if $\mathbf{A} = [a_j^i]$ is a matrix of smooth functions, then $\mathrm{d}\mathbf{A} = [\mathrm{d}a_j^i]$ is a matrix of smooth $1$-forms.

$$
\begin{align*}
  \nabla\bar{\mathbf{e}} =& \nabla(\mathbf{eA}) & \\
  =& (\nabla\mathbf{e})\mathbf{A} + \mathbf{e}\mathrm{d}\mathbf{A} \quad& (\text{Leibniz rule}) \\
  =& (\mathbf{e}\omega)\mathbf{a} + \mathbf{e}\mathrm{d}\mathbf{A} \quad& (\nabla\mathbf{e}= \mathbf{e}\omega) \\
  =& \bar{\mathbf{e}}\mathbf{A}^{-1}\omega\mathbf{A}+ \bar{\mathbf{e}}\mathbf{A}^{-1}\mathrm{d}\mathbf{A} \quad& (\mathbf{e} = \bar{\mathbf{e}}\mathbf{A}^{-1}) \\
  =& \bar{\mathbf{e}}(\mathbf{A}^{-1} \omega\mathbf{A} + \mathbf{A}^{-1}\mathrm{d}\mathbf{A})
\end{align*}
$$

Thus

$$
  \bar{\omega} = \mathbf{A}^{-1}\omega\mathbf{A} + \mathbf{A}^{-1}\mathrm{d}\mathbf{A}
$$

**(2):** Since the structural equation

$$
  \bar{\Omega} = \mathrm{d}\bar{\omega} + \bar{\omega}\wedge\bar{\omega}
$$

expresses the curvature $\bar{\Omega}$ in terms of the connection matrix $\omega$, the brute-force way to obtain the transformation rule for $\bar{\Omega}$ is to plug the formula in **(1)** into the structural equation and expand into terms of $\Omega$.

Another way is to note that since for any $\mathbf{X_p}, \mathbf{Y_p}\in T_\mathbf{p}M$, the curvature $R(\mathbf{X_p},\mathbf{Y_p})$ is the linear transformation of $E_\mathbf{p}$ to $E_\mathbf{p}$ with matrix $[\Omega_j^i(\mathbf{X_p},\mathbf{Y_p})]$ relative to the basis $\Set{\mathbf{e}_i}_{i=1}^r$ at $\mathbf{p}$, a change of basis should lead to a conjugate matrix. Indeed, for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{e}_j = \sum_{i=1}^r \Omega_j^i (\mathbf{X},\mathbf{Y})\mathbf{e}_i
$$

or in matrix notation

$$
\begin{align*}
  R(\mathbf{X},\mathbf{Y})(\mathbf{e}) =& R(\mathbf{X},\mathbf{Y})[\mathbf{e}_1 \cdots \mathbf{e}_r] \\
  =& [\mathbf{e}_1 \cdots \mathbf{e}_r][\Omega_j^i (\mathbf{X},\mathbf{Y})] = \mathbf{e}\Omega(\mathbf{X},\mathbf{Y})
\end{align*}
$$

Suppressing $\mathbf{X}$ and $\mathbf{Y}$ we get

$$
\begin{align*}
  R(\bar{\mathbf{e}}) =& R(\mathbf{eA}) \\
  =& R(\mathbf{e})\mathbf{A} \\
  =& \mathbf{e}\Omega\mathbf{A} \\
  =& \bar{\mathbf{e}}\mathbf{A}^{-1} \Omega\mathbf{A}
\end{align*}
$$

showing that $\bar{\Omega} = \mathbf{A}^{-1}\Omega\mathbf{A}$.
</details>
</MathBox>

## Riemann curvature tensor

Recall that the curvature tensor of an affine connection $\nabla$ on a manifold $M$ is defined to be

$$
\begin{gather*}
  R:\mathfrak{X}(M)\times\mathfrak{X}(M)\times\mathfrak{X}(M) \to\mathfrak{X}(M) \\
  R(\mathbf{X},\mathbf{Y})\mathbf{Z} = \nabla_\mathbf{X} \nabla_\mathbf{Y} \mathbf{Z} - \nabla_\mathbf{Y} \nabla_\mathbf{X} \mathbf{Z} - \nabla_{[\mathbf{X},\mathbf{Y}]}\mathbf{Z}
\end{gather*}
$$

We showed that $R(\mathbf{X},\mathbf{Y})\mathbf{Z}$ is $\mathcal{F}$-linear in every argument. It is immediate from the definition that the curvature tensor $R(\mathbf{X},\mathbf{Y})\mathbf{Z}$ is skew-symmetric in $\mathbf{X}$ and $\mathbf{Y}$.

### Bianchi identities

<MathBox title='First Bianchi identity' boxType='proposition'>
Let $\nabla$ be a connection on the tangent bundle $TM$ of a smooth manifold $M$. Suppose $\varepsilon$ and $\tau$ are the column vectors of dual $1$-forms and torsion forms, respectively, on a framed open set, and $\omega and $\Omega$ are the connection and curvature matrices, respectively. Then

$$
  \mathrm{d}\tau = \Omega\wedge\varepsilon - \omega\wedge\tau
$$

For a Riemann connection, the torsion form $\tau$ is zero and the first Bianchi identity simplifies to

$$
  \Omega\wedge\varepsilon = 0
$$

<details>
<summary>Proof</summary>

Differentiating the first structural equation gives

$$
\begin{align*}
  \mathrm{d}\tau =& \mathrm{d}(\mathrm{d}\varepsilon) + \mathrm{d}\omega\wedge\varepsilon - \omega\wedge\mathrm{d}\varepsilon \\
  =& 0 + (\Omega - \omega\wedge\omega) \wedge\varepsilon - \omega\wedge(\tau - \omega\wedge\varepsilon) \\
  =& \Omega\wedge\varepsilon - \omega\wedge\tau
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Second Bianchi identity' boxType='proposition'>
Let $\nabla$ be a connection on a smooth vector bundle $E$. Suppose $\omega$ and $\Omega$ are the connection and curvature matrices of $\nabla$ relative to a frame for $E$ over an open set. Then

$$
  \mathrm{d}\Omega = \Omega\wedge\omega - \omega\wedge\Omega
$$

In general

$$
  \mathrm{d}\left(\bigwedge_{i=1}^k \Omega \right) = \left(\bigwedge_{i=1}^k \Omega \right)\wedge\omega - \omega\wedge\left(\bigwedge_{i=1}^k \Omega \right)
$$

<details>
<summary>Proof</summary>

Differentiating the second structural equation gives

$$
\begin{align*}
  \mathrm{d}\Omega =& \mathrm{d}(\mathrm{d}\omega) + (\mathrm{d}\omega)\wedge\omega - \omega\wedge\mathrm{d}\omega \\
  =& 0 + (\Omega - \omega\wedge\omega) \wedge\omega - \omega\wedge(\Omega - \omega\wedge\omega) \\
  =& \Omega\wedge\omega - \omega\wedge\Omega
\end{align*}
$$
</details>
</MathBox>

### Symmetry properties

<MathBox title='Symmetry properties of the Riemann curvature tensor' boxType='proposition'>
Let $M$ be a Riemannian manifold with Levi-Civita connection $\nabla$. The Riemann curvature tensor has the following symmetries and identities for $\mathbf{X},\mathbf{Y},\mathbf{Z},\mathbf{V},\mathbf{W}\in\mathfrak{X}(M)$:
1. $R(\mathbf{X},\mathbf{Y}) =  -R(\mathbf{Y},\mathbf{X})$
2. $\langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W}\rangle = \langle R(\mathbf{X},\mathbf{Y})\mathbf{W},\mathbf{Z}\rangle$
3. **First Bianchi identity:** $R(\mathbf{X},\mathbf{Y})\mathbf{Z} + R(\mathbf{Y},\mathbf{Z})\mathbf{X}) + R(\mathbf{Z},\mathbf{X})\mathbf{Y} = 0$
4. **Interchange symmetry:** $\langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W}\rangle = \langle R(\mathbf{Z},\mathbf{W})\mathbf{X},\mathbf{Y}\rangle$
5. **Second Bianchi identity:**
$$
  \nabla_\mathbf{X} \langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle + \nabla_\mathbf{Y} \langle R(\mathbf{Z},\mathbf{X})\mathbf{V},\mathbf{W}\rangle + \nabla_\mathbf{Z} \langle R(\mathbf{X},\mathbf{Y})\mathbf{V},\mathbf{W}\rangle = 0
$$

<details>
<summary>Proof</summary>

**(2):** Because $\langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W}\rangle$ is a tensor, it is enough to check its skew-symmetry locally, e.g. on an open set $U$ with an orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^n$ (assured by the Gram-Schmidt process). Then

$$
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{e}_j,\mathbf{e}_i\rangle = \Omega_j^i (\mathbf{X},\mathbf{Y})
$$

Since $\nabla$ is metric compatible, its curvature matrix $\Omega = [\Omega_j^i]$ relative to an orthonormal frame is skew-symmetric. Thus

$$
\begin{align*}
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{e}_j,\mathbf{e}_i \rangle =& \omega_j^i (\mathbf{X},\mathbf{Y}) = -\Omega_i^j (\mathbf{X},\mathbf{Y}) \\
  =& -\langle R(\mathbf{X},\mathbf{Y})\mathbf{e}_1,\mathbf{e}_2 \rangle
\end{align*}
$$

On $U$, we can write $\mathbf{Z} = \sum_{i=1}^n z^i \mathbf{e}_i$ and $\mathbf{W} = \sum_{i=1}^n w^j \mathbf{e}_j$ for some smooth functions $z^i, w^j \in C^\infty (U)$. Then

$$
\begin{align*}
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W} \rangle =& \sum_{i,j}^n z^i w^j \langle R(\mathbf{X},\mathbf{Y})\mathbf{e}_i, \mathbf{e}_j \rangle \\
  =& -\sum_{i,j}^n z^i w^j \langle R(\mathbf{X},\mathbf{Y})\mathbf{e}_j, \mathbf{e}_i \rangle
\end{align*}
$$

We now show that $\langle R(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle$ is independent of the orthonormal basis $\Set{\mathbf{u},\mathbf{v}}$ for $T_\mathbf{p}M$. Suppse $\Set{\bar{\mathbf{u}},\bar{\mathbf{v}}}$ is another orthonormal basis. Then

$$
\begin{align*}
  \bar{\mathbf{u}} = a\mathbf{u} + b\mathbf{v} \\
  \bar{\mathbf{v}} = c\mathbf{u} + d\mathbf{v}
\end{align*}
$$

for an orthonormal matrix $\mathbf{A} = \left[\begin{smallmatrix}a & b \\ c & d\end{smallmatrix}\right]$ and

$$
\begin{align*}
  \langle R(\bar{\mathbf{u}},\bar{\mathbf{v}})\bar{\mathbf{v}},\bar{\mathbf{u}}\rangle =& \langle \det(\mathbf{A})R(\mathbf{u},\mathbf{v})(c\mathbf{u} + d\mathbf{v}),a\mathbf{u} + d\mathbf{v}\rangle \\
  =& \det(\mathbf{A})^2 \langle R(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle
\end{align*}
$$

by the skew-symmetry of $\langle R(\mathbf{u},\mathbf{v}\mathbf{z},\mathbf{w}\rangle$ in $\mathbf{z}$ and $\mathbf{w}$. Since $\mathbf{A}\in \mathrm{O}(2)$, then $\det(\mathbf{A}) = \pm 1$. Hence

$$
  \langle R(\bar{\mathbf{u}},\bar{\mathbf{v}})\mathbf{v},\mathbf{u}\rangle = \langle R(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle
$$

**(3):** Let $\Set{\mathbf{e}_i}_{i=1}^n$ be a frame over an open set $U$ in $M$, and $\Set{\varepsilon^i}_{i=1}^n$ the dual $1$-forms. On $U$, we write $\mathbf{Z} = \sum_{j=1}^n \varepsilon^j (\mathbf{Z})\mathbf{e}_j$, and

$$
\begin{align*}
  R(\mathbf{X},\mathbf{Y})\mathbf{Z} =& \sum_{j=1} R(\mathbf{X},\mathbf{Y})\varepsilon^j (\mathbf{Z})\mathbf{e}_j \\
  =& \sum_{i,j=1}^n \Omega_j^i (\mathbf{X},\mathbf{Y})\varepsilon^j (\mathbf{Z})\mathbf{e}_i
\end{align*}
$$

For a Riemannian connection, the torsion form is zero and the first Bianchi identity simplifies to $\Omega\wedge\varepsilon$. The $i$th component of $\Omega\wedge\varepsilon$ is $\sum_j \Omega_j^i \wedge \varepsilon^j$. Thus, for each $i$, the first Bianchi identity gives

$$
\begin{align*}
  0 =& \sum_{j=1}^n (\Omega_j^i \wedge \varepsilon^j)(\mathbf{X},\mathbf{Y},\mathbf{Z}) \\
  =& \sum_{j=1}^n \Omega_j^i (\mathbf{X},\mathbf{Y})\varepsilon^j (\mathbf{Z}) - \Omega_j^i (\mathbf{X},\mathbf{Z})\varepsilon^j (\mathbf{Y}) + \Omega_j^i (\mathbf{Y},\mathbf{Z})\varepsilon^j (\mathbf{X})
\end{align*}
$$

Multiplying by $\mathbf{e}_i$ and summing over $i$, we obtain

$$
  0 = R(\mathbf{X},\mathbf{Y})\mathbf{Z} + R(\mathbf{Z},\mathbf{X})\mathbf{Y} + R(\mathbf{Y},\mathbf{Z})\mathbf{X}
$$

**(4):** By the first Bianchi identity

$$
  \langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W}\rangle + R(\mathbf{Y},\mathbf{Z})\mathbf{X},\mathbf{W}\rangle + R(\mathbf{Z},\mathbf{X})\mathbf{Y},\mathbf{W}\rangle = 0
$$

First, to cancel out the term $R(\mathbf{Y},\mathbf{Z})\mathbf{X},\mathbf{W}\rangle$ we add the first Bianchi identity

$$
  \langle R(\mathbf{Y},\mathbf{Z})\mathbf{W},\mathbf{X}\rangle + R(\mathbf{Z},\mathbf{W})\mathbf{Y},\mathbf{X}\rangle + R(\mathbf{W},\mathbf{Y})\mathbf{Z},\mathbf{X}\rangle = 0
$$

Secondly, to cancel out the term $R(\mathbf{Z},\mathbf{X})\mathbf{Y},\mathbf{W}\rangle$ terms we add the first Bianchi identity

$$
  \langle R(\mathbf{Z},\mathbf{X})\mathbf{W},\mathbf{Y}\rangle + R(\mathbf{X},\mathbf{W})\mathbf{Z},\mathbf{Y}\rangle + R(\mathbf{W},\mathbf{Z})\mathbf{X},\mathbf{Y}\rangle = 0
$$

Finally, to cancel out the term $R(\mathbf{W},\mathbf{Y})\mathbf{Z},\mathbf{X}\rangle$ terms we add the first Bianchi identity

$$
  \langle R(\mathbf{W},\mathbf{Y})\mathbf{X},\mathbf{Z}\rangle + R(\mathbf{Y},\mathbf{X})\mathbf{W},\mathbf{Z}\rangle + R(\mathbf{X},\mathbf{W})\mathbf{Y},\mathbf{Z}\rangle = 0
$$

Adding the four equations and making use of the skew-symmetry properties, we get

$$
  2\langle R(\mathbf{X},\mathbf{Y})\mathbf{Z},\mathbf{W}\rangle - 2\langle R(\mathbf{Z},\mathbf{W})\mathbf{X},\mathbf{Y}\rangle = 0
$$

**(5):** Since $\nabla_\mathbf{X} \langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle$ is $\mathcal{F}$-linear in all of its arguments, it suffices to verify the identity at a point $\mathbf{p}\in M$ and for $\mathbf{X},\mathbf{Y},\mathbf{Z},\mathbf{V},\mathbf{W}$ a frame of smooth vector fields near $\mathbf{p}$. Such a frame is the coordinate frame $\Set{\frac{\partial}{\partial x^i}}_{i=1}^n$ of a normal coordinate neighbourhood of $\mathbf{p}$. The advantage of using a normal coordinate system is that $\nabla_\mathbf{X}\mathbf{Y} = 0$ at $\mathbf{p}$ and $[\mathbf{X},\mathbf{Y}] = 0$ on $U$ for any given coordinate vector fields $\mathbf{X} = \frac{\partial}{\partial x^i}$ and $\mathbf{Y} = \frac{\partial}{\partial x^j}$ for some $i,j$. This greatly simplifies the expression for the covariant derivative of a tensor field. Thus if $\mathbf{X},\mathbf{Y},\mathbf{Z},\mathbf{V},\mathbf{W}$ are coordinate vector fields on a normal neighbourhood of $\mathbf{p}$, then the covariant derivative by $\mathbf{X}$ is

$$
\begin{align*}
  \nabla_\mathbf{X} \langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle =& \mathbf{X}(\langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle) \\
  &- \langle R(\nabla_\mathbf{X} \mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle - \langle R(\mathbf{Y},\nabla_\mathbf{X}\mathbf{Z})\mathbf{V},\mathbf{W}\rangle \\
  &- \langle R(\mathbf{Y},\mathbf{Z})\nabla_\mathbf{X} \mathbf{V},\mathbf{W}\rangle - \langle R(\mathbf{Y},\mathbf{Z}) \mathbf{V},\nabla_\mathbf{X}\mathbf{W}\rangle \\
  =& \mathbf{X}(\langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle) \\
  =& \langle \nabla_\mathbf{X} R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle + \langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\nabla_\mathbf{X}\mathbf{W}\rangle \\
  =& \langle\nabla_\mathbf{X} \nabla_\mathbf{Y} \nabla_\mathbf{Z}, \mathbf{W}\rangle - \langle \nabla_\mathbf{X}, \nabla_\mathbf{Z}, \nabla_\mathbf{Y} \mathbf{V},\mathbf{W}\rangle
\end{align*}
$$

Cyclically permuting $\mathbf{X},\mathbf{Y},\mathbf{Z}$ we get

$$
  \nabla_\mathbf{Y} \langle R(\mathbf{Z},\mathbf{X})\mathbf{V},\mathbf{W}\rangle = \langle\nabla_\mathbf{Y} \nabla_\mathbf{Z} \nabla_\mathbf{X}, \mathbf{W}\rangle - \langle \nabla_\mathbf{Y}, \nabla_\mathbf{X}, \nabla_\mathbf{Z} \mathbf{V},\mathbf{W}\rangle
$$

and 

$$
  \nabla_\mathbf{Z} \langle R(\mathbf{X},\mathbf{Y})\mathbf{V},\mathbf{W}\rangle = \langle\nabla_\mathbf{Z} \nabla_\mathbf{X} \nabla_\mathbf{Y}, \mathbf{W}\rangle - \langle \nabla_\mathbf{Z}, \nabla_\mathbf{Y}, \nabla_\mathbf{X} \mathbf{V},\mathbf{W}\rangle
$$

Summing the three covariant derivatives gives

$$
\begin{align*}
  &\nabla_\mathbf{X} \langle R(\mathbf{Y},\mathbf{Z})\mathbf{V},\mathbf{W}\rangle + \nabla_\mathbf{Y} \langle R(\mathbf{Z},\mathbf{X})\mathbf{V},\mathbf{W}\rangle + \nabla_\mathbf{Z} \langle R(\mathbf{X},\mathbf{Y})\mathbf{V},\mathbf{W}\rangle \\
  =& \langle R(\mathbf{X},\mathbf{Y})\nabla_\mathbf{Z} \mathbf{V},\mathbf{W}\rangle + \langleR(\mathbf{Y},\mathbf{Z})\nabla_\mathbf{X} \mathbf{V},\mathbf{W}\rangle + \langle R(\mathbf{Z},\mathbf{X})\nabla_\mathbf{Y} \mathbf{V},\mathbf{W}\rangle
\end{align*}
$$

Because $R(-,-)-$ is a tensor, we can evaluate the arguments at a single point $\mathbf{p}$ on the right-hand side. Since $\nabla_\mathbf{X} \mathbf{V}$, $\nabla_\mathbf{Y} \mathbf{V}$, $\nabla_\mathbf{Z} \mathbf{V}$ all vanish at $\mathbf{p}$, all three terms are zero.
</details>
</MathBox>

### Sectional curvature

Let $M$ be a Riemannian manifold and $\mathbf{p}$ a point in $M$. If $P$ is a $2$-dimensional subspace of the tangent space $T_\mathbf{p}M$, then we define the *sectional curvature* of $P$ to be

$$
  K(P) = \langle R(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2,\mathbf{e}_1\rangle
$$

for any orthonormal basis $\Set{\mathbf{e}_1,\mathbf{e}_2}$ of $P$. Just as in the definition of the Gaussian curvature, the right-hand side is independent of the orthonormal basis $\Set{\mathbf{e}_1,\mathbf{e}_2}$.

If $\Set{\mathbf{u},\mathbf{v}}$ is an arbitrary basis for the $2$-plane $P$, then the sectional curvature of $P$ is given by

$$
  K(P) = \frac{\langle R(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle}{\langle\mathbf{u},\mathbf{u}\rangle\langle\mathbf{v},\mathbf{v}\rangle - \langle\mathbf{u},\mathbf{v}\rangle^2}
$$

### Ricci curvature

If $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(U)$ are smooth vector fields on an open set $U$ in a Riemannian manifold $M$, $\Set{\mathbf{E}_i}_{i=1}^n$ is an orthonormal frame on $U$, the *Ricci curvature* $\operatorname{Ric}:T_\mathbf{p} M \times T_\mathbf{p} M \to T_\mathbf{p} M$ is defined as

$$
\begin{align*}
  \operatorname{Ric}(\mathbf{X},\mathbf{Y}) =& \operatorname{tr}(R(-,\mathbf{X})\mathbf{Y}) \\
  =& \sum_{i=1}^n \langle R(\mathbf{E}_i,\mathbf{X}\mathbf{Y}, \mathbf{E}_i)\rangle
\end{align*}
$$

In other words, the Ricci curvature associates two tangent vectors $\mathbf{u},\mathbf{v}\in T_\mathbf{p}M$ at $\mathbf{p}$ to the trace of the linear endomorphism

$$
  \mathbf{w}\mapsto R(\mathbf{w},\mathbf{u})\mathbf{v}
$$

By the symmetry properties of the Riemann curvature tensor

$$
\begin{align*}
  \operatorname{Ric}(\mathbf{X},\mathbf{Y}) =& \sum_{i=1}^n \langle R(\mathbf{E}_i, \mathbf{X})\mathbf{Y}, \mathbf{E}_i \rangle \\
  =& \sum_{i=1}^n \langle R(\mathbf{Y},\mathbf{E}_i)\mathbf{E}_i, \mathbf{X}\rangle \\
  =& \sum_{i=1}^n \langle R(\mathbf{E}_i, \mathbf{Y})\mathbf{X}, \mathbf{E}_i \rangle \\
  =& \operatorname{Ric}(\mathbf{Y},\mathbf{X})
\end{align*}
$$

Hence, $\operatorname{Ric}(\mathbf{X},\mathbf{Y})$ is a symmetric tensor of rank $(0,2)$.

### Ricci scalar curvature

The Ricci scalar (curvature) at a point $\mathbf{p}$ of a Riemannian manifold $M$ is the trace of the Ricci curvature at $\mathbf{p}$, defined as follows. By the nondegeneracy of the Riemannian metric, there is a unique linear map $\rho:T_\mathbf{p} M \to T_\mathbf{p} M$ such that

$$
  \operatorname{Ric}(\mathbf{u},\mathbf{v}) = \langle \rho(\mathbf{u}),\mathbf{v}\rangle,\; \forall \mathbf{u},\mathbf{v}\in T_\mathbf{p}M
$$

The Ricci scalar $S(\mathbf{p})$ at $\mathbf{p}$ is defined as the trace of $\rho$. If $\Set{\mathbf{e}_i}_{i=1}^n$ is an orthonormal basis for $T_\mathbf{p} M$, then

$$
\begin{align*}
  S(\mathbf{p}) =& \operatorname{tr}(\rho) = \sum_{j=1}^n \langle \rho(\mathbf{e}_j), \mathbf{e}_j \rangle \\
  =& \sum_{j=1}^n \operatorname{Ric}(\mathbf{e}_j, \mathbf{e}_j) \\
  =& \sum_{i,j=1}^n \langle R(\mathbf{e}_i, \mathbf{e}_j), \mathbf{e}_j, \mathbf{e}_i \rangle
\end{align*}
$$

## Gauss's Theorema Egregium using forms

### The Gauss curvature equation

Consider a smooth surface $M$ in $\R^3$ and a point $\mathbf{p}\in M$. Let $U$ be an open neighbourhood of $\mathbf{p}$ on which there is an orthonormal frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$. This is always possible by the Gram-Schmidth process, which turns any frame into an orthonormal frame. If $\mathbf{e}_3 = \mathbf{e}_1 \times\mathbf{e}_2$ is a unit normal vector field, then $B = \Set{\mathbf{e}_1,\mathbf{e}_2,\mathbf{e}_3}$ is an orthonormal frame for the vector bundle $T\R^3|_U$ over $U$.

For the connection $\mathrm{D}$ on the bundle $T\R^3|_M$, let $[\omega_j^i]$ be the connection matrix of $1$-forms relative to the orthonormal frame $B$ over $U$. Since $\mathrm{D}$ is metric compatible and the frame $B$ is orthonormal, the matrix $[\omega_j^i]$ is skew-symmetric. Thus, for $\mathbf{X}\in\mathfrak{X}(M)$

$$
\begin{align*}
  \mathrm{D}_\mathbf{X} \mathbf{e}_1 =& -\omega_2^1 (\mathbf{X})\mathbf{e}_2 -\omega_3^1 (\mathbf{X})\mathbf{e}_3 \\
  \mathrm{D}_\mathbf{X} \mathbf{e}_2 =& -\omega_2^1 (\mathbf{X})\mathbf{e}_1 -\omega_3^2 (\mathbf{X})\mathbf{e}_3 \\
  \mathrm{D}_\mathbf{X} \mathbf{e}_3 =& -\omega_3^1 (\mathbf{X})\mathbf{e}_1 -\omega_3^2 (\mathbf{X})\mathbf{e}_2 
\end{align*}
$$

Let $\nabla$ be the Levi-Civita connection on the surface $M$. Recall that for $\mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)$, the directional derivative $\mathrm{D}_\mathbf{X} \mathbf{Y}$ need not be tangent to the surface $M$, and $\nabla_\mathbf{X} \mathbf{Y}$ is simply the tangential component of $\mathrm{D}_\mathbf{X} \mathbf{Y}$

$$
\begin{align*}
  \nabla_\mathbf{X} \mathbf{e}_1 =& -\omega_2^1 (\mathbf{X})\mathbf{e}_2 \\
  \nabla_\mathbf{X} \mathbf{e}_2 =& \omega_2^1 (\mathbf{X})\mathbf{e}_1
\end{align*}
$$

Thus the connection matrix of the Levi-Civita connection $\nabla$ on $M$ is

$$
  \omega = \begin{bmatrix} 0 & \omega_2^1 \\ -\omega_2^1 & 0 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix} \omega_2^1
$$

Since

$$
\begin{align*}
  \omega\wedge\omega =& \begin{bmatrix} 0 & \omega_2^1 \\ -\omega_2^1 & 0 \end{bmatrix} \wedge \begin{bmatrix} 0 & \omega_2^1 \\ -\omega_2^1 & 0 \end{bmatrix} \\
  =& \begin{bmatrix} -\omega_2^1 \wedge \omega_2^1 & 0 \\ 0 & -\omega_2^1 \wedge \omega_2^1 \end{bmatrix} = \begin{bmatrix} 0 & 0 \\ 0 & 0 \end{bmatrix}
\end{align*}
$$

the curvature matrix of $\nabla$ is

$$
\begin{align*}
  \Omega =& \mathrm{d}\omega + \omega\wedge\omega = \mathrm{d}\omega \\
  =& \begin{bmatrix} 0 & \mathrm{d}\omega_2^1 \\ -\mathrm{d}\omega_2^1 & 0 \end{bmatrix} = \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix} \mathrm{d}\omega_2^1
\end{align*}
$$

So the curvature matrix of $\nabla$ is completely described by $\Omega_2^1 = \mathrm{d}\omega_2^1$. Set the unit normal vector field $\mathbf{N}$ on $U$ to be $\mathbf{N} = -\mathbf{e}_3$. The shape operator becomes

$$
\begin{align*}
  L(\mathbf{X}) =& -\mathrm{D}_\mathbf{X} \mathbf{N} = \mathrm{D}_\mathbf{X} \mathbf{e}_3,\; \mathbf{X}\in\mathfrak{X}(M) \\
  =& \omega_3^1 (\mathbf{X})\mathbf{e}_1 + \omega_3^2 (\mathbf{X})\mathbf{e}_2
\end{align*} 
$$

<MathBox title='Gauss curvature equation in $\R^3$ using forms' boxType='proposition'>
Let $B = \Set{\mathbf{e}_1,\mathbf{e}_2}$ be an orthonormal frame of vector fields on an oriented open subset $U$ of a surface $M$ in $\R^3$, and let $\mathbf{e}_3$ be a unit normal vector field on $U$. Relative to $B$, the curvature form $\Omega_2^1$ of the Levi-Civita connection on $M$ is related to the connection forms of the direction derivative $\mathrm{D}$ on the bundle $T\R^3|_M$ by the Gauss curvature equation

$$
  \omega_2^1 = \omega_3^1 \wedge \omega_3^2
$$

<details>
<summary>Proof</summary>

Let $\tilde{\Omega_j^i}$ be the curvature forms of the connection $\mathrm{D}$ on $T\R^3|_M$. Because the curvature tensor of $\mathrm{D}$ is zero, the second equation for $\tilde{\Omega}$ gives

$$
  \tilde{\Omega}_j^i = \mathrm{d}\omega_j^i + \sum_{k=1}^3 \omega_k^i \wedge\omega_j^k = 0
$$

In particular

$$
  \mathrm{d}\omega_2^1 + \omega_1^1 \wedge\omega_2^1 + \omega_2^1 \wedge \omega_2^2 + \omega_3^1 \wedge \omega_2^3 = 0
$$

Since $\omega_1^1 = \omega_2^2 = 0$, this reduces to

$$
  \mathrm{d}\omega_2^1 + \omega_3^1 \wedge\omega_2^3 = 0
$$

Since the matrix $[\omega_j^i]$ is skew-symmetric and $\Omega_2^1 = \mathrm{d}\omega_2^1$

$$
  \mathrm{d}\omega_2^1 = \omega_3^1 \wedge \omega_3^2 = \Omega_2^1
$$
</details>
</MathBox>

<MathBox title='Gaussian curvature in $\R^3$ using forms' boxType='proposition'>
For a smooth surface in $\R^3$, if $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal frame over an oriented subset $U$ of the surface and $\mathbf{e}_3$ is a unit normal vector field on $U$, then the Gaussian curvature $K$ on $U$ is given by

$$
  K = \det\begin{align*} \omega_3^1 (\mathbf{e}_1) & \omega_3^1 (\mathbf{e}_2) \\ \omega_3^2 (\mathbf{e}_1) & \omega_3^2 (\mathbf{e}_2) \end{align*} = (\omega_3^1 \wedge \omega_3^2)(\mathbf{e}_1,\mathbf{e}_2)
$$

<details>
<summary>Proof</summary>

From $L(\mathbf{X}) = \omega_3^1 (\mathbf{X})\mathbf{e}_1 + \omega_3^2 (\mathbf{X})\mathbf{e}_2$ for $\mathbf{X}\in\mathfrak{X}(U)$ we have

$$
\begin{align*}
  L(\mathbf{e}_1) =& \omega_3^1 (\mathbf{e}_1)\mathbf{e}_1 + \omega_3^2 (\mathbf{e}_1)\mathbf{e}_2 \\
  L(\mathbf{e}_2) =& \omega_3^1 (\mathbf{e}_2)\mathbf{e}_1 + \omega_3^2 (\mathbf{e}_2)\mathbf{e}_2
\end{align*}
$$

So the matrix of $L$ relative to the frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is

$$
  L = \begin{bmatrix} \omega_3^1 (\mathbf{e}_1) & \omega_3^1 (\mathbf{e}_2) \\ \omega_3^2 (\mathbf{e}_1) & \omega_3^2 \end{bmatrix}
$$

Thus

$$
\begin{align*}
  K =& \det(L) = \begin{vmatrix} \omega_3^1 (\mathbf{e}_1) & \omega_3^1 (\mathbf{e}_2) \\ \omega_3^2 (\mathbf{e}_1) & \omega_3^2 (\mathbf{e}_2) \end{vmatrix} \\
  =& \omega_3^1 (\mathbf{e}_1)\omega_3^2 (\mathbf{e}_2) - \omega_3^1 (\mathbf{e}_2)\omega_3^2 (\mathbf{e}_1) \\
  =& (\omega_3^1 \wedge \omega_3^2)(\mathbf{e}_1,\mathbf{e}_2)
\end{align*}
$$
</details>
</MathBox>


<MathBox title="Gauss's Theorema Egregium in $\R^3$ using forms" boxType='theorem'>
For a smooth surface in $\R^3$, if $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal frame over an open subset $U$ of the surface with dual frame $\Set{\varepsilon^1,\varepsilon^2}$, then the Gaussian curvature $K$ on $U$ is given by

$$
  K = \Omega_2^1 (\mathbf{e}_1,\mathbf{e}_2)
$$

or

$$
  \mathrm{d}\omega_2^1 = K\varepsilon^1 \wedge\varepsilon^2
$$

<details>
<summary>Proof</summary>

The first formula follows immediately from the previous theorem and the Gauss curvature equation. As for the second formula, since

$$
  K = K(\varepsilon^1 \wedge\varepsilon^2)(\mathbf{e}_1,\mathbf{e}_2) = \omega_2^1 (\mathbf{e}_1,\mathbf{e}_2)
$$

and a $2$-form on $U$ is completely determined by its value on $\mathbf{e}_1,\mathbf{e_2}$ we have $\Omega_2^1 = K\varepsilon^1 \wedge\varepsilon^2$ and since $\Omega_2^1 = \mathrm{d}\omega_2^1$ we get

$$
  \mathrm{d}\omega_2^1 = K\varepsilon^1 \wedge\varepsilon^2
$$
</details>
</MathBox>

Since $\Omega_2^1$ depends only on the metric and not on the embedding of the surface in $\R^3$, then $K = \Omega_2^1 (\mathbf{e}_1,\mathbf{e}_2)$ shows that the same i true of the Gaussian curvature. This formula is therefore a definition of the Gaussian curvature of an abstract Riemannian $2$-manifold. It is consistent with the Theorema Egregium for vector fields, for by the definition of the curvature matrix, if $\Set{\mathbf{e}_1,\mathbf{e}_2}$ is an orthonormal frame on an open subset $U$ of $M$, then

$$
  R(\mathbf{X},\mathbf{Y})\mathbf{e}_2 = \Omega_2^1(\mathbf{X},\mathbf{Y})\mathbf{e}_1,\; \forall \mathbf{X},\mathbf{Y}\in\mathfrak{X}(U)
$$

so that

$$
  \langle R(\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_2,\mathbf{e}_1\rangle = \langle\Omega_2^1 (\mathbf{e}_1,\mathbf{e}_2)\mathbf{e}_1,\mathbf{e}_2\rangle = \Omega_2^1 (\mathbf{e}_1,\mathbf{e}_2)
$$

<MathBox title='Gaussian curvature of a Riemannian 2-manifold' boxType='definition'>
The *Gaussian curvature* $K$ at a point $\mathbf{p}$ of a Riemannian 2-manifold $M$ is defined to be

$$
  K_\mathbf{p} = \langle R_\mathbf{p}(\mathbf{u},\mathbf{v})\mathbf{v},\mathbf{u}\rangle
$$

for any orthonormal basis $\Set{\mathbf{u},\mathbf{v}}$ for the tangent plane $T_\mathbf{p}M$.
</MathBox>

### Poincaré half-plane

<MathBox title='Gaussian curvature of the Poincaré half-plane' boxType='example' tag='example-6'>
The Poincaré half-plane is the upper half-plane

$$
  \mathbb{H}^2 = \Set{(x,y)\in\R^2 | y > 0}
$$

with the metric

$$
  g_{xy} = \frac{\mathrm{d}x \otimes \mathrm{d}x + \mathrm{d}y \otimes \mathrm{d}y}{y^2}
$$

With this metric, the orthonormal frame is

$$
  \mathbf{E}_1 = y\frac{\partial}{\partial x} \quad \mathbf{E}_2 = y\frac{\partial}{\partial y}
$$

The dual frame is

$$
  \varepsilon_1 = \frac{1}{y}\mathrm{d}x \quad \varepsilon_2 = \frac{1}{y}\mathrm{d}y
$$

Hence

$$
  \mathrm{d}\varepsilon^1 = \frac{1}{y^2}\mathrm{d}x \wedge \mathrm{d}y \quad \mathrm{d}\varepsilon^2 = 0
$$

On the Poincaré half-plane the connection form $\omega_2^1$ is a linear combination of $\mathrm{d}x$ and $\mathrm{d}y$, taking the form

$$
  \omega_2^1 = a\;\mathrm{d}x + b\;\mathrm{d}y
$$

We will determine the coefficients $a$ and $b$ from the first structural equation

$$
\begin{align*}
  \mathrm{d}\varepsilon^1 =& -\omega_2^1 \wedge\varepsilon^2 \\
  \mathrm{d}\varepsilon^2 =& -\omega_1^2 \wedge\varepsilon^1 = \omega_2^1 \wedge\varepsilon^1
\end{align*}
$$

Combining the results give

$$
\begin{align*}
  \frac{1}{y^2}\mathrm{d}x \wedge\mathrm{d}y =& \mathrm{d}\varepsilon^1 \\
  =& -(a\mathrm{d}x + b\mathrm{d}y)\wedge \frac{1}{y}\mathrm{d}y \\
  =& -\frac{a}{y}\mathrm{d}x\wedge\mathrm{d}y
\end{align*}
$$

showing that $a = -\frac{1}{y}$. Furthermore

$$
\begin{align*}
  0 =& \mathrm{d}\varepsilon^2 = \left(-\frac{1}{y}\mathrm{d}x + b\mathrm{d}y \right)\wedge\frac{1}{y}\mathrm{d}x \\
  =& -\frac{b}{y}\mathrm{d}x\wedge\mathrm{d}y
\end{align*}
$$

giving $b = 0$. Thus

$$
\begin{align*}
  \omega_2^1 =& -\frac{1}{y}\mathrm{d}x \\
  \mathrm{d}\omega_2^1 =& \frac{1}{y^2}\mathrm{d}y\wedge\mathrm{d}x = -\frac{1}{y^2}\mathrm{d}x\wedge\mathrm{d}y 
\end{align*}
$$

By definition, the Gaussian curvature of the Poincaré half-plane is

$$
\begin{align*}
  K =& \Omega_2^1 (\mathbf{e}_1,\mathbf{e}_2) = -\frac{1}{y^2} (\mathrm{d}x\wedge\mathrm{d}y)\left(y\frac{\partial}{\partial x}, y\frac{\partial}{\partial y} \right) \\
  =& -(\mathrm{d}x\wedge\mathrm{d}y)\left(\frac{\partial}{\partial x},\frac{\partial}{\partial y}\right) = -1
\end{align*}
$$

As such, the Poincaré half-plane is also known as the *hyperbolic plane*.
</MathBox>

## Bianchi identities

# Geodesics

## Affine connections by covariant derivatives

<MathBox title='Christoffel symbols for the Poincaré half-plane' boxType='example' tag='example-8'>
The Poincaré half-plane $\mathbb{H}^2$ is covered by a single coordinate open set $(U,x^1,x^2)$. We showed in example $\ref{example-6}$ that its connection form $\omega_2^1$ relative to the orthonormal frame $\mathbf{E}_i = x^2 \frac{\partial}{\partial x^i}$ for $i=1,2$ is

$$
  \omega_2^1 = -\frac{1}{x^2}\mathrm{d}x
$$

such that $\frac{\partial}{\partial x^i} = \frac{1}{x^2}\mathbf{e}_i$. For any smooth vector field $\mathbf{X}$ on the Poincaré half-plane

$$
\begin{align*}
  \nabla_\mathbf{X} \frac{\partial}{\partial x^1} =& \nabla_\mathbf{X} \left( \frac{1}{x^2}\mathbf{e}_1 \right) = \mathbf{X}\left(\frac{1}{x^2}\right)\mathbf{e}_1 + \frac{1}{x^2}\nabla_\mathbf{X}\mathbf{e}_1 \\
  =& \frac{1}{(x^2)^2}(\mathbf{X}x^2)x^2 \frac{\partial}{\partial x^2} + \frac{1}{x^2} \omega_1^2 (\mathbf{X})\mathbf{e}_2 \\
  =& -\frac{1}{x^2} (\mathbf{X}x^2)\frac{\partial}{\partial x^1} + \frac{1}{(x^2)^2} \mathrm{d}x (\mathbf{X})x^2 \frac{\partial}{\partial x^2} \\
  =& -\frac{1}{x^2} (\mathbf{X}x^2)\frac{\partial}{\partial x^1} + \frac{1}{x^2}(\mathbf{X}x^2)\frac{\partial}{\partial x^2}
\end{align*}
$$

Similarly

$$
  \nabla_\mathbf{X} \frac{\partial}{\partial x^2} = -\frac{1}{x^2}(\mathbf{X}x^1) \frac{\partial}{\partial x^1} - \frac{1}{x^1}(\mathbf{X}x^2)\frac{\partial}{\partial x^2}
$$

Relative to the coordinate frame $\Set{\frac{\partial}{\partial x^1},\frac{\partial}{\partial x^2}}$, the connection is given by

$$
\begin{align*}
  \nabla_{\partial/\partial x^1} \frac{\partial}{\partial x^2} = \frac{1}{x^2}\frac{\partial}{\partial x^2} \quad \nabla_{\partial/\partial x^2} \frac{\partial}{\partial x^1} = -\frac{1}{x^2}\frac{\partial}{\partial x^1} \\
  \nabla_{\partial/\partial x^1} \frac{\partial}{\partial x^2} = -\frac{1}{x^2}\frac{\partial}{\partial x^1} \quad \nabla_{\partial/\partial x^2} \frac{\partial}{\partial x^2} = -\frac{1}{x^2}\frac{\partial}{\partial x^2}
\end{align*}
$$

Thus, the Christoffel symbols $\Gamma_{ij}^k$ for the Poincaré half-plane are

| $~_{\boldsymbol{ij}}\diagdown^{\boldsymbol{k}}$ | $\boldsymbol{1}$ | $\boldsymbol{2}$ |
|:-:|:-:|:-:|
| $\boldsymbol{11}$ | $0$ | $\frac{1}{x^2}$ |
| $\boldsymbol{12}$ | -$\frac{1}{x^2}$ | $0$ |
| $\boldsymbol{21}$ | -$\frac{1}{x^2}$ | $0$ |
| $\boldsymbol{22}$ | $0$ | -$\frac{1}{x^2}$ |
</MathBox>

<MathBox title='Christoffel symbols for $\mathbb{S}^2$' boxType='example'>

</MathBox>


## Geodesic curves

<MathBox title='Geodesic' boxType='definition'>
Let $M$ be a smooth manifold with an affine connection $\nabla$ and $I\subseteq\R$ a real open, closed or half-closed interval. A parametrized curve $c:I\to M$ is a *geodesic* if the covariant derivative $\frac{\mathrm{D}\mathbf{\mathrm{D}}}{\mathrm{d}t}$ of its velocity vector field $\mathbf{T}(t) = c'(t)$ is zero. The geodesic is *maximal* if its domain $I$ cannot be extended to larger interval.
</MathBox>

The notion of a geodesic depends only on a connection and does not require a metric on the smooth manifold $M$. However, if $M$ is a Riemannian manifold, then we will always take the connection to be the unique Levi-Civita connection.

<MathBox title='' boxType='proposition'>
The speed of a geodesic on a Riemannian manifold is constant.

<details>
<summary>Proof</summary>

Let $\mathbf{T} = c'(t)$ be the velocity of the geodesic. The speed is constant if and only if its square $f(t) = \langle\mathb{T},\mathbf{T}\rangle$. However,

$$
\begin{align*}
  f'(t) =& \frac{\mathrm{d}}{\mathrm{d}t}\langle\mathbf{T},\mathbf{T}\rangle \\
  =& 2\left\langle\frac{\mathrm{D}\mathbf{T}}{\mathrm{d}t},\mathbf{T} \right\rangle = 0
\end{align*}
$$

showing that $f(t)$.
</details>
</MathBox>

Let $M$ be a smooth surface in $\R^3$. Recall that its Riemannian connection is given by

$$
  \nabla_\mathbf{X} \mathbf{Y} = (\mathrm{D}_\mathbf{X}\mathbf{Y})_\text{tan},\; \mathbf{X},\mathbf{Y}\in\mathfrak{X}(M)
$$

the tangential component of the directional derivative $\mathrm{D}_\mathbf{X}\mathbf{Y}$. If $\mathbf{N}$ is a unit normal vector field on an open subset $U$ of $M$, then the tangential component of a vector field $Z$ along $M$ is

$$
  \mathbf{Z}_\text{tan} = \mathbf{Z} - \langle\mathbf{Z},\mathbf{N}\rangle\mathbf{N}
$$

For a vector field $\mathbf{V}$ along a curve $c(t)$ in $M$, the covariant derivative associated to the Riemannian connection $\nabla$ on $M$ is

$$
  \frac{\mathrm{D}\mathbf{V}}{\mathrm{d}t} = \left(\frac{\mathrm{d}\mathbf{V}}{\mathrm{d}t} \right)_\text{tan}
$$

<MathBox title='Geodesics on a sphere' boxType='example'>
On a $2$-sphere $M$ of radius $a$ \in $\R^3$, let $\gamma(t)$ be a great circe parametrized by arc length. Then $\gamma(t)$ has unit speed. Differentiating

$$
  \langle\gamma'(t),\gamma'(t)\rangle = 1
$$

with repsect to $t$ gives

$$
  2\langle\gamma''(t),\gamma'(t)\rangle = 0
$$

This shows that the acceleration $\gamma''(t)$ of a unit-speed curve in $\R^3$ is perpendicular to the velocity.

Since $\gamma(t)$ lies in the plane of the curve, so do $\gamma'$ and $\gamma''(t)$. Being perpendicular to $\gamma'(t)$, the acceleration $\gamma''(t)$ must point in the radial direction. Hence, because $\gamma''(t)$ is perpendicular to the tangent plane to the target plane at

$$
  \frac{\mathrm{D}\mathbf{T}}{\mathrm{d}t} = \left(\frac{\mathrm{d}\mathbf{T}}{\mathrm{d}t}\right)_\text{tan} = \gamma''(t)_\text{tan} = 0
$$

This shows that every great circle is a geodesic on the sphere
</MathBox>

### Reparametrization of a geodesic

<MathBox title='' boxType='proposition'>
Suppose $\gamma(u)$ us a nonconstant geodesic on a smooth manifold with connection and $\bar{\gamma}(t) := \gamma(t)$ is a reparametrization of $\gamma(u)$. Then $\bar{\gamma}(t)$ is a geodesic if and only if $u = \alpha t + \beta$ for $\alpha,\beta\in\R$.

<details>
<summary>Proof</summary>

Let $\mathbf{T}(u) = \gamma'(u)$ and $\bar{\mathbf{T}}(t) = \bar{\gamma}(t)$ be the tangent vector fields of the curves $\gamma(u)$ and $\bar{\gamma}(t)$. By the chain rule

$$
\begin{align*}
  \bar{\mathbf{T}}(t) =& \frac{\mathrm{d}}{\mathrm{d}t} \gamma(u(t)) = \gamma'(u(t))u'(t) \\
  =& u'(t)\mathbf{T}(u(t))
\end{align*}
$$

By properties of a covariant derivative

$$
\begin{align*}
  \frac{\mathrm{D}\bar{\mathbf{T}}}{\mathrm{d}t} =& u''(t)\mathbf{T}(u(t)) + u'(t)\frac{\mathrm{D}\mathbf{T}(u(t))}{\mathrm{d}t} \\
  =& u''(t)\mathbf{T}(u(t)) + u'(t)\frac{\mathrm{D}\mathbf{T}}{\mathrm{d}\mathbf{u}}\frac{\mathrm{d}u}{\mathrm{d}t} \\
  =& u''(t)\mathbf{T}(u(t))
\end{align*}
$$

where $\frac{\mathrm{D}\mathbf{T}}{\mathrm{d}u} = 0$ because $\gamma(u)$ is a geodesic. Since $\mathbf{T}(u)$ has constant length, it is never zero. Thus,

$$
  \frac{\mathrm{D}\mathbf{T}}{\mathrm{d}t} = 0 \iff u'' = 0 \iff u = \alpha t + \beta,\; \alpha,\beta\in\R
$$
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Let $(a,b)\subseteq\R$ be an interval containing $0$. For any positive constant $k\in[0,\infty)$, the curve $\gamma(u)$ is a geodesic on $(a,b)$ with initial point $\mathbf{q}$ and initial vector $\mathbf{v}$ if and only if $\bar{\gamma}(t) := \gamma(kt)$ is a geodesic on $\left(\frac{a}{k},\frac{b}{k}\right)$ with initial point $\mathbf{q}$ and initial vector $\mathbf{v}$.

<details>
<summary>Proof</summary>

Since

$$
  \frac{a}{k} < t < \frac{b}{k} \iff a < kt < b
$$

the curve $\bar{\gamma}(t) := \gamma(kt)$ is defined on $\left(\frac{a}{k},\frac{b}{k}\right)$ if and only if $\gamma(t)$ is defined on $(a,b)$. By the chain rule

$$
  \bar{\gamma}'(t) = k\gamma'(kt)
$$

Equivalently,

$$
  \bar{\mathbf{T}}(t) = k\mathbf{T}(kt)
$$

so that

$$
  \frac{\mathrm{D}\bar{\mathbf{T}}}{\mathrm{d}t}(t) = k^2 \frac{\mathrm{D}\mathbf{T}}{\mathrm{d}t}(kt)
$$

Thus, $\bar{\gamma}$ is a geodesic if and only if $\gamma$ geodesic. They have the same initial point $\bar{\gamma}(0) = \gamma(0)$. Their initial vectors are related by

$$
  \bar{\gamma}'(0) = k\gamma'(0)
$$
</details>
</MathBox>

### Geodesics in the Poincaré half-plane

Recall that the Poincaré half-plane is covered by a single coordinate open set $(U,x,y)$. The system of geodesic equations for the geodesic $c(t) = (x(t), y(t))$ on the Poincaré half-plane is given by the two equations

$$
\begin{align*}
  \ddot{x} - \frac{2}{x}\dot{x}\dot{y} =& 0\\
  \ddot{y} + \frac{1}{y}\dot{x}^2 - \frac{1}{y}\dot{y}^2 =& 0
\end{align*}
$$

There is a third equation arising from the fact that a geodesic has constant speed $s\in[0,\infty)$

$$
  \langle\dot{c}(t),\dot{c}(t)\rangle = s^2
$$

This equations is a consequence of the first two, because any curve satisfying the geodesic equations will be a geodesic and hence will have constant speed. We include it because of its simplicity. In fact, be a simple reparametrization, we may even assume that the speed is $1$. Hence, we get

$$
  \frac{\dot{x}^2 + \dot{y}^2}{y^2} = 1
$$

or

$$
  \dot{x}^2 + \dot{y}^2 = y^2
$$

Assuming $\dot{x}$ is not identically zero, we can divide the first geodesic equation by $\dot{x}$ and solve it by separation of variables

$$
  \frac{\ddot{x}}{\dot{x}} = 2\frac{\dot{y}}{y}
$$

Integrating both sides with respect to $t$ gives

$$
  \ln(\dot{x}) = 2\ln(y) + d = \ln(y^2) + d
$$

where $d\in\R$ is an integration constant. Hence

$$
  \dot{x} = ky^2
$$

for some konstant $k\in\R$. Plugging this into the third equation and solving for $\dot{y}$ gives

$$
\begin{gather*}
  k^2 y^4 + \dot{y}^2 = y^2 \\
  \dot{y} = \pm y\sqrt{1 - k^2 y^2}
\end{gather*}
$$

Dividing $\dot{x}$ by $\dot{y}$, we get

$$
  \frac{\mathrm{d}x}{\mathrm{d}y} = \pm\frac{ky^2}{y\sqrt{1 - k^2 y^2}} = \pm\frac{ky}{\sqrt{1 - k^2 y^2}}
$$

Integrate with respect to $y$ to get

$$
  x = \mp \frac{1}{k}\sqrt{1 - k^2 y^2} + d
$$

This equation can be in the form

$$
  (x - d)^2 + y^2 = \frac{1}{k^2}
$$

which is the equation of a circle centered on the $x$-axis.

In our derivation so far, we assumed that the first derivative $\dot{x}$ is not identically zero. It to consider the case $\dot{x}\equiv 0$. In this case, $x$ is constant, so the curve is a vertical line. Thus, the geodesics in the Poincaré half-plane are either vertical lines or semicircles centered on the $x$-axis.

## Exponential maps

There are two exponential maps in geometry: the exponential map of a connection and the exponential map for a Lie group. While these are two independent notions, when a Lie group has a bi-invariant Riemannian metric, as all compact Lie groups do, the exponential map for the Lie group coincides with the exponential map of the Riemannian connection.

### The exponential map of a connection

Suppose $M$ is a smooth manifold with an affine connection. For any point $\mathbf{q}\in M$ and vector $\mathbf{v}\in T_\mathbf{q}M$, denote by $\gamma_\mathbf{v}(t,\mathbf{q})$ or simply $\gamma_\mathbf{v}(t)$ the unique maximal geodesics with initial point $\gamma_\mathbf{v}(0) = \mathbf{q}$ and initial vector $\gamma'_{\mathbf{v}} = \mathbf{v}$. If $\gamma_\mathbf{v}(1)$ is defined, we set

$$
  \exp_\mathbf{q}(\mathbf{v}) = \gamma_\mathbf{v}(1)
$$

Assume that $M$ is endowed with a Riemannian metric. For any point $\mathbf{p}\in M$, there exist a neigbourhood $U$ of $\mathbf{p}$ and a real number $\varepsilon > 0$ such that for all $\mathbf{q}\in U$ then exponential map $\exp_\mathbf{q}$ is defined on the open ball $B_\varepsilon (0)$ in $T_\mathbf{q}M$

$$
  \exp_\mathbf{q}:T_\mathbf{q}M \supset B_\varepsilon (0) \to M
$$

Let $s:M\to TM$ be the zero section of the tangent bundle $TM$, and let $s(U)$ image of $U\subset M$ under $s$. Viewed as a function of two variables $(\mathbf{q},\mathbf{v})$, the exponential map $\exp_\mathbf{q}(v)$ is defined on an $\varepsilon$-tube around $s(U)$ in $TM$.

<MathBox title='' boxType='proposition'>
On a manifold with a connection the maximal geodesic with initial point $\mathbf{q}$ and initial vector $\mathbf{v}$ is $\gamma_{\mathbf{v}} (t,\mathbf{q}) = \exp_{\mathbf{q}} (t\mathbf{v})$.

<details>
<summary>Proof</summary>

$$
\begin{align*}
  \exp_\mathbf{q} (t\mathbf{v}) =& \gamma_{t\mathbf{v}}(1) \\
  =& \gamma_\mathbf{v} (t)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Naturality of the exponential map' boxType='theorem'>
Let $f:N\to M$ be an isometry of Riemannian manifolds, and $\mathbf{p}\in N$. Suppose $V\subset T_\mathbf{p}N$ and $U\subset T_{f(\mathbf{p})} M$ are neighbourhoods of the origin on which the exponential maps $\exp_\mathbf{p}$ and $\exp_{f(\mathbf{p})}$ are defined. If the differential $f_{*,\mathbf{p}}$ maps $V$ into $U$, then the following diagram commutes.

$$
\begin{CD}
  V @>{f_{*,\mathbf{p}}}>> U \\
  @V{\exp_\mathbf{p}}VV @VV{\exp_{f(\mathbf{p})}}V \\
  N @>>{f}> M
\end{CD}
$$

<details>
<summary>Proof</summary>

For $\mathbf{v}\in V$, let $\gamma_\mathbf{v}(t,\mathbf{p})$ be the maximal geodesic in $N$ with initial point $\mathbf{p}\in V$ and initial vector $\mathbf{v}\in T_\mathbf{p}V$. Since an isometry takes geodesics to geodesics, $(f\circ\gamma_\mathbf{v})(t,\mathbf{p})$ is the maximal geodesics in $M$ with inital point $f(\mathbf{p})$ and initial vector $f_* \mathbf{v}$. By the uniqueness of the geodesic

$$
  (f\circ\gamma_\mathbf{v})(t,\mathbf{p}) = \gamma_{f_* \mathbf{v}}(t,f(\mathbf{p}))
$$

Setting $t = 1$ gives

$$
  f(\exp_\mathbf{p}(\mathbf{v})) = \exp_{f(\mathbf{p})}(f_* \mathbf{v})
$$
</details>
</MathBox>

### The differential of the exponential map

<MathBox title='' boxType='proposition'>
The differential $(\exp_\mathbf{p})_{*,\mathbf{0}}$ at the origin of the exponential map $\exp_\mathbf{p}:V\subset T_\mathbf{p}N\to N$ is the identity map $\mathbf{id}_{T_\mathbf{p}N}: T_\mathbf{p}N\to T_\mathbf{p}N$.

<details>
<summary>Proof</summary>

For $\mathbf{v}\in T_\mathbf{p}N$, a curve $c(t)$ in $T_\mathbf{p}N$ with $c(0) = 0$ and $c'(0) = \mathbf{v}$ is $c(t) = t\mathbf{v}$. Using this curve to compute the differential of $\exp_\mathbf{p}$, we have

$$
\begin{align*}
  (\exp_\mathbf{p})_{*,\mathbf{0}}(\mathbf{v}) =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} \exp_\mathbf{p}(c(t)) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} \exp_\mathbf{p}(t\mathbf{v}) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} \gamma_\mathbf{v}(t) \\
  =& \gamma'_\mathbf{v}(0) = \mathbf{v}
\end{align*}
$$

where $\gamma_\mathbf{v}(t)$ is the unique geodesic with initial point $\mathbf{p}$ and initial vector $\mathbf{v}$.
</details>
</MathBox>

By the inverse function theorem, the map $\exp_\mathbf{p}: V\subset T_\mathbf{p}N \to N$ is a local diffeomorphism at $\mathbf{0}\in T_\mathbf{p} N$. Thus, there are neighbourhoods $V'$ of $\mathbf{0}$ in $T_\mathbf{p}N$ and $V''$ of $\mathbf{p}$ in $N$ such that $\exp_\mathbf{p}:V' \to V''$ is a diffeomorphism.

Now suppose $f:N\to M$ is an isometry of Riemannian manifolds. As above, there are neighbourhoods $U'$ of $0$ in $T_{f(\mathbf{p})}$ and $U''$ of $f(\mathbf{p})$ in $M$ such that $\exp_{f(\mathbf{p})}:U' \to U''$ is a diffeomorphism. Since $f_{*,\mathbf{p}}$ is continuous, one may choose $V'$ sufficiently small so that $f_{*,\mathbf{p}}$ maps $V'$ to $U'$. By the naturality of the exponential map there is a commutative diagram

$$
\begin{CD}
  T_\mathbf{p}N \supset V' @>{f_{*,\mathbf{p}}}>> U' \subset T_{f(\mathbf{p})}M \\
  @V{\exp_\mathbf{p}}V{\cong}V @V{\cong}V{\exp_{f(\mathbf{p})}}V \\
  N \supset V'' @>>{f}> U'' \supset M
\end{CD}
$$

This diagram may be interpreted as follows: relative to the coordinate charts given by the inverse of the exponential map, an isometry of Riemannian manifolds is locally a linear map; more precisely, it is the linear map given by its differential. This is in contrast to the usual statement about the differential $f_{*,\mathbf{p}}$ at a point $\mathbf{p}$ being the best linear approximation to a $C^\infty$ map in a neighbourhood of the point. Here the isometry $f$ is equal to differential right on the nose.

### Normal coordinates

Fix a point $\mathbf{p}$ in a Riemannian manifold $M$. By the preceding section, there is a neigbourhood $V$ of $\mathbf{0}\in T_\mathbf{p}M$ and a neighbourhood $U$ of $\mathbf{p}\in M$ such that the exponential maps $\exp_\mathbf{p}:V\to U$ is a diffeomorphism. Using the exponential map we can transfer coordinates on $T_\mathbf{p}M$ to M. Choose an orthonormal basis $\Set{\mathbf{e}_i}_{i=1}^n$ for $T_\mathbf{p}M$ and let $(r^i)_{i=1}^n$ be the coordinated with respect to this basis. Then $(x^i := r^i \circ \exp_\mathbf{p}^{-1})_{i=1}^n$ is a coordinate system on $U$ such that the tangent vectors $\left(\frac{\partial}{\partial x^i}\right)_{i=1}^n$ are orthonormal at $\mathbf{p}$. The coordinate neighbourhood $(U,\Set{x^i}_{i=1}^n)$ is called *normal neighbourhood* of $\mathbf{p}$ and $(x^i)_{i=1}^n$ are called *normal coordinates* on $U$.

In a normal neighbourhood of $\mathbf{p}$, the geodesics through $\mathbf{p}$ have a particularly simple expression, for the coordinate expression for the geodesic $\gamma(t) = \exp_\mathbf{p}(\mathbf{a}t)$ for $\mathbf{a} = \sum_{i=1}^n a^i \mathbf{e}_i \in T_\mathbf{p}M$ is

$$
  x(\gamma(t)) = r\circ\exp_\mathbf{p}^{-1}(\gamma(t)) = \mathbf{a}t = (a^i t)_{i=1}^n
$$

Normal coordinates are especially useful for computation, because at $\mathbf{p}\in M$, all $\nabla_{\boldsymbol{\partial}_k} \frac{\partial}{\partial x^i} = 0$.

<MathBox title='' boxType='theorem'>
Let $M$ be a Riemannian manifold with metric $g$. In a normal neighbourhood $(U,\Set{\mathbf{x^i}}_{i=1}^n)$ of $\mathbf{p}\in M$, all the partial derivatives of $g_{ij}$ and all the Christoffel symbols $\Gamma_{ij}^k$ vanish at $\mathbf{p}$.

<details>
<summary>Proof</summary>

Let $(x^i)_{i=1}^n = (a^i t)_{i=1}^n$ be a geodesic through $\mathbf{p}\in M$. It satisfies the geodesic equations

$$
  \dot{x}^k + \sum_{i,j=1}^n \Gamma_{ij}^k \dot{x}^i \dot{x}^j = 0,\; k=1,\dots,n
$$

or 

$$
  \sum_{i,j=1}^n \Gamma_{ij}^k a^i a^j = 0
$$

Since this is true for all $(a^1,\dots,a^n)$ at $\mathbf{p}$, setting $\mathbf{a}$ with $a^i = a^j = 1$ and all other entries $0$, we get

$$
  \Gamma_{ij}^k + \Gamma_{ji}^k = 0
$$

By the symmetry of the connection, $\Gamma_{ij}^k = 0$ at $\mathbf{p}$ (at other points, not all of $\mathbf{x} = \mathbf{a}t$ will be geodesics). By the metric compatibility of the connection $\nabla$

$$
\begin{align*}
  \frac{\partial g_{ij}}{\partial x^k} =& \frac{\partial}{\partial x^k}\left\langle\frac{\partial}{\partial x^i},\frac{\partial}{\partial x^j}\right\rangle \\
  =& \left\langle \nabla_{\boldsymbol{\partial}_k} \frac{\partial}{\partial x^i},\frac{\partial}{\partial x^j}\right\rangle + \left\langle \frac{\partial}{\partial x^i}, \nabla_{\boldsymbol{\partial}_k} \frac{\partial}{\partial x^j} \right\rangle
\end{align*}
$$

At $\mathbf{p}$, $\nabla_{\boldsymbol{\partial}_k} \frac{\partial}{\partial x^i}$ and $\nabla_{\boldsymbol{\partial}_k} \frac{\partial}{\partial x^j} = 0$ since all the Christoffel symbols vanish. Thus, $\frac{\partial g_{ij}}{\partial x^k}(\mathbf{p}) = 0$.
</details>
</MathBox>

### Left-invariant vector fields on a Lie group

Let $G$ be a Lie group and $\mathfrak{g} = T_\mathbf{e} G$ its Lie algebra. Any element $\mathbf{X_e} \in\mathfrak{g}$ determines a left-invariant vector field $\mathbf{X}$ on $G$ by $\mathbf{X_g} := (\ell_\mathbf{g})_* (\mathbf{X_e})$. This establishes an injective correspondence betwee $T_\mathbf{e}G$ and the vector space if left-invariant vector fields on $G$. Sometimes we adopt an alternative notation for a left-invariant vector field on a Lie group: if $\mathbf{A}\in\mathfrak{g}$, then the left-invariant vector field on $G$ generated by $\mathbf{A}$ is $\tilde{A}$, with $\tilde{\mathbf{A}}_\mathbf{g} = \ell_{\mathbf{g}*}\mathbf{A}$.

<MathBox title='' boxType='proposition'>
If $\varphi_t (\mathbf{p})$ is an integral curve starting at $\mathbf{p}$ of a left-invariant vector field $\mathbf{X}$ on a Lie group $G$, then for any $\mathbf{g}\in G$, the left translate $\mathbf{g}\varphi_t (\mathbf{p})$ is the integral curve of $\mathbf{X}$ starting at $\mathbf{gp}$.

<details>
<summary>Proof</summary>

We compute the velocity of $\mathbf{g}\varphi_t (\mathbf{p})$

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d}t} (\mathbf{g}\varphi_t (\mathbf{p})) = (\ell_\mathbf{g})_* \frac{\mathrm{d}}{\mathrm{d}t}\varphi_t (\mathbf{p}) \\
  =& (\ell_\mathbf{g})_* \mathbf{X}_{\varphi_t (\mathbf{p})} \\
  =& \mathbf{X}_{\mathbf{g}\varphi(\mathbf{p})}
\end{align*}
$$

This proves that $\mathbf{g}\varphi_t(\mathbf{p})$ is also an integral curve of $\mathbf{X}$. At $t = 0$, we have $\mathbf{g}\varphi_t(\mathbf{p}) = \mathbf{g}\varphi_0(\mathbf{p}) = \mathbf{gp}$.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
The local flow $\varphi_t$ of a left-invariant vector field $\mathbf{X}$ on a Lie group $G$ commutes with left multiplication: $\ell_\mathbf{g}\circ\varphi_t = \varphi_t \circ \ell_\mathbf{g}$ for all $\mathbf{g}\in G$, whenever both sides are defined.

<details>
<summary>Proof</summary>

By the previous proposition, both $\mathbf{g}\varphi_t (\mathbf{p})$ are integral curves of $\mathbf{X}$ starting at $\mathbf{gp}$. By the uniqueness of the integral curve, $\mathbf{g}\varphi_t (\mathbf{p}) = \varphi_t(\mathbf{gp})$. This can be rewritten as $(\ell_\mathbf{g}\circ\varphi_t)(\mathbf{p}) = (\varphi_t \circ\ell_\mathbf{g})(\mathbf{p})$.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
The maximal integral curve $\varphi_t(\mathbf{p})$ of a left-invariant vector field $\mathbf{X}$ on a Lie group $G$, where $\mathbf{p}$ is a point of $G$, is defined for all $t\in\R$. It follows that $\mathbf{X}$ has a *global flow* $\varphi:\R\times G\to G$. 

<details>
<summary>Proof</summary>

By the existence theorem of ordinary differential equations, there are a real number $\varphi > 0$ and an integral curve $\varphi_t (\mathbf{e}): [-\varphi,\varphi]\to G$ of $\mathbf{X}$ through $\mathbf{e}$. By the previous proposition, $\mathbf{p}\varphi_t(\mathbf{e}) = \varphi_t(\mathbf{p})$ is an integral curve of $\mathbf{X}$ defined on $[-\varphi,\varphi]$ through any point $\mathbf{p}\in G$. Let $\mathbf{q}=\varphi_\varepsilon (\mathbf{p})$ be the endpoint of $\varphi_t (\mathbf{p})$ on $[-\varphi,\varphi]$. Then $\varphi_t (\mathbf{q})$ is an integral curve of $\mathbf{X}$ defined on $[-\varepsilon,\varepsilon]$. The two integral curves $\varphi_t (\mathbf{p})$ and $\varphi_t (\mathbf{q})$ agree on the their overlap and so the domain of $\varphi_t (\mathbf{p})$ can be extended to $[-\varepsilon,2\varepsilon]$. Thus, the domain of an integral curve of $\mathbf{X}$ through any point can always be extended an extra $\varepsilon$ unit. By induction, maximal integral curve of $\mathbf{X}$ through any point is defined for all $t\in\R$.
</details>
</MathBox>

### Exponential map for a Lie group

For a Lie group $G$ there is also a notion of an exponential map. Unlike the exponential map of a connection, which is a priori defined only on a small neighbourhood $\mathbf{0}$ in the tangent space $T_\mathbf{p}M$ of each point $\mathbf{p}$ in a smooth manifold with a connection, the exponential map for a Lie group is defined on the entire tangent space $T_\mathbf{e}G$, but only for the tangent space at the identity $\mathbf{e}$. When the Lie group has a bi-invariant Riemannian metric, the exponential map for the Lie group coincides with the exponential map of the Levi-Civita connection.

For $\mathbf{X_e} \in\mathfrak{g} := T_\mathbf{e}G$, denote by $\mathbf{X}$ the left-invariant vector field on $G$ generated by $\mathbf{X_e}$. In this sectuion we consider primarily integral curves starting at the the identity $\mathbf{e}$. For an integral curve $\varphi_t(\mathbf{e})$ through $\mathbf{e}$ of the left-invariant vector field $\mathbf{X}$ we write $c_\mathbf{X}(t) = \varphi_t (\mathbf{e})$ to show the dependence on $\mathbf{X}$.

If $s\in\R$, then

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d}t}c_\mathbf{X}(st) =& sc'_\mathbf{X}(st) \quad \text{chain rule} \\
  =& s\mathbf{X}_{c_\mathbf{X}(st)}
\end{align*}
$$

This shows that $c_\mathbf{X}(st)$ as a function of $t$ is an integral curve through $\mathbf{e}$ of the left-invariant vector field $\mathbf{X}$. Hence

$$
  c_\mathbf{X}(st) = c_{s\mathbf{X}}(t)
$$

<MathBox title='Exponential map for a Lie group' boxType='definition'>
The *exponential map* for a Lie group $G$ with Lie algebra $\mathfrak{g}$ is the map $\exp:\mathfrak{g}\to G$ defined by $\exp(\mathbf{X_e}) = c_\mathbf{X}(1)$ for $\mathbf{X_e}\in\mathfrak{g}$.
</MathBox>

<MathBox title='Properties of the exponential map for a Lie group' boxType='proposition'>
1. For $\mathbf{X_e}\in\mathfrak{g}$, the integral curve starting at $\mathbf{e}$ of the left-invariant vector field $\mathbf{X}$ is $\exp(t\mathbf{X_e}) = c_\mathbf{X}(t) = \varphi_t (\mathbf{e})$.
2. For $\mathbf{X_e}\in\mathfrak{g}$ and $g\in G$, the integral curve starting at $\mathbf{g}$ of the left-invariant vector field $\mathbf{X}$ is $\mathbf{g}\exp(t\mathbf{X_e})$.
3. For $s,t\in\R$ and $\mathbf{X_e}$, then $\exp((s+t)\mathbf{X_e}) = \exp(s\mathbf{X_e})\exp(t\mathbf{X_e})$.
4. The exponential map $\exp:\mathfrak{g}\to G$ is a smooth map.
5. The differential at $\mathbf{0}$ of the exponential map $\exp_{*,\mathbf{0}}:T_\mathbf{0}(\mathfrak) = \mathfrak{g}\to T_\mathbf{e}G = \mathfrak{g}$ is the identity map.
6. For the general linear group $\mathrm{GL}_n (\R)$
$$
  \exp(\mathbf{A}) = \sum_{k=0}^\infty \frac{\mathbf{A}^k}{k!}
$$

<details>
<summary>Proof</summary>

**(1):** By the definition of $\exp$ and since $c_\mathbf{X}(st) = c_{s\mathbf{X}}(t)$

$$
  \exp(t\mathbf{X_e}) = c_{t\mathbf{X}}(1) = c_\mathbf{X}(t) 
$$

**(2):** This follows from **(1)** and a previous proposition.
**(3):** View $s$ as a constant and differentiate with respect to $t$

$$
  \frac{\mathrm{d}}{\mathrm{d}t} c_\mathbf{X}(s + t) = c'_\mathbf{X}(s + t) = \mathbf{X}_{c_\mathbf{X}(s+t)}
$$

This shows that $c_\mathbf{X}(s + t)$ as a function of $t$ is an integral curve with initial point $c_\mathbf{X}(s)$ of the left-invariant vector field $\mathbf{X}$. With $s$ fixed, $c_\mathbf{X}(s) c_\mathbf{X}(t)$ is also an integral curve of $\mathbf{X}$ with initial point $c_\mathbf{X}(s)$. By the uniqueness of integral curves

$$
  c_\mathbf{X}(s + t) = c_\mathbf{X}(s) c_\mathbf{X}(t)
$$

Using **(1)** we can rewrite this equation as $\exp((s + t)\mathbf{X_e}) = \exp(s\mathbf{X_e})\exp(t\mathbf{X_e})$.

**(4):** The proof is based on the fact that the flow of a smooth vector field is smooth. Recall that for each $\mathbf{X_e} \in\mathfrak{g}$, $\mathbf{X}$ is the left-invariant vector field generated by $\mathbf{X_e}$. Define a vector field $\mathbf{V}$ on $G\times\mathfrak{g}$ by

$$
  \mathbf{V}_{(\mathbf{g},\mathbf{X_e})} = (\mathbf{X_g},0) = (\ell_{\mathbf{g}*}(\mathbf{X_e}),0)
$$

By **(2)**, the integral curve of $\mathbf{V}$ starting at $(\mathbf{g},\mathbf{X_e})$ is $c(t) = (\mathbf{g}\exp(t\mathbf{X_e},\mathbf{X_e})$. The global flow of $\mathbf{V}$ is

$$
\begin{align*}
  \varphi:\R\times(G\times\mathfrak{g})\to& G\times\mathfrak{g} \\
  \varphi(t,(\mathbf{g},\mathbf{X_e})) =& (\mathbf{g}\exp(t\mathbf{X_e}, \mathbf{X_e}))
\end{align*}
$$

Let $\pi:G\times\mathbf{g}\to G$ be the projection to the first factor. Then

$$
  \exp(\mathbf{X_e}) = (\pi\circ\varphi)(1,(\mathbf{e},\mathbf{X_e}))
$$

As a composite of smooth maps, $\exp:\mathfrak{g}\to G$ is smooth.

**(5):** For $\mathbf{X_e}\in\mathfrak{g}$, a smooth curve starting at $\mathbf{0}$ in $\mathfrak{g}$ with initial vector $\mathbf{X}_e$ is $c(t) = t\mathbf{X_e}$. Computing the differential $\exp_{*,\mathbf{0}}$ using this curve, we get by **(1)** that

$$
\begin{align*}
  \exp_{*,\mathbf{0}}(\mathbf{X_e}) =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} \exp(t\mathbf{X_e}) = \mathbf{X_e}
\end{align*}
$$

**(6):** We know that $c(t) = \sum_{k=0}^\infty \frac{\mathbf{A}^k t^k}{k!}$ is absolutely convergent for $\mathbf{A}\in\mathfrak{gl}_n (\R)$. Denote by $\tilde{\mathbf{A}}$ the left-invariant vector field on $\mathrm{GL}_n (\R)$ generated by $\mathbf{A}$. Then

$$
  \tilde{\mathbf{A}}_\mathbf{g} = (\ell_\mathbf{g})_* \mathbf{A} = \mathbf{gA}
$$

Now, $c(0) = \mathbf{I}$, the identity matrix, and

$$
\begin{align*}
  c'(t) =& \sum_{k=1}^\infty \frac{k\mathbf{A}^k t^{k-1}}{k!} \\
  =& \sum_{k=1}^\infty \frac{\mathbf{A}^{k-1} t^{k-1}}{(k-1)!}\mathbf{A} \\
  =& c(t)\mathbf{A} = \tilde{\mathbf{A}}_{c(t)}
\end{align*}
$$

Hence $c(t)$ is the integral curve of $\tilde{\mathbf{A}}$ through $\mathbf{I}$. By **(1)**

$$
  \exp(t\mathbf{A}) = c(t) = \sum_{k=0}^\infty \frac{\mathbf{A}^k t^k}{k!}
$$

Setting $t=1$ gives the desired identity.
</details>
</MathBox>

<MathBox title='One-parameter subgroup' boxType='definition'>
A $1$*-parameter subgroup* of a Lie group $G$ is a group homomorphism $\varphi:\R\to G$.
</MathBox>

In this terminolog, if $\mathbf{X}$ is a left-invariant vector field on a Lie group $G$, then its integral curve $c_\mathbf{X}(t) = \exp(t\mathbf{X_e})$ through the identity $\mathbf{e}$ is a $1$-parameter subgroup of $G$.

<MathBox title='' boxType='corollary'>
The diffeomorphism $\varphi_t :G\to G$ induced from the flow of a left-invariant vector field $\mathbf{X}$ on a Lie group $G$ is right multiplication by $\exp(t\mathbf{X_e})$

$$
  \varphi_t(\mathbf{g}) = r_{\exp(t\mathbf{X_e})}(\mathbf{g})
$$

<details>
<summary>Proof</summary>

Applying a previous corollary to $\mathbf{e}$, we get

$$
\begin{align*}
  \varphi_t (\mathbf{g}) =& \varphi_t (\mathbf{ge}) = \mathbf{g}\varphi_t (\mathbf{e}) \\
  =& r_{\varphi_t(\mathbf{e})}(\mathbf{g}) = r_{\exp{(t\mathbf{X_e})}}(\mathbf{g})
\end{align*}
$$
</details>
</MathBox>

### Naturality of the exponential map for a Lie group

Just as the exponential map for a Riemannian manifold is natural with respect to isometries, so the exponential map for a Lie group is natural with respect to Lie group homomorphisms.

<MathBox title='' boxType='lemma'>
If $f:H\to G$ is a group homomorphism, then for any $\mathbf{h}\in H$

$$
  f\circ \ell_\mathbf{h} = \ell_{f(\mathbf{h})}\circ f \tag{\label{equation-5}}
$$

<details>
<summary>Proof</summary>

For $\mathbf{x}\in H$,

$$
  (f\circ\ell_\mathbf{h})(\mathbf{x}) = f(\mathbf{hx}) = f(\mathbf{h})f(\mathbf{x}) = (\ell_{f(\mathbf{h})}\circ f)(\mathbf{x})
$$
</details>
</MathBox>

<MathBox title='' boxType='theorem'>
Let $H$ and $G$ be Lie groups with Lie algebras $\mathfrak{h}$ and $\mathfrak{g}$, respectively. If $f:H\to G$ is a Lie group homomorphism, then the following diagram commutes

$$
\begin{CD}
  \mathfrak{h} @>{f_*}>> \mathfrak{g} \\
  @V{\exp}VV @VV{\exp}V \\
  H @>>{f}> G
\end{CD}
$$

<details>
<summary>Proof</summary>

For $\mathbf{A}\in\mathfrak{h}$ denote by $\tilde{\mathbf{A}}$ the left-invariant vector field on the Lie group $H$ generated by $\mathbf{A}$. If $c(t)$ is an integral curve of $\tilde{\mathbf{A}}$ through $\mathbf{e}$, then

$$
  c'(t) = \tilde{\mathbf{A}}_{c(t)} = (\ell_{c(t)})_* \mathbf{A}
$$

We will now show that $(f\circ c)(t)$ is an integral curve of $\tilde{f_* \mathbf{A}}$, the left-invariant vector field on $G$ generated by $f_* \mathbf{A}\in\mathcal{g}$. Taking the differential of $\eqref{equation-5}$ we get

$$
  f_* \circ\ell_{\mathbf{h}*} = \ell_{f(\mathbf{h})*} \circ f_*
$$

Then

$$
\begin{align*}
  (f\circ c)'(t) =& f_* c'(t) \\
  =& f_* \ell_{c(t)*}\mathbf{A} \\
  =& \ell_{f(c(t))*} (f_* \mathbf{A}) \\
  =& \tilde{f_* \mathbf{A}}_{(f\circ c)(t)}
\end{align*}
$$

By the definition of the exponential map for a Lie group

$$
  \exp(f_* \mathbf{A}) = (f\circ c)(1) = f(c(1)) = f(\exp(\mathbf{A}))
$$
</details>
</MathBox>

### Adjoint representation

Let $G$ be a Lie group with Lie algebra $\mathfrak{g}$. For $\mathbf{g}\in G$, define $c_\mathbf{g}:G\to G$ to be *conjugation* by $\mathbf{g}$

$$
  c_\mathbf{g}(\mathbf{x}) = \mathbf{gxg}^{-1}
$$

The differential at the identity of $c_\mathbf{g}$ is denoted by

$$
  \operatorname{Ad}(\mathbf{g}) = (c_\mathbf{g})_{*,\mathbf{e}}:\mathfrak{g}\to\mathfrak{g}
$$

For $\mathbf{g},\mathbf{h}\in G$

$$
  c_\mathbf{gh} = c_\mathbf{g}\circ c_\mathbf{h}
$$

so that by the chain rule

$$
  (c_\mathbf{gh})_* = (c_\mathbf{g})_* \circ (c_\mathbf{h})_*
$$

or

$$
  \operatorname{Ad}(\mathbf{gh}) = \operatorname{Ad}(\mathbf{g})\circ\operatorname{Ad}(\mathbf{h})
$$

Thus, $\operatorname{Ad}:G\to\mathrm{GL}(\mathfrak{g})$ is a group homomorphism called the *adjoint representation* of the Lie group $G$.

<MathBox title='' boxType='proposition'>
Let $G$ be a Lie group. The adjoint representation $\mathrm{ad}:G\to\mathrm{GL}(\mathfrak{g})$ is a smooth map.

<details>
<summary>Proof</summary>

By the definition of a Lie group, the Lie group multiplication $\mu:G\times G\to G$ and inversion $\mathbf{g}\mapsto\mathbf{g}^{-1}$ are smooth maps. In terms of $\mu$

$$
  c_\mathbf{g}(\mathbf{x}) = \mu(\mathbf{g}, \mu(\mathbf{x},\mathbf{g}^{-1})),\; \mathbf{g},\mathbf{x}\in G
$$

which shows that as a function of $\mathbf{g}$ and $\mathbf{x}$ the $c_\mathbf{g}(\mathbf{x})$ is also smooth.

Let $(x^i)_{i=1}^n$ be a coordinate system in a neighbourhood of the identity $\mathbf{e}$. Then $\operatorname{Ad}(\mathbf{g}) = (c_\mathbf{g})_{*,\mathbf{e}}$ is represented by the Jacobian matrix $\left[\frac{\partial (x^i \circ c_\mathbf{g})}{\partial x^j}(\mathbf{e})\right]$. Since all the partial derivatives $\frac{\partial (x^i \circ c_\mathbf{g})}{\partial x^j}(\mathbf{e})$ are smooth in $\mathbf{g}$, it follows that $\operatorname{Ad}(\mathbf{g})$ is a smooth function of $\mathbf{g}$.
</details>
</MathBox>

The differential of $\operatorname{Ad}$ at the identity is a Lie algebra homomorphism

$$
  \operatorname{ad} := \operatorname{Ad}_{*,\mathbf{e}}:\mathfrak{g}\to\mathfrak{gl}(\mathfrak{g})
$$

called the *adjoint representation* if the Lie group algebra $\mathfrak{g}$. We usually write $\operatorname{ad}(\mathbf{A})(\mathbf{B})$ as $\operatorname{ad}_\mathbf{A}(\mathbf{B})$.

<MathBox title='' boxType='proposition'>
For $\mathbf{A},\mathbf{B}\in\mathfrak{g}$

$$
  \operatorname{ad}_\mathbf{A} (\mathbf{B}) = [\mathbf{A}, \mathbf{B}]
$$

<details>
<summary>Proof</summary>

For $\mathbf{A}\in\mathfrak{g}$, let $\tilde{\mathbf{A}}$ be the left-invariant vector field generated by $\mathbf{A}$. By property **(1)** for exponential maps, the integral curve through $\mathbf{e}$ of $\tilde{\mathbf{A}}$ is $\varphi_t (\mathbf{e}) = \exp(t\mathbf{A})$ and by the previous corollary, the diffeomorphism $\varphi_t:G\to G$ induced from the flow of $\tilde{\mathbf{A}}$ is right multiplication by $\exp(t\mathbf{A})$. For $\mathbf{A},\mathbf{B}\in\mathfrak{g}$

$$
\begin{align*}
  \operatorname{ad}_\mathbf{A}(\mathbf{B}) =& \operatorname{Ad}_{*,\mathbf{e}}(\mathbf{A})(\mathbf{B}) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\left|_{t=0} \operatorname{Ad}(\exp(t\mathbf{A}))(\mathbf{B}) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\left|_{t=0} (c_{\exp(t\mathbf{A})})_* (\mathbf{B}) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\left|_{t=0} (r_{\exp(-t\mathbf{A})})_* (\ell_{\exp(t\mathbf{A})})_* \mathbf{B} \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\left|_{t=0} (r_{\exp(-t\mathbf{A})})_* \tilde{\mathbf{B}}_{\exp(t\mathbf{A})} \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\left|_{t=0} (\varphi_{-t})_* (\tilde{B}_{\exp(t\mathbf{A})}) \\
  =& (\mathcal{L}_{tilde{\mathbf{A}}} \tilde{\mathbf{B}})_\mathbf{e} \\
  =& [\tilde{\mathbf{A}},\tilde{\mathbf{B}}]_\mathbf{e} \\
  =& [\mathbf{A},\mathbf{B}]
\end{align*}
$$
</details>
</MathBox>

### Associativity of a bi-invariant metric on a Lie group

A Riemannian metric $\langle\cdot,\cdot\rangle:G\times G \to\R$ on a Lie group $G$ is *left-invariant* if for all smooth vector fields $\mathbf{X}, \mathbf{Y}$ on $G$ and $\mathbf{g}\in G$

$$
  \langle \ell_{\mathbf{g}*} \mathbf{X},\ell_{\mathbf{g}*} \mathbf{Y} \rangle = \langle\mathbf{X},\mathbf{Y}\rangle
$$

A *rigth-invariant metric* is defined similarly with $r_\mathbf{g}$ in place of $\ell_\mathbf{g}$. A metric that is both left- and right-invariant is *bi-invariant*.

<MathBox title='' boxType='proposition'>
If $\langle\cdot,\cdot\rangle:G\times G \to\R$ is a bi-invariant metric on a Lie group $G$, then for all left-invariant vector fields $\mathbf{X},\mathbf{Y},\mathbf{Z}$ on $G$

$$
  \langle [\mathbf{X},\mathbf{Y}],\mathbf{Z}\rangle = \langle\mathbf{X},[\mathbf{Y},\mathbf{Z}]\rangle
$$

<details>
<summary>Proof</summary>

Since $\langle\cdot,\cdot\rangle$ is bi-invariant, for any $\mathbf{g}\in G$ and $\mathbf{X_e}, \mathbf{Z_e}\in\mathfrak{g}$

$$
\begin{align*}
  \langle\mathbf{X_e},\mathbf{Z_e} =& \langle\ell_{\mathbf{g}*}r_{\mathbf{g}^{-1}*} \mathbf{X_e}, \ell_{\mathbf{g}*} r_{\mathbf{g}^{-1}*} \mathbf{Z_e} \rangle \\
  =& \langle \operatorname{Ad}(\mathbf{g})\mathbf{X_e},\operatorname{Ad}(\mathbf{g})\mathbf{Z_e} \rangle
\end{align*}
$$

If $c(t)$ is the integral curve through $\mathbf{e}$ of the left-invariant vector field $\mathbf{Y}$, then

$$
  \langle\mathbf{X_e},\mathbf{Z_e}\rangle = \langle\operatorname{Ad}(c(t))\mathbf{X_e}, \operatorname{Ad}(c(t))\mathbf{Z_e}\rangle,\; \forall t
$$

Diefferentiating with respect to $t$ and evaluating at $t = 0$ gives

$$
\begin{align*}
  0 =& \left.\frac{\mathrm{d}}{\mathrm{d}}\right|_{t=0} \langle\operatorname{Ad}(c(t))\mathbf{X_e}, \operatorname{Ad}(c(t))\mathbf{Z_e} \rangle \\
  =& \langle \operatorname{Ad}_* (c'(0))\mathbf{X}_\mathbf{e}, \operatorname{Ad}(c(0))\mathbf{Z_e} \rangle \\
  &+ \langle \operatorname{Ad(c(0))\mathbf{X_e},\operatorname{Ad}_* (c'(0))\mathbf{Z_e}}\rangle \\
  =& \langle\operatorname{ad}_\mathbf{Y_e} \mathbf{X_e},\mathbf{Z_e} \rangle + \langle\mathbf{X_e}, \operatorname{ad}_{\mathbf{Y_e}\mathbf{Z_e}}\rangle \\
  =& \langle[\mathbf{Y_e},\mathbf{Y_e}],\mathbf{Z_e}\rangle + \langle\mathbf{X}_e, [\mathbf{Y_e},\mathbf{Z_e}]\rangle
\end{align*}
$$

Since $\langle\cdot,\cdot\rangle$ is left-invariant and $\ell_{\mathbf{g},*}[\mathbf{X_e},\mathbf{Y_e}] = [\ell_{\mathbf{g},*}(\mathbf{X_e}),\ell_{\mathbf{g},*}(\mathbf{Y_e})] = [\mathbf{X_g},\mathbf{Y_g}]$ for all $\mathbf{g}\in G$, left-translating the equation above by $\mathbf{g}$ gives the proposition.
</details>
</MathBox>

## Distance and volume

### Distance in a Riemannian manifold

<MathBox title='' boxType='proposition'>
The arc length of a curve $c:[a,b]\to M$ in a Riemannian manifold $M$ is independent of its parametrization.

<details>
<summary>Proof</summary>

Suppose $c(t(u))$ with $a_1 \leq u \leq b_1$ is an orientation-preserving reparametrization. Then $\frac{\mathrm{d}}{\mathrm{d}t} > 0$. By the chain rule,

$$
  \frac{\mathrm{d}}{\mathrm{d}u} c(t(u)) = c'(t(u))\frac{\mathrm{d}t}{\mathrm{d}u}
$$

It follows that

$$
\begin{align*}
  \int_{a_1}^{b_1} \lVert \frac{\mathrm{d}}{\mathrm{d}u} c(t(u))\rVert\;\mathrm{d}u =& \int_{a_1}^{b_1} \lVert c'(t(u)) \rVert \left|\frac{\mathrm{d}t}{\mathrm{d}u}\right| \mathrm{d}u \\
  =& -\int_{a_1}^{b_1} \lVert c'(t(u))\rVert \frac{\mathrm{d}t}{\mathrm{d}u}\mathrm{d}u \\
  =& \int_{b_1}^{a_1} \lVert c'(t(u)) \rVert \frac{\mathbf{d}t}{\mathrm{d}u}\mathrm{d}u \\
  =& \int_a^b \lVert c'(t) \rVert \mathrm{d}t
\end{align*}
$$

So the arc length is still independent of the parametrization.
</details>
</MathBox>

Given two points $\mathbf{p}$ and $\mathbf{q}$ on a connected Riemannian manifold, we define the *distance* between them to be

$$
  d(\mathbf{p},\mathbf{q}) = \inf_{c}(\ell(c))
$$

where the infimum is taken over all piecewise smooth curves $c$ from $\mathbf{p}$ to $\mathbf{q}$ and $\ell(c)$ is the length of the curve $c$.

For the distance $d(\mathbf{p},\mathbf{q})$ to be defined, there must be a curve joining $\mathbf{p}$ and $\mathbf{q}$. Hence, in order to have a distance functino, the Riemannian manifold should be path-connected. By a theorem from general topology, a locally path-connected space is path-connected if and only if it is connected. Being locally Euclidean, a manifold is locally path-connected. Thus, for a manifold, path-connectedness is equivalent to connectedness.

It is easily verified that the distance function on a Riemannian manifold satisfies the three defining properties of a metric function on a metric space: for all $\mathbf{p},\mathbf{q},\mathbf{r}\in M$

1. **Positive definiteness:** $d(\mathbf{p},\mathbf{q}) \geq 0$ and equality holds if and only if $\mathbf{p} = \mathbf{q}$
2. **Symmetry:** $d(\mathbf{p},\mathbf{q}) = d(\mathbf{q},\mathbf{p})$
3. **Triangle inequality:** $d(\mathbf{q},\mathbf{r}) \leq d(\mathbf{p},\mathbf{q}) + d(\mathbf{q},\mathbf{r})$

Thus, with the distance as a metric, the Riamannian manifold $M$ becomes a metric space.

### Geodesic completeness

In differential topology, a curce $c:(a,b)\to M$ in a smooth manifold $M$ can be reparametrized so that its domain is $\R$, because the interval $(a,b)$ is diffeomorphic to $\R$. Suppose $M$ is a Riemannian manifold and $c$ is a geodesic. Then any parametrization of the geodesic which keeps it a geodesic must have the form $t = \alpha u + \beta$ for $\alpha,\beta\in\R$. Such a linear change of variables maps a finite interval to another finite interval. Thus, whether or not a geodesic has the entire real line $\R$ as its domain is independent of the parametrization.

<MathBox title='Geodesical completeness' boxType='definition'>
A Riemannian manifold is *geodesically complete* if the domain of every geodesic in it can be extended to $\R$.
</MathBox>

<MathBox title='Minimal geodesic' boxType='definition'>
A geodesic defined on $[a,b]$ is *minimal* if its length is minimal among all piecewise smoth curves joining its two endpoints.
</MathBox>

<MathBox title='Hopf-Rinow theorem' boxType='theorem'>
A Riemannian manifold is geodesically complete if and only if it is complete as a metric space in the distance metric. Moreover, in a geodesically complete Riemannian manifold, any two  points may be joined by a minimal geodesic.
</MathBox>

### Dual $1$-forms under a change of frame

<MathBox title='' boxType='proposition'>
Let $\mathbf{E} = [\mathbf{e}_i]_{i=1}^n$ and $\bar{\mathbf{E}} = [\bar{\mathbf{e}}_i]_{i=1}^n$ be two frames on an open set $U$. If $\bar{\mathbf{E}} = \mathbf{E}\mathbf{A}$ for $\mathbf{A}:U\to\mathrm{GL}_n(\R)$, then the dual frames $\bar{\mathbf{E}}^*$ and $\mathbf{E}^*$ are related by

$$
  \bar{\mathbf{E}}^* = \mathbf{A}^{-1}\mathbf{E}
$$

This means that if $\bar{\varepsilon} = \sum_{j=1}^n b_j^i \theta^j$, then $\mathbf{B} = [b_j^i] = \mathbf{A}^{-1}$.

<details>
<summary>Proof</summary>

Since

$$
  (\mathbf{A}^{-1} \mathbf{E}^*)\bar{\mathbf{E}} = \mathbf{A}^{-1} \mathbf{E}^* \mathbf{EA} = \mathbf{A}^{-1}\mathbf{IA} = \mathbf{I}
$$

we have $\bar{\mathbf{E}}^* = \mathbf{A}^{-1}\mathbf{E}^*$
</details>
</MathBox>

<MathBox title='Wedge product under a change of frame' boxType='proposition'>
Let $V$ be a vector space of dimension $n$ and $\Set{\varepsilon^i}_{i=1}^n$ a basis for the dual space $V^*$. If the $1$-covectors $\Set{\bar{\varepsilon}^i}_{i=1}^n$ and $\Set{\bar{\varepsilon}^i}_{i=1}^n$ are related by $\bar{\varepsilon}^i = \sum_{j=1}^n b_j^i \theta^j$, then with $\mathbf{B} = [b_j^i]$,

$$
  \bigwedge_{i=1}^n \bar{\varepsilon}^i = \det(\mathbf{B})\bigwedge_{i=1}^n \varepsilon^i
$$
</MathBox>

### Volume form

On an oriented smooth manifold of dimension $n$ there are many nowhere-vanishing $n$-forms. If $\omega$ is a nowhere-vanishing $n$-form, so is any nonzero multiple of $\omega$. In general, it is not possible to single out one of them as the volume form. If the oriented manifold is Riemannian, however, we will show that there is a canonically defined volume form.

Let $(U, \Set{x^i}_{i=1}^n)$ be an arbitrary chart on an oriented Riemannian manifold $M$. Applying the Gram-Schmidt process to the coordinate frame $\Set{\frac{\partial}{\partial x^i}}_{i=1}^n$, we can construct an orthonormal frame $\Set{\mathbf{e}_i}_{i=1}^n$ on $U$. Let $\Set{\varepsilon^i}_{i=1}^n$ be the dual frame of $1$-forms and define

$$
  \omega = \bigwedge_{i=1}^n \varepsilon^i
$$

Then $\omega$ is a nowhere-vanishing $n$-form on $U$. To see how $\omega$ depends on the choice of an orthonormal frame, let $\Set{\bar{\mathbf{e}}_i}_{i=1}^n$ be another orthonormal frame on $U$. Then there are smooth functions $a_j^i : U\to\R$ such that

$$
  \bar{\mathbf{e}}_j = \sum_{i=1}^n a_j^i \mathbf{e}_i
$$

Since both $\Set{\mathbf{e}_i}_{i=1}^n$ and $\Set{\bar{\mathbf{e}}_i}_{i=1}^n$ are orthonormal, the change of basis matrix $\mathbf{A} = [a_j^i]$ is a function from $U$ to the orthonormal group $O(n)$. Let $\Set{\bar{\varepsilon}^i}_{i=1}^n$ be the dual frame of $\Set{\bar{\mathbf{e}}_i}_{i=1}^n$. From the previous proposition, $\bar{\varepsilon}^i = \sum_{j=1}^n (\mathbf{A}^{-1})_j^i \varepsilon^j$. It then follows that

$$
  \bigwedge_{i=1}^n \bar{\varepsilon}^i = \det(\mathbf{A}^{-1}) \bigwedge_{i=1}^n \varepsilon^i
$$

This proves that $\omega = \bigwedge_{i=1}^n \varepsilon^i$ is independent of the choice of the positively oriented orthonormal frame. It is a canonically defined $n$-form on an oriented Riemannian manifold $M$. We call $\omega$ the *volume form* of $M$. In case the integral $\int_M omega$ is finite, we call $\int_M \omega$ the *volume* of the oriented Riemannian manifold $M$.

<MathBox title='' boxType='theorem'>
Let $\mathrm{vol}_M$ and $\mathrm{vol}_{\partial M}$ be the volume forms on an oriented Riemannian manifold $M$ and on its boundary $\partial M$. Assume that the boundary is given the boundary orientation. If $\mathbf{X}$ is the outward unit normal along $\partial M$, then $\mathrm{vol}_{\partial M} = \iota_\mathbf{X}(\mathrm{vol}_M)$, where $\iota_\mathbf{X}$ is the interior multiplication with $X$.

<details>
<summary>Proof</summary>

Let $p\in\partial M$. If $(\mathbf{X},\Set{\mathbf{e}_i}_{i=2}^n)$ is a positively oriented orthonormal frame field fro $M$ in a neigbourhood $U$ of $p$, then by the definition of the boundary orientation $\Set{\mathbf{e}_i}_{i=2}^n$ is a positively oriented orthonormal frame for $\partial M$ in $U\cap\partial M$. Let $\Set{\varepsilon^i}_{i=1}^n$ be the dual frame to $(\mathbf{X},\Set{\mathbf{e}_i}_{i=2}^n)$. Clearly, $\Set{\varepsilon^i}_{i=2}^n$ is dual to $\Set{\mathbf{e}_i}_{i=2}^n$ on $U\cap\partial M$. So

$$
\begin{align*}
  \mathrm{vol}_M =& \bigwedge_{i=1}^n \varepsilon^i \\
  \mathrm{vol}_{\partial M} =& \bigwedge_{i=2}^n \varepsilon^i
\end{align*}
$$

At a point of $\partial M$ we get

$$
\begin{align*}
  \iota_\mathbf{X} (\mathrm{vol}_M) =& \iota_\mathbf{X}\left(\bigwedge_{i=1}^n \varepsilon^i \right) \\
  =& \sum_{j=1}^n (-1)^{j-1} \varepsilon^j (\mathbf{X}) \varepsilon^i \wedge\cdots\wedge\hat{\varepsilon^j}\wedge\cdots\wedge\varepsilon^n \\
  =& \varepsilon^1 (\mathbf{X}) \bigwedge_{i=2}^n \varepsilon^i \\
  =& \bigwedge_{i=2}^n varepsilon^i = \mathrm{vol}_{\partial M}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Volume form on a circle' boxType='example'>
The volume form on the unit disk

$$
  D = \Set{(x,y)\in\R^2 | x^2 + y^2 \leq 1}
$$

is $\mathrm{d}x\wedge\mathrm{d}y$. The unit outward normal $\mathbf{X}$ along its boundary $\partial D = \mathbb{S}^1$ is

$$
  \mathbf{X} = x\frac{\partial}{\partial x} + y\frac{\partial}{\partial y}
$$

The volume form on the unit circle oriented counterclockwise is

$$
\begin{align*}
  \omega_{\mathbb{S}^1} =& \iota_\mathbf{X}(\mathrm{d}x\wedge\mathrm{d}y) \\
  =& (\iota \mathrm{d}x) \mathrm{d}y - \mathrm{d}x (\iota_\mathbf{X} \mathrm{d}y) \\
  =& (\mathbf{X}x) \mathrm{d}y - \mathrm{d}x (\mathbf{X}y) = x\mathrm{d}y - y\mathrm{d}x
\end{align*}
$$
</MathBox>

### Volume form in local coordinates

<MathBox title='' boxType='theorem'>
Let $(U,\Set{x^i}_{i=1}^n)$ be a coordinate chart on a Riemannian manifold $M$, and let $g_{ij} = \left\langle\frac{\partial}{\partial x^i}, \frac{\partial}{\partial x^j} \right\rangle$. Then the volume form of $M$ on $U$ is given by

$$
  \mathrm{vol}_M = \sqrt{\det(g)} \bigwedge_{i=1}^n \mathrm{d}x^i
$$

where $g$ is the matrix $[g_{ij}]$.

<details>
<summary>Proof</summary>

Let $\Set{\mathbf{e}_i}_{i=1}^n$ be an orthonormal frame on $U$, with the dual frame of $1$-forms $\Set{\varepsilon^i}_{i=1}^n$. Then $\frac{\partial}{\partial x^j} = \sum_{i=1}^n a_j^i \mathbf{e}_i$ for some matrix valued function $\mathbf{A} = [a_j^i]_U\to\operatorname{GL}_n(\R)$. The dual frame to $\Set{\frac{\partial}{\partial x^j}}$ is $\Set{\mathrm{d}x^i}_{i=1}^n$. By previous proposition $\mathrm{d}x^i = \sum_{j=1}^n b_j^i \varepsilon^j$ with $\mathbf{B} = [b_j^i] = \mathbf{A}^{-1}$. By previous proposition

$$
  \bigwedge_{i=1}^n \mathrm{d}x^i = \det(\mathbf{B})\bigwedge_{i=1}^n \varepsilon^i
$$

Hence

$$
\begin{align*}
  \mathrm{vol}_M =& \bigwedge_{i=1}^n = \det(\mathbf{B})^{-1} \bigwedge_{i=1}^n \mathrm{d}x^i \\
  =& \det(\mathbf{A}) \bigwedge_{i=1}^n \mathrm{d}x^i
\end{align*}
$$

To find $\det(\mathbf{A})$, note that

$$
\begin{align*}
  g_{ij} =& \left\langle\frac{\partial}{\partial x^i},\frac{\partial}{\partial x^j}\right\rangle = \left\langle \sum_{k=1}^n a_i^k \mathbf{e}_k, \sum_{\ell=1}^n a_j^\ell \mathbf{e}_\ell \right\rangle \\
  =& \sum_{k,\ell=1}^n a_i^k a_j^\ell \langle\mathbf{e}_k,\mathbf{e}_\ell\rangle \\
  =& \sum_{k,\ell=1}^n a_i^k a_j^\ell \delta_{k\ell} = \sum_{k=1}^n a_i^k a_j^k = (\mathbf{A}^\top \mathbf{A})_j^i
\end{align*}
$$

Thus

$$
  g = [g_{ij}] = \mathbf{A}^\top \mathbf{A}
$$

so that

$$
  \det(g) = \det(\mathbf{A}^\top \mathbf{A}) = \det(\mathbf{A})^2
$$

It follows that $\det(\mathbf{A}) = \sqrt{\det(g)}$ and

$$
  \mathrm{vol}_M = \det(A) \bigwedge_{i=1}^n \mathrm{d}x^i = \sqrt{\det(g)}\bigwedge_{i=1}^n \mathrm{d}x^i
$$
</details>
</MathBox>

## Gauss-Bonnet theorem

### Geodesic curvature

<MathBox title='Geodesic curvature' boxType='definition'>
Let $\gamma:[a,b]\to M$ be a unit-speed curve in a Riemannian manifold $M$ with metric $g$. If $T(s) = \gamma'(s)$, the *geodesic curvature* of $\gamma$ is defined as

$$
  \tilde{\kappa}_g = \left\lVert\frac{\mathrm{D}T}{\mathrm{d}s}\right\rVert
$$

It follows directly from the definition that a unit-speed curve is a geodesic if and only if its geodesic curvature is zero. The integral $\int_a^b \kappa_g \;\mathrm{d}s$ is called the *total geodesic curvature* of $\gamma$.
</MathBox>

### The angle function along a curve

At a point $\mathbf{p}$ of an oriented Riemannian manifold $M$, the angle $\theta$ between two vectors $\mathbf{u}$ and $\mathbf{v}$ in the tangent space $T_\mathbf{p}M$ is given by the formula

$$
  \cos\theta = \frac{\langle\mathbf{u},\mathbf{v}\rangle}{\lVert\mathbf{u}\rVert\cdot\lVert\mathbf{v}\rVert}
$$

In general, the angle $\theta$ is defined only up to an integer multiple of $2\pi$

Suppose that $(U,\Set{\mathbf{e}_1,\mathbf{e}_2})$ is a framed open set on which there is a positively oriented orthonormal frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$. If $c:[a,b]\to U$ is a smooth curve, let $\underline{\theta}(t)$ be the angle from $\mathbf{e}_{1,c(t)}$ to $c'(t)$ in $T_{c(t)}M$, i.e. a function from $[a,b]$ to $\R\setminus 2\pi\Z$. It is a smooth function, since it is locally a branch of

$$
  \cos^{-1}\left(\frac{\langle c'(t),\mathbf{e}_{1,c(t)} \rangle}{\lVert c'(t)\rVert}\right)
$$

Let $\theta_0$ be a real number such that

$$
  \cos\theta_0 = \frac{\langle c'(a),\mathbf{e}_{1,c(a)} \rangle}{\lVert c'(a)\rVert}
$$

Since $\R$ is a covering space of $\R\setminus 2\pi\Z$ and the interval $[a,b]$ is simply connected, we know from the theory of covering spaces that there is a unique smooth map $\theta:[a,b]\to\R$ with a specified initial values $\theta(a) = \theta_0$ covering $\underline{\theta}$.

We call $\theta:[a,b]\to\R$ the *angle function* with initial value $\theta_0$ along the curve $c$ relative to the frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$. Since an angle funcion along a curve is uniquely determined by its initial value, any two angle functions along the curve $c$ is relative to $\Set{\mathbf{e}_1,\mathbf{e}_2}$ differ by a constant integer multiple of $2\pi$.

### Signed geodesic curvature on an oriented surface

<MathBox title='Signed geodesic curvature' boxType='definition'>
Let $\gamma:[a,b]\to M$ be a unit-speed curve on an oriented Riemannian $2$-manifold $M$. If $T(s) = \gamma'(s)$, let $\mathbf{n}$ be a unit vector field so that $\Set{T,\mathbf{n}}$ is positively oriented and orthonormal. The *signed geodesic curvature* at a point $\gamma(s)$ is the number $\kappa_g (s)$ such that

$$
  \frac{\mathrm{D}T}{\mathrm{d}s} = \kappa_g \mathbf{n}
$$

The signed geodesic curvature $\kappa_g$ can also be computed as

$$
  \kappa_g = \left\langle\frac{\mathrm{D}T}{\mathrm{d}s},\mathbf{n}\right\rangle
$$

<details>
<summary>Details</summary>

Since $\langle T, T\rangle \equiv 1$ on $\gamma$

$$
  \frac{\mathrm{d}}{s}\langle T,T\rangle = 0
$$

and

$$
  2\left\langle\frac{\mathrm{D}T}{\mathrm{d}s},T\right\rangle = 0
$$

Since the tangent space of $M$ at $\gamma$ is $2$-dimensional and $\frac{\mathrm{D}T}{\mathrm{d}s}$ is perpendicular ot $T$, it follows that $\frac{\mathrm{D}T}{\mathrm{d}s}$ must be a scalar multiple of $\mathbf{n}$.
</details>
</MathBox>

Let $U$ be an open subset of an oriented Riemannian $2$-manifold $M$ with an orthonormal frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$ that is positively oriented. Suppose $\gamma:[a,b]\to U$ is a unit-speed curve and $\theta:[a,b]\to\R$ is the angle function along the curve $\gamma$ relative to $\Set{\mathbf{e}_1,\mathbf{e}_2}$. Thus, $\theta$ is the angle that the velocity vector $T(s)$ makes relative to $\mathbf{e}_1$ at $\gamma(s)$. In terms of the angle $\theta$

$$
\begin{align*}
  T =& \cos(\theta)\mathbf{e}_1 + \sin(\theta)\mathbf{e}_2 \\
  \mathbf{n} -\sin(\theta)\mathbf{e}_1 + \cos(\theta)\mathbf{e}_2
\end{align*}
$$

where $\mathbf{e}_1$ and $\mathbf{e}_2$ are evaluated at $c(t)$.

<MathBox title='' boxType='proposition'>
Let $U$ be an open subset of an oriented Riemannian $2$-manifold $M$ with an orthonormal frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$ that is positively oriented. Suppose $\gamma:[a,b]\to U$ is a unit-speed curve and $\theta:[a,b]\to\R$ is the angle function along the curve $\gamma$ relative to $\Set{\mathbf{e}_1,\mathbf{e}_2}$. If $\omega_2^1$ is the connection form of an affine connection M$, the signed geodesic curvature of $\gamma$ is given by

$$
  \kappa_g = \frac{\mathrm{d}\theta}{\mathrm{d}s} - \omega_2^1 (T)
$$

<details>
<summary>Proof</summary>

Recall that

$$
\begin{align*}
  T =& \cos(\theta)\mathbf{e}_1 + \sin(\theta)\mathbf{e}_2 \\
  \mathbf{n} -\sin(\theta)\mathbf{e}_1 + \cos(\theta)\mathbf{e}_2
\end{align*}
$$

Taking the covariant derivative of $T$ gives

$$
\begin{align*}
  \frac{\mathrm{D}T}{\mathrm{d}s} =& \left(\frac{\mathrm{d}}{\mathrm{d}s}\cos\theta\right)\mathbf{e}_{1,c(t)} + \cos(\theta)\frac{\mathrm{D}\mathbf{e}_{1,c(t)}}{\mathrm{d}s} \\
  &+ \left(\frac{\mathrm{d}}{\mathrm{d}s} \sin\theta \right)\mathbf{e}_{2,c(t)} + \sin(\theta)\frac{\mathrm{D}\mathbf{e}_{2,c(t)}}{\mathrm{d}s}
\end{align*}
$$

It follows from previous theorems that

$$
\begin{align*}
  \frac{\mathrm{D}\mathbf{e}_{1,c(t)}}{\mathrm{d}s} = \nabla_T \mathbf{e}_{1,c(t)} = \omega_1^2 (T)\mathbf{e}_{2,c(t)} = -\omega_2^1 (T)\mathbf{e}_{2,c(t)} \\
  \frac{\mathrm{D}\mathbf{e}_{2,c(t)}}{\mathrm{d}s} = \nabla_T \mathbf{e}_{2,c(t)} = \omega_2^1 (T)\mathbf{e}_{1,c(t)}
\end{align*}
$$

Hence

$$
\begin{align*}
  \frac{\mathrm{D}T}{\mathrm{d}s} =& -\sin(\theta)\frac{\mathrm{d}\theta}{\mathrm{d}s}\mathbf{e}_{1,c(t)} - \cos(\theta)\omega_2^1 (T)\mathbf{e}_{2,c(t)} \\
  &+ \cos(\theta)\frac{\mathrm{d}\theta}{\mathrm{d}s}\mathbf{e}_{2,c(t)} + \sin(\theta)\omega_2^1 (T)\mathbf{e}_{1,c(t)} \\
  =& \left(\frac{\mathrm{d}\theta}{\mathrm{d}s} - \omega_2^1 (T) \right)\mathbf{n}
\end{align*}
$$

So

$$
  \kappa_g = \frac{\mathrm{d}\theta}{\mathrm{d}s} - \omega_2^1 (T)
$$
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Let $M$ be an oriented Riemannian $2$-manifold. Assume that the image of the unit-speed curve $\gamma:[a,b]\to M$ is a $1$-dimensional submanifold $C$ with boundary. If $C$ lies in an open set $U$ with positively oriented frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$ and connection form $\omega_2^1$, then its total geodesic curve is

$$
  \int_a^b \kappa_g \;\mathrm{d}s = \theta(a) - \theta(b) - \int_C \omega_2^1
$$

where $\theta:[a,b]\to\R$ is the angle function.

<details>
<summary>Proof</summary>

Note that $\gamma^{-1}:C\to[a,b]$ is a coordinate map on $C$, so that

$$
  \int_C \omega_2^1 = \int_a^b \gamma^* \omega_2^1
$$

Let $s$ be the coordinate on $[a,b]$. Then

$$
  \gamma^* \omega_2^1 = f(s)\;\mathrm{d}s
$$

for some smooth function $f(s)$. Applying $\frac{\mathrm{d}}{\mathrm{d}s}$ to the above gives

$$
\begin{align*}
  f(s) =& (\gamma* \omega_2^1)\left(\frac{\mathrm{d}}{\mathrm{d}s}\right) = \omega_1^2 (\gamma*\frac{\mathrm{d}}{\mathrm{d}}s) \\
  =& \omega_2^1 (\gamma'(s)) = \omega_2^1 (T)
\end{align*}
$$

Hence $\gamma* \omega_2^1 = \omega_2^1 (T)\;\mathrm{d}s$. By previous proposition

$$
\begin{align*}
  \int_a^b \kappa_g \;\mathrm{d}s = \int_a^b \frac{\mathrm{d}\theta}{\mathrm{d}s}\mathrm{d}s - \int_a^b \omega_2^1 (T)\;\mathrm{d}s \\
  =& \theta(b) - \theta(a) - \int_a^b \omega_2^1 (T)\;\mathrm{d}s \\
  =& \theta(b) - \theta(a) - \int_a^b \gamma*\omega_2^1 \\
  =& \theta(b) - \theta(a) - \int_C \omega_2^1
\end{align*}
$$
</details>
</MathBox>

### Gauss-Bonnet formula for a polygon

A *polygon* on a surface $M$ is a piecewise smooth simple closed curve $\gamma:[a,b]\to M$. In this context, "closed" means that $\gamma(a) = \gamma(b)$ and "simple" means that the curve has no other self-intersections. On an oriented surface, a polygon is *positively oriented* if it has the boundary orientation of the oriented region it encloses. A *geodesic polygon* is a polygon whose segments are geodesics. We say that a polygon is *unit-speed* if it has unit speed every except at the nonsmooth points. Suppose now that $M$ is an oriented Riemannian $2$-manifold and that $\gamma:[a,b]\to M$ is a unit-speed polygon with $m$ vertices that lies in an open set $U$ on which there is an oriented orthonormal frame $\Set{\mathbf{e}_1,\mathbf{e}_2}$. Let $\gamma(s_0),\dots,\gamma(s_m)$ be the vertices of the polygon, where $a=s_0$, $b=s_m$ and $\gamma(a) = \gamma(b)$. Denote the image of $\gamma$ by $C$, and by $R$ the region enclosed by $C$. Let $K$ be the Gaussian curvature of the oriented Riemannian $2$-manifold $M$.

In a neighbourhood of a vertex $\gamma(s_i)$, the curve is the union of two $1$-dimensional manifolds with boundary. Let $\gamma'(s_i^-)$ be the outward-pointing tangent vector at $\gamma(s_i)$ of the incoming curve, and let $\gamma'(s_i^+)$ be the inward-pointing tangent vector at $\gamma(s_i)$ of the outgoing curve. The angle $\phi_i \in (-\pi,\pi)$ from the incoming tangent vector $\gamma'(s_i^-)$ to the outgoing tangent vector $\gamma'(s_i^+)$ is called the *jump angle* at $\gamma(s_i)$. The *interior angle* at $\gamma(s_i)$ is defined to be

$$
  \beta_i := \pi - \pi_i
$$

Along each edge $\gamma([s_{i-1},s_i])$ of a polygon, the velocity vector $T$ changes its angle by $\Delta\theta_i = \theta(s_i) - \theta(s_{i-1})$. At the vertex $\gamma(s_i)$, the angle jumps by $\phi_i$. Thus, the total change in the angle of $T$ around a polygon is

$$
  \sum_{i=1}^m \Delta\theta_i + \sum_{i=1}^m \phi_i
$$

<MathBox title='Hopf umlautz (rotation angle theorem)' boxType='theorem'>
Let $(U,\Set{\mathbf{e}_1,\mathbf{e}_2})$ be a framed open set on an oriented Riemannian $2$-manifold, and $\gamma:[a,b]\to U$ a positively oriented piecewise smooth simple curve. Then the total change in the angle of $T(s) = \gamma'(s)$ around $\gamma$ is

$$
  \beta_i := \pi - \pi_i = 2\pi
$$
</MathBox>

<MathBox title='Gauss-Bonnet formula for a polygon' boxType='theorem'>
Let $(U,\Set{\mathbf{e}_1,\mathbf{e}_2})$ be a framed open set on an oriented Riemannian $2$-manifold, and $\gamma:[a,b]\to U$ a positively oriented piecewise smooth simple curve. The total geodesic curvature of $\gamma$ is given by

$$
  \int_a^b \kappa_g \;\mathrm{d}s = 2\pi - \sum_{i=1}^m \phi_i - \int_R K \;\mathrm{vol}
$$

<details>
<summary>Proof</summary>

The integral $\int_a^b \kappa_g \;\mathrm{d}s$ is the sum of the total geodesic curvature on each edge of a simple closed curve. Denote the change in the angle $\theta$ along the $i$th edge of $\gamma$ by $\Delta\theta_i$. By previous corollary

$$
  \int_a^b \kappa_g \;\mathrm{d}s =& \sum_{i=1}^m \int_{s_i - 1}^{s_i} \kappa_g \;\mathrm{d}s \\
  =& \sum_{i=1}^m \Delta\theta_i - \int_C \omega_2^1
$$

By the Hopf umlautz

$$
  \sum_{i=1}^m \Delta\theta_i = 2\pi - \sum_{i=1}^m \phi_i
$$

Suppose $\Set{\varepsilon^1,\varepsilon^2}$ is the dual frame to $\Set{\mathbf{e}_1,\mathbf{e}_2}$. If $[\Omega_j^i]$ is the curvature matrix relative to $\Set{\mathbf{e}_1,\mathbf{e}_2}$, recall that

$$
  \Omega_2^1 = \mathrm{d}\omega_2^1 = K \varepsilon^1 \wedge\varepsilon^2
$$

Thus

$$
\begin{align*}
  \int_C \omega_2^1 =& \int_{\partial R} \omega_2^1 \\
  =& \int_R \mathrm{d}\omega_2^1 \\
  =& \int_R K \varepsilon^1 \wedge \varepsilon^2 = \int_R K \;\mathrm{vol}
\end{align*}
$$

Combining the result give the Gauss-Bonnet formula for a polygon
</details>
</MathBox>

### Triangles on a Riemannian $2$-manifold

<MathBox title='' boxType='proposition'>
Suppose a geodesic $m$-gon $\gamma$ lies in a framed open set of an oriented Riemannian $2$-manifold. If $\beta_i$ is the interior angle at vertex $i$ of the geodesic $m$-gon, $R$ is the closed region enclosed by $\gamma$, and $K$ is the Gaussian curvature on $R$, then

$$
  \sum_{i=1}^m \beta_i = (m - 2)\pi + \int_R K\;\mathrm{vol}
$$

<details>
<summary>Proof</summary>

Along a geodesic $m$-gon, the geodesic curvature $\kappa_g$ is identically zero. The exterior angle $\phi_i$ at vertex $i$ is $\phi_i = \pi - \beta_i$. Hence, the Gauss-Bonnet formula becomes

$$
  0 = 2\pi - \sum_{i=1}^m (\pi - \beta_i) - \int_R K\;\mathrm{vol}
$$

or

$$
  \sum_{i=1}^m \beta_i = (m - 2)\pi + \int_R K\;\mathrm{vol}
$$
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Suppose a geodesic triangle lies in a framed open set of an oriented Riemannian $2$-manifold $M$.
1. If $M$ has zero Gaussian curvature, the angles of the geodesic triangle add up to $\pi$ radians.
2. If $M$ has everywhere positive Gaussian curvature, the angles of the geodesic triangle add up to more than $\pi$ radians.
3. If $M$ has everywhere negative Gaussian curvature, the angles of the geodesic triangle add up to less than $\pi$ radians.
</MathBox>

Recall that the Poincaré half-plane is also known as the hyperbolic plane. A geodesic triangle in the Poincaré half-plane is therefore called a hyperbolic triangle.

<MathBox title='' boxType='corollary'>
The area enclosed by a hyperbolic triangle is $\pi$ minus the sum of its interior angles.

<details>
<summary>Proof</summary>

If $R$ is the regiosn enclosed by the hyperbolic triangle, then by previous proposition

$$
\begin{align*}
  \operatorname{area}(R) = \int_R 1 \;\mathrm{vol} = -\int_R K\;\mathrm{vol} \\
  =& \pi - \sum_{i=1}^3 \beta_i
\end{align*}
$$
</details>
</MathBox>

### Gauss-Bonnet theorem for a surface

Let $M$ be a compact oriented Riemannian $2$-manifold. Suppose $M$ has been cut up into polygonal regions, each of which is bounded by a piecewise smooth simple closed curve and lies in a framed open set. We call such a polygonal decomposition *sufficiently fine*. Let $V,E,F$ be the number of vertices, edges, and faces, respectively, of this polygonal decomposition. The Euler characteristic of the decomposition is defined to be 

$$
  \chi = V - E + F
$$

<MathBox title='Gauss-Bonnet theorem' boxType='theorem'>
For a compact oriented Riemannian $2$-manifold $M$

$$
  \int_M K\;\mathrm{vol} = 2\pi\chi(M)
$$

where $\chi$ is the Euler characteristic.

<details>
<summary>Proof</summary>

Decompose the surface $M$ into a sufficiently fine polygonal decomposition. The orientation on the surface will orient each face in such a way that each edge is oriented in two opposite ways, depending on which of the two adjacent faces it is a boundary of.

Denote the polygonial regions by $R_j$. If we sum up $\int \kappa_g \;\mathrm{d}s$ over the boundaries of all the regions $R_j$, the result is zero because each edge occurs twice, with opposite orientations. Let $\beta_i^(j)$ for $1\leq i \leq n_j$ be the interior angles of the $j$th polygon. Then by the Gauss-Bonnet formula for a polygon

$$
\begin{align*}
  0 =& \sum_j \int_{\partial R_j} \kappa_g \;\mathrm{d}s \\
  =& 2\pi F - \sum_j \sum_{i=1}^{n_j} (\pi - \beta_i^{(j)}) - \sum_j \int_{R_j} K\;\mathrm{vol}
\end{align*}
$$

In the sum $\sum_j \sum_i (\pi - \beta_i^{(j)})$, the term $\pi$ occurs $2E$ times because each edge occurs twice. The sum of all interior angles is $2\pi$ at each vertex. Hence

$$
  \sum_{i,j} \beta_i^{(j)} = 2\pi V
$$

Thus

$$
  0 = 2\pi F - 2\pi E + \sum_{i,j} \beta_i^{(j)} - \int_M K\;\mathrm{vol}
$$

or

$$
\begin{align*}
  \int_M K\;\mathrm{vol} =& 2\pi V - 2\pi E + 2\pi F \\
  =& 2\pi\chi(M)
\end{align*}
$$
</details>
</MathBox>

In the Gauss-Bonnet theorem the total curvature $\int_M K\;\mathrm{vol}$ on the left-hande side is independent of the polygonial decomposition, while the Euler characteristic $2\pi\chi$ on the right-hand side is independent of the Riemannian structure. This theorem shows that the Euler characteristic of a sufficiently fine polygonial decomposition is independent of the decomposition and the total curvature is a topological invariant, independent of the Riemannian structure.

By the classification theorem for surfaces, a compact orientable surface is classified by an integer $g$ called its genus, which is essentially the number of holes in the surface. Any two compact orientable surfaces of the same genus are diffeomorphic and moreover, if $M$ is a compact orientable surface of genus $g$, then

$$
  \chi(M) = 2 - 2g
$$

<MathBox title='Gauss-Bonnet theorem' boxType='theorem'>
If a compact orientable Riemannian manifold of dimension $2$ has positive Gaussian curvature $K$ everywhere, then it is diffeomorphic to a sphere.

<details>
<summary>Proof</summary>

By the Gauss-Bonnet theorem

$$
  2\pi\chi(M) = \int_M K\;\mathrm{vol} > 0
$$

So $\chi(M) = 2 - 2g > 0$, which is equivalent to $g < 1$. Hence, $g = 0$ and $M$ is diffeomorphic to a sphere.
</details>
</MathBox>

### Gauss-Bonnet theorem for a hypersurface in $\R^{2n+1}$

If $M$ is an even-dimensional smooth, compact, oriented hypersurface in $\R^{2n+1}$, the Gauss-Bonnet theorem states that

$$
  \int_M K\;\mathrm{vol}_M = \frac{\operatorname{vol}(\mathbb{S}^{2n})}{2}\chi(M)
$$

# Partial derivative (basis vector)

Partial derivatives represent basis vectors

$$
  \mathbf{e}_i \equiv \frac{\partial}{\partial \mathbf{x}^i} \equiv \boldsymbol{\partial}_i
$$

A basis of partial derivatives can be transformed to a new basis $\tilde{\mathbf{e}}_i \equiv \frac{\partial}{\partial \tilde{\mathbf{x}}^i}$ by the chain rule

$$
  \frac{\partial}{\partial \tilde{\mathbf{x}}^i} = \frac{\partial x^j}{\partial \tilde{x}^i} \frac{\partial}{\partial \mathbf{x}^j} = J_i^j \frac{\partial}{\partial \mathbf{x}^j}
$$

where $J$ is the Jacobian matrix of the coordinate transform.

Tangent vectors of a curve can be expressed as linear combination of partial derivatives

$$
  \frac{\mathrm{d}}{\mathrm{d} \lambda} = \frac{\mathrm{d}x^i}{\mathrm{d} \lambda} \frac{\partial }{\partial \mathbf{x}^i} 
$$

Tangent vectors can be transformed to a new basis. The tangent vector derivative components transform contravariantly

$$
\begin{align*}
  \frac{\mathrm{d}}{\mathrm{d} \lambda} = \frac{\mathrm{d}x^i}{\mathrm{d} \lambda} \frac{\partial }{\partial \mathbf{x}^i} &= \frac{\mathrm{d}x^i}{\mathrm{d} \lambda} \left( \frac{\partial \tilde{x}^j}{\partial x^i} \frac{\partial}{\partial \tilde{\mathbf{x}}^j} \right) \\
  &= \left( \frac{\mathrm{d}x^i}{\mathrm{d} \lambda} \frac{\partial \tilde{x}^j}{\partial x^i} \right) \frac{\partial}{\partial \tilde{\mathbf{x}}^j} \\
  &= \frac{\mathrm{d} \tilde{x}^i}{\mathrm{d} \lambda} \frac{\partial}{\partial \tilde{\mathbf{x}}^i}
\end{align*}
$$

# Gradient

The gradient (del) operator maps a scalar field to a vector field. 

$$
  \operatorname{grad}(f) = \left( \operatorname{grad}(f) \right)^i \frac{\partial}{\partial x^i}
$$

The gradient operator and differential form are a dual pair

$$
\begin{align*}
  \mathrm{d}f = \operatorname{grad}(f) \cdot \_ &= g\left( \operatorname{grad}(f), \_ \right) \\ 
  &= \left[ g_{ij} \left( \mathrm{d}x^i \otimes \mathrm{d}x^j \right) \right] \left[ \left( \operatorname{grad}(f) \right)^k \frac{\partial}{\partial x^k} \right] \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^k \mathrm{d}x^i \left( \frac{\partial}{\partial x^k} \right) \mathrm{d}x^j \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^k \delta_k^i \mathrm{d}x^j \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^i  \mathrm{d}x^j
\end{align*}
$$

The covector components are given by

$$
  \frac{\partial f}{\partial x^j} = \left( \operatorname{grad}(f) \right)^i g_{ij}
$$

The gradient components are retrieved by applying the inverse metric tensor

$$
\begin{align*}
  \frac{\partial f}{\partial x^j} \mathfrak{g}^{jk} &= \left( \operatorname{grad}(f) \right)^i g_{ij} \mathfrak{g}^{jk} \\
  &= \left( \operatorname{grad}(f) \right)^i \delta_i^k \\
  &= \left( \operatorname{grad}(f) \right)^k &= \frac{\partial f}{\partial x^j} \mathfrak{g}^{jk}
\end{align*}    
$$

The gradient can thus be expressed as

$$
  \operatorname{grad}(f) = \left( \operatorname{grad}(f) \right)^i \frac{\partial}{\partial x^k} = \mathfrak{g}^{jk} \frac{\partial f}{\partial x^j} \frac{\partial}{\partial x^k} 
$$

For a Cartesian basis $g_{ij} = \mathfrak{g}_{ij} = \delta_{ij}$ and the gradient simplifies to

$$
  \operatorname{grad}(f) = \frac{\partial f}{\partial x^i} \frac{\partial}{\partial x^i}
$$

# Directional derivative

The directional derivative is defined as

$$
  \mathrm{d}f (\mathbf{v}) \equiv \operatorname{grad}(\)mathbf{v} f = \lim_{h \to 0} \frac{f(\mathbf{x} + \mathbf{h} \cdot \mathbf{v}) - f(\mathbf{x})}{\mathbf{h}} = \mathbf{v} \cdot \operatorname{grad}(f)
$$

This implies that the gradient (vector) $\operatorname{grad}(f)$ and the differential form (covector) $\mathrm{d}f$ are dual pairs

$$
\begin{align*}
  \mathrm{d}f(\mathbf{v}) = \operatorname{grad}(f) \cdot \mathbf{v} &= \left[ \left( \operatorname{grad}(f)\right)^i \frac{\partial}{\partial x^i} \right] \cdot \left(v^j \frac{\partial}{\partial x^j} \right) \\
  &= \left( \operatorname{grad}(f) \right)^i v^j \left( \frac{\partial}{\partial x^i} \cdot \frac{\partial}{\partial x^j} \right) \\
  &= \left( \operatorname{grad}(f) \right)^i v^j g_{ij}
\end{align*}
$$

Alternatively

$$
\begin{align*}
  \operatorname{grad}(f) \cdot \mathbf{v} &= g\left(\operatorname{grad}(f), \mathbf{v} \right) \\
  &= \left[ g_{ij} \left( \mathrm{d}x^i \otimes \mathrm{d}x^j \right) \right] \left[ \left( \operatorname{grad}(f) \right)^k \frac{\partial}{\partial x^k} , v^l \frac{\partial}{\partial x^l} \right] \\
  &= g_{ij} \mathrm{d}x^i \left[ \left( \operatorname{grad}(f) \right)^k \frac{\partial}{\partial x^k} \right] \mathrm{d}x^j \left( v^l \frac{\partial}{\partial x^l} \right) \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^k v^l \mathrm{d}x^i \left( \frac{\partial}{\partial x^k} \right) \mathrm{d}x^j \left( \frac{\partial}{\partial x^l} \right) \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^k v^l \delta_k^i \delta_l^j \\
  &= g_{ij} \left( \operatorname{grad}(f) \right)^i v^j
\end{align*}
$$