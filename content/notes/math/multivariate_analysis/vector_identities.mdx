---
title: 'Vector Analysis'
subject: 'Mathematics/Multivariate Analysis'
showToc: true
---

# Unit vector representations

$$
\begin{equation*}
  \unitvec{z} = \unitvec{r} \cos(\theta) - \unitsym{\theta} \sin(\theta)
\tag{\label{equation-62}}
\end{equation*}
$$

# Vector identities

$$
\begin{equation*}
  \nabla \times (f \mathbf{G}) = (\nabla f) \times \mathbf{G} + f (\nabla \times \mathbf{G})
\tag{\label{equation-59}}
\end{equation*}
$$

$$
\begin{equation*}
  \nabla\times\nabla\times\mathbf{G} = \nabla(\nabla\cdot\mathbf{G}) - \nabla^2 \mathbf{G}
\tag{\label{equation-63}}
\end{equation*}
$$

# Vector differential operators

## Spherical coordinates

**Gradient**

$$
\begin{equation*}
  \nabla f = \frac{\partial f}{\partial r}\unitvec{r} + \frac{1}{r} \frac{\partial f}{\partial\theta} \unitsym{\theta} + \frac{1}{r\sin(\theta)} \frac{\partial f}{\partial\phi} \unitsym{\phi}
\tag{\label{equation-60}}
\end{equation*}
$$

**Curl**

$$
\begin{equation*}
\begin{split}
  \nabla\times\mathbf{F} =& \unitvec{r} \frac{1}{r\sin(\theta)} \left[\frac{\partial}{\partial\theta} (F_\phi \sin\theta) - \frac{\partial F_\theta}{\partial\phi} \right] \\
  &+ \unitsym{\theta} \frac{1}{r} \left[\frac{1}{\sin(\theta)} \frac{\partial F_r}{\partial\phi} - \frac{\partial}{\partial r} (rF_\phi) \right] \\
  &+ \unitsym{\phi} \frac{1}{r} \left[\frac{\partial}{\partial r} (rF_\theta) - \frac{\partial F_r}{\partial\theta} \right]
\end{split}
\tag{\label{equation-61}}
\end{equation*}
$$

**Laplacian**

$$
\begin{equation*}
\begin{split}
  \nabla^2 f =& \frac{1}{r^2} \frac{\partial}{\partial r} \left(r^2 \frac{\partial f}{\partial r} \right) + \frac{1}{r^2} \Lambda^2 f \\
  =& \frac{2}{r} \frac{\partial}{\partial r} + \frac{\partial^2}{\partial r^2} + \frac{1}{r^2} \Lambda^2
\end{split}
\tag{\label{equation-}}
\end{equation*}
$$

where the angular part $\Lambda^2$, called the Legendrian, is

$$
  \frac{1}{\sin(\theta)} \frac{\partial}{\partial\theta} \left(\sin(\theta) \frac{\partial}{\partial\theta} \right) + \frac{1}{\sin^2 (\theta)} \frac{\partial^2}{\partial\phi^2}
$$

# Curvilinear coordinates

| System | $q_1$ | $q_2$ | $q_3$ | $h_1$ | $h_2$ | $h_3$ |
|---|:-:|:-:|:-:|:-:|:-:|:-:|
| Cartesian | $x$ | $y$ | $z$ | $1$ | $1$ | $1$ | 
| Spherical | $r$ | $\theta$ | $\phi$ | $1$ | $r$ | $r\sin\theta$ |
| Cylindrical | $s$ | $\phi$ | $z$ | $1$ | $s$ | $1$ |

Consider the 3-dimensional Euclidean space. In Cartesian coordinates the position of a point $P$ is given by

$$
  \mathbf{r} = x_1 \mathbf{e}_1 + x_2 \mathbf{e}_2 + x_3 \mathbf{e}_3
$$

where $\mathbf{e}_i := \frac{\partial\mathbf{r}}{\partial x_i}$ are the standard basis vectors. The point $P$ can also be defined by curviliner coordinates $q_i$ that are related to the Cartesian coordinates by the functions

$$
\begin{split}
  x_1 = f_1(q_1, q_2, q_3) 
\end{split}\quad
\begin{split}
  x_2 = f_2(q_1, q_2, q_3) 
\end{split}\quad
\begin{split}
    x_3 = f_3(q_1, q_2, q_3) 
\end{split}
$$

Assuming that the curvilinear coordinate system is orthogonal, its basis vectors $\mathbf{h}_i := \frac{\partial\mathbf{r}}{\partial q_i}$ are mutually perpendicular such that

$$
  \mathbf{h_i}\cdot\mathbf{h_j} = \delta_{ij} = \begin{cases}
    1 \quad i = j \\ 
    0 \quad i \neq j
  \end{cases}
$$

The norm of the basis vectors are given by $\left| \mathbf{h}_i \right| = \sqrt{\frac{\partial\mathbf{r}}{\partial q_i} \cdot \frac{\partial\mathbf{r}}{\partial q_i}}$. An orthonormal basis $\Set{\mathbf{b}_i }_{i=1}^3$ can thus be formed by setting

$$
  \mathbf{b}_i = \frac{\mathbf{h_i}}{h_i} \quad h_j := \sqrt{\frac{\partial\mathbf{r}}{\partial q_i} \cdot \frac{\partial\mathbf{r}}{\partial q_i}}
$$

The total differential change in $\mathbf{r}$ is then given by 

$$
  \d\mathbf{r} = \sum_{i=1}^3 \left(\frac{\partial\mathbf{r}}{\partial q_i}\right)\d q_i = \sum_{i=1}^3 h_i \d q_i \mathbf{b}_i
$$

From the total differential change we can form the differential volume element by

$$
  \d V = \prod_{i=1}^3 \left(\d\mathbf{r} \right)_i = h_1 h_2 h_3 \;\d q_1\;\d q_2\;\d q_3
$$

and differential surface elements by

$$
  \d\mathbf{a}_i = (\d\mathbf{r})_j \cdot (\d\mathbf{r})_k \mathbf{b}_i = h_j h_k \;\d q_j\;\d q_k \mathbf{b}_i
$$

## Gradient

Consider a scalar function $f(q_i) : \R^3 \to\R$. The total derivative of $f$ is given by

$$
  \d f := \nabla f \cdot\d\mathbf{r} = \sum_{i=1}^3 \frac{\partial f}{\partial q_i}\d q_i
$$

Evaluating the inner product $\nabla f\cdot \d\mathbf{r}$ we get

$$
  \d f = \nabla f \cdot\d\mathbf{r} = \nabla f \cdot \left( \sum_{i=1}^3 h_i \d q_i \mathbf{b}_i \right) = \sum_{i=1}^3 h_i \left( \nabla f \cdot\mathbf{b}_i \right)\d q_i
$$

Equating the terms of $\d f$ we see that

$$
  \nabla f \cdot \mathbf{b}_i = \frac{1}{h_i}\frac{\partial f}{\partial q_i}
$$

and hence the gradient of $f$ with respect to the curvilinear coordinates is given by

$$
  \nabla f = \sum_{i=1}^3 \left(\nabla f \cdot \mathbf{b}_i \right)\mathbf{b}_i = \sum_{i=1}^3 \frac{1}{h_i}\frac{\partial f}{\partial q_i}\mathbf{b}_i
$$

## Divergence

Suppose $\mathbf{A}: \R^3 \to\R^3$ is a vector field with components $\mathbf{A} = \sum_{i=1}^3 A_i\mathbf{b}_i$. The divergence of $\mathbf{A}$ can be derived by writing out

$$
\begin{align*}
  \nabla\cdot\mathbf{A} &= \nabla\cdot\left( A_1 \mathbf{b}_1 + A_2 \mathbf{b}_2 + A_3 \mathbf{b}_3 \right) \\
  &= \nabla\cdot\left( h_2 h_3 A_1 \frac{\mathbf{b}_1}{h_2 h_3} + h_1 h_3 A_2 \frac{\mathbf{b}_2}{h_1 h_3} + h_1 h_2 A_3 \frac{\mathbf{b}_3}{h_1 h_2} \right) \\
  &= \nabla\cdot\left( h_2 h_3 A_1 \frac{\mathbf{b}_1}{h_2 h_3} \right) + \nabla\cdot\left( h_1 h_3 A_2 \frac{\mathbf{b}_2}{h_1 h_3} \right) + \nabla\cdot\left( h_1 h_2 A_3 \frac{\mathbf{b}_3}{h_1 h_2} \right)
\end{align*}
$$

Setting $f:= h_j h_k A_i$ and $\mathbf{v}:= \frac{\mathbf{b}_i}{h_j h_k}$, each divergence term takes the form $\nabla\cdot(f\mathbf{v})$ allowing us to apply the identity

$$
  \nabla\cdot(f\mathbf{v}) = \mathbf{v}\cdot\nabla f + f\nabla\cdot\mathbf{v}
$$

It can be further shown that $\nabla\cdot\mathbf{v} = \nabla\cdot\left( \frac{\mathbf{b}_i}{h_j h_k} \right) = 0$, by recalling that $\nabla q_i = \frac{\mathbf{b}_i}{h_i}$ and $\mathbf{b}_i \times \mathbf{b}_j = \sum_{k=1}^3 \varepsilon_{ijk}\mathbf{b}_k$ where $\varepsilon_{ijk}$ is the Levi-Civita symbol, so that

$$
  \nabla q_j \times\nabla q_k = \frac{\mathbf{b}_j \times\mathbf{b}_k}{h_j h_k} = \frac{\mathbf{b}_i}{h_j h_k}
$$

Taking the divergence of the left hand side, we may use the identity

$$
  \nabla\cdot(\mathbf{u}\times\mathbf{v}) = \mathbf{v}\cdot(\nabla\times\mathbf{u}) - \mathbf{u}\cdot(\nabla\times\mathbf{v})
$$

with $\mathbf{u}:= \nabla q_j$ and $\mathbf{v}:= q_k$. However, because gradients are curl free, i.e. $\nabla\times(\nabla f) = \mathbf{0}$ we conclude that

$$
\begin{align*}
  \nabla\cdot\left( \frac{\mathbf{b}_i}{h_j h_k} \right) &= \nabla\cdot\left(\nabla q_j \times\nabla q_k\right) \\
  &= \nabla q_k \left(\nabla \times \nabla q_j \right) - \nabla q_j \cdot\left( \nabla\times \nabla q_k \right) \\
  &= 0
\end{align*}
$$

It therefore follows that

$$
  \nabla\left( h_j h_k A_i \frac{\mathbf{b}_i}{h_j h_k} \right) = \frac{\mathbf{b}_i}{h_j h_k}\cdot \nabla(h_j h_k A_i) = \frac{1}{h_i h_j h_k}\frac{\partial}{\partial q_i}\left( h_j h_k A_i \right)
$$

where we have used that $\mathbf{q}_i \cdot \nabla f = \frac{1}{h_i}\frac{\partial f}{\partial q_i}$. In conclusion, the divergence of $\mathbf{A}$ with respect to curvilinear coordinates is given by

$$
  \nabla\cdot\mathbf{A} := \frac{1}{h_1 h_2 h_3}\left[\frac{\partial}{\partial q_1}\left(h_2 h_3 A_1\right) + \frac{\partial}{\partial q_2}\left(h_1 h_3 A_2\right) + \frac{\partial}{\partial q_3}\left(h_1 h_2 A_3\right)\right]
$$

## Curl

The curl of $\mathbf{A}$ can be derived by writing out

$$
\begin{align*}
  \nabla\times\mathbf{A} &= \nabla\times\left(\sum_{i=1}^3 A_i \mathbf{b}_i \right) \\
  &= \nabla\times\left(\sum_{i=1}^3 h_i A_i \frac{\mathbf{b}_i}{h_i} \right) \\
  &= \sum_{i=1}^3 \nabla\times\left(h_i A_i \frac{\mathbf{b}_i}{h_i} \right)
\end{align*}
$$

Setting $f:= h_i A_i$ and $\mathbf{v} = \frac{\mathbf{b}_i}{h_i}$, each curl term takes the form $\nabla\times (f\mathbf{v})$, allowing us to apply the identity

$$
  \nabla\times(f\mathbf{v}) = -\mathbf{v}\times\nabla f + f\nabla\times\mathbf{v}
$$

Since $\nabla\times\left(\frac{\mathbf{b}_i}{h_i}\right) = \nabla\times\left(\nabla q_i \right) = 0$, we are left with

$$
  \nabla\times\mathbf{A} = \sum_{i=1}^3 -\frac{\mathbf{b}_i}{h_i}\times\nabla\left(h_i A_i\right) = \sum_{i=1}^3 -\frac{\mathbf{b}_i}{h_i}\times\left[\sum_{j=1}^3 \frac{1}{h_j}\frac{\partial}{\partial q_j}\left( h_i A_i \right)\mathbf{b}_j \right] 
$$

Applyting the relation $\mathbf{b}_i \times \mathbf{b}_j = \sum_{k=1}^3 \varepsilon_{ijk}\mathbf{b}_k$, we conclude that

$$
  \nabla\times\mathbf{A} = \frac{\mathbf{q}_1}{h_2 h_3}\left[\frac{\partial}{\partial q_2}\left(h_3 A_3 \right) - \frac{\partial}{\partial q_3}\left(h_2 A_2 \right)\right] + \frac{\mathbf{q}_2}{h_1 h_3}\left[\frac{\partial}{\partial q_3}\left(h_1 A_1 \right) - \frac{\partial}{\partial q_1}\left(h_3 A_3 \right)\right] + \frac{\mathbf{q}_3}{h_1 h_2}\left[\frac{\partial}{\partial q_1}\left(h_2 A_2 \right) - \frac{\partial}{\partial q_2}\left(h_1 A_1 \right)\right]
$$

## Laplacian

The Laplacian of a scalar function $f:\R^3 \to\R$ is defined as the divergence of $\nabla f$. Using the results for the gradient and dirvergence in curvilinear coordinates, we find that

$$
\begin{align*}
  \nabla^2 f &:= \nabla\cdot\left(\nabla f \right) = \nabla\cdot\left(\sum_{i=1}^3 \frac{1}{h_1}\frac{\partial f}{\partial q_i}\mathbf{b}_i \right) \\
  &= \nabla\cdot\left( \frac{h_2 h_3}{h_1} \frac{\partial f}{\partial q_1} \frac{\mathbf{b}_1}{h_2 h_3} + \frac{h_1 h_3}{h_2} \frac{\partial f}{\partial q_2} \frac{\mathbf{b}_2}{h_1 h_3} + \frac{h_1 h_2}{h_3} \frac{\partial f}{\partial q_3} \frac{\mathbf{b}_3}{h_1 h_2} \right) \\
  &= \nabla\cdot\left( \frac{h_2 h_3}{h_1} \frac{\partial f}{\partial q_1} \frac{\mathbf{b}_1}{h_2 h_3}\right)  + \nabla\cdot\left(\frac{h_1 h_3}{h_2} \frac{\partial f}{\partial q_2} \frac{\mathbf{b}_2}{h_1 h_3}\right) + \nabla\cdot\left( \frac{h_1 h_2}{h_3} \frac{\partial f}{\partial q_3} \frac{\mathbf{b}_3}{h_1 h_2} \right) \\
  &= \frac{\mathbf{b_1}}{h_2 h3}\cdot\left(\frac{h_2 h_3}{h_1}\frac{\partial f}{\partial q_1} \right) + \frac{\mathbf{b_2}}{h_1 h3}\cdot\left(\frac{h_1 h_3}{h_2} \frac{\partial f}{\partial q_2} \right) + \frac{\mathbf{b_3}}{h_1 h2}\cdot\left(\frac{h_1 h_2}{h_3} \frac{\partial f}{\partial q_3} \right) \\
  &= \frac{1}{h_1 h_2 h_3}\left[ \frac{\partial}{\partial q_1}\left( \frac{h_2 h_3}{h_1}\frac{\partial f}{\partial q_1} \right) + \frac{\partial}{\partial q_2}\left( \frac{h_1 h_3}{h_2}\frac{\partial f}{\partial q_2} \right) + \frac{\partial}{\partial q_3}\left( \frac{h_1 h_2}{h_3}\frac{\partial f}{\partial q_3} \right) \right]
\end{align*}
$$
