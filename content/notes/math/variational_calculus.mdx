---
title: 'Variational Calculus'
subject: 'Mathematics'
showToc: true
---

# Euler-Lagrange equations

Calculus of variations seeks to find extremas of functionals in the form of definite integrals

$$
  I[y] = \int_{x_1}^{x_2} L\left(x, y, \frac{\d y}{\d x} \right) \d x
$$

The extremal function $y = f(x)$ of $I[y]$ can be found by introducing a variation in $f$

$$
\begin{align*}
  \bar{f}(x) &= f(x) + \varepsilon \eta(x) \, , \quad \eta(x_1) = \eta(x_2) = 0 \\
  \bar{f}'(x) &= f'(x) + \varepsilon\eta'(x)
\end{align*}
$$

Substituting $\bar{f}$ into $I[y]$ results in a function of $\varepsilon$, $\Phi(\varepsilon) \equiv I[\bar{f}]$ and since $y = f(x)$ is a minimum of $I[y]$, the function $\Phi(\varepsilon)$ is stationary at $\varepsilon = 0$ 

$$
\begin{align*}
  0 &= \left. \frac{\d\Phi}{\d\varepsilon} \right|_{\varepsilon = 0} \\
  &= \left. \frac{\d}{\d\varepsilon} \right|_{\varepsilon = 0} \int_{x_1}^{x_2} L\left(x, \bar{f}, \bar{f}' \right) \d x \\
  &= \left. \int_{x_1}^{x_2} \frac{\d}{\d\varepsilon} L\left(x, \bar{f}, \bar{f}' \right) \d x \right|_{\varepsilon = 0} \\
  &= \left. \int_{x_1}^{x_2} \left( \frac{\partial L}{\partial \bar{f}} \frac{\partial \bar{f}}{\partial \varepsilon} + \frac{\partial L}{\partial \bar{f}'}\frac{\partial \bar{f}'}{\partial \varepsilon} \right) \right|_{\varepsilon = 0} \d x \\
  &= \left. \int_{x_1}^{x_2} \left( \frac{\partial L}{\partial \bar{f}} \eta + \frac{\partial L}{\partial \bar{f}'}\eta' \right) \right|_{\varepsilon = 0} \d x
\end{align*}
$$

Integrating the second term by parts

$$
  \int_{x_1}^{x^2} \frac{\partial L}{\partial \bar{f}'}\eta' \d x = \frac{\partial L}{\partial \bar{f}'} \underbrace{\left[ \eta \right]_{x_1}^{x_2}}_{=0} - \int_{x_1}^{x^2} \eta \frac{\d}{\d x} \left( \frac{\partial L}{\partial \bar{f}'} \right) \d x
$$

and inserting back

$$
\begin{align*}
  0 &= \left. \int_{x_1}^{x_2} \left[ \frac{\partial L}{\partial \bar{f}} \eta - \frac{\d}{\d x} \left( \frac{\partial L}{\partial \bar{f}'} \right) \eta \right] \right|_{\varepsilon = 0} \d x \\
  &= \int_{x_1}^{x_2} \left[ \frac{\partial L}{\partial f} - \frac{\d}{\d x} \left( \frac{\partial L}{\partial f'} \right) \right] \eta \d x 
\end{align*}
$$

By the fundamental lemma of calculus of variations, the integrand part in the paranthesis vanishes. Thus, if $f(x)$ is an extremal of $I[y]$, then $f(x)$ satisfy the Euler-Lagrange equation

$$
  \frac{\partial L}{\partial f} - \frac{\d}{\d x} \left( \frac{\partial L}{\partial f'} \right) = 0
$$

## Beltrami identity

The Beltrami identity is a special case of the Euler-Lagrange equation when $L$ does not depend on $x$, i.e. $\frac{\partial L}{\partial x} = 0$

$$
\begin{align*}
  \frac{\partial L}{\partial f} - \frac{\d}{\d x} \left( \frac{\partial L}{\partial f'} \right) = 0 \\
  y' \frac{\partial L}{\partial f} - y' \frac{\d}{\d x} \left( \frac{\partial L}{\partial f'} \right)
\end{align*}
$$

The term $y' \frac{\partial L}{\partial y}$ is also found in the total derivative $\frac{\d L(x, y, y')}{\d x}$

$$
\begin{gather*}
  \frac{\d L}{\d x} = \frac{\partial L}{\partial x} + \frac{\partial L}{\partial y}y' + \frac{\partial L}{\partial y'}y'' \\
  y' \frac{\partial L}{\partial y} = \frac{\d L}{\d x} - \frac{\partial L}{\partial x} - \frac{\partial L}{\partial y'}y''
\end{gather*}
$$

Inserting back to the modified Euler-Lagrange equation gives

$$
\begin{gather*}
  \frac{\d L}{\d x} - \frac{\partial L}{\partial x} - \left[ \frac{\partial L}{\partial y'}y'' - y' \frac{\d}{\d x} \left( \frac{\partial L}{\partial f'} \right) \right] = 0 \\
  \frac{\d L}{\d x} - \frac{\partial L}{\partial x} - \frac{\d}{\d x} \left( y' \frac{\partial L}{\partial y'} \right) = 0 \\
  \frac{\d}{\d x} \left( L - y' \frac{\partial L}{\partial y'} \right) = \underbrace{\frac{\partial L}{\partial x}}_{=0} \\
  \frac{\d}{\d x} \left( L - y' \frac{\partial L}{\partial y'} \right) = 0
\end{gather*}
$$

Integrating on both sides results in the Beltrami identity

$$
  L - y' \frac{\partial L}{\partial y'} = C
$$

where $C$ is a constant dependent on boundary conditions.

### Brachistochrone problem

The brachistochrone problem seeks to find the path $y = f(x)$ which minimized the time travelled from $a = (0, h)$ to $b = (L, 0)$ in a gravitational field:

$$
  T = \int_a^b \d t = \int_a^b \frac{\d S}{v(x, y)}
$$

where
- the infinitisemal distance $\d S$ is retrieved from the Pythagorean theorem: $\sqrt{1 + \left(\frac{\d y}{\d x}\right)^2}\d x$
- the velocity $v(x, y)$ is retrieved from conservation of energy
$$
\begin{gather*}
  mgh = mgy + \frac{1}{2}mv^2 \\
  v = \sqrt{2g(h-y)}
\end{gather*}
$$

Substituting back into $T$ yields

$$
  T = \int_a^b \sqrt{\frac{1 + (y')^2}{2g(h-y)}} \d x
$$

The minimal function is found with the Euler-Lagrange equation. Since the integrand is not dependent on $x$, the Beltrami identity applies

$$
\begin{gather*}
  \sqrt{\frac{1 + (y')^2}{2g(h-y)}} - \frac{(y')^2}{\sqrt{\left[1 + (y')^2 \right]\left[2g (h - y) \right]}} = C \\
  1 + (y')^2 - (y')^2 = C \sqrt{\left[1 + (y')^2 \right]\left[2g (h - y) \right]} \\
  1 = C^2 \left[1 + (y')^2 \right]\left[2g (h - y) \right] \\
  \left[1 + (y')^2 \right] (h - y) = \underbrace{C_1}_{=\left(2gC^2\right)^{-1}} \\
  \frac{\d y}{\d x} = \sqrt{\frac{C_1 - (h - y)}{h - y}}
\end{gather*}
$$

The differential equation can be solved by separation of variables

$$
\begin{align*}
  \d x &= \sqrt{\frac{C_1 - (h - y)}{h - y}} \d y \\
  x &= \int \sqrt{\frac{C_1 - (h - y)}{h - y}} \d y
\end{align*}
$$

The right hand side integral can be solved by substituting 

$$
\begin{gather*}
  y = h - C_1 \sin^2 \left( \frac{\theta}{2} \right) = h - \frac{C_1}{2}(1 - \cos\theta) \\
  \d y = - C_1 \sin\left( \frac{\theta}{2} \right)\cos\left( \frac{\theta}{2} \right) \d\theta
\end{gather*}
$$

Inserting back into the differential equation gives

$$
\begin{align*}
  x &= -C_1 \int \sqrt{\frac{C_1 \sin^2 \left( \frac{\theta}{2} \right)}{C_1 \left[1 - \sin^2 \left( \frac{\theta}{2} \right) \right]}}  \sin\left( \frac{\theta}{2} \right)\cos\left( \frac{\theta}{2} \right) \d\theta \\
  &= -C_1 \int \sin^2 \left( \frac{\theta}{2} \right) \d\theta \\
  &= -\frac{C_1}{2} \int (1 - \cos\theta)\d\theta \\
  &= \frac{K_1}{2}\left( \theta - \sin\theta \right) + K_2
\end{align*}
$$

This results in the following parametric equations

$$
\begin{align*}
  x &= \frac{K_1}{2}\left( \theta - \sin\theta \right) + K_2 \\
  y &= h + \frac{K_1}{2}(1 - \cos\theta)
\end{align*}
$$

The boundary condition at $a = (0, h)$ corresponding to $\theta = 0$ implies $K_2 = 0$, while the boundary condition at $b = (L, 0)$ gives an equation set that is not easily solved analytically. Hence, the following parametric equations describe the brachistochrone curve

$$
\begin{align*}
  x &= \frac{K_1}{2}\left( \theta - \sin\theta \right) \\
  y &= h + \frac{K_1}{2}(1 - \cos\theta)
\end{align*}
$$

which are the equations of a cycloid.

# Lagrange multiplier method

The Langrange multiplier method finds extrema of a function $f: \R^n \to \R$ subject to $k$ equality constraints $g_i(\mathbf{x}) = c_i$ where $g_i : \R^n \to \R$.

The extrema of $f$ are points whose gradients are linear combinations of the constraint gradients

$$
  \nabla f(\mathbf{x}) = \sum_i^k \lambda_i \left[c_i - \nabla g_i \left(\mathbf{x}\right)\right]
$$

where $\lambda_i$ are the Langrange multipliers. The problem can be converted to an unconstrained optimization by defining the Lagrange function 

$$
  L(\mathbf{x}, \lambda) = f(\mathbf{x}) - \sum_i^k \lambda_i \left[c_i - g_i\left( \mathbf{x} \right)\right]
$$

whoose extrames are given by the Euler-Lagrange equations.