---
title: 'Number Sets'
subject: 'Mathematics'
showToc: true
---

# Natural numbers ($\N$)

Using set theory, the natural numbers $\N_0$ can be constructed recursively by letting $0 := \set{} = \emptyset \in \N$ and $n + 1 = n \cup \set{n}$ for each $n \in \N_0$ such that $n = \set{i}_{i=0}^{n-1}$, i.e. $n$ is a set of length $n$. In this way, every $n\in\N_0$ has a successor, which can be formulated using the successor map $s: \N_0 \to \N_0$ given by $n \mapsto n\cup\Set{n} \equiv n + 1$. The set of natural numbers $\N_0$ is then defined as the smallest set that
1. contains $0$
2. is closed under the successor map $s$

This definition requires that $s$ satisfies
1. $s$ is injective (every element has a unique successor)
2. $0 \notin \operatorname{ran}(s) = s[\N_0]$ ($0$ is not a successor to any $n\in\N_0$)
3. if $M \subseteq \N_0$ with $0 \in M$ and $s[M] \subseteq M$, then $M = \N_0$ ($\N_0$ is the smallest possible infinite set)

For $a, b \in \N_+$ and $b\geq 2$, we can find a natural number $q = \left\lfloor\frac{a}{b} \right\rfloor\in\N_+$ such that

$$
  a = bq + r,\; 0 \leq r \leq b - 1
$$

where $r$ is the remained when dividing $a$ by $b$. If $r = 0$, then $b$ divides $a$, denoted $b \mid a$, meaning $b$ is a divisor or factor of $a$. If $r \neq 0$, we write $b \nmid a$, meaning $b$ does not divide $a$. For $a > 2$, if the only divisors of $a$ are $1$ and $a$ itself, then $a$ is a *prime number*. Otherwise, $a$ is a *composite number*. The factors $b \notin\set{1,a}$ of the composite number $a$ are called *proper factors* of $a$. The set of proper factors of a composite number $a\in\N$ is denoted

$$
  S_\text{pf} (a) = \set{d\in\N : d\mid a, d\geq 2, d\neq a}
$$

Let $a$ be a composite number and $w \in\set{2,\dots,\lfloor\sqrt{a}\rfloor}$ be a lower bound. The set of bounded proper factors of $a$ is defined as

$$
  S_\text{bpf} (a, w) = \Set{d\in S_\text{pf} (a) : w \leq d \leq \left\lfloor\frac{a}{w}\right\rfloor}
$$

## Addition

Addition of natural numbers is a map $\N_0 \times \N_0 \to \N_0$ given by $(m, n) \mapsto m +n$. Formally, this can be defined recursively using the successor map

$$
  m + 0 := m \quad m + s(n) := s(m + n)
$$

Which is a well-defined map by Dedekind's principle of recursive definition. Addition of natural numbers obeys the following properties
- commutativity: $m + n = n + m$
- associativity: $k + (m + n) = (k + m) + n$

<details>
<summary>Proof</summary>

Associativity can be proved by mathematical induction with the predicate $P(n)$ given by

$$
  \forall k,m \in \N_0: (k + m) + n = k + (m + n)
$$

The base case $P(0)$ is trivially shown. For all $k, m \in \N_0$ we have

$$
\begin{gather*}
  (k + m) + 0 = k + \underbrace{(m + 0)}_{m} \\
  \iff k + m = k + m
\end{gather*}
$$

In the induction step, we assume $P(n)$ is true for all $n\in\N_0$. To prove $P(n) \implies P(n+1)$ we need to show that for all $k, m \in \N_0$

$$
  (k + m) + (n + 1) = k + \left(m + (n + 1)\right)
$$

From the recursive definition of addition (RD), we alread know that $m + (n + 1) = (m + n) + 1$. This can be used to rewrite the left-hand

$$
\begin{align*}
  (k + m) + (n + 1) &\overset{\mathrm{RD}}{=} \left((k + m) + n\right) + 1 \\
  &\overset{P(n)}{=} \left(k + (m + n)\right) + 1 \\
  &\overset{\mathrm{RD}}{=} k + \left((m + n) + 1\right) \\
  &\overset{\mathrm{RD}}{=} k + \left(m + (n + 1)\right)
\end{align*}
$$

which shows that $P(n + 1)$ is true.
</details>

## Multiplication

Multiplication of natural numbers is a map $\N_0 \times \N_0 \mapsto \N_0$ given by $(n, m) \mapsto n \cdot m$. Formally, this can be defined recursively using the successor map

$$
  0 \cdot m := 0 \quad (n + 1)\cdot m := (n \cdot m) + m
$$

Which is a well-defined map by Dedekind's principle of recursive definition. Multiplication of natural numbers obeys the following properties
1. commutativity: $n\cdot m = m \cdot n$
2. associativity: $n\cdot(m\cdot k) = (n\cdot m)\cdot k$
3. neutral element: $1 \cdot m = m$

Addition and multiplication are connected through the distrutive law

$$
  n \cdot (m + k) = n \cdot m + n \cdot k
$$

<details>
<summary>Proof</summary>

Distributivity can be proved by mathematical induction setting the predicate $P(n): n \cdot (m + k) = n \cdot m + n \cdot k$.

The base case $P(0)$ is trivially shown. For all $k,m\in\N_0$ we have

- LHS: $0 \cdot (m + k) = 0$
- RHS: $0 \cdot m + 0 \cdot n = 0 + 0 = 0$

In the induction step, we assume $P(n)$ is true for all $n\in\N_0$. To prove $P(n) \implies P(n+1)$ we need to show that for all $k, m \in \N_0$

$$
  (n + 1) \cdot (m + k) = (n + 1)\cdot m + (n + 1)\cdot k
$$

Using the recursive definition of multiplication, we can rewrite the left-hand side as

$$
\begin{align*}
  (n + 1) \cdot (m + k) &= n\cdot(m + k) + (m + k) \\
  &\overset{P(n)}{=} n\cdot m + n \cdot k + m + k = n \cdot + (n\cdot k + m) + k \\
  &= n\cdot m + (m + n\cdot k) + k = (n \cdot m + m) + (n \cdot k + k) \\
  &= (n + 1)\cdot m + (n + 1)\cdot k
\end{align*}
$$

which shows that $P(n + 1)$ is true.
</details>

## Ordering

For two natural numbers $m, n \in \N$ we have that $m \leq m$, i.e. $m$ is less than or equal to $n$, if there is a $k$ such that $n = m + k$. We also have that $m < n$, i.e. $m$ is (strictly) less than $n$, if $m \leq n \land m \neq n$. Ordering of natural numbers has the following properties for all $l, m, n \in \N_0$
1. reflexivity: $n \leq n$
2. anti-symmetry: $m \leq n \land n \leq m \implies n = m$
3. transitivity: $m \leq l \land l \leq n \implies m \leq n$

<details>
<summary>Proof</summary>

**Transitivity** 
Assume $m \leq l$ and $l \leq n$, then theres is a $k_1\in\N_0$ such that $l = m + k_1$ and there is a $k_2 \in \N_0$ such that $n = l + k_2$. Therefore we have

$$
  n = l + k_2 = (m + k_1) + k_2 = n + \underbrace{(k_1 + k_2)}_{=: k \in \N_0} = m + k
$$

This shows that there is a $k \in \N_0$ such that $n = m + k$, which by definition implies that $m \leq n$.
</details>

## Dedekind's principle of recursive definition

For a set $A$, $a\in A$ and $h: A \to A$, then there exists a unique map $f: \N_0 \to A$ with $f(0) = a$ and $f(s(n)) = h(f(n))$

## Mathematical induction

Let $P(n)$ be a property for natural numbers $n \in \N$ (predicate). Then $P(n)$ is true for all $n \in \N_0$ if 
1. $P(0)$ is true (base case)
2. $\forall n \in \N_0: P(n) \implies P(n+1)$ is true (induction step)

# Integers ($\Z$)

The integers can be constructed as the equivalence classes of ordered pairs of natural numbers, $(a, b) \in \N_0^2$, representing the substraction $a - b$ (without explicitly defining subtraction). This can be formulated by an equivalence relation $\sim$ obeying

$$
  (x,y) \sim (a,b) \iff x + b = a + y \quad(\iff x - y = a - b)
$$

The set of integers $\Z$ is then defined as the quotient set imposed by this equivalence relation

$$
  \Z := \N_0^2 / \sim = \Set{ [(a, b)]_\sim | (a, b) \in \N_0^2 }
$$

By relabeling the equivalence classes as $[(n, 0)]_\sim =: n_\Z$ and $[(0, n)]_\sim =: (-n)_\Z$, we get the familiar form for the integers $\Z := \Set{ n }_{n=-\infty}^\infty$. The set of $n$-multiples for $n\in\N$ is written

$$
  n\Z = \Set{na | a\in\Z}
$$

## Addition

Addition of integers can be defined in terms of addition of natural numbers within equivalence classes

$$
  [(a, b)]_\sim + [(c, d)]_\sim := [(a + c), b + d)]_\sim
$$

<details>
<summary>Proof</summary>

To prove that this definition of addition of well-defined, consider $\left(\tilde{a}, \tilde{b} \right) \sim (a, b)$ and $\left(\tilde{c}, \tilde{d}\right) \sim (c, d)$. We then need to show that $\left(\tilde{a} + \tilde{c}, \tilde{b} + \tilde{d} \right) \sim (a + c, b + d)$. By definition we have that

$$
\begin{gather*}
  \left(\tilde{a}, \tilde{b}\right) \sim (a, b) \iff \tilde{a} + b = a + \tilde{b} \\
  \left(\tilde{c}, \tilde{d}\right) \sim (c, d) \iff \tilde{c} + d = c + \tilde{d}
\end{gather*}
$$

Combining the equations we get

$$
\begin{gather*}
  \tilde{a} + b + \tilde{c} = a + \tilde{b} + c + \tilde{d} \\
  \iff \tilde{a} + \tilde{b} + b + d = a + c + \tilde{b} + \tilde{d}
\end{gather*}
$$

which we recognize as the definition for the equivalence relation

$$
  \left( \tilde{a} + \tilde{c}, \tilde{b} + \tilde{d} \right) \sim (a + c, b + d)
$$

</details>

The integers together with addition, $(\Z, +)$, forms an Abelian group satisfying
1. commutativity
2. associativity
3. existence of neutral element $0 \in \Z$: $m + 0_\Z = 0$
4. existence of inverse elements: $\forall m \in \Z \; \exists \tilde{m}\in\Z: m + \tilde{m} = 0$

## Multiplication

Multiplication of integers in terms of equivalence classes represents the distributive product $(a - b)\cdot (c - d) = (ac + bd) - (ad + bc)$, which can be reflected with the following definition.

$$
  [(a, b)]_\sim \cdot [(c, d)]_\sim := [(a\cdot c + b \cdot d, a\cdot d + b \cdot c)]_\sim
$$

Multiplication of integers satisfy the following properties
1. commutativity
2. associativity
3. distributivity
4. existence of the neutral element $0 \in \Z$ such that $m \cdot 0_\Z = 0$

## Modular arithmetic

<MathBox title='Congruence' boxType='definition'>
Given an integer $m\in\Z$, called a *modulus*, two integers $a,b\in\Z$ are congruent mod(ulo) $m$ if $a-b$ is divisible by $b$, i.e. if there is an integer $k\in\Z$ such that $a - b = km$. This relation is written

$$
  a \equiv b \mod m
$$

The congruence class modulo $m$, denoted $[a]_m$, is the set of all integers that are congruent modulo $m$, i.e.

$$
  [a]_n = \Set{b\in\Z | a - b = kn,\; k\in\Z}
$$

For $m\in\N_+$, any integer is congruent mod $m$ to exactly one of the numbers $0,1,\dots,m-1$. The set of congruence classes is the quotient set

$$
  \Z_m := \Z / m\Z = \Set{[i]_m}_{i=0}^{n-1}
$$

where $m\Z = \Set{ma | a\in\Z}$ is the set of $m$-multiples.
</MathBox>

<MathBox title='' boxType='definition'>
The integer part of a real number $u\in\R$ is denoted by $\lfloor u \rfloor$ and defined as

$$
  \lfloor u \rfloor := \max\set{z\in\Z | z\leq u}
$$

Likewise, we define

$$
  \lceil u \rceil := \min\set{z \in Z | z\leg u}
$$

For $a\in Z$, the remainder of $a$ after division by $N \in\N$ is denoted by $a\mod N$ and is defined as

$$
\begin{equation*}
  a\mod N := a - \left\lfloor \frac{a}{N} \right\rfloor N
\tag{\label{equation-1}}
\end{equation*}
$$
</MathBox>

<MathBox title='' boxType='proposition'>
1. For $a,b\in\Z$ and $N\in\N$ it follows that 
$$
\begin{equation*}
  a \mod N = b \mod N \iff (a - b) \mod N = 0
\tag{\label{equation-2}}
\end{equation*}
$$
2. For a $a, N\in\N$ with $a > N$ it follows that 
$$
\begin{equation*}
  a \mod N < \min\Set{\frac{a}{2}, N}
\tag{\label{equation-3}}
\end{equation*}
$$

<details>
<summary>Proof</summary>

**(1):** To show $\implies$, note that from $\eqref{equation-1}$, we have

$$
  a\mod N = b\mod N \implies a - \left\lfloor \frac{a}{N} \right\rfloor N = b - \left\lfloor \frac{b}{N} \right\rfloor N
$$

and it follows that $N$ divides $a - b$, which implies $(a - b) \mod N = 0$.

To show $\impliedby$, let $(a - b) \mod N = 0$. Then it follows from $\eqref{equation-1}$ that there exists a $z\in\Z$ such that $a - b = z N$. Consequently,

$$
\begin{align*}
  b \mod N =& b - \left\lfloor\frac{b}{N}\right\rfloor N \\
  =& a - zN - \left\lfloor\frac{a - zN}{N}\right\rfloor N \\
  =& a - \left\lfloor\frac{a}{N}\right\rfloor \\
  =& a \mod N
\end{align*}
$$

**(2)** For any $x\in\R$ we have

$$
  0 \leq x - \lfloor x \rfloor < 1
$$

such that $\frac{a}{N} - \left\rfloor\frac{a}{N}\right\rfloor < 1$ and thus

$$
  a\mod N = a - \left\lfloor\frac{a}{N}\right\rfloor N < N
$$

On the other hand, note that $x > 1$ implies $\frac{1}{2} x < \lfloor x \rfloor$. Because $a > N$ this in turn implies $\frac{1}{2}\frac{a}{N} < \left\lfloor\frac{a}{N}\right\rfloor$ from which it follows that $\frac{a}{2} < \left\lfloor\frac{a}{N}\right\rfloor$ and thus

$$
  a\mod N = a - \left\lfloor\frac{a}{N} N < \frac{a}{2}
$$
</details>
</MathBox>

<MathBox title='' boxType='definition'>
For $a, N \to\infty$ the number of computational steps required for the calculation of $a\mod N$ scales as $O(\log_2^2 [\max\set{a,N}])$.

<details>
<summary>Proof</summary>

Because of $\eqref{equation-1}$, the computational effort to calculate $a\mod N$ is given by

- the number of operations required for dividing $a$ by $N$ and determining $\left\lfloor\frac{a}{N}\right\rfloor$, which is of order $O(\log_2^2 [\max\set{a,N}])$
- $+$ the number of operations for the multiplication $\left\lfloor\frac{a}{N}\right\rfloor$ with $N$, which is of order $O(\log_2^2 [\max\set{a,N}])$
- $+$ the number of operations for subtracting $\left\lfloor\frac{a}{N}\right\rfloor N$ from $a$, which is of order $O(\log_2^2 [\max\set{a,N}])$

From properties of the big-O symbol, it follows that the number of operations to calculate $a\mod N$ is of order $O(\log_2^2 [\max\set{a,N}])$.
</details>
</MathBox>

<MathBox title='' boxType='definition'>
If, for $a,b\in\Z$, there is a $z\in\Z$, such that $b = za$, then $a$ *divides* b (or $b$ is *divisible* by $a$). If no such $z$ exists, $a$ does not divide $b$. These two exclusive cases are described by the following notations

$$
\begin{align*}
  a\mid b :\iff& \exists z\in\Z : b = za \\
  a\nmid b :\iff& \not\exists z\in\Z : b = za 
\end{align*}
$$

For integers $a_i = \Z$ with $i\in\set{1,\dots,n}$ and $\sum_{i=1}^n |a_i| \neq 0$, we define the *greatest common divisor* as

$$
  \gcd(a_1,\dots,a_n) := \max\set{k\in\Z : k\mid a_i,\; \forall a_i}
$$

In case $\prod_{i=1}^n |a_i| \neq 0$, we define the *smallest common multiple* as

$$
  \operatorname{scm}(a_1,\dots,a_n) := \min\set{k\in\Z : a_i \mid k, \; \forall a_i}
$$

For $a \neq 0$ we define $\gcd(a,0) = a$. If $a$ and $b$ have no common divisor other than $1$, that is, if

$$
  \gcd(a,b) = 1
$$

then $a$ and $b$ are *coprimes*.
</MathBox>

<MathBox title='Extended Euclid algorithm' boxType='theorem'>
Let $a, b \in\N$. Define

$$
\begin{align*}
  r_{-1} :=& \max\set{a,b}, \quad r_0 :=& \min\set{a,b} \\
  s_{-1} :=& 1, \quad s_0 :=& 0 \\
  t_{-1} :=& 0, \quad t_0 :=& 1
$$

and for every $j\in\N$ with $r_{j-1} > 0$

$$
\begin{align*}
  r_j :=& r_{j-2} \mod r_{j-1} \tag{\label{equation-4}} \\
  s_j :=& s_{j-2} - \left\lfloor\frac{r_{j-2}}{r_{j-1}}\right\rfloor s_{j-1} \\
  t_j :=& t_{j-2} - \left\lfloor\frac{r_{j-2}}{r_{j-1}}\right\rfloor t_{j-1}
\end{align*}
$$

Then $r_j < r_{j-1}$ holds and there is an $n\in\N$ after which the sequence terminates, that is, for which

$$
\begin{equation*}
  r_{n+1} = 0
\tag{\label{equation-5}}
\end{equation*}
$$

Furtermore, one has

$$
\begin{align*}
  r_n =& \gcd(a,b) \tag{\label{equation-6}} \\
  n \leq& 2\min\set{\log_2 (a), log_2 (b)} + 1 \tag{\label{equation-7}} \\
  r_{-1} s_n + r_0 t_n =& \gcd(a,b) \tag{\label{equation-8}}
\end{align*}
$$

<details>
<summary>Proof</summary>

Since we know from $\eqref{equation-3}$ that $u \mod v < v$, if follows from the definition $\eqref{equation-4}$ of the $r_j$ that $0 \leq r_j \leq r_{j-1}$, that is, the $r_j$ are strictly decreasing with increasing $j$. Hence, there must exist an $n\in\N_+$ with $n\leq\min\set{a,b}$, $r_n > 0$ and $r_{n+1} = 0$. This proves $\eqref{equation-5}$.

In order to show $\eqref{equation-5}$, we first prove by descending induction that for all $j\in\set{0,\dots,n+1}$ a $z_{n-j} \in\N_+$ exists such that

$$
\begin{equation*}
  r_{n-1} = z_{n-j} r_n
\tag{\label{equation-9}}
\end{equation*}
$$

For the induction hypothesis, let $n\in\N$ be such that $r_n > 0$ but $r_{n+1} = 0$. From $\eqref{equation-4}$, if follows that

$$
  0 = r_{n+1} = r_{n-1} \mod r_n = r_{n-1} - \left\lfloor\frac{r_{n-1}}{r_n} \right\rfloor r_n
$$

Consequently, there exists a $z_{n-1} := \left\lfloor\frac{r_{n-1}}{r_n} \right\rfloor \in\N_+$ that satisfies

$$
  r_{n-1} = z_{n-1} r_n
$$

Furthermore, from $\eqref{equation-4}$ it follows that $r_n = r_{n-2} \mod r_{n-1}$ and thus

$$
\begin{align*}
  r_{n-2} =& r_n + \left\lfloor\frac{r_{n-2}}{r_{n-1}}\right\rfloor r_{n-1} \\
  =& \left(\underbrace{:= z_n} + \left\lfloor\frac{r_{n-2}}{r_{n-1}}\right\rfloor z_{n-1} \right)r_n \\
  =& z_{n-2} r_n
\end{align*}
$$

for $z_{n-2} \in\N$. This proves $\eqref{equation-9}$ for $j\in\set{1,2}$. For the induction step, we will show that if there exist $z_{n-(j-1)}, z_{n-j} \in\N$ such that

$$
\begin{equation*}
\begin{split}
  r_{n - (j - 1)} =& z_{n - (j - 1)} r_n \\
  r_{n-j} = z_{n-j} r_n
\end{split}
\tag{\label{equation-10}}
\end{equation*}
$$

Then there exists $z_{n-(j+1)}\in\N_+$ satisfying

$$
  r_{n-(j-1)} = z_{n - (j+1)} r_n
$$

From the definition $\eqref{equation-4}$ of $r_{n-(j-1)}$ and the assumptions $\eqref{equation-10}$ it follows that

$$
\begin{align*}
  r_{n - (j + 1)} =& r_{n - (j-1)} + \left\lfloor\frac{r_{n - (j + 1)}}{r_{n-j}}\right\rfloor r_{n-j} \\
  =& \underbrace{\left(z_{n-(j-1) + \left\lfloor\frac{r_{n-(j+1)}}{r_{n-j}}\right\rfloor} z_{n-j} \right)}_{:= z_{n - (j + 1)}} r_n \\
  =& z_{n - (j+1)} r_{n-1}
\end{align*}
$$

This completes the inductive proof of $\eqref{equation-9}$. Hence, there xists $z_0, z_{-1} \in\N_+$ such that

$$
\begin{align*}
  \min\set{a,b} =& r_0 = z_0 r_n \\
  \max\set{a,b} =& r_{-1} = z_{-1} r_n
\end{align*}
$$

and $r_n$ is a common divisor of $a$ and $b$.

To show that $r_n$ is the greatest such divisior, suppose $g$ is alos a common divisor of $a$ and $b$. Then define $\tilde{a} := a/g \in \N_0$ and $\tilde{b} := b/g \in\N_+$. Applying the algorithm to $\tilde{a}$, $\tilde{b}$ generates $\tilde{r}_j := r_j /g$ and thus $\tilde{r}_n = r_n / g \in\N_+$. In other words, any common divisor of $a$ and $b$ also divides $r_n$. Consequently, $r_n$ is the greatest common divisor of $a$ and $b$. This completes $\eqref{equation-5}$.

To prove $\eqref{equation-6}$, we note that since $r_j < r_{j-1}$, we can apply $\eqref{equation-3}$ to $\eqref{equation-4}$. This implies

$$
  r_j < \min\Set{\frac{r_{j-2}}{2}, r_{j-1}}
$$

Repeated application of this yields

$$
\begin{align*}
  r_{2k - 1} < \frac{r_{2k - 3}}{2} <\cdots < \frac{r_{-1}}{2^k} =& \frac{\max\set{a,b}}{2^k} \\
  r_{2k} < \frac{r_{2k - 2}}{2} <\cdots < \frac{r_0}{2^k} =& \frac{\min\set{a,b}}{2^k}
\end{align*}
$$

Because of $r_{2k+1} < r_{2k} < r_{2k-1}$, we then have

$$
  r_{2k + 1} < r_{2k} < \min\Set{\frac{a}{2^k}, \frac{b}{2^k}}
$$

and thus

$$
  r_j < \frac{\min\set{a,b}}{2^{\lfloor j/2 \rfloor}}
$$

Consequently,

$$
  \left\lfloor\frac{j}{2}\right\rfloor \geq \min\set{\log_2  (a), \log_2 (b)} \implies r_j = 0
$$

Since $n$ per definition in $\eqref{equation-5}$ is the biggest number that still satisfies $r_n > 0$, it follows that

$$
  \left\lfloor\frac{n}{2}\right\rfloor < \min\set{\log_2 (a), \log_2 (b)}
$$

This in turn implies

$$
  n < 2\min\set{\log_2 (a), \log_2 (b)} + 1
$$

In order to prove $\eqref{equation-8}$, we show, again by a two-step induction, that

$$
\begin{equation*}
  r_{-1} s_j + r_0 t_j = r
\tag{\label{equation-11}}
\end{equation*}
$$

The induction hypothesis is given by $j\in\set{-1,0}$ because the defining equations $\eqref{equation-6}$-$\eqref{equation-8}$ imply

$$
\begin{align*}
  r_{-1} s_{-1} + r_0 t_{-1} =& r_{-1} \\
  r_{-1} s_0 + r_0 t_0 = r_0
\end{align*}
$$

In order to verify the induction step from $j$ to $j+1$, we suppose that $\eqref{equation-11}$ holds for $j$ and $j-1$. Then it follows that

$$
\begin{align*}
  r_{-1} s_{j+1} + r_0 t_{j+1} =& r_{-1} \left(s_{j-1} - \left\lfloor \frac{r_{j-1}}{r_j} \right\rfloor s_j \right) + r_0 \left(t_{j-1} - \left\lfloor \frac{r_{j-1}}{r_j} \right\rfloor t_j \right) \\
  =& \underbrace{r_{-1} s_{j-1} + r_0 t_{j-1}}_{r_{j-1}} + \left\lfloor\frac{r_{j-1}}{r_j}\right\rfloor \underbrace{(r_{-1} s_j + r_0 t_j)}_{=r_j} \\
  =& r_{j-1} - \left\lfloor\frac{r_{j-1}}{r_j} \right\rfloor r_j = r_{j+1}
\end{align*}
$$

This proves $\eqref{equation-11}$ and the claim $\eqref{equation-8}$ from the case $j = n$.
</details>
</MathBox>

# Rational numbers ($\mathbb{Q}$)

The rational numbers can be constructed as the equivalence classes of ordered pairs of integers, $(a, b) \in \Z \times \Z\backslash\Set{0}$, representing the division $a/b$ (without explicitly defining division). This can be formulated by an equivalence relation $\sim$ obeying

$$
  (x,y) \sim (a,b) \iff x \cdot b = a \cdot y \quad\left(\iff \frac{x}{y} = \frac{a}{b}\right)
$$

The set of rational numbers $\Z$ is then defined as the quotient set imposed by this equivalence relation

$$
  \mathbb{Q} := \Z \times \Z\backslash\Set{ [(a, b)]_\sim | (a, b) \in \Z \times \Z\backslash\Set{0} }
$$

We get the familiar form for the rational numbers by relabelling the equivalence classes as $[(a, b)]_\sim =: \left(\frac{a}{b}\right)_\mathbb{Q}$ and $[(n, 1)]_\sim := n_\mathbb{Q} = n_\Z$. Using this notation, we can write

$$
  \mathbb{Q} := \Set{ \frac{a}{b} | a \in \Z,\; b \in \Z\backslash\Set{0} }
$$

The set of rational numbers forms a field satisfying
1. $(\mathbb{Q}, +)$ is an Abelian group
2. $(\mathbb{Q}\backslash\Set{0}, \cdot)$ is an Abelian group
3. distributive law

## Multiplication

Multiplication of rational numbers is defined as

$$
  [(a, b)]_\sim \cdot [(c, d)]_\sim := [(a \cdot c, b \cdot d)]_\sim \iff \frac{a}{b}\cdot \frac{c}{d} = \frac{a\cdot b}{c\cdot b}
$$

The rational numbers together with multiplication, $(\mathbb{Q}\backslash\Set{0}, \cdot)$ forms an Abelian group satisfying
1. commutativity
2. associativity
3. existence of the neutral element $1 \in \mathbb{Q}$ such that $q \cdot 1_\mathbb{Q}\backslash\Set{0} = q$
4. existence of inverse elements: $\forall \frac{a}{b} \in \mathbb{Q}\backslash\Set{0} \; \exists \frac{b}{a}\in\mathbb{Q}\backslash\Set{0}: \frac{a}{b} \cdot \frac{b}{a} = 1_\mathbb{Q}$

## Addition

Addition of rational numbers is defined as

$$
\begin{align*}
  \frac{a}{b} + \frac{c}{d} :=& \frac{a\cdot d + c \cdot b}{b\cdot d} \\
  =& \left( \frac{a\cdot d}{1} + \frac{c\cdot b}{1} \right)\frac{1}{b\cdot d} \\
  =& \frac{a\cdot d}{1}\cdot\frac{1}{b\cdot d} + \frac{c\cdot b}{1}\cdot\frac{1}{b\cdot d} \\
  =& \frac{a}{b}\cdot\frac{d}{d} + \frac{c}{d}\cdot\frac{b}{b}
\end{align*}
$$

The rational numbers together with addition, $(\mathbb{Q}, +)$ form an Abelian group satisfying
1. commutativity
2. associativity
3. existence of the neutral element $0 \in \mathbb{Q}$ such that $q + 0_\mathbb{Q} = q$
4. existence of inverse elements: $\forall q \in \mathbb{Q} \quad \exists \tilde{q} \in\mathbb{Q}\backslash\Set{0}: q + \tilde{q} = 0_\mathbb{Q}$

## Ordering

For two rational numbers $\frac{a}{b}, \frac{c}{d} \in \mathbb{Q}$ with $b, d > 0$ we have that 

$$
    \frac{a}{b} \leq \frac{c}{d} \iff a\cdot d \leq c \cdot b
$$

Ordering of rational numbers has the following properties for all $q, r, s \in \mathbb{Q}$
1. reflexivity: $q \leq q$
2. anti-symmetry: $q \leq r \land r \leq q \implies q = r$
3. transitivity: $q \leq s \land s \leq r \implies q \leq r$
4. Archimedean property: for all $q, \epsilon \in \mathbb{Q}$ with $q, \epsilon > 0$ there is a $n\in\N_0$ such that $n\cdot \epsilon > q$

# Real numbers ($\R$)

## Rational Cauchy sequence

<MathBox title='Rational Cauchy sequence' boxType='definition'>
A rational sequence $\left( x_n \right)_{n\in\N}$ with $x_n \in \mathbb{Q}$ is called Cauchy if

$$
  \forall \epsilon \in \mathbb{Q} \quad \exists N\in\N \quad n,m \in \N : \left( \epsilon > 0 \; \land \; n, m \geq N \; \implies \left| x_n - x_m \right| < \epsilon \right)
$$

or in short

$$
  \forall \epsilon > 0 \; \exists N\in\N \; \forall n, m \geq N: \; \left| x_n - x_m \right| < \epsilon
$$
</MathBox>

<MathBox title='Rational convergent sequence' boxType='definition'>
A rational sequence $\left( x_n \right)_{n\in\N}$ is convergent if 

$$
  \exists a \in \mathbb{Q} \quad \forall \epsilon > 0 \quad \exists N \in\N \quad \forall n \geq N : \left| x_n - a \right| < \epsilon
$$

In this case, $a$ is the limit of $\left( x_n \right)_{n\in\N}$.
</MathBox>

<MathBox title='Proposition' boxType='proposition'>
A rational convergent sequence is also Cauchy.
<details>
<summary>Proof</summary>

Suppose $\left( x_n \right)_{n\in\N}$ is a convergent sequence with limit $a$, let $\epsilon > 0$. For convenience we set $\epsilon' := \frac{\epsilon}{2} > 0$. Since $\left( x_n \right)_{n\in\N}$ is convergent, there is a $N \in \N$ such that

$$
  \forall n\geq N: \left| x_n - a \right| < \epsilon'
$$

Therefore for all $n, m \geq N$ we have

$$
  \left| x_n - x_m \right| = \left| x_n - a + a - x_m \right| \tleq \underbrace{\left| x_n - a \right|}_{<\epsilon'} + \underbrace{\left| a - x_m \right|}_{<\epsilon'} < 2\epsilon' = \epsilon
$$

Hence, $\left(x_n \right)_{n\in\N}$ is also a Cauchy sequence. 
</details>
</MathBox>

## Axiomatic definition

A non-empty set $\R$ together with the operations addition, multiplication and ordering is called the real numbers if it satisfies
1. $(\R, +, 0)$ is an Abelian group
2. $(\R\backslash\Set{0}, \cdot, 1)$ is an Abelian group
3. Distributive law: $a\cdot(b + c) = a\cdot b + a\cdot c$ for $a,b,c\in\R$
4. Archimedean order ($\geq$ defines a total order compatible with $+$ and $\cdot$, and satisfying the Archimedean property)
5. Completeness axiom: Every Cauchy sequence is a convergent sequence (completion of $\mathbb{Q}$)

## Construction from the rational numbers (completion)

The real numbers can be constructed as a completion of the rational numbers wrt. the metric $d(x,y) = |x - y|\; \forall x,y \in\mathbb{Q}$ by letting all Cauchy sequences converge. The set of all Cauchy sequences on the rational numbers is denoted
$$
  \mathcal{C} := \Set{ \left(x_n \right)_{n\in\N} | \forall n \in \N : x_n \in \mathbb{Q} \textrm{ and } \left(x_n \right)_{n\in\N} \textrm{ is a Cauchy sequence} }
$$

For two Cauchy sequences $(a_n)_{n\in\N}, (b_n)_{n\in\N}$ we can define an equivalence relation on $\mathcal{C}$ by
$$
  (a_n)_{n\in\N} \sim (b_n)_{n\in\N} :\iff (a_n - b_n)_{n\in\N} \xrightarrow{n\to\infty} 0
$$

From this equivalence relation, we can construct equivalence classes uniquely representing all points on the real number line
$$
  \left[ \left(x_n \right)_{n\in\N} \right]_\sim := \Set{ \left(a_n \right)_{n\in\N} | \left(a_n \right)_{n\in\N} \sim \left(x_n \right)_{n\in\N} }
$$

<MathBox title='Real numbers' boxType='definition'>
The real numbers is the set 
$$
  \R := \mathcal{C}\backslash\sim := \Set{ \left[ \left(x_n \right)_{n\in\N} \right]_\sim | \left(x_n \right)_{n\in\N} \in \mathcal{C} }
$$

together with the operations
- Addition
$$
  \left[ \left(a_n \right)_{n\in\N} \right]_\sim + \left[ \left(b_n \right)_{n\in\N} \right]_\sim := \left[ \left(a_n + b_n \right)_{n\in\N} \right]_\sim
$$
- Multiplication
$$
  \left[ \left(b_n \right)_{n\in\N} \right]_\sim \cdot \left[ \left(b_n \right)_{n\in\N} \right]_\sim := \left[ \left(a_n \cdot b_n \right)_{n\in\N} \right]_\sim
$$
- Ordering
$$
  \left[ \left(a_n \right)_{n\in\N} \right]_\sim < \left[ \left(b_n \right)_{n\in\N} \right]_\sim :\iff \exists \delta > 0 \quad \exists N \in\N \quad \forall n\geq N: \delta < b_n - a_n
$$
</MathBox>

## Extended real numbers

<MathBox title='Extended real numbers' boxType='proposition'>
The extended real number line include the infinite points and is denoted $\R* = \R\cup\Set{-\infty, \infty}$. In the extended topology of $\R*$ the following is defined for $a\in\R$
- $(a,\infty]$ is an open neighbourhood of $\infty$
- $[-\infty, a)$ is an open neighbourhood of $-\infty$

This topology results in the two-point compactification of $\R$.
</MathBox>

<MathBox title='Arithmetic on extended real numbers' boxType='proposition'>
The following arithmetic rules are defined for the extended real numbers $\R*$
1. if $a\in(0,\infty]$ then $a\cdot\infty = \infty$ and $a\cdot(-\infty) = -\infty$
2. if $a\in[-\infty,0)$ then $a\cdot\infty = -\infty$ and $a\cdot(-\infty) = \infty$
3. $0\cdot\infty = 0$ and $0\cdot(-\infty) = 0$
4. if $a\in\R$ then $a+\infty = \infty$ and $a+(-\infty) = -\infty$
5. $\infty + \infty = \infty$ and $-\infty + (-\infty) = -\infty$

Note that $\infty - \infty$ is not defined
</MathBox>

# Complex numbers ($\mathbb{C}$)

A complex number is an ordered pair of real numbers of the form  $\mathbb{C} \ni z = x + iy := (x, y) \in \R\times\R$ where

- $x = \Re(z)$ is the real part
- $y = \Im(z)$ is the imaginary part
- $i = \sqrt{-1}$ is the imaginary unit satisfying $i^2 = -1$

The following rules for addition and multiplication are imposed on complex numbers

- Addition (real and imaginary parts added separately): 

$$
  z + w = (x + iy) + (u + iv) = (x + u) + i(y + v)
$$

- Multiplication (distributive): 

$$
\begin{align*}
  z \cdot w &= (x + iy) \cdot (u + iv) \\ 
  &= xu + iyu + ixv + \underbrace{i^2}_{=-1} y v \\
  &= (xu - yv) + i(yu + xv)
\end{align*}
$$

Note that complex addition is identical to vector addition in $\R^2$.

In particular, the square of the imaginary unit $i$ equals $-1$

$$
\begin{align*}
  i^2 &= i\cdot i = (0 + i)\cdot (0 + i) \\
  &= (0 \cdot 0 - 1\cdot 1) + i(0\cdot 1 + 1\cdot 0) = -1
\end{align*}
$$

The set of complex numbers $\mathbb{C}$ defines an unordered field where the operations of addition and mulitiplication satisfy the following
- Associativity, distributivity and commutativity
- Additive and multiplicative identities
- Additive and multiplicative inverses
- There is no Archimedean order

This implies that
- $(\mathbb{C}, +, 0)$ is an Abelian group
- $(\mathbb{C} \backslash \Set{ 0 }, \cdot, 1)$ is an Abelian group

## Operations on complex numbers

### Absolute value (modulus)
The absolute value of a complex number $z = x + iy$ is given by its length (Euclidean norm)

$$
  |z| := \sqrt{x^2 + y^2} = \sqrt{\Re(z)^2 + \Im(z)^2}
$$

### Complex conjugation
The complex conjugate of a complex number $z = x + iy$ is given by $\bar{z} = x - iy$. Geometrically, the complex conjugate reflect a complex number about the real axis, i.e. $\Im\left(\bar{z}\right) = -\Im(z)$. Conjugating twice gives the original complex number, i.e. $\bar{\bar{z}} = z$. The product of a complex number and its conjugate gives the square of its length

$$
  z\cdot\bar{z} = (x + iy)\cdot(x - iy) = x^2 + ixy - ixy - i^2y^2 = x^2 + y^2 = |z|^2
$$

The real and imaginary parts of a complex number can be extracted using the conjugation

$$
  \Re(z) = \frac{z + \bar{z}}{2} \quad \Im(z) = \frac{z - \bar{z}}{2}
$$

Conjugation distributes over the basic complex arithmetic operations

$$
\begin{gather*}
  \overline{z \pm w} = \bar{z} \pm \bar{w} \\
  \overline{z \cdot w} = \bar{z} \cdot \bar{w} \\
  \overline{z/w} = \bar{z}/\bar{w}
\end{gather*}
$$

## Polar representation
In addition to its Cartesian representation, $z = x + iy$, a complex number can be represented in a polar form

$$
  z = r(\cos\phi + i \sin\phi) = re^{i\phi}
$$

where $r = |z|$ is the absolute value of $z$ and $\phi := \arg(z) = \Set{ \mathrm{Arg}(z) + 2\pi n | n \in \Z }$ is the argument of $z$ giving the angle of $z$ with respect to the positive real axis. The principal argument $\mathrm{Arg}(z) \in [0, 2\pi)$ can be calculated using the tangent half-angle formula 

$$
  \mathrm{Arg}(z) = \mathrm{Arg}(x + iy) = \begin{cases} 
      2\arctan\left( \frac{y}{\sqrt{x^2 + y^2} + x} \right) &\quad x > 0,\, y \geq 0 \\
      \pi &\quad x < 0,\, y = 0 \\
      \textrm{undefined} &\quad x = 0,\, y = 0
  \end{cases}
$$

# Quaternions ($\mathbb{H}$)

A quaternion is an ordered 4-tuple of real numbers of the form $q = a + b\hat{\imath} + c\hat{\jmath} + d\hat{k} \in \mathbb{H}$ where $a,b,c,d\in\R$ and $\hat{\imath}, \hat{\jmath}, \hat{k}$ are imaginary basis elements satisfying the quaternion equations

$$
  \hat{\imath}^2 = \hat{\jmath}^2 = \hat{k}^2 = \hat{\imath}\hat{\jmath}\hat{k} = -1   
$$

from which it follows that

$$
\begin{align*}
  \hat{\imath}\hat{\jmath} &= \hat{k} = -\hat{\jmath}\hat{\imath} \\
  \hat{\jmath}\hat{k} &= \hat{i} = -\hat{\jmath}\hat{k} \\
  \hat{k}\hat{\imath} &= \hat{\jmath} = -\hat{\imath}\hat{k}
\end{align*}
$$

<LatexFigure width={25} src='/fig/quaternion_multiplication.svg' alt=''
  caption='Mnemonic for multiplying quaternion basis elements'
>
```latex
\documentclass[tikz]{standalone}
\usepackage{amsmath}
\usepackage{tikz}

\begin{document}

\begin{tikzpicture}[->]
  \node (o) at (0,0) {\Huge{$+$}};
  \node (i) at (90:1cm)  {$\hat{\imath}$};
  \node (j) at (-30:1cm) {$\hat{\jmath}$};
  \node (k) at (210:1cm) {$\hat{k}$};

  \draw (70:1cm)  arc (70:-10:1cm);
  \draw (-50:1cm) arc (-50:-130:1cm);
  \draw (190:1cm) arc (190:110:1cm); 
\end{tikzpicture}

\end{document}
```
</LatexFigure>

The basis elements can be intepreted as an orthonormal basis for $\R^3$. As such a quaternion can be decomposed into a scalar $q_0$ and a vector $\mathbf{q} = (q_1, q_2, q_3)\in\R^3$, i.e.

$$
  q = q_0 + \mathbf{q} = q_0 + q_1\hat{\imath} + q_2\hat{\jmath} + q_3\hat{k}
$$

The set of quaternions forms a 4-dimensional vector space over the real numbers with $\Set{1,\hat{\imath},\hat{\jmath},\hat{k}}$ as basis. Thus quaternions satisfy componentwise addition

$$
\begin{gather*}
  &(a_1 + b_1\hat{\imath} + c_1\hat{\jmath} + d_1\hat{k}) + (a_2 + b_2\hat{\imath} + c_2\hat{\jmath} + d_2\hat{k}) \\
  &= (a_1 + a_2) + (b_1 + b_2)\hat{\imath} + (c_1 + c_2)\hat{\jmath} + (d_1 + d_2)\hat{k}
\end{gather*}
$$

or in quaternion vector notation

$$
  p + q = (p_0 + \mathbf{p}) + (q_0 + \mathbf{q}) = (p_0 + q_0) + (\mathbf{p} + \mathbf{q})
$$

and componentwise scalar multiplication

$$
  \lambda(a + b\hat{\imath} + c\hat{\jmath} + d\hat{k}) = \lambda a + (\lambda b)\hat{\imath} + (\lambda c)\hat{\jmath} + (\lambda d)\hat{k}
$$

## Operations on Quaternions

### Multiplication rules for basis elements

The defining equations for quaternions produce a set multiplication rules for the basis elements. From the equation $\hat{\imath}\hat{\jmath}\hat{k} = -1$, we get that

$$
\begin{split}
  (\hat{\imath}\hat{\jmath}\hat{k})\hat{k} &= (-1)\hat{k} \\
  \hat{\imath}\hat{\jmath}(\hat{k}\hat{k}) &= (-1)\hat{k} \\
  \hat{\imath}\hat{\jmath}(-1) &= (-1)\hat{k} \\
  \hat{\imath}\hat{\jmath} &= \hat{k}
\end{split} \quad \begin{split} 
  \hat{\imath}(\hat{\imath}\hat{\jmath}\hat{k}) &= \hat{\imath}(-1) \\
  (\hat{\imath}\hat{\imath})\hat{\jmath}\hat{k} &= \hat{\imath}(-1) \\
  (-1)\hat{\jmath}\hat{k} &= \hat{\imath}(-1) \\
  \hat{\jmath}\hat{k} &= \hat{\imath}
\end{split} \quad \begin{split} 
  \hat{\imath}(\hat{\imath}\hat{\jmath}\hat{k})\hat{k} &= \hat{\imath}(-1)\hat{k} \\
  (\hat{\imath}\hat{\imath})\hat{\jmath}(\hat{k}\hat{k}) &= -\hat{\imath}\hat{k} \\
  (-1)\hat{\jmath}(-1) &= -\hat{\imath}\hat{k} \\
  \hat{\imath}\hat{k} &= -\hat{\jmath}
\end{split}
$$

From $\hat{\imath}\hat{\jmath} = \hat{k}$ and $\hat{\jmath}\hat{k} = \hat{\imath}$, we get that

$$
\begin{split}
  (\hat{\imath}\hat{\jmath})\hat{\jmath} =& \hat{k}\hat{\jmath} \\
  \hat{\imath}(\hat{\jmath}\hat{\jmath}) =& \hat{k}\hat{\jmath} \\
  \hat{\imath}(-1) =& \hat{k}\hat{\jmath} \\
  \hat{k}\hat{\jmath} =& -\hat{\imath}
\end{split} \quad \begin{split}
  \hat{\jmath}(\hat{\jmath}\hat{k}) =& \hat{\jmath}\hat{\imath} \\
  (\hat{\jmath}\hat{\jmath})\hat{k} =& \hat{\jmath}\hat{\imath} \\
  (-1)\hat{k} =& \hat{\jmath}\hat{\imath} \\
  \hat{\jmath}\hat{\imath} =& -\hat{k}
\end{split} \quad \begin{split}
  \hat{\jmath}(\hat{\jmath}\hat{k}) =& \hat{\jmath}(\hat{\imath}) \\
  (\hat{\jmath}\hat{\jmath})\hat{k}\hat{\imath} =& \hat{\jmath}(\hat{\imath}\hat{\imath}) \\
  (-1)\hat{k}\hat{\imath} =& \hat{\jmath}(-1) \\
  \hat{k}\hat{\imath} =& \hat{\jmath}
\end{split}
$$

#### Multiplication table

| $\times$ | $\hat{\imath}$ | $\hat{\jmath}$ | $\hat{k}$ |
|---|---|---|---|
| $\boldsymbol{\hat{\imath}}$ | $-1$ | $\color{red}{\hat{k}}$ | $\color{cyan}{-\hat{\jmath}}$ |
| $\boldsymbol{\hat{\jmath}}$ | $\color{red}{-\hat{k}}$ | $-1$ | $\color{green}{\hat{\imath}}$ |
| $\boldsymbol{\hat{\jmath}}$ | $\color{cyan}{-\hat{\jmath}}$ | $\color{green}{-\hat{\imath}}$ | $-1$ |


### Hamilton product

The product of two quaternions $p = p_0 + \mathbf{p}$ and $q = q_0 + \mathbf{q}$, called the Hamilton product, is given by the quaternion equations and the distributive law

$$
\begin{align*}
  p q =& (p_0 + p_1\hat{\imath} + p_2\hat{\jmath} + p_3\hat{k}) \cdot (q_0 + q_1\hat{\imath} + q_2\hat{\jmath} + q_3\hat{k}) \\
  =& p_0 q_0 + p_1 q_1\hat{\imath} + p_0 q_2\hat{\jmath} + p_0 q_3\hat{k} \\
    &+ p_1 q_0\hat{\imath} + p_1 q_1\hat{\imath}^2 + p_1 q_2\hat{\imath}\hat{\jmath} + p_1 q_3\hat{\imath}\hat{k} \\
    &+ p_2 q_0\hat{\jmath} + p_2 q_1\hat{\jmath}\hat{\imath} + p_2 q_2\hat{\jmath}^2 + p_2 q_3\hat{\jmath}\hat{k} \\
    &+ p_3 q_0\hat{k} + p_3 q_1\hat{k}\hat{\imath} + p_3 q_2\hat{k}\hat{\jmath} + p_3 q_3\hat{k}^2 \\
  =& p_0 q_0 - p_1 q_1 + p_2 q_2 - p_3 q_3 \\
    &+ (p_0 q_1 + p_1 q_0 + p_2 q_3 - p_3 q_2)\hat{\imath}\\
    &+ (p_0 q_2 - p_1 q_3 + p_2 q_0 + p_3 q_1)\hat{\jmath}\\
    &+ (p_0 q_3 + p_1 q_2 - p_2 q_1 + p_3 q_0)\hat{k} \\
  =& p_0 q_0 - p_1 q_1 + p_2 q_2 - p_3 q_3 \\
    &+ p_0 q_1 \hat{\imath} + p_0 q_2 \hat{\jmath} + p_0 q_3 \hat{k} \\
    &+ q_0 p_1 \hat{\imath} + q_0 p_2 \hat{\jmath} + q_0 p_3 \hat{k} \\
    &+ (p_2 q_3 - p_3 q_2)\hat{\imath} + (p_1 q_3 - p_3 q_1)\hat{\jmath} + (p_1 q_2 - p_2 q_1)\hat{k} \\
  =& p_0 q_0 - \mathbf{p}\cdot\mathbf{q} + p_0 \mathbf{q} + q_0 \mathbf{p} + \mathbf{p}\times\mathbf{q}
\end{align*}
$$

where $\cdot$ is the Euclidean inner product and $\times$ is the cross product in $\R^3$. The Hamilton product is noncommutative as

$$
\begin{align*}
  q p =& q_0 p_0 - \mathbf{q}\cdot\mathbf{p} + q_0 \mathbf{p} + p_0 \mathbf{q} + \mathbf{q}\times\mathbf{p} \\
  =& p_0 q_0 - \mathbf{p}\cdot\mathbf{q} + p_0 \mathbf{q} + q_0 \mathbf{p} - \mathbf{p}\times\mathbf{q}
\end{align*}
$$

giving the anti-commutative relation $\{p, q\} = p q - q p = 2\mathbf{p} \times \mathbf{q}_2$. 

### Conjugation

The conjugate of a quaternion $q = q_0 + q_1\hat{i} + q_2\hat{\jmath} + q_3\hat{k} = q_0 + \mathbf{q}$ is defined by

$$
  q^* := q_0 - q_1\hat{\imath} + q_2\hat{\jmath} + q_3\hat{k} = q_0 - \mathbf{q}
$$

The conjugate of a quaternion can be expressed with multiplication and addition of quaternions:

$$
  q^* = -\frac{1}{2}(q + \hat{\imath}q\hat{\imath} + \hat{\jmath}q\hat{\jmath} + \hat{k}q\hat{k})
$$

The scalar and vector parts of a quaternion $q = q_0 + \mathbf{q}$ can be extracted using the conjugation

$$
  q_0 = \frac{1}{2}(q + q^*) \quad \mathbf{q} = \frac{1}{2}(q - q^*)
$$

### Norm

The norm of a quaternion is defined by

$$
  \norm{ q} := \sqrt{q^*q} = \sqrt{qq^*} = \sqrt{a^2 + b^2 + c^2 + d^2}
$$

Normalizing a nonzero quaternion gives a unit quaternion $\mathbf{U}_q$ called the versor of $q$

$$
  \mathbf{U}_q = \frac{q}{\norm{ q}}
$$

### Multiplicative inverse
The product of a quaternion with its reciprocal should equal $1$, i.e. $qq^1 = 1$. This can be achieved by defining

$$
  q^{-1} = \frac{1}{\norm{ q}} q^*
$$
