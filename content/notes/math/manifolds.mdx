---
title: 'Manifolds'
subject: 'Mathematics'
showToc: true
---

# Topological space

Topological spaces are an abstraction of metric spaces. 

<MathBox title='Topological space' boxType='definition'>
Let $X$ be a set with power set $\mathcal{P}(X)$. A topology on $X$ is a collection $\mathcal{T}\subseteq\mathcal{P}(X)$ of subsets of $X$, called open subsets, satisfying

1. $\emptyset, X \in \mathcal{T}$
2. $\mathcal{T}$ is closed under arbitrary union: $\mathcal{A}\subseteq\mathcal{T}\implies\bigcup A \in \mathcal{T}$
3. $\mathcal{T}$ is closed under finite intersection: $\mathcal{A}\subseteq\mathcal{T} \land \mathcal{A}\text{ is finite } \implies \bigcap \mathcal{A} \in \mathcal{T}$

The pair $(X, \mathcal{T})$ is called a topological space. A subset $C\subseteq X$ is called closed in $(X,\mathcal{T})$ if its complement is open, i.e. $X\setminus C \in\mathcal{T}$. Note that $X$ and $\emptyset$ are both open and closed.
</MathBox>

A topology can similarly be constructed from collections of closed sets, as captured in the following proposition.

<MathBox title='Closed set topology' boxType='proposition'>
Given a set $X$, then $\mathcal{C}\subseteq\mathcal{P}(X)$ is the collection of closed sets for a topology on $X$ iff

1. $\emptyset, X \in \mathcal{X}$
2. $\mathcal{C}$ is closed under arbitrary intersection: $\mathcal{A}\subseteq\mathcal{C}\implies\bigcap A \in \mathcal{C}$
3. $\mathcal{C}$ is closed under finite union: $\mathcal{A}\subseteq\mathcal{C} \land \mathcal{A}\textrm{ is finite } \implies \bigcup \mathcal{A} \in \mathcal{C}$

<details>
<summary>Proof</summary>

Note that $\mathcal{T} = \Set{U^c | U\in\mathcal{C}}$ defines a collection of open sets that satsify the axioms of a topology
1. since $\emptyset, X\in\mathcal{T}$ and $\emptyset = X^c$, then $\emptyset, X\in\mathcal{C}$
2. for an arbitrary collection $\mathcal{A}\subseteq\mathcal{T}$ we know that $\bigcup\mathcal{A}\in\mathcal{T}$. Taking the complement of the union and applying DeMorgan's law gives
$$
  \left( \bigcup\mathcal{A} \right)^c &= \bigcap \Set{ A^c | A\in\mathcal{A} } \in\mathcal{C}
$$
3. for an arbitrary collection $\mathcal{A}\subseteq\mathcal{T}$, then $\bigcup\mathcal{A}\in\mathcal{T}$. Noting that $\mathcal{A}^c = \Set{A^c | A\in\mathcal{A}\subseteq\mathcal{T}}\subseteq\mathcal{C}$. Applying DeMorgan's law shows that $\mathcal{C}$ is closed under arbitrary intersection
$$
  \left( \bigcup\mathcal{A} \right)^c = \bigcap \Set{ A^c | A\in\mathcal{A} } = \bigcap \mathcal{A}^c \in\mathcal{C}
$$
4. for a finite collection $\mathcal{A}\subseteq\mathcal{T}$, then $\bigcap\mathcal{A}\in\mathcal{T}$. Noting that $\mathcal{A}^c = \Set{A^c | A\in\mathcal{A}\subseteq\mathcal{T}}\subseteq\mathcal{C}$. Applying DeMorgan's law shows that $\mathcal{C}$ is closed under finite union
$$
  \left( \bigcap\mathcal{A} \right)^c = \bigcup \Set{ A^c | A\in\mathcal{A} } = \bigcup \mathcal{A}^c \in\mathcal{C}
$$
</details>
</MathBox>

<MathBox title='Neighbourhood' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a point $x\in X$. A neighbourhood of $x$ is a subset $V\subseteq X$ that includes an open set $U\subseteq X$ containing $x$, i.e.

$$
  x \in U\subseteq V\subseteq X
$$

The neighbourhood $V$ need not be open.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose $(X,\mathcal{T})$ is a topological space. A set $U\subseteq X$ is open if and only if $U$ is a neighbourhood of every $x\in U$.

<details>
<summary>Proof</summary>

If $U$ is open, then it is clearly a neighbourhood of every $x\in U$. Conversely, suppose $U$ is a neighbourhood of every $x\in U$. Then by definition, for every $x\in U$ there is an open set $\x \in U_x \subseteq U$. Then $\bigcup_{x\in U} U_x = U$ is also open.
</details>
</MathBox>

<MathBox title='Closure' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a subset $S\subseteq X$. The closure of $S$, denoted $\mathrm{cl}(S) \equiv \overline{S}$ is the intersection of all closed subsets of $X$ containing $S$

$$
  \overline{S} := \Set{\bigcap C \subseteq X | C\textrm{ is closed and }S\subseteq C }
$$

This is the smallest closed set containing $S$.
1. $\overline{S}$ is closed
2. $S\subseteq\overline{S}$
3. if $C$ is closed and $S\subseteq C$ then $\overline{S}\subseteq C$
</MathBox>

<MathBox title='Interior' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a subset $S\subseteq X$. Then $p\in S$ is called an interior point of $S$ if and only if there is an open set $U\in\mathcal{T}$ such that $p\in U$ and $U \subseteq S$. The interior of $S$, denoted $\mathrm{int}(S) \equiv S^0$, is the set of all interior points of $S$. Equivalently, $\mathrm{Int}(S)$, is defined as the union of all open subsets of $X$ contained in $S$.

$$
  \mathrm{int}(S) := \Set{\bigcup U\subseteq X | U\textrm{ is open and }U\subseteq S }
$$

This set is the largest open subset of $S$:
1. $\mathrm{int}(S)$ is open
2. $\mathrm{int}(S)\subseteq S$
3. if $U$ is open and $U\subseteq S$, then $U\subseteq\mathrm{int}(S)$
</MathBox>

<MathBox title='Exterior' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a subset $S\subseteq X$. Then $p\in S$ is called an extorior point of $S$ if and only if there is an open set $U \in \mathcal{T}$ such that $p \in U$ and $U \subseteq X\setminus S$. The extorior of $S$, denoted $\mathrm{ext}(S)$, is the set of all extorior points of $S$. Equivalently, $\mathrm{ext}(S)$ is the is the union of all open subsets of $X$ contained in $X \setminus S$, i.e. disjoint from $S$.

$$
  \mathrm{ext}(S) := \Set{\bigcup U\subseteq X | U\textrm{ is open and }U\subseteq X\setminus S }
$$

This is the largest open set disjoint from $S$. The exterior is the interior of of the complement of $S$

$$
  \mathrm{ext}(S) = \mathrm{int}(X\setminus S) = X\setminus\overline{S}
$$
</MathBox>

<MathBox title='Boundary' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a subset $S\subseteq X$. Then $p\in S$ is called a boundary point of $S$ if and only if for all open sets $U \in \mathcal{T}$ with $p \in U$ then $U \cap S \neq \emptyset$ and $U \cap (X\setminus S) \neq \emptyset$. The boundary of $S$, denoted $\partial S$, is the set off all boundary points of $S$. Equivalently

$$
  \partial S := \overline{S}\setminus\mathrm{int}(S)
$$
</MathBox>

<MathBox title='Derived set' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space, and consider a subset $S\subseteq X$. Then $p\in S$ is an accumulation point of $S$ if and only if for all open sets $U \in \mathcal{T}$ with $p \in U$ then $U\setminus \Set{ p } \cap S \neq \emptyset$. The derived set of $S$, denoted $S'$, is the set of all accumulation points of $S$.
</MathBox>

## Partial order

<MathBox title='Topological partial order' boxType='definition'>
Suppose that $X$ is a set, and that $\mathcal{S}$ and $\mathcal{T}$ are topologies on $X$. If $\mathcal{S}\subseteq\mathcal{T}$, then $\mathcal{T}$ is finer than $\mathcal{S}$, and $\mathcal{S}$ is coarser than $\mathcal{T}$. *Coarser than* ($\subseteq$) defines a partial order on the collection of topologies on $X$. That is, if $\mathcal{R}, \mathcal{S}, \mathcal{T}$ are topologies on $X$, then this partial order has the following properties
1. reflexivity: $\mathcal{R}$ is coarser than $\mathcal{R}$
2. anti-symmetry: if $\mathcal{R}$ is coarser than $\mathcal{S}$, and $\mathcal{S}$ is coarser than $\mathcal{R}$, then $\mathcal{R} = \mathcal{S}$
3. transitivity: if $\mathcal{R}$ is coarser than $\mathcal{S}$ and $\mathcal{S}$ is coarser that $\mathcal{T}$, then $\mathcal{R}$ is coarser than $\mathcal{T}$
</MathBox>

## Separation

Separation properties refer to the ability to separate points or sets with disjoint open sets. Separated spaces are known as Hausdorff spaces.

<MathBox title='Hausdorff space (separated space)' boxType='definition'>
A topological space $(X, \mathcal{T})$ is called a Hausdorff space if for every pair of distinct points $p, q \in X$, there exist disjoint open subsets $U, V \subseteq X$, ie. $U \cap V = \emptyset$ such that $p \in U$ and $q \in V$. A Hausdorff space guarantees the uniqueness of limits of sequences.
</MathBox>

<MathBox title='Regular space' boxType='definition'>
Let $(X, \mathcal{T})$ be a topological space. A closed set $A\subseteq X$ and a point $x\in A^c$ can be separated if there exist disjoint open sets $U, V\in\mathcal{T}$ with $A\subseteq U$ and $x\in V$. If every nonempty closed set $A$ and point $x\in A^c$ can be separated, then $(X, \mathcal{T})$ is called a regular space. 
</MathBox>

## Basis

<MathBox title='Base' boxType='definition'>
Let $(X, \mathcal{T})$ be a topological space. A collection of open subsets $\mathcal{B}\subseteq\mathcal{T}$ is called a basis (base) of $\mathcal{T}$ if every set in $\mathcal{T}$ can be written as a union of sets in $\mathcal{B}$

$$
  \forall T\in\mathcal{T}: \bigcup_{i \in I} B_i \subseteq\mathcal{B} = T
$$

where $I$ is an index set.
</MathBox>

<MathBox title='Base properties' boxType='proposition'>
Let $X$ be a nonempty set. A collection of open subsets $\mathcal{B}\subseteq\mathcal{P}(X)$ is a base for a topology on $X$ iff
1. $X = \bigcup\mathcal{B}$
2. if $A,B\in\mathcal{B}$ and $x\in A\cap B$, there exists $C\in\mathcal{B}$ with $x\in C\subseteq A\cap B$

The second condition can be more weakly stated as
2. if $A, B\in\mathcal{B}$, then $A\cap B\in\mathcal{B}$
<details>
<summary>Proof</summary>

Suppose that $\mathcal{B}$ is a base for a topology on $X$. Since $X$ is open, $X$ is a union of sets in $\mathcal{B}$. Since every set in $\mathcal{B}$ is a subset of $X$, we must have $X=\bigcup\mathcal{B}$. Suppose that $A,B\in\mathcal{B}$ and that $x\in A\cap B$. Since $A\cap B$ is open, it's a union of sets in $\mathcal{B}$. The point $x$ must be in one of those sets, so there exists $C\in\mathcal{B}$ with $x\in C\subseteq A\cap B$.
</details>
</MathBox>

A neighbourhood basis at $p \in X$ is a collection $\mathcal{B}_p$ of neighbourhoods of $p$ such that every neighbourhood of $p$ contains at least one $B \in \mathcal{B}_p$.

A topological set $(X, \mathcal{T})$ is first-countable if there is a countable neighbourhood basis at each point, and second-countable if there is a countable basis of $\mathcal{T}$. Since a countable basis of $\mathcal{T}$ contains a countable neighbourhood basis at each point, second-countability implies first-countability. A set is called countable if it admits a bijection with the set of natural numbers.

### Examples

For a topological space $(X, \mathcal{T})$ induced by a metric $(X, d)$, the basis of $\mathcal{T}$ is

$$
  \mathcal{B} = \Set{ B_\varepsilon (x) | x \in X, \, \varepsilon > 0 }
$$

## Compactness (finite covers)

<MathBox title='Cover' boxType='definition'>
Let $(X, \mathcal{T})$ be a topological space. A cover of $X$ is a collection of subsets $\mathcal{C} = \Set{ U_i }_{i\in I}$, for some index set $I$, whose union is the whole space $X$, i.E

$$
  \bigcup \mathcal{C} = \bigcup_{i\in I} U_i = X
$$

The collection $\mathcal{C}$ is said to cover a subspace $A\subseteq X$ if

$$
  A \subseteq \bigcup \mathcal{C} = \bigcup_{i\in I} U_i
$$

We call $\mathcal{C}$ an open cover if all its members are open subsets, i.e. $\mathcal{C}\subseteq\mathcal{T}$, and we call $\mathcal{C}$ a closed cover if all its members are closed subsets. A subcover of $\mathcal{C}$ is a subset of $\mathcal{C}$ that still covers $X$
</MathBox>

<MathBox title='Compact set' boxType='definition'>
Let $(X, \mathcal{T})$ be a topological space. A subset $C\subseteq X$ is called compact if any open cover of $C$ has a finite subcover. That is, if $\mathcal{A}\in\mathcal{T}$ covers $C$, i.e. with $C\subseteq\bigcap\mathcal{A}$, there exists a finite $\mathcal{B}\subseteq\mathcal{A}$ with $C\subseteq\mathcal{B}$. Alternatively, any infinite collection of open sets that together cover a compact set, always overcovers it. A topological space $X$ is locally compact if every point $x\in X$ has a compact neighbourhood.
</MathBox>

<MathBox title='Proposition' boxType='proposition'>
Let $(X, \mathcal{T})$ be a topological space, and let $C\subseteq X$ be compact. If $B\subseteq C$ is closed, then $B$ is also compact.
<details>
<summary>Proof</summary>

Suppose that $\mathcal{A}$ is an open cover of $B$. Since $B$ is closed, then $B^c$ is open, so $\mathcal{A}\cup \Set{B^c}$ is an open cover of $C$. Since $C$ is compact, this last collection has a finite subcover of $C$, which is also a finite subscover of $B$. Hence $B$ is also compact.
</details>
</MathBox>

<MathBox title='Compactness is preserved under finite unions' boxType='proposition'>
Let $(X, \mathcal{T})$ be a topological space, and let $C_i \subseteq X$ be compact for each $i$ in a finite index set $I$. Then $C = \bigcup_{i\in I} C_i$ is compact.
<details>
<summary>Proof</summary>

Suppose that $\mathcal{A}$ is an open cover of $C$. Trivially, $\mathcal{A}$ is also an open cover of $C_i$ for each $i\in I$. Hence there exists a finite subcover $\mathcal{A}_i \subseteq\mathcal{A}$ of $C_i$ for each $i\in I$. Then $\bigcup_{i\in I} \mathcal{A}_i$ is also a finite cover of $C$.
</details>
</MathBox>

<MathBox title='Compactness properties of Hausdorff spaces' boxType='proposition'>
Let $(X, \mathcal{T})$ be a Hausdorff space, then the following properties hold
1. if $C\subseteq X$ is compact, then $C$ is closed, ie. $C^c = X \setminus C \in \mathcal{T}$
2. if $x\in X$, $C\subseteq X$ is compact, and $x\notin C$, then there exist disjoint open sets $U$ and $V$ with $x\in U$ and $C\subseteq V$
3. if $x\in X$ and $A$ is a neighbourhood of $x$ with $\partial A$ compact, then there exists a closed neighbourhood $B$ of $x$ with $B\subseteq A$

<details>
<summary>Proof</summary>

**(1):** We will show that $C^c = X\setminus C$ is open, so fix $x\in C^c$. Since $C$ is Hausdorff, each $y\in C$ can be separated from $x$, meaning there are disjoint open sets $U_y, V_y\in\mathcal{T}$ with $x\in U_y$ and $y\in V_y$. Trivially, the collection $\Set{ V_y | y\in C}$ form an open cover of $C$

$$
  C \subseteq \bigcup_{y \in C} V_y
$$

Since $C$ is compact, it has a finite subscover and hence there is a finite subset $B\subseteq C$ such that $\Set{ V_y | y\in B }$ covers $C$. But then $U = \bigcap_{y\in B} U_y$ is open (since $B$ is finite) and disjoint from $\bigcup_{y\in B} V_y$. Thus, $U$ is also disjoint from $C$. To summarize, $U$ is open and $x\in U\subseteq C^c$

**(2):** For each $y\in C$ there exist disjoint open sets $U_y$ and $V_y$ with $x\in U_y$ and $y\in V_y$. Trivially, the collection $\Set{V_y | y\in C}$ is an open cover of $C$, and by compactness there exists a finite subset $B\subseteq C$ such that $\Set{V_y | y\in B}$ covers $C$. Thus, let $U = \bigcap_{y\in B} U_y$ and $V = \bigcup_{y\in B} V_y$. Then $U$ is open, since $B$ is finite, and $V$ is open. Moreover $U$ and $V$ are disjoint, and $x\in U$ and $C\subseteq V$.

**(3):** By property $(2)$, there exists disjoint open sets $U$ and $V$ with $x\in U$ and $\partial A\subseteq V$. Hence $\overline{U}$ and $\partial A$ are disjoint. Let $B = \overline{A\cap U}$. Note that $B$ is closed, and is a neighbourhood of $x$ since $U$ and $A$ are neighbourhoods of $x$. Moreover

$$
\begin{align*}
  B &\subseteq \overline{A}\cap\overline{U} \\
  &= [A\cup \partial A]\cap\overline{U} \\
  &= [A\cap\overline{U}] \cup \underbrace{[\partial A \cap\overline{U}]}_{=\emptyset} \\
  &= A\cap\overline{U} \subseteq A
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Compactness properties of Hausdorff spaces' boxType='proposition'>
Let $(X, \mathcal{T})$ be a locally compact Hausdorff space. If $x\in X$ and $A$ is a neighbourhood of $x$, then there exists a compact neighbourhood $B$ of $x$ with $B\subseteq A$.

<details>
<summary>Proof</summary>

Since $X$ is locally compact, there exists a compact neighbourhood $C$ of $x$. Hence $A\cap C$ is a neighbourhood of $x$. Moreover, $\partial(A\cap C)\subseteq C$ is closed and hence compact. We know that there exists a closed neighbourhood $B$ of $x$ with $B\subseteq A\cap C$. Since $B$ is closed and $B\subseteq C$, it is also compact. Additionally we have $B\subseteq A$.  
</details>
</MathBox>

## Connectivity

<MathBox title='Connected and disconnected spaces' boxType='definition'>
A topological space $(X, \mathcal{T})$ is disconnected if there exists two disjoint nonempty open subsets $A, B \subseteq X$ such that $X = A \cup B$ and $\overline{A}\cap B = A \cap \overline{B} = \emptyset$. Otherwise $X$ is connected, which is equivalently true if and only if the only subsets of $X$ that are both open and closed are $\emptyset$ and $X$ itself.
</MathBox>

A connected subset of $X$ is a subset that is connected space when endowed with the subspace topology. A maximal connected subset of $X$ (that is not containing in any larger connected subset) is called a (connected) component of $X$. 

<MathBox title='Path-connected spaces' boxType='definition'>
A path in $X$ from $p \in X$ to $q \in X$ is a continuous map $f: I = [0, 1] \to X$ such that $f(0) = p$ and $f(1) = q$. If there exists a path in $X$ for every pair $p, q \in X$, then $X$ is path-connected. The path components of $X$ are its maximal path-connected subsets.

The topological space $X$ is locally path-connected if $X$ has a basis of path-connected open subsets.
</MathBox>

<MathBox title='Properties of (path-)connected spaces' boxType='definition'>
Let $X$ and $Y$ be topological spaces.
1. If $F:X \to Y$ is continuous and $X$ is connected, then $F(X)$ is also connected.
2. Every connected subset of $X$ is contained in a single component of $X$.
3. A union of connected subspaces of $X$ with a point in common is connected.
4. The components of $X$ are disjoint nonempty closed subsets whose union is $X$, and thus they form a partition of $X$.
5. If $S \subseteq X$ is both open and closed, then $S$ is a union of components of $X$.
6. Every finite product of connected spaces is connected.
7. Every quotient space of a connected space is connected.
</MathBox>

A topological space is locally path-connected if it admits a basis of path-connected open subsets.

<MathBox title='Properties of locally path-connected spaces' boxType='definition'>
Let $X$ be a topological space.
1. The components of $X$ are open in $X$.
2. The path components of $X$ are equal to its components.
3. $X$ is connected if and only if it is path-connected.
4. Every open subset of $X$ is locally path-connected.
</MathBox>

## Countability axioms

<MathBox title='Dense set' boxType='definition'>
Suppose $(X,\mathcal{T})$ is a topological space. A set $D\subseteq X$ is dense if $U\subseteq D$ is nonempty for every nonempty $U\subseteq\mathcal{T}$. Equivalently, $D$ is dense if every neighbourhood of a point $x\in X$ contains an element of $D$. A set $S$ is said to be nowhere dense in $X$ if $\overline{S}$ contains no nonempty open subset.
</MathBox>

<MathBox title='Proposition' boxType='proposition'>
Suppose $(X,\mathcal{T})$ is a topological space. A set $D\subseteq X$ is dense if and only if $\overline{D} = X$
<details>
<summary>Proof</summary>

Suppose that $D$ is dense. Since $\overline{D}$ is closed, then $\overline{D}^c$ is open. If this set is nonempty, it must contain a point in $D$. This is a constradiction since $D\subseteq\overline{D}$. Conversely, suppose that $\overline{D} = X$, and suppose that $U$ is a nonempty open set. Then $U^c$ is closed and $U^c \neq X$. If $D\cap U = \emptyset$, then $D\subseteq U^c$. But then $\overline{D}\subseteq U^c$ so $\overline{D}\neq X$.
</details>
</MathBox>

<MathBox title='Countability axioms' boxType='axiom'>
A topological space $(X,\mathcal{T})$ is called
1. *separable* if there exists a countable dense subset
2. *first-countable* if each point $x\in X$ has a countable neighbourhood basis
3. *second-countable* if the topology $\mathcal{T}$ has a countable base
</MathBox>

<MathBox title='Countability relations' boxType='proposition'>
Let $(X,\mathcal{T})$ be a topological space, then the following properties hold
1. if $X$ is second countable, then it is separable
<details>
<summary>Proof</summary>

**(1):** Suppose that $\mathcal{B} = \Set{U_i}_{i\in I}$ is a base for $\mathcal{T}$, where $I$ is a countable index set. Select $x_i\in U_i$ for each $i\in I$, and let $D = \Set{ x_i }_{i\in I}$, which is clearly countable. If $U$ is open and nonempty, then $U = \bigcup_{j\in J} U_j$ for some $J\subseteq I$. But then $\Set{x_j }_{j\in J} \subseteq U$, so $D$ is dense.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $X$ be a second-countable topological space. Every open cover of $X$ has a countable subcover.

<details>
<summary>Proof</summary>

Let $\mathcal{B}$ be a countable basis for $X$, and let $\mathcal{U}$ be an arbitrary open cover of $X$. Let $\mathcal{B}' \subseteq\mathcal{B}$ be the collection of basis open subsets $B\in\mathcal{B}$ such that $B\subseteq U$ for some $U\in\mathcal{U}$. For each $B\in\mathcal{B}'$, choose a particular set $U_B \in\mathcal{U}$ containing $B$. The collection $\Set{U_B | B\in\mathcal{B}'}$ is countable, so it suffices to show that it covers $X$. Given a point $B\in\mathcal{B}$ such that $x\in B\subseteq V$. This implies, in particular, that $B\in\mathcal{B}'$ and therefore $x\in B\subseteq U_B$.
</details>
</MathBox>

## Convergence

<MathBox title='Convergent sequence' boxType='definition'>
Let $(X, \mathcal{T})$ be a topological space. A sequence $\left( x_n \in X \right)_{n \in \N}$ of points in $X$ is said to converge to a point $x\in X$, if and only if for each neighbourhood $U$ of $x$ there is a $N \in \N$ such that $x_n \in U$ for all $n \geq N$. This convergence is denoted $x_n \xrightarrow{n\to \infty} x$.
</MathBox>

Unlike metric spaces, where neighbourhoods can be made arbitrarily small, the limit of a sequence in a topological space is not necessarily unique. This is only the case if points in the space can be separated, meaning that the space is Hausdorff.

<MathBox title='Uniqueness of limits' boxType='proposition'>
Let $(X, \mathcal{T})$ be a Hausdorff space. If $\left( x_n \in X \right)_{n\in\N}$ is a sequence of points in $X$ with $x_n \xrightarrow{n\to \infty} x$ and $x_n \xrightarrow{n\to \infty} y$, then $x = y$.
<details>
<summary>Proof</summary>

If $x\neq y$, there exists disjoint neighbourhoods $A$ and $B$ of $x$ and $y$, respectively. There exist $M, N \in\N$ such that $x_n \in A$ for all $n \geq M$ and $x_n \in B$ for all $n\geq N$. However, if $n \geq\max\Set{M, N}$, then $x_n \in A$ and $x_n \in B$, giving a contradiction.
</details>
</MathBox>

## Continuity

Continuity of functions is one of the most important concepts of topology. The idea is that if two points are close together in the domain, the functional values should be close together in the range. In topology, this is expressed through preservation of openness between the domain and range spaces. A continuous function has the property that the preimage of an open set (in the range space) is also open (in the domain space).

<MathBox title='Open function' boxType='definition'>
Let $(X, \mathcal{T}_X)$ and $(Y, \mathcal{T}_Y)$ be topological spaces. A map $f: X \to Y$ is called open if it sends open sets $A \subseteq X$ to open sets $f[A] \subseteq Y$.
</MathBox>

<MathBox title='Continuous function' boxType='definition'>
Let $(X, \mathcal{T}_X)$ and $(Y, \mathcal{T}_Y)$ be topological spaces. A function $f: X\to Y$ is continuous if $f^{-1}[U]\in\mathcal{T}_X$ is open for every open $U \in\mathcal{T}_Y$. The function $f$ is locally continuous at a point $x\in X$ if $f^{-1}[B]$ is a neighbourhood of $x$ whenever $B$ is a neigbourhood of $f(x)\in Y$. Given a subset $A\subseteq X$, the function $f$ is continuous on $A$ if $f$ is continuous at each $x\in A$.

If $f$ is bijective and $f^{-1}: Y \to X$ is continuous, then $f$ is also open. The continuity of $f^{-1}$ implies that for all open sets $A \subseteq X$, then $\left( f^{-1} \right)^{-1}[A] = f[A] \subseteq Y$ is also open.
</MathBox>

<MathBox title='Proposition' boxType='proposition'>
Let $(X, \mathcal{T}_X)$ and $(Y, \mathcal{T}_Y)$ be two topoligical spaces. A function $f: X\to Y$ is continuous if and only if $f$ is continuous at each $x\in X$.
<details>
<summary>Proof</summary>

Suppose that $f$ is continuous. Let $x\in X$ and let $B$ be a neigbourhood of $f(x)$. Then there exists an open set $V\subseteq T$ with $f(x)\in V\subseteq B$. However, then $f^{-1}[V]\in\mathcal{T}_X$ is open in $X$, and $x\in f^{-1}[V]\subseteq f^{-1}[B]$, so $f^{-1}[B]$ is a neighbourhood of $x$. Hence $f$ is continuous at $x$.

Conversely, suppose that $f$ is continuous at each $x\in X$, and suppose that $V\in\mathcal{T}_Y$. If $V$ contains no points in the range of $f$, then $f^{-1}[V] = \emptyset\in\mathcal{T}_X$. Otherwise, there exists $x\in X$ with $f(x)\in V$. However, then $V$ is a neighbourhood of $f(x)$, so $U = f^{-1}[V]$ is a neighbourhood of $x$. Let $y\in U$. Then $f(y)\in V$ also, so $U$ is also a neighbourhood of $y$, hence $U\in\mathcal{T}$.
</details>
</MathBox>

<MathBox title='Continuity preserves limits' boxType='proposition'>
Let $(X, \mathcal{T}_X)$ and $(Y, \mathcal{T}_Y)$ be two topoligical spaces, and consider a continuous function $f: X\to Y$. If $\left( x_n \in X \right)_{n\in\N}$ is a sequence of points in $X$ with $x_n \xrightarrow{n\to \infty} x$, then $f(x_n) \xrightarrow{n\to \infty} f(x)$.
<details>
<summary>Proof</summary>

Suppose that $V\subseteq Y$ with $f(x)\in V$. Then $f^{-1}[V]$ is open in $X$ and $x\in f^{-1}[V]$. Hence there exists $N\in\N$ such that $x_n \in f^{-1}[V]$ for every $n\geq M$. However, then $f(x_n)\in V$ for every $n\geq N$ meaning $f(x_n) \xrightarrow{n\to \infty} f(x)$. 
</details>
</MathBox>

<MathBox title='Composition preserves continuity' boxType='proposition'>
Let $(X, \mathcal{T}_X)$, $(Y, \mathcal{T}_Y)$ and $(Z, \mathcal{T}_Z)$ be three topoligical spaces. If $f: X\to Y$ and $g: Y\to Z$ are continuous, then $g\circ f: X\to Z$ is continuous.
<details>
<summary>Proof</summary>

If $A$ is open in $Z$, then $g^{-1}[A]$ is open in $Y$ and therefore $f^{-1}\left[g^{-1}[A] \right] = \left(f^{-1}\circ g^{-1} \right)(A)$ is open in $X$. Noting $(g\circ f)^{-1} = f^{-1}\circ g^{-1}$.
</details>
</MathBox>

<MathBox title='Continuity is local' boxType='lemma'>
Continuity is a local property in the following sense: if $F:X\to Y$ is a map between topological spaces such that every point $p\in X$ has a neighbourhood $U$ on which the restriction $F|_U$ is continuous, then $F$ is continuous.
</MathBox>

<MathBox title='Gluing lemma for continuous maps' boxType='lemma'>
Let $X$ and $Y$ be topological spaces, and suppose that one of the following conditions holds:
1. $B_1,\dots,B_n$ are finitely many closed subsets of $X$ whose union is $X$
2. $\Set{B_i}_{i\in A}$ is a collection of open subsets of $X$ whose union is $X$

Suppose that for all $i$ we are given continuous maps $F_i:B_i\to Y$ that agree on overlaps, i.e. $F_i|_{B_i \cap B_j} = F_j|_{B_i \cap B_j}$. Then there exists a unique continuous map $F:X\to Y$ whose restriction to each $B_i$ is equal to $F_i$. 
</MathBox>

### Homeomorphism

<MathBox title='Homeomorphism' boxType='definition'>
Given two topological spaces $(X, \mathcal{T}_X)$ and $(Y, \mathcal{T}_Y)$, a continuous bijection $f: X \mapsto Y$ with a continuous inverse is called a homeomorphism. When such a function exists, the topoligical spaces $X$ and $Y$ are homeomorphic. A continuous map is called a local homeomorphism if every point $p \in X$ has a neighbourhood $U \subseteq X$ such that $f(U)$ is open in $Y$ and $f$ restricts to a homeomorphism from $U$ to $f(U)$.
</MathBox>

<MathBox title='Properties of homeomorphisms' boxType='proposition'>
For topological spaces $(X, \mathcal{T}_X)$, $(Y, \mathcal{T}_Y)$ and $(Z, \mathcal{T}_Z)$, then
1. $X$ is homeomorphic to $X$ (reflexivity)
2. if $X$ is homeomorphic to $Y$, then $Y$ is homeomorphic to $X$ (symmetry)
3. if $X$ is homeomorphic to $Y$, and $Y$ is homeomorphic to $Z$, then $X$ is homeomorphic to $Z$ (transitivity)
<details>
<summary>Proof</summary>

1. The identity function $\mathrm{id}: X\to X$ defined by $\mathrm{id}(x) = x$ for $x\in S$ is a homeomorphism from $S$ to itself.
2. If $f: X\to Y$ is a homeomorphism from $(X, \mathcal{T}_X)$ to $(Y, \mathcal{T}_Y)$, then $f$ is continuous bijection and hence $f^{-1}: Y\to X$ is a homeomorphism from $(Y, \mathcal{T}_Y)$ to $(X, \mathcal{T}_X)$.
3. If $f: X\to Y$ is a homeomorphism from $(X, \mathcal{T}_X)$ to $(Y, \mathcal{T}_Y)$, and $g: Y\to Z$ is homeomorphism from $(Y, \mathcal{T}_Y)$ to $(Z, \mathcal{T}_Z)$, then $g\circ f: X\to Z$ is homemorphism from $(X, \mathcal{T}_X)$ to $(Z, \mathcal{T}_Z)$.
</details>
</MathBox>

### Sequential continuity

A map $f: X \mapsto Y$ is called sequential continuous if for all $x \in X$ such that $\left( x_n \right)_{n \in \N}$ with $x_n \xrightarrow{n\to \infty} x$, then $\left( f(x_n) \right)_{n \in \mathcal{N}} \subseteq Y$ is convergent with $f(x_n) \xrightarrow{n\to \infty} f(x)$.

## Subspace

A subspace of the topological space $(X, \mathcal{U})$ is a subset $A \subseteq X$ with the topology given by $\Set{ A \cap U | U \in \mathcal{U} }$

## Product topology

<MathBox title='Product topology' boxType='definition'>
Let $\Set{ \left(X_i, \mathcal{T}_{i}\right) }_{i\in I}$ be a collection of topological spaces, where $I$ is an index set. The product space denoted $\prod_{i\in I} (X_i, \mathcal{T}_i)$ consists of the product space $\prod_{i\in I} X_i$ with a topology given by the basis

$$
  \mathcal{B} := \Set{ \prod_{i\in I} U_i | U_i \in\mathcal{T}_i \textrm{ and }U_i = X_i \textrm{ for all but a finite number of }i\in I }
$$
<details>
<summary>Proof</summary>

Trivially, $\prod_{i\in I} X_i = \bigcup\mathcal{B}$. Given $\prod_{i\in I} A_i \in\mathcal{B}$, $\prod_{i\in I} B_i \in\mathcal{B}$, then 

$$
  \left($\prod_{i\in I} A_i \in\mathcal{B}$\right) \cap \left( $\prod_{i\in I} B_i \in\mathcal{B}$ \right) = \prod_{i, j \in I} A_i \cap B_j \in\mathcal{B}
$$

Hence, $\mathcal{B}$ is a well defined base for the product topology.
</details>
</MathBox>

<MathBox title='Projections are continuous' boxType='proposition'>
Let $\prod_{i\in I} (X_i, \mathcal{T}_i)$ be a product space. The projections $p_j : \prod_{i\in I} (X_i,\mathcal{T}_i)\to X_j$ defined by $p_j (x) = x_j$ are continuous functions.
<details>
<summary>Proof</summary>

If $U$ is open in $X_j$, then $p_j^{-1}[U] = \prod_{i\in I} A_i$ where $A_i = X_i$ for $i\in I$ with $i\neq j$ and $A_j = U$, so this preimage is open in the product space.
</details>
</MathBox>

## Quotient space

Let $(X, \mathcal{T})$ be a topological space, and consider an equivalence relation $\sim$ on $X$. The quotient space wrt to the equivalence relation is the set $X/{\sim}$ with the quotient topology.

An equivalence on the set $X$ is a subset $E$ of the set $X \times X = \Set{ \left( x_1, x_2 \right) | x_1, x_2 \in X }$ satisfying

1. reflexivity: $\left( x, x \right) \in E \, \forall x \in E$ or $x \sim x$
2. symmetry: $\left( x, y \right) \in E \Rightarrow \left( y, x \right)$ or $x \sim y \implies y \sim x$
3. transivity: If $\left( x, y \right) \in E$ and $\left( y, z \right) \in E$ then $\left( x, z \right) \in E$, or $x \sim y \wedge y \sim x \implies x \sim z$

If $\sim$ is an equivalence relation on $X$, then for each $x \in X$, the equivalence class of $x$ is defined as the subset 

$$
  [x]_\sim := \Set{ y \in X | x \sim y }
$$

The set of all equivalence classes is a partition of $X$ into a collection of nonempty, mutually disjoint subsets, defined as 

$$
  X /{\sim} := \Set{ [x]_\sim | x \in X }
$$

Given the surjective quotient map $p: X \mapsto X /{\sim}$ with $x \mapsto [x]_\sim$, commonly known as a canonical projection. The quotient topology $\hat{\mathcal{T}}$ on $X / \sim$ is defined by declaring a subset $U \subseteq X /{\sim}$ to be open if and only if $p^{-1}[U] \subset X$ is open, ie.

$$
  p^{-1} [U] \in \mathcal{T} \iff U \in \hat{\mathcal{T}}
$$

### Projective space

A projective space $P^n (\R)$ is the set  of 1-dimensional subspaces of $\R^{n+1}$. It is defined as the quotient space $P^n := S^n / \sim$ with the equivalence relation $x \sim y :\iff (x = y \textrm{ or } x = -y)$ and where 

$$
  S^n := \Set{ x \in \R^{n+1} \,|\, \| x \| = 1 }
$$

is the $n$-dimensional sphere. To show that $P^n (\R)$ is a Hausdorff space we consider $[x]_\sim , [y]_\sim \in P^n (\R)$ with $[x]_\sim \neq [y]_\sim$. We then take the open neighbourhoods $U, V \in S^n$ of $x$ and $y$ respectively with

$$
\begin{aligned}
  U \cap V &= \emptyset \\
  -U \cap -V &= \emptyset 
\end{aligned}\quad
\begin{aligned}
  -U \cap V &= \emptyset \\
  U \cap -V &= \emptyset 
\end{aligned}
$$

Considering $\hat{U}:= q[u]$ where $q: S^n \mapsto S^n / \sim$ is the canonical projection. Taking the preimage we see that 

$$
  q^{-1}\left[\hat{U}\right] = U \cup -U \in \mathcal{T} \implies \hat{U} \in \hat{\mathcal{T}}
$$

hence, $\hat{U}$ is open. In the same manner it can be shown that $\hat{V}:= q[v] \in \hat{\mathcal{T}}$ is open. We can now show that

$$
  q^{-1}\left[ \hat{U} \cap \hat{V} \right] = q^{-1}\left[\hat{U}\right] \cap q^{-1}\left[\hat{V}\right] = (U \cup -U) \cap (V \cup -V) = \emptyset
$$

since $q$ is surjective we conclude that $\hat{U} \cap \hat{V} = \emptyset$ which proves that $P^n (\R)$ is a Hausdorff space.

### Möbius strip

The Möbius strip can be defined as the square $X = [0, 1] \times (-1,1) \in \R \times \R$ with the equivalence relation $(0, s) \sim (1, -s) \implies x \neq \pm y$.

## Covering maps

<MathBox title='Covering map' boxType='definition'>
Suppose that $E$ and $X$ are topological spaces. A map $\pi:E\to X$ is called a *covering map* if $E$ and $X$ are connected and locally path-connevted, $\pi$ is surjective and continuous, and each point $\mathbf{p}\in X$ has a neighbourhood $U$ that is *evenly covered* by $\pi$, meaning that each component of $\pi^{-1}(U)$ is mapped homemorphically onto $U$ by $\pi$. In this case, $X$ is called the *base of covering*, and $E$ is called a *covering space* of $X$. If $U$ is an evenly covered subset of $X$, the components of $\pi^{-1}(U)$ are called the *sheets of the covering* over $U$. 
</MathBox>

<MathBox title='Lift' boxType='definition'>
If $\pi:E \to X$ is a covering map and $F:B\to X$ is a continuous map, a *lift* of $F$ is a continuous map $\tilde{F}:B\to E$ such that $\pi\circ\tilde{F} = F$

$$
\begin{CD}
  B @>{\tilde{F}}>> E \\
  @| @VV{\pi}V \\
  B @>>{F}> X
\end{CD}
$$
</MathBox>

<MathBox title='Lifting properties of covering maps' boxType='proposition'>
Suppose that $\pi:E\to X$ is a covering map.
1. **(Unique lifting propery):** If $B$ is a connected space and $F:B\to X$ is a continuous map, then any two lifts of $F$ that agree at one point are identical.
2. **(Path lifting property):** If $f:I\to X$ is a path, then for any point $e\in E$ such that $\pi(\mathbf{e}) = f(0)$, there exists a unique lift $\tilde{f}_\mathbf{e}: I\to E$ of $f$ such that $\tilde{f}(0) = \mathbf{e}$.
3. **(Monodromy theorem):** If $f,g: I\to X$ are path-homotopic paths and $\tilde{f}_\mathbf{e}, \tilde{g}_e: I\to E$ are their lifts starting at the same point $\mathbf{e}\in E$, then $\tilde{f}_\mathbf{e}$ and $\tilde{g}_\mathbf{e}$ are path-homotopic and $\tilde{f}_\mathbf{e}(1) = \tilde{g}_\mathbf{e}(1)$.   
</MathBox>

<MathBox title='Lifting criterion' boxType='proposition'>
Suppose that $\pi:E\to X$ is a covering map, $Y$ is a connected and locally path-connected space, and $F:Y\to X$ is a continuous map. Let $\mathbf{y}\in Y$ and $\mathbf{e}\in E$ be such that $\pi(\mathbf{e}) = F(\mathbf{y})$. Then there exists a lift $\tilde{F}: Y\to E$ of $F$ satisfying $\tilde{F}(\mathbf{y}) = \mathbf{e}$ if and only if $F_*(\pi_1(Y,\mathbf{y})) \subseteq \pi_* (\pi_1(E,\mathbf{e}))$. 
</MathBox>

<MathBox title='Coverings of simply connected spaces' boxType='proposition'>
If $X$ is a simply connected space, then every covering map $\pi:E\to X$ is a homemorphism. A topological space is called *locally simply connected* if it admits a basis of simply connected open subsets.
</MathBox>

<MathBox title='Proposition of a universal covering space' boxType='proposition'>
If $X$ is a connected and locally simply connected topologica space, there exists a simply connected topological space $\tilde{X}$ and a covering map $\pi:\tilde{X}\to X$. If $\hat{\pi}:\hat{X}\to X$ is any other simply connected covering of $X$, there is a homeomorphism $\varphi:\tilde{X}\to\hat{X}$ such that $\hat{\pi}\circ\varphi = \pi$. In this case $\tilde{X}$ is called the *universal covering space* of $X$.
</MathBox>

## Locally compact Hausdorff spaces

<MathBox title='Local compactness' boxType='definition'>
A topological space $X$ is *locally compact* if every point has a neighbourhood contained in a compact subset of $X$. A subset of $X$ is *precompact* in $X$ if its closure in $X$ is compact.
</MathBox>

<MathBox title='Proper maps are closed' boxType='theorem'>
Suppose that $X$ is a topological space and that $Y$ is a locally compact Hausdorff space. Then every proper continuous map $F:X\to Y$ is closed.

<details>
<summary>Proof</summary>

Let $K\subseteq X$ be a closed subset. To show that $F(K)$ is closed in $Y$, we show that it contains all of its limit points. Let $\mathbf{y}$ be a limit point of $F(K)$ and let $U$ a precompact neighbourhood of $\mathbf{y}$. Then $\mathbf{y}$ is also a limit point of $F(K) \cap \overline{U}$. Bacause $F$ is proper, $F^{-1}(\overline{U})$ is compact, which implies that $K \cap F^{-1}(\overline{U})$ is compact. Because $F$ is continuous, $F(K \cap F^{-1}(\overline{U})) = F(K) \cap \overline{U}$ is compact and therefore closed in $Y$. In particular, $\mathbf{y}\in F(K) \cap \overline{U} \subseteq F(K)$, so $F(K)$ is closed.
</details>
</MathBox>

<MathBox title='Baire cateogory theorem' boxType='theorem'>
In a locally compact Hausdorff space or a complete metric space, every countable union of nowhere dense sets has empty interior.
</MathBox>

<MathBox title='' boxType='corollary'>
In a locally compact Hausdorff space or a complete metric space, every nonempty countable closed subset contains at least one isolated point.

<details>
<summary>Proof</summary>

Assume that $X$ is such a space. Let $A\subseteq X$ be nonempty countable closed subset, and assume that $A$ has no isolated points. The fact that $A$ is closed in $X$ means that $A$ itself is either a locally compact Hausdorff space or a complete metric space. For each $\mathbf{a}\in A$, the singleton $\Set{\mathbf{a}}$ is nowhere dense in $A$: it is closed in $A$ because $A$ is Hausdorff, and it contains no nonempty open subsets because $A$ has no isolated points. Since $A$ is a countable union of singletons, the Baire category theorem implies that $A$ has empty interior in $A$, which is a contradiction.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
A second-countable, locally compact Hausdorff space admits an exhaustion by compact sets.

<details>
<summary>Proof</summary>

Assume that $X$ is such a space. Because $X$ is a locally compact Hausdorff space, it has a basis of precompact open subsets, since it is second-countable, it is covered by countably many such sets. Let $(U_i)_{i=1}^\infty$ be such a countable cover. Beginning with $K_1 = \overline{U}_1$, assume by induction that we have constructed compact sets $K_1,\dots,K_k$ satisfying $U_j \subseteq K_j$ for each $j$ and $K_{j-1}\subseteq \mathrm{int}(K_j)$ for $j \geq 2$. Because $K_k$ is compact, there is some $m_k$ such that $K_k \subseteq U_1 \cup\cdots\cup U_{m_k}$. If we let $K_{k+1} = \overline{U}_1 \cup\cdots\cup \overline{U}_{m_k}$, then $K_{k+1}$ is a compact set whose interior contains $K_k$. By inncreasing $m_k$ if necessary, we may assume that $m_k \geq k+1$, so that $U_{k+1} \subseteq K_{k+1}$. By induction, we obtain the required exhaustion.
</details>
</MathBox>


## Metrizable spaces

<MathBox title='Projections are continuous' boxType='proposition'>
Let $(X, \mathcal{T})$ be a topological space. If there exists a metric $d$ on $X$ such that $\mathcal{T} = \mathcal{T}_d$, i.e. the topology induced by $d$, then $(X, \mathcal{T})$ is called metrizable.
</MathBox>

<MathBox title='Equivalence of metrics' boxType='definition'>
Let $X$ be a set. Metrics $d$ and $e$ on $X$ are equivalent, denoted $d\equiv e$ if $\mathcal{T}_d = \mathcal{T}_e$. The relation $\equiv$ is an equivalence relation on the collection of metrics on $X$ satisfying (for metrics $d,e,f$ on $X$):
1. reflexivity: $d\equiv d$
2. symmetry: $d\equiv e \implies e\equiv d$
3. transitivity: $d\equiv e \land e\equiv f \implies d\equiv f$
</MathBox>

<MathBox title='Partial order of metrics' boxType='proposition'>
Let $X$ be a set with metrics $d$ and $e$. Then $\mathcal{T}_e$ is finer than $\mathcal{T}_d$, i.e. $\mathcal{T}_d \subseteq \mathcal{T}_e$, if and only if every open ball relative to $d$ contains an open ball relative to $e$.

<details>
<summary>Proof</summary>

Suppose that $\mathcal{T}_d \subseteq \mathcal{T}_e$, i.e. $\mathcal{T}_e$ is finer than $\mathcal{T}_d$. For each $x\in X$ and $a > 0$, the open ball $B_d(x, a)$ at $x$ is in $\mathcal{T}_d$ and hence also in $\mathcal{T}_e$. Thus, there exists $b > 0$ such that $B_e(x, b)\subseteq B_d(x, a)$. Conversely, suppose that every open ball relative to $d$ contains an open ball relative to $e$. Consider an arbitrary open set $U\in\mathcal{T}_d$. For each $x\in U$, there is $a > 0$ such that $B_d(x, a)\subseteq U$. Thus, there is $b > 0$ such that $B_e(x, b)\subseteq B_d(x, e)\subseteq U$. Hence $U\in\mathcal{T}_e$ showing that $\mathcal{T}_d\subseteq\mathcal{T}_e$
</details>
</MathBox>

<MathBox title='Urysohn metrization theorem' boxType='theorem'>
A topological space $(X, \mathcal{T})$ is metrizable if it is a regular, second-countable, Hausdorff space.
</MathBox>

# Topological manifolds

<MathBox title='Topological manifold' boxType='definition'>
A topological space $M$ is a topological manifold of dimension $n\in\N_+$ if it has the following properties:
1. $M$ is a *Hausdorff space*: for every pair of distinct points $p,q\in M$ there are disjoint subsets $U, V\subseteq M$ such that $p\in U$ and $q \in V$.
2. $M$ is *second-countable*: there exists a countable basis for the topology of $M$.
3. $M$ is *locally Euclidean of dimension* $n$: each point of $M$ has a neighbourhood that is homemorphic to an open subset of $\R^n$.

<details>
<summary>Details</summary>

More specifically, the third property means that for each $p\in M$ we can find
- an open subset $U\subseteq M$ containing $p$
- an open subset $\U' \subseteq\R^n$
- a homeomorphism $\varphi: U'\to\U'$
</details>
</MathBox>

An $n$-dimensional topological manifold is a Hausdorff topological space $(M, \mathcal{T})$ with a second-countable basis for the topology which is locally homeomorphic to $\R^n$ (Euclidean space).

## Coordinate charts

<MathBox title='Coordinate chart' boxType='definition'>
A (coordinate) chart on a topological $n$-manifold $M$ is a pair $(U, \varphi)$ where $U$ is an open subset of $M$, called a coordinate domain/neighbourhood, and $\varphi:U\to \tilde{U}$, called a (local) coordinate map, is a homemorphism to an open subset $\tilde{U} = \varphi(U)\subseteq\R^n$. The collection of charts $\mathcal{A} := \Set{ \left( U_\alpha, \varphi_\alpha \right) }$ covering $M$, i.e. $M = \bigcup_\alpha U_\alpha$, is called an atlas. 
</MathBox>

Given a chart $(U, \varphi)$, the coordinate domain $U$ get some special names depending on the shape of the image $\varphi(U)$:
- if $\varphi(U)$ is an open ball, $U$ is called a *coordinate ball*
- if $\varphi(U)$ is an open cube, $U$ is called a *coordinate cube

Because a topological $n$-manifold $M$ is local homeomorphic to $\R^n$, each point $p \in M$ is contained in the domain of some chart $(U,\varphi)$.

## Submanifolds

If $M$ is an $n$-manifold, then $M_0 \subseteq M$ is called a $k$-dimensional submanifold of $M$ if for all $\mathbf{p}\in M_0$ there is a chart $(U, h)$ of $M$ with

$$
  h\left[M_0 \cap U \right] = \left(\R^k \times \mathbf{0}_{n-k} \right) \cup U'
$$

where $(U, h)$ is called a submanifold chart for $M_0$.

## $n$-sphere

For $n\in\N_+$, a unit $n$-sphere is defined as (in terms of the Euclidean norm) the set

$$
  S^n := \Set{\mathbf{x} \in\R^{n+1} | \| \mathbf{x} \| = 1}
$$

An $n$-sphere is a topological subspace of $\R^{n+1}$ and is thus Hausdorff and second-countable. To show that an $n$-sphere is locally homeomorphic to $\R^n$, note that it it can be covered by open sets given by 

$$
  U_i^\pm := \Set{(x^i)_{i=1}^{n+1} \in\R^{n+1} | \pm x^i > 0}
$$

where $U_i^+$ and $U_i^-$ denote the subsets of $\R^{n+1}$ where the $i$th coordinate is positive and negative, respectively. 

Let $f:B^n \to\R$ be the continuous function $f(\mathbf{u}) = \sqrt{1 - \|\mathbf{u}\|^2}$, where $B^n$ is the unit $n$-ball. For each $i=1,\dots,n+1$, it is easily seen that $U_i^+ \cap S^n$ is the grap of the function

$$
  x^i = f(x^1,\dots, x^{i-1},x^{i+1},\dots,x^{n+1})
$$

Similarly, $U_i^- \cap S^n$ is the graph of the function

$$
  x^i = -f(x^1,\dots, x^{i-1},x^{i+1},\dots,x^{n+1})
$$

Thus, each subset $U_i^\pm \cap S^n$ is locally homeomorphic to $\R^n$ and the maps $\varphi_i^\pm (x^1,\dots,x^{n+1}) = (x^1,\dots,x^{i-1},x^{i+1},\dots,x^n)$, removing the $i$th coordinate, are graph coordinates for $S^n$. Since each point of $S^n$ is in the domain of least one of these $2n + 2$ charts, $S^n$ is a topological $n$-manifold.

<LatexFig width={50} src='/fig/n_sphere_chart.svg' alt=''
  caption='Charts for n-sphere'
>
```tex
\documentclass[tikz]{standalone}
\usepackage{amssymb}
\usepackage{tikz}

\begin{document}

\def\r{1}

\begin{tikzpicture}[every node/.style={font=\small}]

  % n-sphere
  \begin{scope}
    % Hemispheres
    \fill[red!30] (\r, 0) arc (0:-180:\r{} and \r/3) arc (180:0:\r);
    \fill[blue!30] (\r, 0) arc (0:-180:\r{} and \r/3) arc (-180:0:\r);

    \draw[gray, dashed] (\r, 0) arc(0:180:\r{} and \r/3);
    \draw[gray] (\r, 0) arc(0:-180:\r{} and \r/3);

    % Axes
    \draw[->] (-1.25*\r, 0) -- (1.5*\r, 0);
    \draw[->] (0,-1.25*\r) -- (0,1.5*\r) node[above] {$x^i$};
    \draw[->] (1.5*\r/5, 1.5*\r/3) -- (-1.5*\r/5, -1.5*\r/3);

    % Labels
    \node at (60:\r) [above right, red] {$U_i^+ \cap S^n \subseteq\mathbb{R}^{n+1}$};
    \node at (-60:\r{}) [below right, blue] {$U_i^- \cap S^n \subseteq\mathbb{R}^{n+1}$};
  \end{scope}

  % R^n
  \begin{scope}[shift={(0,-\r*3)}]
    % Elipse
    \filldraw[fill=gray!20, dashed] (0,0) ellipse (\r{} and \r/3);

    % Axes
    \draw[->] (-1.25*\r, 0) -- (1.5*\r, 0);
    \draw[->] (1.5*\r/5, 1.5*\r/3) -- (-1.5*\r/5, -1.5*\r/3);

    % Labels
    \node at (45:\r/2) [above right] {$B^n \subseteq\mathbb{R}^n$};

    % Map
    \path[->] (-0.5*\r, 2*\r) edge[bend right] node[left] {$\varphi_i$} (-0.5*\r, 0.5\r);
  \end{scope}

\end{tikzpicture}

\end{document}
```
</LatexFig>

## Projective space

Recall that the projective space is defined as $P^n (\R) := S^n / \sim$ with the equivalence relation $\mathbf{x}\sim \mathbf{y} :\iff \mathbf{x}=\pm \mathbf{y}$. The canonical projection $\pi: S^n \rightarrow S^n / \sim$ is given by $\mathbf{x} \mapsto [\mathbf{x}]_\sim$. The projective space can be covered by open sets

$$
  V_i := \Set{ [\mathbf{x}]_\sim \in P^n (\R) | x^i \neq 0 }
$$

The pre-image of $V_i$ under $\pi$ is given by 

$$
  \pi^{-1}\left[ V_i \right] = U_i^+ \cup U_i^-
$$

where $U_i^\pm := \Set{\mathbf{x} \in \R^{n+1} | \pm x^i > 0}$ are open hemispheres. 

Define charts $\varphi_i : V_i \rightarrow \tilde{V}_i \subseteq \R^n$ can be formed by taking the slopes with respect to the $i$th component

$$
  \varphi_i\left( [\mathbf{x}]_\sim \right) = \left( \frac{x^1}{x^i}, \dots, \frac{x_{i-1}}{x^i},\frac{x^{i+1}}{x^i},\dots,\frac{x^{n+1}}{x^i} \right)
$$

This map is well-defined because its value is unchanged by multiplying $x$ by a nonzero constant. Because $\varphi_i \circ \pi$ is continuous, $\varphi_i$ is continuous by the characteristic property of quotient maps. It is in fact a hemomorphism with a continuous inverse

$$
  \varphi^{-1}\left(\tilde{x}^i \right) = \frac{1}{\sqrt{1 + \left(\tilde{x}^i \right)^2}}\left( \tilde{x}^1,\dots, \tilde{x}^{i-1}, 1, \tilde{x}^{i+1}, \dots, \tilde{x}^{n} \right)
$$

## Topological properties of manifolds

<MathBox title='' boxType='lemma'>
Every topological manifold has a countable basis of precompact coordinate balls.

<details>
<summary>Proof</summary>

Let $M$ be a topological $n$-manifold. First, we consider the special case in which $M$ can be covered by a single chart. Support $\varphi: M\to \tilde{U} \subseteq\R^n$ is a global coordinate map, and let $\mathcal{B}$ be the collection of all open balls $B_r (\mathbf{x})\subseteq\R^n$ such that $r$ is rational, $x$ has rational coordinates, and $B_{r'}(\mathbf{x}) \subseteq \tilde{U}$ for some $r' > r$. Each such ball is precompact in $\tilde{U}$, and it is easy to check that $\mathcal{B}$ is a countable basis for the topology of $\tilde{U}$. Because $\varphi$ is homeomorphism, it follows that the collection of sets of the form $\varphi^{-1}(B)$ for $B\in\mathcal{B}$ is a countable basis for the topology of $M$, consisting of precompact balls, with the restrictions of $\varphi$ as coordinate maps.

Next, let $M$ be an arbitrary $n$-manifold. By definition, each point $M$ is in the domain of a chart. Because every open cover of a second-countable space has a countable subcover, $M$ is covered by countably many charts $\Set{(U_i, \varphi_i)}_{i\in I \subseteq\N}$. By the preceding argument, each coordinate domain $U_i$ has a countable basis of coordinate balls that are precompact in $U_i$, and the union of all these countable basis is a countable basis for the topology of $M$. If $V\subseteq U_i$ is one of these balls, then the closure of $V$ in $U_i$ is compact, and because $M$ is Hausdorff, it is closed in $M$. It follows that the closure of $V$ in $M$ is the same as its closure in $U_i$, so $V$ is precompact in $M$ as well.
</details>
</MathBox>

<MathBox title='Connectivity properties of manifolds' boxType='proposition'>
If $M$ is a topological manifold, then
1. $M$ is locally path-connected
2. $M$ is connected if and only if it is path-connected
3. the components of $M$ are the same as its path components
4. $M$ has countably many components, each of which is an open subset of $M$ and a connected topological manifold

<details>
<summary>Proof</summary>

Since each coordinate ball is path-connected, **(1)** follows from the fact that $M$ has a basis of coordinate balls. Parts **(2)** and **(3)** follow directly from **(1)**. To prove **(4)**, note the each component is open in $M$ by proposition *X*, so the collection of components is an open cover of $M$. Because $M$ is second-countable, this cover must have a countable subcover. Since the components are all disjoint, the cover must have been countable to begin with, which is to say that $M$ has only countably many components. Because the components are open, they are connected topological manifolds in the subspace topology.
</details>
</MathBox>

<MathBox title='Manifolds are locally compact' boxType='proposition'>
Every topological manifold is locally compact.

<details>
<summary>Proof</summary>

This follows directly from the fact that every manifold has a basis of precompact open subsets.
</details>
</MathBox>

<MathBox title='Paracompactness' boxType='definition'>
Let $M$ be a topological space. A collection $\mathcal{X}$ of subsets of $M$ is *locally finite* if each point of $M$ has a neighbourhood that intersects at most finitely many of the sets in $\mathcal{X}$. Given a cover $\mathcal{U}$ of $M$, another cover $\mathcal{V}$ is a called a refinement of $U$ if for each $V\in\mathcal{V}$ there exists some $U\in\mathcal{U}$ such that $V\subseteq U$. We say that $M$ is paracompact if every open cover of $M$ admits an open, locally finite refinement.
</MathBox>

<MathBox title='Manifolds are paracompact' boxType='theorem'>
Every topological manifold is paracompact. In fact, given a topological manifold $M$, an open cover $\mathcal{X}$ of $M$, and any basis $\mathcal{B}$ for the topology of $M$, there exists a countable, locally finite open refinement of $\mathcal{X}$, consisting of elements of $\mathcal{B}$.

<details>
<summary>Proof</summary>

Let $(K_j)_{j=1}^\infty$ be an exhaustion of $M$ by compact sets. For each $j$, let $V_j = K_{j+1}/\mathrm{int}(K_j)$ and $W_j = \mathrm{int}(K_{j+1})/K_{j-1}$, where $K_j = \emptyset$ for $j < 1$. Then $V_j$ is a compact set contained in the open subset $W_j$. For each $x\in V_j$ there is some $X_x \in \mathcal{X}$ containing $x$, and because $\mathcal{B}$ is a basis, there exists $B_x \in \mathcal{B}$ such that $x\in B_x \subseteq X_x \cap W_j$. The collection of all such sets $B_x$ as $x$ ranges over $V_j$ is an open cover of $V_j$, and thus has a finite subcover. The union of all such finite subcovers as $j$ ranges over the positive integers is a countable open cover of $M$ that refines $\mathcal{X}$. Because the finite subcover of $V_j$ consists of sets contained in $W_j$, and $W_j \cap W_{j'} = \emptyset$ except when $j-2 \leq j' \leq j+2$, the resulting cover is locally finite.
</details>
</MathBox>

## Manifolds with boundary

<MathBox title='Upper half space' boxType='definition'>
The upper half space $H^n \subseteq\R^n$ is defined as

$$
  H^n := \Set{(x^i)_{i=1}^n \in\R^n | x^n \geq 0}
$$

with interior $\mathrm{int}(H^n)$ and boundary $\partial H^n$ given by

$$
\begin{align*}
  \mathrm{int}(H^n) =& \Set{(x^i)_{i=1}^n \in\R^n | x^n > 0} \\
  \partial H^n =& \Set{(x^i)_{i=1}^n \in\R^n | x^n = 0}
\end{align*}
$$

If $n=0$, then $H^0 = \R^0 = \Set{0}$ with $\mathrm{int}(H^n) = \R^0$ and $\partial H^0 = \emptyset$.
</MathBox>

A topological $n$-manifold with boundary is a second-countable Hausdorff space $M$ in which every point has a neighbourhood homoemorphic either to an open subset of $\R^n$ or to a (relatively) open subset of $H^n$.

An open subset $U\subseteq M$ together with a map $\varphi: U\to\R^n$ that is homeomorphic with an open subset of $\R^n$ or $H^n$ is called a chart for $M$. If $\varphi(U)$ is a open subset of $\R^n$, including an open subset of $H^n$ that does not intersect $\partial H^n$, then $(U,\varphi)$ is an interior chart. If $\varphi(U)$ is an open subset of $H^n$ such that $\varphi(U)\cap\partial H^n \neq\emptyset$, then $(U,\varphi)$ is called a *boundary chart*. A boundary chart whose image is a set of the form $B_r(\mathbf{x}) \cap H^n$ for some $\mathbf{x}\in\partial H^n$ and $r > 0$ is called a *coordinate half-ball*.

A point $p\in M$ is called an *interior point* of $M$, i.e. $p\in\mathrm{int}(M)$ if it is in the domain of some interior chart. It is a *boundary point* of $M$, i.e. $p\in\partial M$, if it is in the domain of a boundary chart that sends $p$ to $\partial H^n$.

<MathBox title='Topological invariance of the boundary' boxType='theorem'>
If $M$ is a topological manifold with boundary, then each point of $M$ is either a boundary point or an interior point, but not both. Thus, $\partial M$ and $\mathrm{int}(M)$ are disjoint sets whose union is $M$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a topological $n$-manifold with boundary.
1. $\mathrm{int}(M)$ is an open subset of $M$ and a topological $n$-manifold without boundary
2. $\partial M$ is a closed subset of $M$ and a topological $(n-1)$-manifold without boundary
3. $M$ is a topological manifold if and only if $\partial M = \emptyset$
4. if $n=0$, then $\partial M = \emptyset$ and $M$ is a $0$-manifold
</MathBox>

# Smooth manifolds

## Smooth structure

<MathBox title='Diffeomorphism' boxType='theorem'>
Let $U \subseteq \R^n$ and $U \subseteq \R^m$ be open subsets of Euclidean space. A function $f: U \rightarrow V$ is $k$-times continuously differentiable, i.e. $f \in C^k$, if all partial derivatives of $f$ up to the $k$-th order exist and are continuous. For $k=\infty$, $f\in C^\infty$ is called *smooth* or *infinitely differentiable*. If $f$ is bijective with a differentiable inverse map, it is called a *diffeomorphism*, which by definition is a homeomorphism.
</MathBox>

<MathBox title='Smooth manifold' boxType='definition'>
Let $M$ be a topological $n$-manifold. If $(U,\varphi)$ and $(V,\psi)$ are two charts such that $U\cap V \neq \emptyset$, the composite chart $\psi\circ\varphi^{-1}: \varphi(U\cap V) \to\psi(U\cap V=$ is called the *transition map* from $\varphi$ to $\psi$. It is a composition of homeomorphisms, and is thus itself a homeomorphism. Two charts $(U,\varphi)$ and $\psi(U\cap V)$ are *smoothly compatible* if either $U\cap V = \emptyset$ or the transition map $\psi\circ\varphi^{-1}$ is a diffeomorphism. 

An atlas $\mathcal{A}$ on $M$ is called a *smooth atlas* if any two charts in $\mathcal{A}$ are smoothly compatible with each other. A smooth atlas $\mathcal{A}$ is *maximal* (complete) if it is not properly contained in any larger smooth atlas. 

A *smooth structure* on $M$ is a maximal smooth atlas. A smooth (differentiable) manifold $(M, \mathcal{A})$ is a topological manifold $M$ equipped with a maximal smooth atlas $\mathcal{A}$, called a smooth structure. 
</MathBox>

The notion of smooth structure can be specified in different ways by changing the compatibility requirements for charts:
- A $C^k$ structure requires each transition map to be $C^k$ diffeomorphic. A manifold endowed with such a structure is called a $C^k$ manifold.
- A *real-analytic structure* requires that each transition map is expressible as a convergent power series in a neighbourhood of each point. A manifold endowed with such a structure is called a *real-analytic manifold*.
- If $M$ has even dimension $n = 2m$, we can identify $\R^{2m}$ with $\mathrm{C}^m$ and require that the transition maps be complex-analytic, yielding a *complex-analytic manifold*.

<MathBox title='' boxType='proposition'>
Let $M$ be a topological $n$-manifold.
1. Every smooth atlas $\mathcal{A}$ for $M$ is contained in a unique maximal smooth atlas, called the smooth structure determined by $\mathcal{A}$.
2. Two smooth atlases for $M$ determine the same smooth structure if and only if their union is a smooth atlas.

<details>
<summary>Proof</summary>

**(1):** Let $\mathcal{A}$ be a smooth atlas for $M$ and let $\overline{\mathcal{A}}$ denote the set of all charts that are smoothly compatible with every chart in $\mathcal{A}$. To show that $\overline{\mathcal{A}}$ is a smooth atlas, we need to show that any two charts of $\overline{\mathcal{A}}$ are smoothly compatible with each other, that is for ny $(U,\varphi), (V,\psi)\in\overline{\mathcal{A}}$, the transition map $\psi\circ\varphi^{-1}: \varphi(U\cap V)\to \psi(U\cap V)$ is smooth.

Let $\mathbf{x} = \varphi(p) \in \varphi(U \cap V)$ be arbitrary. Because that domains of the charts in $\mathcal{A}$ cover $M$, there is some chart $(W,\theta)\in\mathcal{A}$ such that $p\in W$. Since every chart in $\overline{\mathcal{A}}$ is smoothly compatible with $(W,\theta)$, both of the maps $\theta\circ\varphi^{-1}$ and $\psi\circ\theta^{-1}$ are smooth where they are defined. Since $p\in U\cap V\cap W$, it follows that $\psi\circ\varphi^{-1} = (\psi\circ\theta^{-1})\circ(\theta\circ\varphi^{-1})$ is smooth on a neighbourhood of $\mathbf{x}$. Thus, $\psi\circ\varphi^{-1}$ is smooth in a neighbourhood of each point in $\varphi(U\cap V)$. Therefore, $\mathcal{A}$ is a smooth atlas. To that it is maximal, note that any chart that is smoothly compatible with every chart in $\overline{\mathcal{A}}$ must in particular be smoothly compatible with every chart in $\mathcal{A}$, so it is already on $\overline{\mathcal{A}}$. This proves the existence of a maximal smooth atlas containing $\mathcal{A}$. If $\mathcal{B}$ is any other maximal smooth atals containin $\mathcal{A}$, each of its charts is smoothly compatible with each chart in $\mathcal{A}$, so $\mathcal{B}\subseteq\overline{\mathcal{A}}$. By maximality of $\mathcal{B}$, it follows that $\mathcal{B} = \overline{\mathcal{A}}$.
</details>
</MathBox>

<MathBox title='Regular coordinate ball' boxType='definition'>
If $M$ is a smooth manifold, any set $B\subseteq M$ is a *regular coordinate ball* if there is a smooth coordinate ball $B' \supseteq \overline{B}$ and a smooth coordinate map $\varphi: B' \to\R^n$ such that for some positive real numbers $r < r'$

$$
\begin{align*}
  \varphi(B) =& B_r (0) \\
  \varphi(\overline{B}) =& \overline{B}_r (0) \\
  \varphi(B') = B_{r'}(0)
\end{align*}
$$

Because $\overline{B}$ is homeomorphic to $\overline{B}_r (0)$ it is compact, and thus every regular coordinate ball is precompact in $M$.
</MathBox>

<MathBox title='' boxType='lemma'>
Every smooth manifold has a countable basis of regular coordinate balls.
</MathBox>

## Smooth structures on manifolds with boundary

Recall that a map from an arbitrary subset $A\subseteq\R^n \to\R^n$ is smooth if, in a neighbourhood of each point of $A$, it admits an extension to a smooth map defined on an open subset of $\R^n$. Thus, if $U$ is an open subset of $H^n$, a map $F:U\to\R^n$ is smooth if for each $\mathbf{x}\in U$, there exists an open substeq $\tilde{U}\subseteq\R^n$ containing $\mathbf{x}$ and a smooth map $\tilde{F}:\tilde{U}\to\R^k$ that agrees with $F$ on $\tilde{U}\cap H^n$.

If $F$ is such a map, the restriction of $F$ to $U\cap\mathrm{int}(H^n)$ is smooth in the usual sense. By continuity, all partial derivatives of $F$ at points of $U\cap\partial H^n$ are determined by their values in $\mathrm{int}(H^n)$, and there in particular are independent of the choice of extension. It is a fact that $F:U\to\R^k$ is smooth in this sense if and only if $F$ is continuous, $F|_{U\cap\mathrm{int}(H^n)}$ is smooth, and the partial derivatives of $F|_{U\cap\mathrm{int}(H^n)}$ of all orders have continuous extensions to all of $U$.

Let $M$ be a topological manifold with boundary. A smooth structure for $M$ is defined to be a maximal smooth atlas, a collection of charts whose domains cover $M$ and whose transition maps (and their inverses) are smooth in the sense just described. With such a structure, $M$ is called a smooth manifold with boundary.

A subset $B\subseteq M$ is a *regular coordinate half-ball* if there is a smooth coordinate half-ball $B' \supseteq \overline{B}$ and a smooth coordinate map $\varphi: B'\to H^n$ such that for some $r' > r > 0$ we have

$$
\begin{align*}
  \varphi(B) =& B_r (\mathbf{0}) \cap H^n \\
  \varphi(\overline{B}) =& \overline{B}_r(\mathbf{0}) \cap H^n \\
  \varphi(B') = B_{r'} =& B_{r'} (\mathbf{0}) \cap H^n
\end{align*}
$$

<MathBox title='' boxType='proposition'>
Suppose that $M_1,\dots,M_k$ are smooth manifolds and $N$ is a smooth manifold with boundary. Then $M_1 \times\cdots\times M_k \times N$ is a smooth manifold with boundary, and $\partial(M_1 \times\cdots\times M_k \times N) = M_1 \times\cdots\times M_k \times \partial N$.
</MathBox>

<MathBox title='Smooth invariance of the boundary' boxType='theorem'>
Suppose that $M$ is a smooth manifold with boundary and $p\in M$. If there is some smooth chart $(U,\varphi)$ for $M$ such that $\varphi(U)\subseteq H^n$ and $\varphi(p)\in \partial H^n$, then same is true for every smooth chart whose domain contains $p$.

<details>
<summary>Proof</summary>

Suppose on the contrary that $p$ is in the domain of a smooth interior chart $(U,\psi)$ and also in the domain of a smooth boundary chart $(V,\varphi)$ such that $\varphi(p)\in\partial H^n$. Let $\tau = \varphi\circ\psi^{-1}$ denote the transition map, which is a homeomorphism from $\psi(U\cap V)$ to $\varphi(U \cap V)$. The smooth compatibility of the charts ensures that both $\tau$ and $\tau^{-1}$ are smooth, in the sense that locally they can be extended, if necessary, to smooth maps defined on open subsets of $\R^n$.

Write $\mathbf{x}_0 = \psi(p)$ and $\mathbf{y}_0 = \varphi(p) = \tau(\mathbf{x}_0)$. There is some neighbourhood $W$ of $\mathbf{y}_0$ in $\R^n$ and a smooth function $\eta: W\to\R^n$ that agrees with $\tau^{-1}$ on $W\cap\varphi(U\cap V)$. On the other hand, because we are assuming that $\psi$ is an interior chart, there is an open Euclidean ball $B$ that is centered at $x_0$ and contained in $\varphi(U\cap V)$, so $\tau$ itself is smooth on $B$ in the ordinary sense. After shrinking $B$ if necessary, we may assume that $B\subseteq \tau^{-1}(W)$. Then $\eta\circ\tau|_B = \tau^{-1} \circ\tau|_B = \mathrm{id}_B$, so it follows from the chain rule that $\mathrm{D}\eta(\tau(\mathbf{x}))\circ\mathrm{D}\tau(\mathbf{x})$ is the identity map for each $x\in B$. Since $\mathrm{D}\tau(\mathbf{x})$ is a square matrix, this implies that it is non-singular. It follows that $\tau$ as a map from $B\to\R^n$ is an open map, so $\tau(B)$ is an open subset of $\R^n$ that contains $\mathbf{y}_0 = \varphi(p)$ and is contained in $\varphi(V)$. This contradicts the assumption that $\varphi(V)\subseteq H^n$ and $\varphi(p)\in\partial H^n$.
</details>
</MathBox>

## Open submanifolds

Let $M$ be an $n$-dimensional manifold, and let $S\subseteq M$ be any open subset. Define an atlas on $S$ as a collection $\mathcal{A}_S$ of smooth charts $(U,\varphi)$ for $M$ such that $U\subseteq S$. Every point $\mathbf{p}\in S$ is contained in the domain of some chart $(V,\varphi)$ for $M$. Setting $W = V\cap U$, then $(W, \varphi|_W)$ is a chart in $\mathcal{A}_S$ whose domain contains $\mathbf{p}$. Thus, $S$ is covered by the domains of charts in $\mathcal{A}_S$, and it is easy to verify that this is a smooth atlas for $S$. Hence, any open subset of $M$ is itself a smooth $n$-manifold in a natural way. Endowed with this smooth structure, any open subset is an *open submanifold* of $M$.

## Smooth maps

Generally, the terms *function* and *map* are synonymous. However, it is convenient to make a distinction between them in studying smooth manifolds. In the following discussion the term *function* is reserved for a map whose codomain is a vector space of fields, usually $\R^n$ and $\mathbb{C}^n$ for $n\in\N_+$. Either of the words *map* or *mapping* can mean any type of relation, such as a map between arbitrary manifolds.

### Smooth functions on manifolds

Suppose that $M$ is a smooth $n$-manifold. A function $f:M\to\R^k$ for $k\in\N_+$ is smooth if for every $p\in M$ there exists a smooth chart $(U,\varphi)$ for $M$ whose domain contains $p$ and such that the composite function $f\circ\varphi^{-1}$ is smooth on the subset $\tilde{U} = \varphi(U)\subseteq\R^n$. 

If $M$ is a smooth manifold with boundary, $\varphi(U)$ is an open subset of either $\R^n$ or $H^n$, and in the latter case we interpret smoothness of $f\circ\varphi^{-1}$ to mean that each point of $\varphi(U)$ has a neighbourhood on which $f\circ\varphi^{-1}$ extends to a smooth function in the ordinary sense.

Given a function $f:M\to\R^k$ and a chart $(U,\varphi)$ for $M$, the function $\tilde{f}:\varphi(U)\to\R^k$ defined by $\tilde{f}(\mathbf{x}) = f\circ\varphi^{-1}(\mathbf{x})$ is called the coordinate representation of $f$. By definition, $f$ is smooth if and only if its coordinate representation is smooth in some smooth chart around each point. Smooth functions have smooth coordinate representations in every smooth chart.

### Smooth maps between manifolds

Let $M$ and $N$ be smooth manifolds. A map $F:M\to N$ is smooth if for every $p\in M$, there exists smooth charts $(U,\varphi)$ containing $p$ and $(V,\psi)$ containing $F(p)$ such that $F(U) \subseteq V$ and the composite map $\psi\circ F\circ\varphi^{-1}$ is smooth from $\varphi(U)$ to $\psi(V)$. If $M$ and $N$ are smooth manifolds with boundary, smoothness of $F$ is defined in exactly the same way.

$$
\begin{CD}
  U\subseteq M @>F>> F(U)\subseteq V\subseteq N \\
  @V{\varphi}VV @VV{\psi}V \\
  \varphi(U)\subseteq\R^m @>>\psi\circ F\circ\varphi^{-1}> \psi(V)\subseteq\R^n
\end{CD}
$$

If $F:M\to N$ is a smooth map, and $(U,\varphi)$ and $(V,\psi)$ are any smooth charts for $M$ and $N$, respectively, we call $\tilde{F} = \psi\circ F \circ\varphi^{-1}$ the coordinate representation of $F$ with respect to the given coordinates. It maps the set $\varphi(U\cap F^{-1} (V))$ to $\psi(V)$

<MathBox title='' boxType='proposition'>
Every smooth map is continuous.

<details>
<summary>Proof</summary>

Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and that $F:M\to N$ is smooth. Given $p\in M$, smoothness of $F$ means that there are smooth charts $(U,\varphi)$ containing $p$, and $(V,\psi)$ containing $F(p)$, such that $F(U) \subseteq V$ and $\psi\circ F\circ \varphi^{-1}: \varphi(U)\to\psi(V)$ is smooth, hence continuous. Since $\varphi: U\to\varphi(U)$ and $\psi:V\to\psi(V)$ are homemorphisms, it follows that

$$
  F|_U = \psi^{-1}\circ (\psi\circ F\circ \varphi^{-1})\circ\varphi: U\to V
$$

which is a composition of continuous maps. Since $F$ is continuous in a neighbourhood of each point, it is continuous on $M$.
</details>
</MathBox>

<MathBox title='Equivalent characterizations of smoothness' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and $F:M\to N$ is a map. Then $F$ is smooth if and only if either of the following conditions is satisfied:
1. For every $p\in M$, there exist smooth charts $(U,\varphi)$ containing $p$ and $(V,\psi)$ containing $F(p)$ suchat $U\cap F^{-1}(V)$ is open in $M$ and the composite map $\psi\circ F\circ\varphi^{-1}$ is smooth from $\varphi(U\cap F^{-1}(V))$ to $\psi(V)$.
2. $F$ is continuous and there exist smooth atlases $\Set{(U_\alpha, \varphi_\alpha)}$ and $\Set{((V_\beta, \psi_\beta))}$ for $M$ and $N$, respectively, suh that for each $\alpha$ and $\beta$, the composition $\psi_\beta \circ F \circ \varphi_\alpha^{-1}$ is a smooth map from $\varphi_\alpha(U_\alpha \cap F^{-1}(V_\beta))$ to $\psi_\beta (V_\beta)$
</MathBox>

<MathBox title='Smoothness is local' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and let $F:M\to N$ be a map.
1. If every point $p\in M$ has a neighbourhood $U$ such that the restriction $F|_U$ is smooth then $F$ is smooth.
2. Conversely, if $F$ is smooth, then its restriction to every open subset is smooth.
</MathBox>

<MathBox title='Gluing lemma for smooth maps' boxType='corollary'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and ket $\Set{U_\alpha}_{\alpha\in A}$ be an open cover of $M$. Suppose that for each $\alpha\in A$, we are given a smooth map $F_\alpha: U_\alpha \to N$ such that the maps agree on overlaps, i.e. $F_\alpha|_{U_\alpha \cap U_\beta} = F_\beta |_{U_\alpha \cap U_\beta}$ for all $\alpha$ and $\beta$. Then there exists a unique smooth map $F:M\to N$ such that $F|_{U_\alpha} = F_\alpha$ for each $\alpha\in A$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$, $N$ and $P$ be smooth manifolds with or without boundary.
1. Every constant map $c:M\to N$ is smooth
2. The identity map $\mathrm{id}:M\to M$ is smooth
3. If $U\subseteq M$ is an open submanifold with or without boundary, then the inclusion map $U \hookrightarrow M$ is smooth
4. If $F:M\to N$ and $G:N\to P$ are smooth, then so is $G\circ F: M\to P$

<details>
<summary>Proof</summary>

**(4):** Let $p\in M$. By definition of smoothness of $G$, there exists smooth charts $(V,\theta)$ containing $F(p)$ and $(W,\psi)$ contining $G(F(p))$ such that $G(V)\subseteq W$ and $\psi\circ G\circ\theta^{-1}: \theta(V) \to \psi(W)$ is smooth. Since $F$ is continuous, $F^{-1}(V)$ is a neigbourhood of $p\in M$, so there is a smooth chart $(U,\varphi)$ for $M$ such that $p\in U\subseteq F^{-1}(V)$. The coordinate representation $\theta\circ F\circ\varphi^{-1}$ is smooth from $\varphi(U)$ to $\theta(V)$. It follows that $G\circ F(U)\subseteq G(V)\subseteq W$ is smooth because it is a composition of smooth maps between subsets of Euclidean spaces.

$$
\begin{CD}
  U\subseteq M @>F>> F(U)\subseteq V\subseteq M @>G>> G(F(U)) \subseteq W\subseteq P \\
  @V{\varphi}VV @V{\theta}VV @VV{\psi}V \\
  \phi(U)\subseteq\R^m @>>\theta\circ F\circ \varphi^{-1}> \theta(V)\subseteq\R^n @>>\psi\circ G\circ\theta^{-1}> \psi(W)\subseteq\R^p
\end{CD}
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M_1,\dots,M_k$ and $N$ are smooth manifolds with or without boundary, such that at most on of $M_1,\dots,M_k$ has nonzero boundary. For each $i=1,\dots,k$, let $\pi_i: \prod_{j=1}^k M_j \to M_i$ denote the projection onto the $M_i$ factor. A map $F:N\to \prod_{i=1}^k M_i$ is smooth if and only if each of the components maps $F_i = \pi_i \circ F: N\to M_i$ is smooth.
</MathBox>

### Diffeomorphism

<MathBox title='Diffeomorphism' boxType='definition'>
If $M$ and $N$ are smooth manifolds with or without boundary, a *diffeomorphism* $M$ to $N$ is a smooth bijective map $F:M\to N$ that has a smooth inverse. The manifolds $M$ and $N$ are *diffeomorphic*, denoted $M\cong N$, if there exists a diffeomorphism between them. 
</MathBox>

<MathBox title='Properties of diffeomorphism' boxType='proposition'>
1. Every composition of diffeomorphisms is a diffeomorphism.
2. Every finite product of diffeomorphism between smooth manifolds is a diffeomorphism.
3. Every diffeomorphism is a homeomorphism and an open map.
4. The restriction of a diffeomorphism to an open submanifold with or without boundary is a diffeomorphism onto its image.
5. "Diffeomorphic" is an equivalence relation on the class of all smooth manifolds with or without boundary.
</MathBox>

<MathBox title='Diffeomorphism invariance of dimension' boxType='theorem'>
A nonempty smooth manifold of dimension $m$ cannot be diffeomorphic to an $n$-dimensional smooth manifold unless $m=n$.

<details>
<summary>Proof</summary>

$$
\begin{CD}
  U\subseteq M @>F>> F(U)\subseteq V\subseteq N \\
  @V{\varphi}VV @VV{\psi}V \\
  \varphi(U)\subseteq\R^m @>>\psi\circ F\circ\varphi^{-1}> \psi(V)\subseteq\R^n
\end{CD}
$$

Suppose that $M$ is a nonempty smooth $m$-manifold, $N$ is a nonempty smooth $n$-manifold, and $F:M\to N$ is a diffeomorphism. Choose any point $p\in M$, and let $(U,\varphi)$ and $(V,\psi)$ be smooth coordinate charts containing $p$ and $F(p)$ respectively. Then the restriction of $\tilde{F} = \psi\circ F\circ\varphi^{-1}:\varphi(U)\to\psi(V)$ is a diffeomorphism from an open subset of $\R^m$ to an open subset of $\R^n$. 

Because $\tilde{F}^{-1} \circ\tilde{F} = \mathrm{id}_{\varphi(U)}$, the chain rule implies that for each $\mathbf{x}\in \varphi(U)$

$$
\begin{align*}
  \mathrm{id}_{\R^n} =& \mathrm{D}(\mathrm{id}_{\varphi(U)})(\mathbf{x}) = \mathrm{D}(\tilde{F}^{-1}\circ\tilde{F})(\mathbf{x}) \\
  =& \mathrm{D}(\tilde{F}^{-1})(\tilde{F}(\mathbf{x}))\circ\mathrm{D}\tilde{F}(\mathbf{x})
\end{align*}
$$

Similarly, $\tilde{F}\circ\tilde{F}^{-1} = \mathrm{id}_{\psi(V)}$ implies that $\mathrm{id}_{\R^m} = \mathrm{D}F(\mathbf{x})\circ\mathrm{D}(\tilde{F}^{-1})(\tilde{F}(\mathbf{x}))$. This implies that $\mathrm{D}(\tilde{F}(\mathbf{x}))$ is invertible with inverse $\mathrm{D}(\tilde{F}^{-1})(\tilde{F}(\mathbf{x}))$, and hence $m = n$.
</details>
</MathBox>

<MathBox title='Diffeomorphism invariance of the boundary' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and that $F:M\to N$ is a diffeomorphism. Then $F(\partial M) = \partial N$, and $F$ restricts to a diffeomorphism from $\mathrm{int}(M)$ to $\mathrm{int}(N)$.
</MathBox>

### Partitions of unity

<MathBox title='Partition of unity' boxType='definition'>
Suppose that $M$ is a topological space, and let $\mathcal{X} = \Set{X_\alpha}_{\alpha\in A}$ be an arbitrary open cover of $M$, indexed by a set $A$. A *partition of unity* subordinate to $\mathcal{X}$ is an indexed collection of continuous function $\Set{\psi_\alpha:M\to\R}_{\alpha\in A}$ with the following properties:
1. $0\leq\psi_\alpha(x)\leq 1$ for all $\alpha\in A$ and all $x\in M$
2. $\mathrm{supp}(\psi_\alpha) = \overline{\Set{p\in M | \psi_\alpha(p) \neq 0}}\subseteq X_\alpha$ for each $\alpha\in A$.
3. The collection of supports $\Set{\mathrm{supp}(\psi_\alpha)}_{\alpha\in A}$ is locally finite, meaning that every point has a neighbourhood that intersects $\mathrm{supp}(\psi_\alpha)$ for only finitely many values of $\alpha$.
4. $\sum_{\alpha\in A} \psi_\alpha (x) = 1$ for all $x\in M$

If $M$ is a smooth manifold with or without boundary, a *smooth parition of unity* is one for which each of the functions $\psi_\alpha$ is smooth.
</MathBox>

<MathBox title='Existence of partitions of unity' boxType='theorem'>
Suppose that $M$ is a smooth manifold with or without boundary, and $\mathcal{X} = (X_\alpha)_{\alpha\in A}$ is any indexed open cover of $M$. Then there exists a smooth partition of unity subordinate to $\mathcal{X}$.

<details>
<summary>Proof</summary>

For simplicity, suppose that $M$ is a smooth manifold without boundary. Each set $X_\alpha$ is a smooth manifold in its own right, and thus has a basis $\mathcal{B}_\alpha$ of regular coordinate balls and it is easy to check that $\mathcal{B} = \bigcup_\alpha \mathcal{B}_\alpha$ is a basis for the topology of $M$. It follows that $\mathcal{X}$ has a countable, locally finite refinement $\Set{B_i}$ consisting of elements of $\mathcal{B}$. The cover $\Set{\overline{B}_i}$ is also locally finite.

For each $i$, the fact that $B_i$ is a regular coordinate ball in some $X_\alpha$ guarantees that there is a coordinate ball $B'_i \subseteq X_\alpha$ such that $B'_i \supseteq \overline{B}_i$, and a smooth coordinate map $\varphi_i: B'_i \to\R^n$ such that $\varphi_i(\overline{B}_i) = \overline{B}_{r_i}(\mathbf{0})$ and $\varphi_i(B'_i) = B_{r'_i}(\mathbf{0})$ for some $r_i < r'_i$. For each $i$, defined a function $f_i:M\to\R$ by

$$
  f_i = \begin{cases}
    H_i \circ\varphi_i \quad& \text{on } B'_i \\
    0 \quad& \text{on } M\setminus\overline{B}_i
  \end{cases}
$$

where $H_i:\R^n \to\R$ is a smooth function that is positive in $B_{r_i}(\mathbf{0})$ and zero elsewhere. On the set $B'_i\setminus\overline{B}_i$ where the two definitions overlap, both definitions yield the zero function, $f_i$ is well-defined and smooth with $\mathrm{supp}(f_i) = \overline{B}_i$.

Define $f:M\to\R$ by $f(x) = \sum_i f_i(x)$. Because of the local finiteness of the cover $\Set{\overline{B}_i}$, this sum has only finitely many nonzero terms in a neighbourhood of each point and thus defines a smooth function. Because each $f_i$ is nonnegative everywhere and positive on $B_i$, and every point of $M$ is in some $B_i$, it follows that $f(x) > 0$ everywhere on $M$. Thus, the functions $g_i:M\to\R$ defined by $g_i (x) \frac{f_i (x)}{f(x)}$ are also smooth. It is immediate from the definition that $0\leq g_i \leq 1$ and $\sum_i g_i \equiv 1$.

Finally, we need to reindex our functions so that they are indexed by the same set $A$ as our open cover. Because the cover $\Set{B'_i}$ is a refinement of $\mathcal{X}$, for each $i$ we can choose some index $a(i)\in A$ such taht $B'_i \subseteq X_{a(i)}$. For each $\alpha\in A$, define $\psi_\alpha: M\to\R$ by

$$
  \psi_\alpha = \sum_{i:a(i) = \alpha} g_i
$$

If there are no indices $i$ for which $a(i) = \alpha$, then this sum should be interpreted as the zero function. It follos that

$$
  \mathrm{supp}(\psi_\alpha) = \overline_{\bigcup_{i:a(i) = \alpha} B_i} = \bigcup_{i:a(i) = \alpha} \overline{B}_i \subseteq X_\alpha
$$

Each $\psi_\alpha$ is a smooth function that satisfies $0\leq\psi_\alpha \leq 1$. Moreover, the collection of supports $\Set{\mathrm{supp}(\psi_\alpha)}_{\alpha\in A}$ is still locally finite, and $\sum_\alpha \psi_\alpha \equiv \sum_i g_i \equiv 1$, which is the desired partition of unity.
</details>
</MathBox>

#### Applications of partitions of unity

<MathBox title='Bump function' boxType='definition'>
If $M$ is a topological space, $A\subseteq M$ is a closed subset, and $U\subseteq M$ is an open subset containing $A$, a continuous function $\psi:M\to\R$ is called a *bump function* for $A$ supported in $U$ if $0\leq\psi\leq 1$ on $M$ and $\psi\equiv 1$ on $A$ and $\mathrm{supp}(\psi) \subseteq U$.
</MathBox>

<MathBox title='Existence of smooth bump functions' boxType='definition'>
Let $M$ be a smooth manifold with or without boundary. For any closed subset $A\subseteq M$ and any open subset $U$ containing $A$, there exists a smooth bump function for $A$ supported in $U$.

<details>
<summary>Proof</summary>

Let $U_0 = U$ an $U_1 = M\setminus A$ and let $\Set{\psi_0, \psi_1}$ be a smooth partition of unity subordinate to the open cover $\Set{U_0, U_1}$. Because $\psi_1 \equiv 0$ on $A$ with $\psi_0 = \sum_i \psi_i = 0$, the functino $\psi_0$ has the required properties.
</details>
</MathBox>

<MathBox title='Extension lemma for smooth function' boxType='lemma'>
Suppose $M$ is a smooth manifold with or without boundary, $A\subseteq M$ is a closed subset, and $f:A\to\R^k$ is a smooth function. For any open subset $U$ containing $A$, there exists a smooth function $\tilde{f}:M\to\R^k$ such that $\tilde{f}|_A = f$ and $\mathrm{supp}(\tilde{f})\subseteq U$.

<details>
<summary>Proof</summary>

For each $p\in A$, choose a neighbourhood $W_p$ of $p$ and a smooth function $\tilde{f}_p :W_p \to R^k$ that agrees with $f$ on $W_p \cap A$. Replacing $W_p$ by $W_p \cap U$, we may assume $W_p \subseteq U$. The collection of sets $\Set{W_p | p\in A}\cup M\setminus A$ is an open cover of $M$. Let $\Set{\psi_p | p\in A} \cup \Set{\psi_0}$ be a smooth partition of unity subordinate to this cover, with $\mathrm{supp}(\psi_p)\subseteq W_p$ and $\mathrm{supp}(\psi_0) \subseteq M\setminus A$.

For each $p\in A$, the product $\psi_p \tilde{f}_p$ is smooth on $W_p$, and has a smooth extension to all of $M$ if we interpret it to be zero on $M\setminus\mathrm{supp}(\psi_p)$. Thus, we can defined $\tilde{f}: M\to\R^k$ by

$$
  \tilde{f}(x) = \sum_{p\in A} \psi_p (x)\tilde{f}_p (x)
$$

Because the collection of supports $\Set{\psi_p}$ is locally finite, this sum has only a finite number of nonzero terms in a neighbourhood of any point of $M$, and therefore defines a smooth function. If $x\in A$, then $\psi_0 (x) = 0$ and $\tilde{f}_p (x) = f(x)$ for each $p$ such that $\psi_p (x) \neq 0$, so

$$
\begin{align*}
  \tilde{f}(x) =& \sum_{p\in A} \psi_p(x)f(x) \\
  =& \left( \psi_0(x) + \sum_{p\in A} \psi_p (x) \right)f(x) \\
  =& f(x)
\end{align*}
$$

so $\tilde{f}$ is indeed an extension of $f$. It follows that 

$$
  \mathrm{supp}(\tilde{f}) = \overline{\bigcup_{p\in A}\mathrm{supp}(\psi_p)} = \bigcup_{p\in A} \mathrm{supp}(\psi_p) \subseteq U
$$
</details>
</MathBox>

<MathBox title='Exhaustion function' boxType='definition'>
If $M$ is a topological space, and *exhaustion function* for $M$ is a continuous function $f:M\to\R$ with the property that the set $f^{-1}((-\infty,c])$, called the sublevel set of $f$, is compact for each $c\in\R$. As $n$ ranges over the positive integers, the sublevel sets $f^{-1}((-\infty, n])$ form an exhaustion of $M$ by compact sets.
</MathBox>

<MathBox title='Existence of smooth exhaustion functions' boxType='proposition'>
Every smooth manifold with or without boundary admits a smooth positive exhaustion function.

<details>
<summary>Proof</summary>

Let $\Set{V_j}_{j=1}^\infty$ be any countable open cover of $M$ by precompact open subsets, and let $\Set{\psi_j}$ be a smooth partition of unity subordinate to this cover. Define $f\in C^\infty (M)$ by

$$
  f(p) = \sum_{j=1}^\infty j\psi_j(p)
$$

Then $f$ is smooth because only finitely many terms are nonzero in a neighbourhood of any point, and positive because $f(p) \geq\sum_j \psi_j (p) = 1$.

To see that $f$ is an exhaustion function, let $c\in\R$ be arbitrary, and choose a positive integer $N > c$. If $p\notin \bigcup_{j=1}^N \overline{V}_j$, then $\psi_j(p) = 0$ for $1\leq j\leq N$, so

$$
\begin{align*}
  f(p) =& \sum_{j=N+1}^\infty j\psi_j (p) \\
  \geq& \sum_{j=N+1}^\infty N\psi_j (p) \\
  =& N\sum_{j=1}^\infty \psi_j (p) = N > c
\end{align*}
$$

Equivalently, if $f(p) \leq c$, then $p\in \bigcup_{j=1}^N \overline{V}_j$. Thus $f^{-1}((-\infty, c])$ is a closed subset of the compact set $\bigcup_{j=1}^N \overline{V}_j$ and is therefore compact.
</details>
</MathBox>

<MathBox title='Level sets of smooth functions' boxType='proposition'>
Let $M$ be a smooth manifold. If $K$ is any closed subset of $M$, there is a smooth nonnegative function $f:M\to\R$ such that $f^{-1}(0) = K$.

<details>
<summary>Proof</summary>

**$M = \R^n$**<br/>
First, consider the special case in which $M = \R^n$ and $K\subseteq\R^n$ is a closed subset. For each $x \in M\setminus K$, there is a positive number $r \leq 1$ such that $B_r (x) \subseteq M\setminus K$. By second-countability, $M\subseteq K$ is the union of countably many such balls $\Set{B_{r_i}(x_i)}_{i=1}^\infty$.

Let $h:\R^n \to\R$ be a smooth bump function that is equal to $1$ on $\overline{B}_{1/2} (0)$ and supported in $B_1 (0)$. For each positive integer $i$, let $C_i \geq 1$ be a constant that bounds the absolute values of $h$ and all of its partial derivatives up through order $i$. Define $f:\R^n \to\R$ by

$$
  f(x) = \sum_{i=1}^\infty \frac{(r_i)^i}{2^i C_i} h\left( \frac{x-x_i}{r_i} \right)
$$

The terms of the series are bounded in absolute value by those of the convergent series $\sum_i \frac{1}{2^i}$, so the entire series converges uniformly to a continuous function by the Weierstrass $M$-test. Because the $i$th term is positive extactly when $x\in B_{r_i}(x_i)$, it follows that $f$ is zero in $K$ and positive elsewhere.

It remains to show that $f$ is smooth. Suppose that $k\geq 1$ and assume by induction that all partial derivatives of $f$ of order less than $k$ exist and are continuous. By the chain rule and induction, every $k$th partial derivative of the $i$th term in the series can be written in the form

$$
  \frac{(r_i)^{i-k}}{2^i C_i} \mathrm{D}_k\left[h\left( \frac{x - x_i}{r_i} \right)\right]
$$

where $\mathrm{D}_k (h)$ is some $k$th partial derivative of $h$. By our choices of $r_i$ and $C_i$, as as $i\geq k$, each of these terms is bounded in absolute value by $\frac{1}{2^i}$, so the differentiated series also converges uniformly to a continuous function. It the follows from properties of uniform convergence that the $k$th partial derivatives of $f$ exist and are continuous. This completes the induction, and show that $f$ is smooth.

**$M$ arbitrary smooth manifold**<br/>
Let $M$ be an arbitrary smooth manifold, and $K\subseteq M$ any closed subset. Let $\Set{B_\alpha}$ be an open cover of $M$ by smooth coordinate balls, and let $\Set{\psi_\alpha}$ be a subordinate partition of unity. Since each $B_\alpha$ is diffeomorphic to $\R^n$, the preceeding argument show that for each $\alpha$ there is a smooth nonnegative function $f_\alpha: B_\alpha \to\R$ such that $f_\alpha^{-1}(0) = B_\alpha \cap K$. The functino $f = \sum_\alpha \psi_\alpha f_\alpha$ does the trick.
</details>
</MathBox>

# Tangent space

## Geometric tangent vectors

<MathBox title='Geometric tangent vector' boxType='definition'>
Given a point $\mathbf{a}\in\R^n$, the *geometric tangent space* to $\R^n$ at $\mathbf{a}$, denoted $\R_\mathbf{a}^n$, is the set 

$$
  \Set{\mathbf{a}} \times \R^n = \Set{(\mathbf{a}, \mathbf{v}) = \mathbf{v}_\mathbf{a} | \mathbf{v}\in \R^n}
$$

A *geometric tangent vector* $\mathbf{v}$ in $\R^n$ is an element of $\R_\mathbf{a}^n$ with initial point at $\mathbf{a}\in\R^n$. The set $\R_\mathbf{a}^n$ is a vector space.
</MathBox>

As a vector space, $\R_\mathbf{a}^n$ is essentially the same as $\R^n$ itself; the only reason for the additional index $\mathbf{a}$ is so that the geometric tangent spaces $\R_\mathbf{a}^n$ and $\R_\mathbf{b}^n$ at distinct points $\mathbf{a}, \mathbf{b}\in \R^n$ will be disjoint sets.

The directional derivate of a geometric tangent vector $\mathbf{v}$ at $\mathbf{a}$ is a map $\mathrm{D}_\mathbf{v}|_\mathbf{a}: C^\infty (\R^n) \to\R$ defined by

$$
  \mathrm{D}_\mathbf{v}|_\mathbf{a}(f) = \mathrm{D}_\mathbf{v} f(\mathbf{a}) = \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(\mathbf{a} + t\mathbf{v})
$$

This operation is linear over $\R$ and satisfies the product rule

$$
  \mathrm{D}_\mathbf{v}|_\mathbf{a} (fg) = f(\mathbf{a})\mathrm{D}_\mathbf{v}|_\mathbf{a}(g) + g(a)\mathrm{D}_\mathbf{v}|_\mathbf{a}(f)
$$

If $\mathbf{v}_\mathbf{a} = v^i \mathbf{e}_i|_\mathbf{a}$ in terms of the standard basis, then by the rule, $\mathrm{D}_\mathbf{v}|_\mathbf{a}(f)$ can written as

$$
  \mathrm{D}_\mathbf{v}|_\mathbf{a}(f) = v^i \frac{\partial f}{\partial x^i}(\mathbf{a})
$$

<MathBox title='Derivation' boxType='definition'>
If $\mathbf{a}$ is a point of $\R^n$, a function $w: C^\infty (\R^n)\to\R$ is called a *derivation* at $\mathbf{a}$ if it is linear over $\R$ and satisfies the following product rule

$$
  w(fg) = f(\mathbf{a})wg + g(\mathbf{a})wf
$$
</MathBox>

Let $T_\mathbf{a}\R^n$ denote the set of all derivations of $C^\infty(\R^n)$ at $\mathbf{a}$. Clearly, $T_\mathbf{a} \R^n$ is a vector space under the operations

$$
\begin{align*}
  (w_1 + w_2)f =& w_1 f + w_2 f \\
  (cw)f =& c(wf)
\end{align*}
$$

<MathBox title='Properties of derivations' boxType='proposition'>
Suppose that $\mathbf{a}\in\R^n$, $w\in T_\mathbf{a} \R^n$ and $f,g\in C^\infty(\R^n)$.
1. If $f$ is a constant function, then $wf = 0$.
2. If $f(\mathbf{a}) = g(\mathbf{a}) = 0$, then $w(fg) = 0$.

<details>
<summary>Proof</summary>

**(1):** It suffices to consider the constant function $f_1 (\mathbf{x}) \equiv 1$, for then $f(\mathbf{x}) \equiv c$ implies $wf = w(cf_1) = cw f_1 = 0$ by linearity. For $f_1$, the product rule gives

$$
\begin{align*}
  wf_1 =& w(f_1 f_1) \\
  =& f_1 (\mathbf{a})wf_1 + f_1 (\mathbf{a})w f_1 = 2wf_1
\end{align*}
$$

which implies that $wf_1 = 0$.

**(2):** Applyting the product rule gives

$$
  w(fg) = f(\mathbf{a})wg + g(\mathbf{a})wf = 0 + 0 = 0
$$
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $\mathbf{a}\in\R^n$.
1. For each geometric tangent vector $\mathbf{v}_\mathbf{a} \in\R_\mathbf{a}^n$, the directional derivative $\mathrm{D}_\mathbf{v}|_\mathbf{a}: C^\infty (\R^n) \to\R$ is a derivation at $\mathbf{a}$.
2. The map $\mathbf{v}_a \mapsto \mathrm{D}_\mathbf{v}|_\mathbf{a}$ is an isomorphism from $\R_\mathbf{a}^n$ onto $T_\mathbf{a}\R^n$.

<details>
<summary>Proof</summary>

**(1):** This follows from the product rule of the directional derivative.

**(2):** It is easily seen that $\mathbf{v}_\mathbf{a} \mapsto \mathrm{D}_\mathbf{v}|_\mathbf{a}$ is linear. To see that it is injective, suppose that $\mathbf{v}_\mathbf{a}\in\R_\mathbf{a}^n$ has the property that $\mathrm{D}_\mathbf{v}|_\mathbf{a}$ is the zero derivation. Writing $\mathbf{v}_\mathbf{a} = v^i \mathbf{e}_i|_\mathbf{a}$ in terms of the standard basis, and taking $f$ to be the $j$th coordinate function $x^j: \R^n\to\R$ thought of as a smooth function on $\R^n$, we obtain

$$
  0 = \mathrm{D}_\mathbf{v}|_\mathbf{a}(x^j) = v^i \left.\frac{\partial}{\partial x^i}(x^j)\right|_{\mathbf{x}=\mathbf{a}} = v^i \delta_i^j = v^j
$$

Since this is true for each $j$, it follows that $\mathbf{v}_\mathbf{a}$ is the zero vector.

To prove surjectivity, let $w\in T_\mathbf{a} \R^n$ be arbitrary and define $\mathbf{v} = v^i \mathbf{e}_i$ where $v^i = w(x^i)$. We will show that $w = \mathrm{D}_\mathbf{v}|_\mathbf{a}$. Let $f:\R^n \to\R$ be any smooth function. By Taylor's theorem, we can write

$$
\begin{align*}
  f(\mathbf{x}) =& f(\mathbf{a}) + \sum_{i=1}^n \frac{\partial f}{\partial x_i}(\mathbf{a})(x^i - a^i) \\
  &+ \sum_{i,j=1}^n (x^i - a^i)(x^j - a^j) \int_0^1 (1-t)\frac{\partial^2 f}{\partial x^i \partial x^j}(\mathbf{a} + t(\mathbf{x} - \mathbf{a}))\;\mathrm{d}t
\end{align*}
$$

Note that each term in the last sum above is a product of two smooth functions of $\mathbf{x}$ that vanish at $\mathbf{x} = \mathbf{a}$: one is (x^i - a^i), and the other is $(x^j - a^j)$ times the integral. The derivation $w$ annihilates this sum by its properties, giving

$$
\begin{align*}
  wf =& w(f(\mathbf{a})) + \sum_{i=1}^n w\left(\frac{\partial f}{\partial x^i}(\mathbf{a})(x^i - a^i)\right) \\
  =& 0 + \sum_{i=1}^n \frac{\partial f}{\partial x^i}(x)(w(x^i) - w(a^i)) \\
  =& \sum_{i=1}^n \frac{\partial f}{\partial x^i} (\mathbf{a})v^i = \mathrm{D}_\mathbf{v}|_\mathbf{a}(f)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Partial derivatives form a tangent basis' boxType='corollary'>
For $\mathbf{a}\in\R^n$, the set of $n$ derivations

$$
  \Set{\boldsymbol{\partial}_i\rvert_\mathbf{a} := \left.\frac{\partial}{\partial x^i}\right\rvert_\mathbf{a} }_{i=1}^n,\quad \left.\frac{\partial}{\partial x^i}\right|_\mathbf{a} f = \frac{\partial f}{\partial x^i}(\mathbf{a})
$$

form a basis for $T_\mathbf{a} \R^n$, which therefore has dimension $n$.

<details>
<summary>Proof</summary>

Note that $\left.\frac{\partial}{\partial x^i}\right|_\mathbf{a} = \mathrm{D}_{\mathbf{e}_i}|_\mathbf{a}$.
</details>
</MathBox>

## Tangent vectors on manifolds

<MathBox title='Tangent space' boxType='definition'>
Let $M$ be a smooth manifold with or without boundary. If $\mathbf{p}\in M$, a linear function $\mathbf{v}: C^\infty(M)\to\R$ is called a *derivation* at $\mathbf{p}$ if it satisfied the product rule

$$
  \mathbf{v}(fg) = f(\mathbf{p})\mathbf{v}g + g(\mathbf{p})\mathbf{v}f,\quad \forall f,g\in C^\infty(M)
$$

The set of all derivations of $C^\infty (M)$ at $\mathbf{p}$, denoted $T_\mathbf{p} M$, is a vector space called the *tangent space* to $M$ at $\mathbf{p}$. An element $\mathbf{v}$ of $T_\mathbf{p} M$ is called a *tangent vector* at $\mathbf{p}$. 
</MathBox>

<MathBox title='Properties of tangent vectors on manifolds' boxType='definition'>
Suppose that $M$ is a smooth manifold with or without boundary, $\mathbf{p}\in M$, $\mathbf{v} \in T_\mathbf{p} M$ and $f, g\in C^\infty (M)$.
1. If $f$ is a constant function, then $\mathbf{v}f = 0$.
2. If $f(\mathbf{p}) = g(\mathbf{p}) = 0$, then $\mathbf{v}(fg) = 0$.
</MathBox>

## Differential of a smooth map

<MathBox title='Differential' boxType='definition'>
If $M$ and $N$ are smooth manifolds with or without boundary and $F:M\to N$ is a smooth map, the differential of $F$ at $\mathbf{p}\in M$ is the map

$$
  \mathrm{d}F_\mathbf{p} : T_\mathbf{p} M \to T_{F(\mathbf{p})}N
$$

defined as follows. Given $\mathbf{v}\in T_\mathbf{p} M$, we let $\mathrm{d}F_\mathbf{p} (\mathbf{v})$ be the derivation at $F(\mathbf{p})$ that acts on $f\in C^\infty$ by the rule

$$
  \mathrm{d}F_\mathbf{p} (\mathbf{v}) = \mathbf{v}(f\circ F)
$$

<details>
<summary>Details</summary>

Note that if $f\in C^\infty (N)$, then $f\circ F \in C^\infty (M)$, so $\mathbf{v}(f\circ F)$ makes sense. The operator $\mathrm{d}F_\mathbf{p} (\mathbf{v}): C^\infty (N)\to\R$ is linear because $\mathbf{v}$ is, and is a derivation at $F(\mathbf{p})$ because for any $f,g\in C^\infty (N)$ we have

$$
\begin{align*}
  \mathrm{d}F_\mathbf{p}(\mathbf{v})(fg) =& \mathbf{v}((fg)\circ F) = \mathbf{v}((f\circ F)(g\circ F)) \\
  =& f\circ F(\mathbf{p})\mathbf{v}(g\circ F) + g\circ F(\mathbf{p})\mathbf{v}(f\circ F) \\
  =& f(F(\mathbf{p}))\mathrm{d}F_\mathbf{p} (\mathbf{v})(g) + g(F(\mathbf{p}))\mathrm{d}F_\mathbf{p} (\mathbf{v})(f)
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Properties of differentials' boxType='proposition'>
Let $M$, $N$ and $P$ be smooth manifolds with or without boundary, $F:M\to N$ and $G:N\to P$ be smooth maps and let $p\in M$.
1. $\mathrm{d}F_\mathbf{p}: T_\mathbf{p} M \to T_{F(\mathbf{p})}N$ is linear
2. $\mathrm{d}(G\circ F)_\mathbf{p} = \mathrm{d}G_{F(\mathbf{p})} \circ\mathrm{d}F_\mathbf{p}: T_\mathbf{p} M \to T_{G\circ F(\mathbf{p})} P$
3. $\mathrm{d}(\mathrm{id}_M)_\mathbf{p} = \mathrm{id}_{T_\mathbf{p} M}: T_\mathbf{p} M \to T_\mathbf{p} M$
4. If $F$ is a diffeomorphism, then $\mathrm{d}F_\mathbf{p}: T_\mathbf{p} M \to T_{F(\mathbf{p})} N$ is an isomorphism and $(\mathrm{d}F_\mathbf{p})^{-1} = \mathrm{d}(F^{-1})_{F_(\mathbf{p})}$
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary, $\mathbf{p}\in M$ and $\mathbf{v}\in T_\mathbf{p} M$. If $f,g\in C^\infty(M)$ agree on some neighbourhood of $\mathbf{p}$, then $\mathbf{v}f = \mathbf{v}g$.

<details>
<summary>Proof</summary>

Let $h = f - g$ so that $h$ is a smooth function that vanishes in a neighbourhood of $\mathbf{p}$. Let $\psi\in C^\infty (M)$ be a smooth bump function that is identically equal to $1$ on the support of $h$ and is supported in $M\setminus\Set{\mathbf{p}}$. Because $\psi\equiv 1$ where $h$ is nonzero, the product $\psi h$ is identically equal to $h$. Since $h(\mathbf{p}) = \psi(\mathbf{p}) = 0$, it follows that $\mathbf{v}h = \mathbf{v}(\psi h) = 0$. By linearity, this implies $\mathbf{v}f = \mathbf{v}g$.
</details>
</MathBox>

<MathBox title='The tangent space to an open submanifold' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary, $U\subseteq M$ an open subset, and let $\iota: U \hookrightarrow M$ be the inclusion map. For every $\mathbf{p}\in U$, the differential $\mathrm{d}\iota_\mathbf{p}: T_\mathbf{p} U \to T_\mathbf{p} M$ is an isomorphism.

<details>
<summary>Proof</summary>

To show injectivity, suppose that $\mathbf{v}\in T_\mathbf{p} U$ and $\mathrm{d}\iota_\mathbf{p} (\mathbf{v}) = 0\in T_\mathbf{p} M$. Let $B$ a neighbourhood of $\mathbf{p}$ such that $\overline{B} \subseteq U$. If $f\in C^\infty (U)$ is arbitrary, the extension lemma for smooth function guarantees that there exists $\tilde{f}\in C^\infty(M)$ such that $\tilde{f}\equiv f$ on $\overline{B}$. Then since $f$ and $\tilde{f}|_U$ are smooth function on $U$ that agree in a neighbourhood of $\mathbf{p}$, it follows from the previous proposition that

$$
  \mathbf{v}f = \mathbf{v}(\tilde{f}|_U) = \mathbf{v}(\tilde{f}\circ\iota) = \mathrm{d}\iota(\mathbf{v})_\mathbf{p} \tilde{f} = 0
$$

Since this holds for every $f\in C^\infty (U)$, it follows that $\mathbf{v} = \mathbf{0}$, so $\mathrm{d}\iota_\mathbf{p}$ is injective.

To show surjectivity, suppose that $w\in T_\mathbf{p} M$ is arbitrary. Define an operator $\mathbf{v}: C^\infty(U) \to\R$ by setting $\mathbf{v}f = \mathbf{w}\tilde{f}$, where $\tilde{f}$ is any smooth function on all of $M$ that agrees with $f$ on $\overline{B}$. By the previous proposition, $\mathbf{v}f$ is independent of the choice of $\tilde{f}$, so $\mathbf{v}$ is well-defined, and it is easy to check that it is a derivation of $C^\inft (U)$ at $\mathbf{p}$. For any $g\in C^\infty (M)$

$$
  \mathrm{d}\iota_\mathbf{p} (\mathbf{v})g = \mathbf{v}(g\circ\iota) = \mathbf{w}(\tilde{g\circ\iota}) = \mathbf{w}g
$$

where the last two equalities follow from the fact that $g\circ\iota$, $\tilde{g\circ\iota}$ and $g$ all agree on $B$. Thus, $\mathrm{d}\iota_\mathbf{p}$ is also surjective.
</details>
</MathBox>

<MathBox title='Dimension of the tangent space' boxType='proposition'>
If $M$ is a an $n$-dimensional smooth manifold, then for each $\mathbf{p}\in M$, the tangent space $T_\mathbf{p} M$ is an $n$-dimensional vector space.

<details>
<summary>Proof</summary>

Given $\mathbf{p}\in M$, let $(U,\varphi)$ be a smooth coordinate chart containing $\mathbf{p}$. Because $\varphi$ is a diffeomorphism from $U$ onto an open subset $\tilde{U}\subseteq\R^n$, follows from the properties of differentials that $\mathrm{d}\varphi_p$ is an isomorphism from $T_\mathbf{p} U \to T_{\varphi(\mathbf{p})}\tilde{U}$. Since the previous proposition guarantees that $T_\mathbf{p} M \cong T_\mathbf{p} U$ and $T_{\varphi(\mathbf{p})}\tilde{U} \cong T_{\varphi(p)} \R^n$ it follows that $\dim(T_\mathbf{p} M) = \dim(T_{\varphi(\mathbf{p})}\R^n = n$.
</details>
</MathBox>

<MathBox title='' boxType='lemma'>
Let $\iota:H^n \to\R^n$ denote the inclusion map. For any $\mathbf{a}\in\partial H^n$, the differential $\mathrm{d}\iota_\mathbf{a}: T_\mathbf{a} H^n \to T_\mathbf{a} \R^n$ is an isomorphism.

<details>
<summary>Proof</summary>

To show that $\mathrm{d}\iota_\mathbf{a}$ is injective, assume that $\mathrm{d}\iota_\mathbf{a} (\mathbf{0}) = 0$. Suppose that $f:H^n \to\R^n$ is smooth, and let $\tilde{f}$ be any extension of $f$ to a smooth function defined on all of $\R^n$. Then $\tilde{f}\circ\iota = f$ and

$$
  \mathbf{v}f = \mathbf{v}(\tilde{f}\circ\iota) = \mathrm{d}\iota_\mathbf{a} (\mathbf{v})\tilde{f} = 0
$$

which implies that $\mathrm{d}\iota_a$ is injective.

To show surjectivity, let $\mathbf{w}\in T_\mathbf{a} \R^n$ be arbitrary. Define $\mathbf{v}\in T_\mathbf{a} H^n$ by $\mathbf{v}f = \mathbf{w}\tilde{f}$, where $\tilde{f}$ is any smooth extension of $f$. Writing $\mathbf{w} = w^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{a}$ in terms of the standard basis for $T_\mathbf{a} \R^n$, means that

$$
  \mathbf{v}f = w^i \frac{\partial\tilde{f}}{\partial x^i}(\mathbf{a})
$$

This is independent of the choice of $\tilde{f}$, because by continuity the derivatives of $\tilde{f}$ at $\mathbf{a}$ are determined by those of $f$ in $H^n$. It is easy to check that $\mathbf{v}$ is a derivation at $\mathbf{a}$ and that $\mathbf{w} = \mathrm{d}\iota_\mathbf{a} (\mathbf{v})$, so $\mathrm{d}\iota_\mathbf{a}$ is surjective.
</details>
</MathBox>

<MathBox title='Dimension of the tangent space on a manifold with boundary' boxType='proposition'>
Suppose that $M$ is a an $n$-dimensional smooth manifold with boundary, then for each $\mathbf{p}\in M$, the tangent space $T_\mathbf{p} M$ is an $n$-dimensional vector space.

<details>
<summary>Proof</summary>

Let $\mathbf{p}\in M$ be arbitrary. If $\mathbf{p}\in\mathrm{int}(M)$ it follows that $T_\mathbf{p}(\mathrm{int}(M)) \cong T_\mathbf{p} M$ because $\mathrm{int}(M)$ is an open submanifold. Since $\mathrm{int}(M)$ is a smooth $n$-manifold without boundary, its tangent spaces all have dimension $n$.

If $\mathbf{p}\in\partial M$, let $(U,\varphi)$ be a smooth boundary chart containing $\mathbf{p}$, and let $\tilde{U} = \varphi(U)\subseteq H^n$. Then we have the isomorphisms

$$
  T_\mathbf{p} M \cong T_\mathbf{p} U \cont T_{\varphi(\mathbf{p})}\tilde{U} \cong T_{\varphi(\mathbf{p})} H^n \cong T_{\varphi(\mathbf{p})}\R^n
$$
</details>
</MathBox>

<MathBox title='The tangent space to a vector space' boxType='proposition'>
Suppose that $V$ is a finite-dimensional vector space with its standard smooth manifold structure. For each point $\mathbf{a}\in V$ and vector $\mathbf{v}\in V$, define the directional derivative $\mathrm{D}_\mathbf{v}|_\mathbf{a}:C^\infty (V) \to\R$ by

$$
  \mathrm{D}_\mathbf{v}|_\mathbf{a} = \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(\mathbf{a} + t\mathbf{v})
$$

The map $v \mapsto \mathrm{D}_\mathbf{v}|_\mathbf{a}$ is a canonical isomorphism from $V$ to $T_a V$ such that for any linear map $L: V\to W$, the following diagram commutes:

$$
\begin{CD}
  V @>\cong>> T_\mathbf{a} V \\
  @V{L}VV @V{\mathrm{d}L_\mathbf{a}}VV \\
  W @>>\cong> T_{L_\mathbf{a}}W
\end{CD}
$$

<details>
<summary>Proof</summary>

Suppose that $L:V\to W$ is a linear map. Because its components with respect to any choices of bases for $V$ and $W$ are linear functions of the coordinates, $L$ is smooth. Unwinding the definitions and using the linearity of $L$, we compute

$$
\begin{align*}
  \mathrm{d}L_\mathbf{a}(\mathrm{D}_\mathbf{v}|_\mathbf{a})f =& \mathrm{D}_\mathbf{v}|_\mathbf{a} (f\circ L) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(L(\mathbf{a} + t\mathbf{v})) \\
  =& \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t=0} f(L\mathbf{a} + tL\mathbf{v}) \\
  =& \mathrm{D}_{L\mathbf{v}}|_{L\mathbf{a}}(f)  
\end{align*}
$$
</details>
</MathBox>

<MathBox title='The tangent space to a product manifold' boxType='proposition'>
Let $M_1,\dots, M_k$ be smooth manifolds, and for each $j=1,\dots,k$, let $pi_j: M_1 \times\cdots\times M_k \to M_j$ be the projection onto the $M_j$ factor. For any point $\mathbf{p} = (\mathbf{p}_j)_{j=1}^k \in \prod_{j=1}^k M_i$, the map $\alpha: T_\mathbf{p} \left(\prod_{j=1}^k M_j \right) \to \bigoplus_{j=1}^k T_{\mathbf{p}_j} M_j$ defined by

$$
  \alpha(\mathbf{v}) = (\mathrm{d}(\pi_j)_\mathbf{p}(\mathbf{v}))_{j=1}^k
$$

is an isomorphism. The same is true if one of the spaces $M_j$ is a smooth manifold with boundary.
</MathBox>

## Coordinate vectors

Suppose that $M$ is a smooth $n$-manifold without boundary, and let $(U,\varphi)$ be a smooth coordinate chart on $M$. Since $\varphi: U\to\tilde{U}\subseteq\R^n$ it follows that $\mathrm{d}\varphi_\mathbf{p}: T_\mathbf{p} U \to T_{\varphi(\mathbf{p})} \R^n$ is an isomorphism. Furthermore, since $U$ is an open submanifold it follows that $T_\mathbf{p} U \cong T_\mathbf{p} M$ for every $\mathbf{p}\in M$. This implies that $\mathrm{d}\varphi_\mathbf{p}: T_\mathbf{p} M \to T_{\varphi(\mathbf{p})} \R^n$ is an isomorphism.

The partial derivatives $\Set{\boldsymbol{\partial}_i\rvert_{\varphi(\mathbf{p})}}_{i=1}^{n}$ forms a basis for $T_{\varphi(\mathbf{p})}\R^n$. Thus, the preimages of these vectors under the isomorphism $\mathrm{d}\varphi_\mathbf{p}$ form a basis for $T_\mathbf{p}M$. These vector are denoted $\boldsymbol{\partial_i}|_\mathbf{p} = \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}$, characterized by either of the following expressions:

$$
\begin{align*}
  \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} =& (\mathrm{d}\phi_\mathbf{p})^{-1} \left( \left.\frac{\partial}{\partial x^i}\right|_{\varphi(\mathbf{p})} \right) \\
  =& \mathrm{d}(\varphi^{-1})_{\varphi(\mathbf{p})} \left( \left. \frac{\partial}{\partial x^i} \right|_{\varphi(\mathbf{p})} \right)
\end{align*}
$$

Unwinding these definitions, we see that $\boldsymbol{\partial}_i|_\mathbf{p}$ acts on a function $f\in C^\infty (U)$ by

$$
  \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} = \left.\frac{\partial}{\partial x^i}\right|_{\varphi(\mathbf{p})}(f \circ\varphi^{-1}) = \frac{\partial \tilde{f}}{\partial x^i}(\tilde{\mathbf{p}})
$$

where $\tilde{f} = f\circ\varphi^{-1}$ is the coordinate representation of $f$, $\tilde{\mathbf{p}} = (p^i)_{i=1}^n = \varphi(\mathbf{p})$ is the coordinate representation of $\mathbf{p}$. In other vords, $\boldsymbol{\partial}_i|_\mathbf{p}$ is just the derivation that takes the partial derivative of $f$ at $\mathbf{p}$. The vectors $\boldsymbol{\partial}_i|_\mathbf{p}$ are called the *coordinate vectors* at $\mathbf{p}$ associated with a given coordinate system. In the special case of standard coordinates on $\R^n$, the vectors $\boldsymbol{\partial}_i|_\mathbf{p}$ are literally the partial derivative operators.

If $M$ is a smooth manifold with boundary and $\mathbf{p}$ is an interior point, the discussion above applies verbatim. For $\mathbf{p}\in\partial M$, the only change that needs to be made is to substitute $H^n$ for $\R^n$, with the understanding that the notation $\boldsymbol{\partial}_i|_{\varphi(\mathbf{p})}$ can be used interchangeably to denote either an element of $T_{\varphi(\mathbf{p})} \R^n$ or an element of $T_{\varphi(\mathbf{p})} H^n$, where we consider the isomorphism $\mathrm{d}\iota_{\varphi(\mathbf{p})}: T_{\varphi(\mathbf{p})}H^n \to T_{\varphi(\mathbf{p})}\R^n$ as an identification. The $n$th coordinte vector $\boldsymbol{\partial}_i|_\mathbf{p}$ should be interpreted as a one-sided derivative in this case. 

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth $n$-manifold with or without boundary, and let $\mathbf{p}\in M$. Then $T_\mathbf{p}M$ is an $n$-dimensional vector space, and for any smooth chart $(U, (x^i))$ containing $\mathbf{p}$, the cordinate vectors $\Set{\boldsymbol{\partial}_i\rvert_\mathbf{p}}_{i=1}^n$ form a basis for $T_\mathbf{p} M$.
</MathBox>

A tangent vector $\mathbf{v}\in T_\mathbf{p} M$ can be written uniquely as a linear combination

$$
  \mathbf{v} = v^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} = v^i \boldsymbol{\partial}_i|_\mathbf{p}
$$

The ordered basis $(\boldsymbol{\partial}_i|_\mathbf{p})_{i=1}^n$ is a called a *coordinate basis* for $T_\mathbf{p} M$ and the scalars $(v^i)_{i=1}^n$ are called the *components* of $\mathbf{v}$ with respect to the coordinate basis. If $\mathbf{v}$ is known, its components can be easily computed from its action on the coordinate functions. For each $j$, the components of $\mathbf{v}$ are given by $v^j = \mathbf{v}(x^j)$, where $x^j:U\to\R$ is a smooth real-valued function, because

$$
\begin{align*}
  \mathbf{v}(x^j) =& \left( v^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} \right)(x^j) \\
  =& v^i \frac{\partial x^j}{\partial x^i}(\mathbf{p}) \\
  =& v^i \delta_i^j = v^j
\end{align*}
$$

### Coordinate representation of differentials

In order to find a coordinate representation of differential, consider first the special case of a smooth map $F:U\to V$, where $U\subseteq\R^n$ and $V\subseteq\R^m$ are open subsets of Euclidean spaces. For any $\mathbf{p}\in U$, we determine the matrix of $\mathrm{d}F_\mathbf{p}: T_\mathbf{p} \R^n \to T_{F(\mathbf{p})} \R^m$ in terms of the standard coordinate bases. Using $(x^i)_{i=1}^n$ to denote the coordinates in the domain and $(y^j)_{j=1}^m$ to denote those in the codomain, we apply the chain rule to compute the action of $\mathrm{d}F_\mathbf{d}$ on a typical basis vector:

$$
\begin{align*}
  \mathrm{d}F_\mathbf{p}\left(\left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} \right) f =& \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} (f \circ F) \\
  =& \frac{\partial f}{\partial y^j} (F(\mathbf{p})) \frac{\partial F^j}{\partial x^i}(\mathbf{p}) \\
  =& \left( \frac{\partial F^j}{\partial x^i}(\mathbf{p}) \left.\frac{\partial}{\partial y^j}\right|_{F(\mathbf{p})} \right)f
\end{align*}
$$

Thus

$$
  \mathrm{d}F_\mathbf{p}\left(\left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} \right) = \frac{\partial f}{\partial y^j} (F(\mathbf{p})) \frac{\partial F^j}{\partial x^i}(\mathbf{p})
$$

In other words, the matrix of $\mathrm{d}F_\mathbf{p}$ in terms of the coordinate basis is

$$
\begin{bmatrix}
  \frac{\partial F^1}{\partial x^1}(\mathbf{p}) & \cdots & \frac{\partial F^1}{\partial x^n}(\mathbf{p}) \\
  \vdots & \ddots & \vdots \\
  \frac{\partial F^m}{\partial x^1}(\mathbf{p}) & \cdots & \frac{\partial F^m}{\partial x^n}(\mathbf{p})
\end{bmatrix}
$$

which is called the *Jacobian (matrix)* of $F$ at $\mathbf{p}$. The Jacobian is the matrix representation of the total derivative $\mathrm{D}F(\mathbf{p}): \R^n \to\R^m$. Thus, in this case, $\mathrm{d}F_\mathbf{p}: T_\mathbf{p}\R^n \to T_{F(\mathbf{p})} \R^m$ corresponds to the total derivative $\mathrm{D}F(\mathbf{p}):\R^n \to\R^m$, under our usual identification of Euclidean spaces with their tangent spaces. The same calcalulation applies if $U$ is an open subset of $H^n$ and $V$ is an open subset of $H^m$.

Consider the more general case of a smooth map $F:M\to N$ between smooth manifolds with or without boundary. Choosing smooth coordinate charts $(U,\varphi)$ for $M$ containing $\mathbf{p}\in M$ and $(V,\psi)$ for $N$ containing $F(\mathbf{p})$, we obtain the coordinate representation $\tilde{F} = \psi\circ F\circ^{-1}: \varphi(U\cap F^{-1}(V)) \to\psi(V)$.

Let $\tilde{\mathbf{p}} = \varphi(\mathbf{p})$ denote the coordinate representation of $\mathbf{p}$. By the computation above, $\mathrm{d}\tilde{F}_{\tilde{\mathbf{p}}}$ is represented with respect to the standard coordinate bases by the Jacobian matrix of $\tilde{F}$ at $\tilde{\mathbf{p}}$. Using the factor that $F\circ\varphi^{-1} = \psi^{-1} \circ\tilde{F}$ we get 

$$
\begin{align*}
  \mathrm{d}F_\mathbf{p}\left(\left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}\right) =& \mathrm{d}F_\mathbf{p} \left(\mathrm{d}(\varphi^{-1})_{\tilde{\mathbf{p}}} \left( \left.\frac{\partial}{\partial x^i}\right|_\mathbf{\tilde{p}} \right) \right) \\
  =& \mathrm{d}(\psi^{-1})_{\tilde{F}(\tilde{\mathbf{p}})} \left(\mathrm{d}(\tilde{F})_{\tilde{\mathbf{p}}} \left( \left.\frac{\partial}{\partial x^i}\right|_\mathbf{\tilde{p}} \right) \right) \\
  =& \mathrm{d}(\psi^{-1})_{\tilde{F}(\tilde{\mathbf{p}})} \left( \frac{\partial\tilde{F}^j}{\partial x^i}(\tilde{\mathbf{p}})\left.\frac{\partial}{\partial y^j}\right|_{\tilde{F}(\tilde{\mathbf{p}})} \right) \\
  =& \frac{\partial\tilde{F}^j}{\partial x^j}(\tilde{\mathbf{p}})\left.\frac{\partial}{\partial y^j}\right|_{F(\mathbf{p})}
\end{align*}
$$

Thus, $\mathrm{d}F_\mathbf{p}$ is represented in coordinate bases by the Jacobian matrix of $F$. In the fact, the definition of the differential is formulated to give a coordinate-independent meaning to the Jacobian matrix.

### Change of coordinates

Suppose that $(U,\varphi)$ and $(V,\psi)$ are two smooth charts on $M$ and $\mathbf{p}\in U \cap B$. Let us denote the coordinate functions of $\varphi$ by $(x^i)$ and those of $\psi$ by $(\hat{x}^i)$, such that the transition map $\psi\circ\varphi^{-1}: \varphi(U \cap V)\to \psi(U\cap V)$ can be written

$$
  \psi\circ\varphi^{-1} (\mathbf{x}) = \left(\hat{x}^i(\mathbf{x}) \right)_{i=1}^n 
$$

The differential $\mathrm{d}(\psi\circ\phi^{-1})_{\varphi(\mathbf{p})}$ can be written

$$
\begin{align*}
  \mathrm{d}(\psi\circ\varphi^{-1})_{\varphi(\mathbf{p})} \left(\left.\frac{\partial}{\partial x^i}\right|\right) = \frac{\partial\hat{x}^j}{\partial x^i}(\varphi(\mathbf{p})) \left.\frac{\partial}{\partial\hat{x}^j}\right|_{\psi(\mathbf{p})}
\end{align*}
$$

Using the definitions of coordinate vectors, we obtain

$$
\begin{align*}
  \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} =& \mathrm{d}(\varphi^{-1})_{\varphi(\mathbf{p})}\left(\left.\frac{\partial}{\partial x^i}\right|_{\varphi(\mathbf{p})}\right) \\
  =& \mathrm{d}(\psi^{-1})_{\psi(\mathbf{p})} \circ \mathrm{d}(\psi\circ\varphi^{-1})_{\varphi(\mathbf{p})} \left(\left.\frac{\partial}{\partial x^i}\right|_{\varphi(\mathbf{p})}\right) \\
  =& \mathrm{d}(\psi^{-1})_{\psi(\mathbf{p})}\left(\frac{\partial\hat{x}^j}{\partial x^i} (\varphi(\mathbf{p})) \left.\frac{\partial}{\partial \hat{x}^j}\right|_{\psi(\mathbf{p})} \right) \\
  =& \frac{\partial\tilde{x}^j}{\partial x^i} (\tilde{\mathbf{p}}) \left.\frac{\partial}{\partial\hat{x}^j}\right|
\end{align*}
$$

where $\tilde{\mathbf{p}} = \varphi(\mathbf{p})$. Applying this to the components of a vector $\mathbf{v} = v^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} = \hat{v}^j \left.\frac{\partial}{\partial\hat{x}^j}\right|_\mathbf{p}$ we find that the components of $\mathbf{v}$ transform by the rule

$$
  \hat{v}^j = \frac{\partial\hat{x}^j}{\partial x^i}(\tilde{\mathbf{p}})v^i
$$

## Tangent bundle

<MathBox title='Tangent bundle' boxType='definition'>
If $M$ is a smooth manifold $M$ with or without boundary, the *tangent bundle* of $M$, denoted $TM$, is the disjoint union of the tangent spaces at all points of $M$:

$$
  TM := \bigsqcup_{\mathbf{p}\in M} T_\mathbf{p} M := \bigcup_{\mathbf{p}\in M} \Set{\mathbf{p}} \times T_\mathbf{p} M
$$

The tangent bundle is equipped with a natural *projection map* $\pi:TM \to M$, sending each vector in $T_\mathbf{p} M$ to the point $\mathbf{p}$ at which it is tangent, i.e. $\pi(\mathbf{p},\mathbf{v}) = \mathbf{p}$. 
</MathBox>

In the special case $M = \R^n$, the tangent bundle of $\R^n$ can be canonically identified with the union of its geometric tangent spaces, which in turn is just the Cartesian product of $\R^n$ with itself:

$$
\begin{align*}
  T\R^n =& \bigsqcup_{\mathbf{a}\in\R^n} T_\mathbf{a}\R^n \cong \bigsqcup_{\mathbf{a}\in\R^n} \R_\mathbf{a}^n \\
  =& \bigsqcup_{\mathbf{a}\in\R^n} \Set{\mathbf{a}} \times\R^n = \R^n \times\R^n
\end{align*}
$$

An element $(\mathbf{a},\mathbf{v})\in T\R^n$ of this Cartesian product can be thought of as representing either the geometric tangent vector $\mathbf{v}_\mathbf{a}$ or the derivation $\mathrm{D}_\mathbf{v}|_\mathbf{a}$.

In general, the tangent bundle of a smooth manifold cannot be identified in any natural way with a Cartesian product, because there is no canonical way to identify tangent spaces at different points with each other.

<MathBox title='The tangent bundle is a smooth manifold' boxType='proposition'>
For any smooth $n$-manifold $M$, the tangent bundle $TM$ has a natural topology and smooth structure that make it into a $2n$-dimensional smooth manifold. With respect to this structure, the projection $\pi:TM\to M$ is smooth.

<details>
<summary>Proof</summary>

$$
\begin{CD}
  \pi^{-1}(U) \subseteq TM @>\tilde{\varphi}>> @ \varphi(U)\times\R^n \subseteq \R^{2n} \\
  @V{\pi}VV @VVV \\
  U \subseteq M @>>\varphi> \varphi(U)\subseteq \R^n
\end{CD}
$$

Given any smooth chart $(U,\varphi)$ for $M$, note that $\pi^{-1} (U)\subseteq TM$ is the set of all tangent vector to $M$ at all points of $U$. Let $(x^i)_{i=1}^n$ denote the coordinate functions of $\varphi$, and define a map $\tilde{\varphi}: \pi^{-1}(U)\to\R^{2n}$ by

$$
  \tilde{\varphi}\left(v^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p} \right) = \left(x^1(\mathbf{p}),\dots,x^n (\mathbf{p}),v^1,\dots,v^n \right)
$$

It image set is $\varphi(U)\times\R^n$ which is an open subset of $\R^{2n}$. It is a bijection onto its image, because its inverse can be written explicitly as

$$
  \tilde{\varphi}^{-1}(x^1,\dots,x^n,v^1,\dots,v^n) = v^i \left.\frac{\partial}{\partial x^i}\right|_{\varphi^{-1}(\mathbf{x})}
$$

Suppose that we are given two smooth charts $(U,\varphi)$ and $(V,\psi)$ for $M$, and let $(\psi^{-1}(U), \tilde{\varphi})$ and $(\tilde^{-1}(V), \tilde{\psi})$ be the corresponding charts on $TM$. The sets

$$
\begin{align*}
  \tilde{\varphi}\left(\pi^{-1}(U) \cap \pi^{-1}(V) \right) =& \varphi(U \cap V) \times\R^n \\
  \tilde{\psi}\left(\pi^{-1}(U) \cap \pi^{-1}(V) \right) =& \psi(U \cap V) \times\R^n
\end{align*}
$$

are open in $\R^{2n}$, and the transition map $\tilde{\psi}\circ\tilde{\varphi}^{-1}: \varphi(U\cap V)\times\R^n \to \psi(U\cap V)\times\R^n$ can be written as

$$
\begin{align*}
  &\tilde{psi}\circ\varphi^^{-1}(x^1,\dots,x^n,v^1,\dots,v^n) \\
  &= \left(\tilde{x}^1(\mathbf{x}),\dots,\tilde{x}^n(\mathbf{x}), \frac{\partial \tilde{x}^1}{\partial x^j}(\mathbf{x})v^j,\dots,\frac{\partial\tilde{x}^n}{\partial x^j}(\mathbf{x})v^j \right)
\end{align*}
$$

which is clearly smooth.

Choosing a countable cover $\Set{U_i}$ of $M$ by smooth coordinate domains, we obtain a countable cover of $TM$ by coordinate domains $\Set{\pi^{-1}(U_i)}$ satisfying the conditions of the smooth manifold chart lemma. To check the Hausdorff condition, note that any two points in the same fibre of $\pi$ lie in one chart, while if $(\mathbf{p},\mathbf{v})$ and $(\mathbf{q}, \mathbf{w})$ lie in different fibers, there exits disjoint smooth coordinate domains $U$ and $V$ for $M$ such that $\mathbf{p}\in U$ and $\mathbf{q}\in V$, and then $\pi^{-1}(U)$ and $\pi^{-1}(V)$ are disjoint coordinate neighbourhoods containing $(\mathbf{p}, \mathbf{v})$ and $(\mathbf{q},\mathbf{w})$, respectively.

To se that $\pi$ is smooth, note that with respect to the charts $(U,\varphi)$ for $M$ and $(\pi^{-1}(U), \tilde{\varphi})$ for $TM$, its coordinate representation is $\pi(\mathbf{p},\mathbf{v}) = \mathbf{x}$.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
If $M$ is a smooth $n$-manifold with or without boundary, and $M$ can be covered by a single smooth chart, then $TM$ is diffeomorphic to $M\times\R^n$.

<details>
<summary>Proof</summary>

If $(U,\varphi)$ is a global smooth chart for $M$, then $\varphi$ is, in particular a diffeomorphism from $U = M$ to an open subset $\hat{U}\subseteq \R^n$ or $H^n$. The proof from the previous proposition showed that the natural coordinate chart $\tilde{\varphi}$ is a bijection from $TM$ for $\hat{U}\times\R^n$, and the smooth structure on $TM$ is defined essentially by declaring $\tilde{\varphi}$ to be a diffeomorphism.
</details>
</MathBox>

Let $F:M\to N$ be a smooth map between smooth manifolds $M$ and $N$. By combining the differentials of $F$ at all points of $M$, we obtain a globally defined map $\mathrm{d}F: TM\to TN$ between tangent bundles, called the *global differential* or *global tangent map*. This is just the map whose restriction to each tangent space $T_\mathbf{p}M \subseteq TM$ is $\mathrm{d}F_p$.

<MathBox title='' boxType='proposition'>
If $F: M\to N$ is a smooth map, its global differential $\mathrm{d}F: TM\to TN$ is a smooth map.

<details>
<summary>Proof</summary>

From the local expression for $\mathrm{d}F_p$ in coordinates, it follows that $\mathrm{d}F$ has the following coordinate representation in terms of natural coordinates for $TM$ and $TN$:

$$
  \mathbf{d}F(x^1,\dots,x^n,v^1,\dots^n) = \left(F^1(\mathbf{x}),\dots,F^n(\mathbf{x}),\frac{\partial F^1}{\partial x^i}(\mathbf{x})v^i,\dots,\frac{\partial F^n}{\partial x^i}(\mathbf{x})v^i \right)
$$

This map is smooth, because $F$ is smooth.
</details>
</MathBox>

<MathBox title='Properties of the global differential' boxType='proposition'>
Suppose that $F:M\to N$ and $G:N\to P$ are smooth maps.
1. $\mathrm{d}(G\circ F) = \mathrm{d}G\circ\mathrm{d}F$
2. $\mathrm{d}(\mathrm{id}_M) = \mathrm{id}_{TM}$ 
3. if $F$ is a diffeomorphism, then $\mathrm{d}F:TM\to TN$ is also a diffeomorphism, and $(\mathrm{d}F)^{-1} = \mathrm{d}(F^{-1})$ allowing us to write $\mathrm{d}F^{-1}$ unambiguously
</MathBox>

## Velocity vectors of curves

<MathBox title='Curve and velocity' boxType='definition'>
If $M$ is a manifold with or without boundary, a *curve* in $M$ is a continuous map $\gamma: I\subseteq\R \to M$ where the interval $I\subseteq\R$ can be both open and closed.

If $\gamma$ is a smooth curve, the *velocity* of $\gamma$ at $t_0$ is defined as the tangent vector

$$
  \gamma'(t_0) = \mathrm{d}\gamma\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) \in T_{\gamma(t_0)}M
$$

where $\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0}$ is the standard coordinate basis vector in $T_{t_0}\R$. This tangent vector acts on functions by

$$
\begin{align*}
  \gamma' (t_0)f =& \mathrm{d}\gamma\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) = \left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} (f\circ\gamma) \\
  =& (f\circ\gamma)'(t_0)
\end{align*}
$$
</MathBox>

Let $(U,\varphi)$ be a smooth chart for a smooth $n$-manifold M with coordinate functions $(x^i)_{i=1}^n$. If $\gamma(t_0)\in U$, the coordinate representation of $\gamma$ is $\gamma(t) = (\gamma^i(t))_{i=1}^n$. The coordinate formula for the differential yields

$$
  \gamma'(t_0) = \frac{\mathrm{d}\gamma^i}{\mathrm{d}t}(t_0)\left.\frac{\partial}{\partial x^i}\right|_{\gamma(t_0)}
$$

This means that $\gamma'(t_0)$ is the tangent vector whose components in a coordinate basis are the derivatives of the component functions of $\gamma$.

<MathBox title='Tangent vectors are velocity vectors' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary and $\mathbf{p}\in M$. Every $\mathbf{v}\in T_\mathbf{p}M$ is the velocity of some smooth curve in $M$.

<details>
<summary>Proof</summary>

First, suppose that $\mathbf{p}\in\mathrm{int}(M)$. Let $(U,\varphi)$ be a smooth coordinate chart centered at $\mathbf{p}$, and write $\mathbf{v} = v^i \boldsymbol{\partial}_i |_\mathbf{p}$ in terms of the coordinate basis. For sufficiently small $\varepsilon > 0$, let $\gamma(-\varepsilon, \varepsilon) \to U$ be the curve with coordinate representation

$$
  \gamma(t) = (tv^i)_{i=1}^n
$$

This is a smooth curve with $\gamma(0) = \mathbf{p}$, and from the coordinate represenation of $\gamma'$ we get $\gamma'(0) = v^i \boldsymbol{\partial}_i |_{\gamma(0)} = \mathbf{v}$.

Next, suppose that $\mathbf{p}\in\partial M$. In this case, $\gamma(t) = (tv^i)_{i=1}^n$ only represents a point in $M$ when $tv^n \geq 0$. We can accommadate this by suitably restricting the domain of $\gamma$:
- if $v^n = 0$, we define $\gamma:(-\varepsilon, \varepsilon)\to U$ as before
- if $v^n >0$, we let the domain be $[0, \varepsilon)$
- if $v^n < 0$, we let the domain be $(-\varepsilon, 0]$

In each case, $\gamma$ is a smooth curve in $M$ with $\gamma(0) = \mathbf{p}$ and $\gamma'(0) = \mathbf{v}$.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $F:M\to N$ be a smooth map, and let $\gamma:I\to M$ be a smooth curve. For any $t_0 \in I$, the velocity at $t = t_0$ of the composite curve $F\circ\gamma:I\to N$ is given by

$$
  (F\circ\gamma)'(t_0) = \mathrm{d}F(\gamma'(t_0))
$$

<details>
<summary>Proof</summary>

From the definition of the velocity of a curve we get

$$
\begin{align*}
  (F\circ\gamma)'(t_0) =& \mathrm{d}(F\circ\gamma)\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) \\
  =& \mathrm{d}F \circ \mathrm{d}\gamma\left(\left.\frac{\mathrm{d}}{\mathrm{d}t}\right|_{t_0} \right) \\
  =& \mathrm{d}F(\gamma'(t_0))
\end{align*}
$$
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Suppose that $F:M\to N$ is a smooth map, and let $\mathbf{p}\in\mathbf{M}$ and $\mathbf{v}\in T_\mathbf{p}M$. Then

$$
  \mathrm{d}F_\mathbf{p}(\mathbf{v}) = (F\circ\gamma)'(0)
$$

for any smooth curve $\gamma:I\to M$ such that $0\in I$, $\gamma(0) = \mathbf{p}$ and $\gamma'(0) = \mathbf{v}$.
</MathBox>

## Alternative definitions of the tangent space

### Derivations of the space of germs

<MathBox title='Germ' boxType='definition'>
Let $M$ be a smooth manifold with or without boundary. A *smooth function element* on $M$ is an ordered pair $(f,U)$ where $U$ is an open subset of $M$ and $f:U\to\R$ is a smooth function.

For two function elements, we define an equivalence relation $(f,U)\sim_\mathbf{p} (g, V)$ if $f \equiv g$ on some neighbourhood of a point $\mathbf{p}\in M$. The equivalence class of a function element $(f,U)$, denoted $[(f,U)]_\mathbf{p}$, is called the *germ* of $f$ at $\mathbf{p}$. The set of all germs of smooth functions at $\mathbf{p}$ is denoted $C_\mathbf{p}^\infty (M)$. It is a real vector space and an associative algebra under the operations

- **(scalar multiplication):** $c[(f,U)]_\mathbf{p} = [(cf, U)]_\mathbf{p}$
- **(addition):** $[(f,U)]_\mathbf{p} + [(f + g, U\cap V)]_\mathbf{p}$
- **(multiplication):** $[(f,U)]_\mathbf{p} \cdot [(g,V)]_\mathbf{p} = [(fg, U\cap V)]$

A *derivation* of $C_\mathbf{p}^\infty$ is a linear map $v:C_\mathbf{p}^\infty (M) \to\R$ satisfying the product rule

$$
  v[fg]_\mathbf{p} = f(\mathbf{p})v[g]_\mathbf{p} + g(\mathbf{p})v[f]_\mathbf{p}
$$
</MathBox>

It is common to define the tangent space to $M$ at $\mathbf{p}$ as the vector space $D_\mathbf{p} M$ of derivations of $C_\mathbf{p}^\infty(M)$. The map $\phi: D_\mathbf{p}M \to T_\mathbf{p} M$ defined by $(\varphi\mathbf{v})f = \mathbf{v}([f]_\mathbf{p})$ is an isomorphism.

### Equivalence classes of curves

<MathBox title='Tangent space' boxType='definition'>
Let $M$ be an $n$-dimensional smooth manifold and let $p\in M$. The set of all curves in $M$ passing through $p$ is defined as

$$
  C_p (M) := \Set{ \gamma:(-\varepsilon, \epsilon) \to M | \gamma \textrm{ differentiable } \gamma(0) = p }
$$

For any chart $h: U\subseteq M \to\R^n$ there is an equivalence relation

$$
  \gamma\sim\alpha :\iff (h\circ\gamma)'(0) = (h\circ\alpha)'(0)
$$

The equivalence class $[\gamma]_\sim := \Set{\alpha | \gamma\sim\alpha }$ represents a tangent vector. The tangent space of $M$ at $p$, denoted $T_p M$ is defined as the set of all tangent vectors at $p$

$$
  T_p M := C_p(M)/\sim
$$
</MathBox>

<MathBox title='Coordinate basis' boxType='definition'>
Let $M$ be an $n$-dimensional smooth manifold having a chart $h:U\subseteq M \to \R^n$ with inverse $\phi = h^{-1}$. Since the tangent space $T_p M$ is isomorphic to $\R^n$ there is a linear and bijective map $h_* : T_p M \to \R^n$ given by $[\gamma]\mapsto (h\circ\gamma)'(0)$ where the equivalence class $[\gamma]$ is a tangent vector in $T_p M$. The coordinate basis with respect to $h$ is defined as

$$
  \partial_j := \phi_* (e_j)
$$

where $\phi_* := h_*^{-1}$ and $(e_i)_{i=1}^n$ is the standard basis of $\R^n$.
</MathBox>

<MathBox title='Differential' boxType='definition'>
Let $M, N$ be two smooth manifolds and let $f:M\to N$ be a smooth function. The differential of $f$ at $p\in M$ is defined as

$$
\begin{align*}
  \mathrm{d}f_p:& T_p M \to T_{f(p)} \\
  & [\gamma] \mapsto [f\circ\gamma]
\end{align*}
$$

The differential of $f$ is defined as

$$
  \mathrm{d}f: p\mapsto\mathrm{d}f_p
$$
</MathBox>

### Tangent space

<MathBox title='Tangent spaces of submanifolds' boxType='definition'>
Let $M\subseteq\R^n$ be a $k$-dimensional submanifold. Then there is a chart $(U, h)$ of $\R^n$ such that

$$
  h(M\cap U) = \left( \R^k \times \mathbf{0}_{n-k} \right) \cap U'
$$

Since $h$ is a homemorphism, we may form an inverse $\phi: \R^k \cap U \to M\cap U$ giving a local parametrization. The tangent space for $p\in M$ is defined as

$$
  \mathrm{T}_p M := \mathrm{d}\phi_{\tilde{p}} [\R^k] = \Set{ J_\phi \left( \phi^{-1}(p)x \right) | x\in\R^k } \subseteq\R^n 
$$

The tangent space can be reformulated in terms of a parametrized curve $\gamma:\R\to M$

$$
  \mathrm{T}_p M = \Set{ \gamma'(0) | \gamma:(-\varepsilon, \varepsilon) \to M \textrm{ differentiable with } \gamma(0) = p }
$$

<details>
<summary>Proof</summary>

To prove the reformulation, first let $v \in \mathrm{T}_p M$ such that $v = J_\phi\left(\tilde{p} \right)x$ with $\tilde{p} = \phi^{-1}(p)$ and $x\in\R^k$. Then for $\tilde{\gamma}(t) = \tilde{p} + tx$

$$
\begin{align}
  v &= J_\phi \left(\tilde{\gamma}(0) right)\tilde{\gamma}(0) \\
  &= \frac{\mathrm{d}}{\mathrm{d}t}\left(\gamma \circ \tilde{\gamma} \right)|_{t=0} = \gamma'
\end{align}
$$

This shows that $T_p M \subseteq \Set{ \gamma'(0) | \gamma:(-\varepsilon, \varepsilon) \to M \textrm{ differentiable with } \gamma(0) = p }$

Finally, let $\gamma: (-\varepsilon, \varepsilon) \to M$ differentiable with $\gamma (0) = p$. Since $M$ is a submanifold, there is a chart $h: U\cap M \to \R^k \cap U'$, which defines an inverse of $\phi$. Define $x:= \frac{\mathrm{d}}{\mathrm{d}t} (h \circ \gamma)|_{t=0}$ so that $\tilde{\gamma} = h\circ \gamma$. Then

$$
\begin{align}
  \gamma'(0) &= \frac{\mathrm{d}}{\mathrm{d}t}\left(\phi \circ \gamma)\right)|_{t=0} \\
  &= J_\phi \left(\tilde{\gamma}(0) \right)\tilde{\gamma}'(0) = J_\phi \left(\phi^{-1}(p)\right)x
\end{align}
$$

This shows that $T_p M \supseteq \Set{ \gamma'(0) | \gamma:(-\varepsilon, \varepsilon) \to M \textrm{ differentiable with } \gamma(0) = p }$
</details>
</MathBox>

# Submersions, immersions and embeddings

<MathBox title='Rank' boxType='definition'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary. Given a smooth map $F:M\to N$ and a point $\mathbf{p}\in M$, we define the *rank* of $F$ at $\mathbf{p}$ to be the rank of the linear map $\mathrm{d}F_\mathbf{p}:T_\mathbf{p}M \to T_{F(\mathbf{p})}N$, which is the rank of the Jacobian matrix of $F$ in any smooth smooth chart, or the dimension of $\mathrm{ran}(\mathrm{d}F_\mathbf{p}) \subseteq T_{F(\mathbf{p})} N$. 

The rank of $F$ at each point bounded above by $\min\Set{\dim(M),\dim(N)}$. If the rank of $\mathrm{d}F_\mathbf{p}$ is equal to this upper bound, then $F$ has full rank at $\mathbf{p}$, and if $F$ has full rank everywhere, we say that $F$ has *full rank*. If $F$ has the same rank at every point, we say that is has constant rank.

A smooth map $F:M\to N$ is called a *smooth submersion* if its differential is surjective at each point, i.e. $\mathrm{rank}(F) = \dim(N)$. It is called a *smooth immersion* if its differential is injective at each point, i.e. $\mathrm{rank}(F) = \dim(M)$.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $F:M\to N$ is a smooth map and $\mathbf{p}\in M$. If $\mathrm{d}F_\mathbf{p}$ is surjective, then $\mathbf{p}$ has a neighbourhood $U$ such that $F|_U$ is a submersion. If $\mathrm{d}F_\mathbf{p}$ is injective, then $\mathbf{p}$ has a neigbourhood $U$ such that $F|_U$ is an immersion.

<details>
<summary>Proof</summary>

If we choose any smooth coordinate for $M$ near $\mathbf{p}$ and for $N$ near $F(\mathbf{p})$, either hypothesis mean that the Jacobian matrix of $F$ in coordinates has full rank at $\mathbf{p}$. If $\dim(M)= m$ and $\dim(N) = n$, the set of $m\times n$ matrices of full rank is an open subset of $\mathcal{M}_{m,n}(\mathbb{R})$. By continuity, the Jacobian of $F$ has full rank in some neighbourhood of $\mathbf{p}$.
</details>
</MathBox>

## Local diffeomorphism

<MathBox title='Local diffeomorphism' boxType='definition'>
If $M$ and $N$ are smooth manifolds with or without boundary, a map $F:M\to N$ is called a *local diffeomorphism* if every point $p\in M$ has a neighbourhood $U$ such that $F(U)$ is open in $N$ and $F|_U:U\to F(U)$ is a diffeomorphism.
</MathBox>

<MathBox title='Inverse function theorem for manifolds' boxType='theorem'>
Suppose that  $M$ and $N$ are smooth manifolds, and let $F:M\to N$ be a smooth map. If $\mathbf{p}\in M$ is a point such that $\mathrm{d}F_\mathbf{p}$ is invertible, then there are connected neighbourhoods $U_0$ of $\mathbf{p}$ and $V_0$ of $F(\mathbf{p})$ such that $F|_U:U_0 \to V_0$ is a diffeomorphism.

<details>
<summary>Proof</summary>

The fact that $\mathrm{d}F_\mathbf{p}$ is bijective implies that $M$ and $N$ have the same dimension, say $n$. Choose smooth charts $(U,\varphi)$ centered at $\mathbf{p}$ and $(V,\psi)$ centered at $F(\mathbf{p})$ with $F(U) \subseteq V$. Then $\tilde{F} = \psi\circ F\circ\varphi^{-1}$ is a smooth map from the open subset $\tilde{U} = \varphi(U)\subseteq\R^n$ into $\tilde{V} = \psi(V)\subseteq\R^n$ with $\tilde{F}(\mathbf{p}) = 0$. Because $\varphi$ and $\psi$ are diffeomorphisms, the differential $\mathrm{d}\tilde{F}_0 = \mathrm{d}_{\psi_{F(\mathbf{p})}} \circ \mathrm{d}F_\mathbf{p} \circ \mathrm{d}(\varphi^{-1})_0$ is nonsingular. The ordinary inverse function theorem shows that there are connected open subsets $\tilde{U}_0 \subseteq\tilde{U}$ and $\tilde{V}_0 \subseteq\tilde{V}$ containing $0$ such that $\tilde{F}$ restricts to a diffeomorphism from $\tilde{U}_0$ to $\tilde{V}_0$. Then $U_0 = \varphi^{-1} (\tilde{U}_0)$ and $V_0 = \psi^{-1}(\tilde{V}_0)$ are connected neighbourhoods of $\mathbf{p}$ and $F(\mathbf{p})$, respectively, and it follows by composition that $F|_{U_0}$ is a diffeomorphism from $U_0$ to $V_0$.
</details>
</MathBox>

<MathBox title='Properties of local diffeomorphisms' boxType='proposition'>
1. Every composition of local diffeomorphisms is a local diffeomorphism.
2. Every finite product of local diffeomorphisms between smooth manifolds is a local diffeomorphism.
3. Every local diffeomorphism is a local homeomorphism and an open map.
4. The restriction of a local diffeomorphism to an open submanifold with or without boundary is a local diffeomorphism.
5. Every diffeomorphism is a local diffeomorphism.
6. Every bijective local diffeomorphism is a diffeomorphism.
7. A map between smooth manifolds with or without boundary is a local diffeomorphism if and only if in a neighbourhood of each point of its domain, it has a coordinate representation that is a local diffeomorphism.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds without boundary, and that $F:M\to N$ is a map.
1. $F$ is a local diffeomorphism if and only if it is both a smooth immersion and a smooth submersion.
2. If $\dim(M) = \dim(N)$ and $F$ is neither a smooth immersion or a smooth submersion, then it is a local diffeomorphism.

<details>
<summary>Proof</summary>

**(1):** Suppose first that $F$ is a local diffeomorpism. Given $\mathbf{p}\in M$ there is a neighbourhood $U$ of $\mathbf{p}$ such that $F$ is a diffeomorphism from $U$ to $F(U)$. It follows that $\mathrm{d}F_\mathbf{p}:T_\mathbf{p}M\to T_{F(\mathbf{p})} N$ is an isomorphism. Thus, $\mathrm{rank}(F) = \dim(M) = \dim(N)$, so $F$ is both a smooth immersion and a smooth submersion.

Conversely, if $F$ is both a smooth immersion and a smooth submersion, then $\mathrm{d}F_\mathbf{p}$ is an isomorphism at each $\mathbf{p}\in M$, and the inverse function theorem for manifolds shows that $\mathbf{p}$ has a neighbourhood on which $F$ restricts to a diffeomorphism onto its image.

**(2):** Note that if $M$ and $N$ have the same dimension, then either injectivity or surjectivity of $\mathrm{d}F_\mathbf{p}$ implies bijectivity, so $F$ is a smooth submersion if and only if it is a smooth immersion, and thus **(2)** follows from **(1)**.
</details>
</MathBox>

## The rank theorem

<MathBox title='Rank theorem' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds of dimensions $m$ and $n$, respectively, and that $F:M\to N$ is a smooth map with constant rank $\mathrm{rank}(F) = r$. For each $\mathbf{p}\in M$, there exists smooth charts $(U,\varphi)$ for $M$ centered at $\mathbf{p}$ and $(V,\psi)$ for $N$ centered at $F(\mathbf{p})$ such that $F(U) \subseteq V$, in which $F$ has a coordinate representation of the form

$$
  \tilde{F}(x^1,\dots,x^r,x^{r+1},\dots,x^m) = (x^1,\dots,x^r,0,\dots,0)
$$

In particular, if $F$ is a smooth submersion, this becomes

$$
  \tilde{F}(x^1,\dots,x^n,x^{n+1},\dots,x^m) = (x^1,\dots,x^n)
$$

and if $F$ is a smooth immersion, it is

$$
  \tilde{F}(x^1,\dots,\dots,x^m) = (x^1,\dots,x^m,0,\dots,0)
$$

<details>
<summary>Proof</summary>

Because the theorem is local, after choosing smooth coordinates we can replace $M$ and $N$ by open subsets $U\subseteq\R^m$ and $V\subseteq\R^n$. The fact that $\mathrm{D}F(\mathbf{p})$ has rank $r$ implies that its matrix has some $r\times r$ submatrix with nonzero determinant. By reordering the coordinates, we may assume that it is the upper left submatrix, $\left(\frac{\partial F^i}{\partial x^j}\right)$ for $i,j=1,\dots,r$. 

Let us relabel the standard coordinates as $(x, y) = (x^1,\dots,x^r, y^1,\dots,y^{m-r})$ in $\R^n$ and $(v,w) = (v^1,\dots,v^r,w^1,\dots,w^{n-r})$ in $\R^n$. By initial translations of the coordinates, we may assume without loss of generality that $\mathbf{p} = (0, 0)$ and $F(\mathbf{p}) = (0,0)$. If we write $F(x,y) = (Q(x,y), R(x,y))$ for some smooth maps $Q: U\to\R^r$ and $R:U\to\R^{n-r}$, then our hypothesis is that $\left(\frac{\partial Q^i}{\partial x^j}\right)$ is nonsingular at $(0,0)$.

Define $\varphi:U\to\R^m$ by $\varphi(x,y) = (Q(x,y), y)$. Its total derivative at $(0,0)$ is

$$
  \mathrm{D}\varphi(0,0) = \begin{bmatrix}
    \frac{\partial Q^i}{\partial x^j}(0,0) & \frac{\partial Q^i}{\partial y^j}(0,0) \\
    0 & \delta_j^i
  \end{bmatrix}
$$

The matrix $\mathrm{D}\varphi(0,0)$ is nonsingular by virtue of the hypothesis. Thus, by the inverse function theorem, there are connected neighbourhoods $U_0$ of $(0,0)$ and $\tilde{U}_0$ of $\varphi(0,0) = (0,0)$ such that $\varphi:U_0\to\tilde{U}_0$ is a diffeomorphism. By shrinking $U_0$ and $\tilde{U}_0$ if necessary, we may assume that $\tilde{U}_0$ is an open cube. Writing the inverse map as $\varphi^{-1}(x,y) = (A(x,y), B(x,y))$ for some smooth functions $A:\tilde{U}_0 \to \R^r$ and $B:\tilde{U}_0 \to\R^{m-r}$, we get

$$
\begin{align*}
  (x,y) =& \varphi(A(x,y), B(x,y)) \\
  =& (Q(A(x,y), B(x,y)), B(x,y))
\end{align*}
$$

Comparing $y$ components shows that $B(x,y) = y$ and therefore $\varphi^{-1}$ has the form

$$
  \varphi^{-1}(x,y) = (A(x,y),y)
$$

On the other hand, $\varphi\circ\varphi^{-1} = \mathrm{id}$ implies that $Q(A(x,y),y)$ = x, and therefore $F\circ\varphi^{-1}$ has the form

$$
  F\circ\varphi^{-1}(x,y) = (x, \tilde{R}(x,y))
$$

where $\tilde{R}:\tilde{U}_0 \to\R^{n-r}$ is defined by $\tilde{R}(x,y) = R(A(x,y), y)$. The Jacobian matrix fo this composite map at an arbitrary point $(x,y)\in\tilde{U}$ is

$$
  \mathrm{D}(F\circ \varphi^{-1})(x,y) = \begin{bmatrix}
    \delta_j^i & 0 \\
    \frac{\partial\tilde{R}^i}{\partial x^j}(x,y) & \frac{\partial\tilde{R}^i}{\partial y^j} (x,y)
  \end{bmatrix}
$$

Since composing with a diffeomorphism does not change the rank of a map, this matrix has rank $r$ everywhere in $\tilde{U}_0$. The first $r$ columns are obviously linearly independent, so the rank can be $r$ on if the derivatives $\frac{\partial\tilde{R}^i}{\partial y^j}$ vanish identically on $\tilde{U}_0$, which implies that $\tilde{R}$ is independent of $(y^1,\dots,y^{m-r})$. Thus, if we let $S(x) = \tilde{R}(x,0)$, then we have

$$
  F\circ\varphi^{-1}(x,y) = (x, S(x))
$$

To complete the proof, we need to define an appropriate smooth chart in some neighbourhood of $(0,0)\in V$. Let $V_0 \subseteq V$ be the open subset defined by $V_0 = \Set{(v,w)\in V | (v,0)\in\tilde{U}_0}$. Then $V_0$ is a neighbourhood of $(0,0)$. Because $\tilde{U}_0$ is a cube and $F\circ\varphi^{-1}$ has the form above, it follows that $F\circ \varphi^{-1}(\tilde{U}_0) \subseteq V_0$, and therefore $F(U_0)\subseteq V_0$. Define $\psi:V_0 \to\R^n$ by $\psi(v,w) = (v, w - S(v))$. This is a diffeomorphism onto its image, because its inverse is given explicitly by $\psi^{-1}(s,t) = (s,t + S(s))$. Thus, $(V_0, \psi)$ is a smooth chart. It follows that 

$$
\begin{align*}
  \psi\circ F\circ\varphi^{-1} (x,y) =& \psi(x, S(x)) \\
  =& (x, S(x) - S(x)) = (x,0)
\end{align*}
$$

which was to be proved.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Let $M$ and $N$ be smooth manifold, let $F:M\to N$ be a smooth map, and suppose that $M$ is connected. Then the following are equivalent:
1. For each $\mathbf{p}\in M$ there exist smooth charts containing $\mathbf{p}$ and $F(\mathbf{p})$ in which the coordinate representation of $F$ is linear.
2. $F$ has constant rank

<details>
<summary>Proof</summary>

First, suppose that $F$ has a linear coordinate representation in a neighbourhood of each point. Since every linear map has constant rank, it follows that the rank of $F$ is constant in a neighbourhood of each point, and thus by connectedness it is constant on all of $M$. Conversely, if $F$ has constant rank, the rank theorem shows that it has the linear coordinate representation in a neighbourhood of each point.
</details>
</MathBox>

<MathBox title='Global rank theorem' boxType='theorem'>
Let $M$ and $N$ be smooth manifold, and suppose that $F:M\to N$ is a smooth map of constant rank.
1. if $F$ is surjective, then it is a smooth submersion
2. if $F$ is injective, then it is a smooth immersion
3. if $F$ is bijective, then it is a diffeomorphism

<details>
<summary>Proof</summary>

Let $\dim(M) = m$ and $\dim(N) = n$, and suppose $\mathrm{rank}(F) = r$ is constant.

**(1):** Assume that $F$ is not a smooth submersion, which means that $r < n$. By the rank theorem, for each $\mathbf{p}\in M$ there are smooth charts $(U,\varphi)$ for $M$ centered at $\mathbf{p}$ and $(V,\psi)$ for $N$ centered at $F(\mathbf{p})$ such that $F(U) \subseteq V$ and the coordinate representation of $F$ is given by the rank theorem, Shrinking $U$ if necessary, we may assume that it is a regular coordinate ball and $F(\overline(U))\subseteq V$. This implies that $F(\overline{U})$ is a compact subset of the set $\Set{y\in V | y^{r+1} = \cdots = y^n = 0}$, so it is closed in $N$ and contains no open subset of $N$; hence it is nowhere dense in $N$. Since very open cover of a manifold has a countable subcover, we can choose countably many such charts $\Set{(U_i,\varphi_i)}$ covering $M$, with corresponding charts $\Set{(V_i,\psi_i)}$ covering $F(M)$. Because $F(M)$ is equal to the countable union of the nowhere dense sets $F(\overline{U}_i)$, it follows from the Baire category theorem that $F(M)$ has empty interior in $N$, meaning that $F$ cannot be surjective.

**(2):** Asuume that $F$ is not a smooth immersion, so that $r < m$. By the rank theorem, for each $\mathbf{p}\in M$ we can choose charts on neighbourhoods of $\mathbf{p}$ and $F(\mathbf{p})$ in which $F$ has the coordinate representation given by the rank theorem. It follows that $F(0,\dots,0,\varepsilon) = F(0,\dots,0,0)$ for any sufficiently small $varepislon$, so $F$ is not injective.

**(3):**  This follows from **(1)** and **(2)**, because a bijective smooth map of constant rank is a smooth submersion by part **(1)** and a smooth immersion by part **(2)**. It follows that $F$ is a local diffeomorphism, and because it is bijective, it is a diffeomorphism.
</details>
</MathBox>

### Rank theorem for manifolds with boundary

<MathBox title='Local immersion theorem for manifolds with boundary' boxType='theorem'>
Suppose that $M$ is a smooth $m$-manifold with boundary, $N$ is a smooth $n$-manifold, and $F:M\to N$ is a smooth immersion. For any $\mathbf{p}\in\partial M$, there exist a smooth boundary chart $(U,\varphi)$ for $M$ centered at $p$ and a smooth coordinate chart $(V,\psi)$ for $N$ centered at $F(\mathbf{p})$ with $F(U)\subseteq V$, in which $F$ has the coordinate representation

$$
  \hat{F}(x^1,\dots,x^m) = (x^1,\dots,x^m,0,\dots,0)
$$

<details>
<summary>Proof</summary>

By choosing initial smooth charts for $M$ and $N$, we may assume that $M$ and $N$ are open subsets of $H^m$ and $\R^n$, respectively, and also that $\mathbf{p} = 0 \in H^m$ and $F(\mathbf{p}) = 0\in\R^n$. By definition os smoothness for functions on $H^m$, it follows that $F$ extends to a smooth map $\tilde{F}:W\to\R^n$, where $W$ is some open subset of $\R^m$ containing $0$. Because $\mathrm{d}\tilde{F}_0 = \mathrm{d}F_0$ is injective, by shrinking $W$ if necessary, we may assume that $\tilde{F}$ is a smooth immersion. Let us write coordintes on $\R^m$ as $x = (x^i)_{i=1}^m$ and those on $\R$ as $(v,w) = (v^1,0\dots,v^m, w^1,\dots,w^{n-m})$.

By the rank theorem, there exist smooth charts $(U_0, \varphi_0)$ for $\R^m$ centered at $0$ and $(V_0,\psi_0)$ for $\R^n$ centered at $0$ such that $\hat{F} = \psi_0 \circ\tilde{F}\circ\varphi_0^{-1}$ is given by the coordinate representation in the hypothesis. The only problem with these coordinates is that $\varphi_0$ might not restrict to a boundary chart for $M$. But we can correct this easily as follow. 

Because $\varphi_0$ is a diffeomorphism from $U_0$ to an open subset $\hat{U}_0 = \psi_0(U_0)\subseteq\R^m$, the map $\varphi_0^{-1} \times\mathrm{id}_{\R^{n-m}}$ is a diffeomorphism from $\tilde{U}_0 \times\R^{n-m}$ to $U_0 \times\R^{n-m}$. Let $\psi = (\varphi_0^{-1} \times \mathrm{id}_{\R^{n-m}}) \circ\varphi_0$, which is a diffeomorphism from some open subset $V\subseteq V_0$ containing $0$ to a neighbourhood of $0$ in $\R^n$. Using the hypothesis coordinate representation, we compute

$$
\begin{align*}
  \psi\circ F(x) =& \left(\varphi_0^{-1} \times\mathrm{id}_{\R^{n-m}} \right) \circ\varphi_0 \circ F \circ\varphi_0^{-1} \circ\varphi_0(x) \\
  =& \left(\varphi_0^{-1} \times\mathrm{id}_{\R^{n-m}} \right) \circ \hat{F}(\varphi_0(x)) \\
  =& \left(\varphi_0^{-1} \times\mathrm{id}_{\R^{n-m}} \right)(\varphi(x),0) = (x,0)
\end{align*}
$$

Thus, the original coordinates for $M$ (restricted to a sufficiently small neighbourhood of $0$) and the chart $(V,\psi)$ for $N$ satisfy the desired conditions.
</details>
</MathBox>

## Embeddings

<MathBox title='Smooth embedding' boxType='definition'>
If $M$ and $N$ are smooth manifolds with or without boundary, a *smooth embedding* of $M$ into $N$ is a smooth immersion $F:M\to N$ that is also a topological embedding, i.e. a homeomorphism onto its image $F(M)\subseteq N$ in the subspace topology. A smooth embedding is a map that is both a topological embedding and a smooth immersion.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and let $F:M\to N$ be an injective smooth immersion. If any of the following holds, then $F$ is a smooth embedding.
1. $F$ is an open or closed map
2. $F$ is a proper map
3. $M$ is compact
4. $M$ has empty boundary and $\dim(M) = \dim(N)$

<details>
<summary>Proof</summary>

**(1)**, **(2)** and **(3)** follow from properties of topological embeddings.

**(4):** If $M$ has empty boundary and $\dim(M) = \dim(N)$, then $\mathrm{d}F_\mathbf{p}$ is nonsingular everywhere, and it follows that $F(M) \subseteq \mathrm{int}(N)$. Since $F:M\to\mathrm{int}(N)$ is a local diffeomorphism, it is an open map. It follows that $F:M\to N$ is a composition of open maps $M\to \mathrm{int}(N)\hookrightarrow N$, so it is an embedding.
</details>
</MathBox>

<MathBox title='Local embedding theorem' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds with or without boundary, and $F:M\to N$ is a smooth map. Then $F$ is a smooth immersion if and only if every point in $M$ has a neighbourhood $U\subseteq M$ such that $F|_U:U\to N$ is a smooth embedding.

<details>
<summary>Proof</summary>

One direction is immediate: if every point has a neighbourhood on which $F$ is a smooth embedding, then $F$ has full rank everywhere, making it a smooth immersion.

Conversely, suppose that $F$ is a smooth immersion, and let $\mathbf{p}\in M$. We show first that $\mathbf{p}$ has a neighbourhood on which $F$ is injective. If $F(\mathbf{p}) \notin\partial N$, then either the rank theorem (if $\mathbf{p}\notin\partial M$) or the local immersion theorem (if $\mathbf{p}\in\partial M$) implies that there is a neighbourhood $U_1$ on $\mathbf{p}$ on which $F$ has a coordinate representation from the rank theorem. It follows from this formula that $F|_{U_1}$ is injective.

On the other hand, suppose that $F(\mathbf{p})\in\partial N$ and let $(W,\psi)$ be any smooth boundary chart for $N$ centered at $F(\mathbf{p})$. If we let $U_0 = F^{-1}(W)$, which is a neighbourhood of $\mathbf{p}$, and let $\iota:H^n \to\R^n$ be the inclusion map, then the preceeding argument can be applied to the composite map $\iota\circ\psi\circ F|_{U_0}: U_0 \to\R^n$ to show that $\mathbf{p}$ has a neighbourhood $U_1 \subseteq U_0$ such that $\iota\circ\psi\circ F|_{U_1}$ is injective, from which it follows that $F|_{U_1}$ is injective.

Let $\mathbf{p}\in M$ be arbitray, and let $U_1$ be a neighbourhood of $\mathbf{p}$ on which $F$ is injective. There exists a precompact neighbourhood $U$ of $\mathbf{p}$ such that $\overline{U}\subseteq U_1$. The restriction of $F$ to $\overline{U}$ is an injective continuous map with compact domain, so it is a topological embedding by the closed map lemma. Because any restriction of a topological embedding is again a topological embedding, $F|_U$ is both a topological embedding and a smooth immersion, hence a smooth embedding.
</details>
</MathBox>

## Submersions

<MathBox title='Section' boxType='definition'>
If $\pi:M\to N$ is any continuous map, a *section* of $\pi$ is a continuous right inverse for $\pi$, i.e. a continuous map $\sigma:N\to M$ such that $\pi\circ\sigma = \mathrm{id}_N$.

A *local section* of $\pi$ is a continuous map $\sigma:U\to M$ defined on some open subset $U\subseteq N$ and satisfying the analogous relation $\pi\circ\sigma = \mathrm{id}_U$.
</MathBox>

<MathBox title='Local section theorem' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds, and let $\pi:M\to N$ be a smooth map. Then $\pi$ is a smooth submersion if and only if every point of $M$ is in the image of a smooth local section of $\pi$.

<details>
<summary>Proof</summary>

Let $\dim(M) = m$ and $\dim(N) = n$. 

First, suppose that $\pi$ is a smooth submersion. Given $\mathbf{p}\in M$, let $\mathbf{q} = \pi(\mathbf{p})\in N$. By the rank theorem, we can chose smooth coordinates $(x^i)_{i=1}^m$ centered at $\mathbf{p}$ and $(y^j)_{j=1}^n$ centered at $\mathbf{q}$ in which $\pi$ has the coordinate representation

$$
  \pi(x^1,\dots,x^n,x^{n+1},\dots,x^m) = (x^1,\dots,x^n)
$$

If $\varepsilon > 0$ is sufficiently small, the coordinate cube

$$
  C_\varepsilon = \Set{x: \lvert x^i \rvert < \varepsion, i=1,\dots,m}
$$

is a neighbourhood of $\mathbf{p}$ whose image under $\pi$ is the cube

$$
  C'_\varepsilon = \Set{y: \lvert y^i \rvert < \varepsilon, i=1,\dots,m}
$$

The map $\sigma: C'_\varepsilon \to C_\varepsilon$ whose coordinate representation is

$$
  \sigma(x^1,\dots,x^n) = (x^1,\dots,x^n,0,\dots,0)
$$

is a smooth local section of $\pi$ satisfying $\sigma(\mathbf{q}) = \mathbf{p}$.

Conversely, assume that each point of $M$ is in the image of a smooth local section. Given $\mathbf{p}\in M$, let $\sigma:U\to M$ be a smooth local section such that $\sigma(\mathbf{q}) = \mathbf{p}$, where $\mathbf{q} = \pi(\sigma(\mathbf{q})) = \pi(\mathbf{p})\in N$. The equation $\pi\circ\sigma = \mathrm{id}_U$ implies that $\mathrm{d}\pi_\mathbf{p} \circ \mathrm{d}\sigma_\mathbf{q} = \mathrm{id}_{T_\mathbf{q} N}$, which in turn implies that $\mathrm{d}\pi_\mathbf{p}$ is surjective.
</details>
</MathBox>

<MathBox title='Properties of smooth submersions' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds, and let $\pi:M\to N$ be a smooth submersion. Then $\pi$ is an open map, and if it is surjective it is a quotient map.

<details>
<summary>Proof</summary>

Suppose that $W$ is an open subset of $M$ and $\mathbf{q}$ is a point of $\pi(W)$. For any $\mathbf{p}\in W$ such that $\pi(\mathbf{p}) = \mathbf{q}$, there is a neighbourhood $U$ of $\mathbf{q}$ on which there exists a smooth local section $\sigma:U\to M$ of $\pi$ satisfying $\sigma(\mathbf{q}) = \mathbf{p}$. For each $\mathbf{y}\in \sigma^{-1}(W)$, the fact that $\sigma(\mathbf{y})\in W$ implies $\mathbf{y} = \pi(\sigma(\mathbf{y}))\in \pi(W)$. Thus $\sigma^{-1}(W)$ is a neighbourhood of $q$ contained in $\pi(W)$, which implies that $\pi(W)$ is open. The second assertion follows from the first because every surjective open continuous map is a quotient map. 
</details>
</MathBox>

<MathBox title='Characteristic property of surjective smooth submersions' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds, and let $\pi:M\to N$ be a surjective smooth submersion. For any smooth manifold $P$ with or without boundary, a map $F:N\to P$ is smooth if and only if $F\circ\pi$ is smooth

$$
\begin{CD}
  M @>{F\circ\pi}>> P \\
  @V{\pi}VV @| \\
  N @>>{F}> P
\end{CD}
$$

<details>
<summary>Proof</summary>

If $F$ is smooth, then $F\circ\pi$ is smooth by composition. Conversely, suppose that $F\circ\pi$ is smooth, and let $\mathbf{q}\in N$ be arbitrary. Since $\pi$ is surjective, there is a point $\mathbf{p}\in\pi^{-1}(\mathbf{q})$, and then the local section theorem guarantees the existence of a neigbourhood $U$ of $\mathbf{q}$ and a smooth local section $\sigma:U\to M$ of $\pi$ such that $\sigma(\mathbf{q}) = \mathbf{p}$. Then $\pi\circ\sigma = \mathrm{id}_U$ implies

$$
\begin{align*}
  F|_U =& F|_U \circ \mathrm{id}_U \\
  =& F|_U \circ (\pi\circ\sigma) \\
  =& (F\circ\pi)\circ\sigma
\end{align*}
$$

which is a composition of smooth maps. This shows that $F$ is smooth in a neighbourhood of each point, so it is smooth.
</details>
</MathBox>

<MathBox title='Passing smoothly to the quotient' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifolds, and let $\pi:M\to N$ be a surjective smooth submersion. If $P$ is a smooth manifold with or without boundary and $F:M\to P$ is a smooth map that is constant on the fibers of $\pi$, then there exists a unique smooth map $\tilde{F}:N\to P$ such that $\tilde{F}\circ\pi = F$

$$
\begin{CD}
  M @>{F\circ\pi}>> P \\
  @V{\pi}VV @| \\
  N @>>{\tilde{F}}> P
\end{CD}
$$

<details>
<summary>Proof</summary>

Since a surjective smooth submersion is a quotient map, the passing to the quotient theorem, shows that there exists a unique continuous map $\tilde{F}:N\to P$ satisfying $\tilde{F}\circ\pi = F$, which is mooth by the characteristic property of surjective smooth submersions.
</details>
</MathBox>

<MathBox title='Uniqueness of smooth quotients' boxType='theorem'>
Suppose that $M$, $N_1$ and $N_2$ are smooth manifolds, and let $\pi_1:M\to N_1$ and $\pi_2:M\to N_2$ be a surjective smooth submersions that are constannt on each other's fibers. Then there exists a unique diffeomorphism $F:N_1\to N_2$ such that $F\circ \pi_1 = \pi_2$

$$
\begin{CD}
  M @= M \\
  @V{\pi_1}VV @VV{\pi_2}V \\
  N_1 @>>{F}> N_2
\end{CD}
$$
</MathBox>

## Smooth covering maps

<MathBox title='Smooth covering map' boxType='definition'>
If $E$ and $M$ are connected smooth manifolds with or without boundary, a map $\pi:E\to M$ is called a *smooth covering map* if $\pi$ is smooth and surjective, and point in $M$ has a neighbourhood $U$ such that each component of $\pi^{-1}(U)$ is mapped diffeomorphically onto $U$ by $\pi$. In this context, we say that $U$ is *evenly covered*. The space $M$ is called the *base of the covering*, and $E$ is called a *covering manifold* of $M$. If $E$ is simply connected, it is called the *universal covering manifold of* $M$.
</MathBox>

<MathBox title='Properties of smooth coverings' boxType='proposition'>
1. Every smooth covering map is a local diffeomorphism, a smooth submersion, an open map, and a quotient map.
2. An injective smooth covering map is a diffeomorphism.
3. A topological covering map is a smooth covering map if and only if it is a local
diffeomorphism.
</MathBox>

<MathBox title='Local section theorem for smooth covering maps' boxType='theorem'>
Suppose that $E$ and $M$ are smooth manifolds with or without boundary, and let $\pi:E\to M$ be a smooth covering map. Given any evenly covered open subsets $U\subseteq M$, any $\mathbf{q}\in U$ and any $\mathbf{p}$ in the fibre of $\pi$ over $\mathbf{q}$, there exists a unique smooth local section $\sigma:U\to E$ such that $\sigma(\mathbf{q}) = \mathbf{p}$.

<details>
<summary>Proof</summary>

Let $\tilde{U}_0$ be the component of $\pi^{-1}(U)$ containing $\mathbf{p}$. Since the restriction of $\pi$ to $U_0$ is a diffeomorphism onto $U$, the map $\sigma = \left(\pi|_{\tilde{U}_0}\right)^{-1}$ is the required smooth local section.

To prove uniqueness, suppose that $\sigma':U\to E$ is any other smooth local section satisfying $\sigma'(\mathbf{q}) = \mathbf{p}$. Since $U$ is connected, $\sigma'(U)$ is contained in the component $\tilde{U}_0$ containing $\mathbf{p}$. Because $\sigma'$ is a right inverse for the bijective map $\pi|_{\tilde{U}_0}$, it must be equal to its inverse, and therefore equal to $\sigma$.
</details>
</MathBox>

<MathBox title='Covering spaces of smooth manifolds' boxType='proposition'>
Suppose that $M$ is a connected smooth $n$-manifold, and let $\pi:E\to M$ be a topological covering map. Then $E$ is a topological $n$-manifold, and has a unique smooth structure such that $\pi$ is a smooth covering map.

<details>
<summary>Proof</summary>

Because $\pi$ is a local homeomorphism, $E$ is locally Euclidean. 

**$E$ is Hausdorff**<br/>
To show that it is Hausdorff, let $\mathbf{p}_1$ and $\mathbf{p}_2$ be distinct points in $E$. If $\varphi(\mathbf{p}_1) = \pi(\mathbf{p}_2)$ and $U\subseteq M$ is an evenly covered subset containing $\pi(\mathbf{p}_1)$, then the components of $\pi^{-1}(U)$ containing $\mathbf{p}_1$ and $\mathbf{p}_2$ are disjoint open subsets of $E$ that separate $\mathbf{p}_1$ and $\mathbf{p}_2$.

On the other hand, if $\pi(\mathbf{p}_1) \neq\pi(\mathbf{p}_2)$, there are disjoint open subsets $U_1, U_2 \subseteq M$ containing $\pi(\mathbf{p}_1)$ and $\pi(\mathbf{p}_2)$, respectively, and then $\pi^{-1}(U_1)$ and $\pi^{-1}(U_2)$ are disjoint open subsets of $E$ containing $\mathbf{p}_1$ and $\mathbf{p}_2$. Thus, $E$ is Hausdorff.

**$E$ is second-countable**<br/>
To show that $E$ is second-countable, we will first show that each fiber of $\pi$ is countable. Given $\mathbf{q}\in M$ and and arbitrary point $\mathbf{p}_0 \in\pi^{-1}(\mathbf{q})$, we will construct a surjective map $\beta: \pi(M,\mathbf{q})\to\pi^{-1}(\mathbf{q})$. This suffices since $\pi_1(M, \mathbf{q})$ is countable by the fundamental group property.

Let $[f]\in\pi_1(M,\mathbf{q})$ be the class of an arbitrary loop $f:[0,1]\to M$ based at $\mathbf{q}$. The path-lifting property of covering maps guarantees that there is a lift $\tilde{f}:[0,1]\to E$ of $f$ starting at $\mathbf{p}_0$, and the monodromy theorem shows that the endpoint $\tilde{f}(1) \in\pi^{-1}(\mathbf{q})$ depends only on the path class of $f$, so it makes sense to define $\beta[f] = \tilde{f}(1)$. To see that $\beta$ is surjective, just note that for any point $\mathbf{p}\in\pi^{-1}(\mathbf{q})$, there is a path $\tilde{f}$ in $E$ from $\mathbf{p}_0$ to $\mathbf{p}$, and then $f = \pi\circ\tilde{f}$ is a loop in $M$ such that $\mathbf{p} = \beta[f]$.

The collection of all evenly covered open subset is an open cover of $M$, and therefore has a countable subcover $\Set{U_i}$. For any given $i$, each component of $\pi^{-1}(U_i)$ contains exactly one point in each fibre oover $U_i$, so $\pi^{-1}(U_i)$ has countably many components. The collection of all components of all sets of the form $\pi^{-1}(U_i)$ is thus a countable open cover of $E$. Since each such component is second-countble, it follows that $E$ is second-countable. This completes the proof that $E$ is a topological manifold.

**Smooth structure on $E$**<br/>
To construct a smooth structure on $E$, suppose $\mathbf{p}$ is any point in $E$, and let $U$ be an evenly covered neighbourhood of $\pi(\mathbf{p})$. After shrinking $U$ if necessary, we may assume also that it is the domain of a smooth coordinate map $\varphi:U\to\R^n$. If $\tilde{U}$ is the component of $\pi^{-1}(U)$ containing $\mathbf{p}$, and $\tilde{\varphi} = \varphi\circ\pi|_{\tilde{U}}: \tilde{U}\to\R^n$, then $(\tilde{U},\tilde{\varphi})$ is a chart on $E$. If two such charts $(\tilde{U},\tilde{\varphi})$ and $(\tilde{V},\tilde{\psi})$ overlap, the transition map can be written

$$
\begin{align*}
  \tilde{\psi}\circ\tilde{\varphi}^{-1} =& \left(\psi\circ\pi|_{\tilde{U}\cap\tilde{V}} \right) \circ \left(\varphi\circ\pi|_{\tilde{U}\cap\tilde{V}} \right)^{-1} \\
  =& \psi\circ(\pi|_{\tilde{U}\cap\tilde{V}})\circ(\pi|_{\tilde{U}\cap\tilde{V}})^{-1}\circ\varphi^{-1} \\
  =& \psi\circ\varphi^{-1}
\end{align*}
$$

which is smooth. Thus, the collection of all such charts defines a smooth structure on $E$, which is unique.

Finally, $\pi$ is a smooth covering map because its coordinate representation in terms of any pair of charts $(\tilde{U},\tilde{\varphi})$ and $(U,\varphi)$ constructed above is the identity.
</details>
</MathBox>

<MathBox title='Covering spaces of smooth manifolds with boundary' boxType='proposition'>
Suppose that $M$ is a connected smooth $n$-manifold with boundary, and let $\pi:E\to M$ be a topological covering map. Then $E$ is a topological $n$-manifold with boundary such that $\partial E = \pi^{-1}(\partial M)$, and it has a unique smooth structure such that $\pi$ is a smooth covering map.
</MathBox>

<MathBox title='Existence of a universal covering manifold' boxType='corollary'>
If $M$ is a connected smooth manifold, there exists a simply coneected smooth manifold $\tilde{M}$, called the *universal covering manifold* of $M$, and a smooth covering map $\pi:\tilde{M}\to M$. The universal covering manifold is unique in the following sense: if $\tilde{M}$ is any other simply connected smooth manifold that admits a smooth covering map $\pi': \tilde{M}'\to M$, then there exists a diffeomorphism $\pi:\tilde{M}\to\tilde{M}'$ such that $\pi'\circ\phi = \pi$.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $E$ and $M$ are nonempty connected smooth manifolds with or without boundary. If $\pi:E\to M$ is a proper local diffeomorphism, then $\pi$ is a smooth covering map.

<details>
<summary>Proof</summary>

Because $\pi$ is a local diffeomorphism, it is an open map, and because it is proper, it is a closed map. Thus, $\pi(E)$ is both open and closed in $M$. Since it is obviously nonempty, it is all of $M$, so $\pi$ is surjective.

Let $\mathbf{q}\in M$ be arbitrary. Since $\pi$ is a local diffeomorphism, each point of $\pi^{-1}(\mathbf{q})$ has a neighbourhood on which $\pi$ is injective, so $\pi^{-1}(\mathbf{q})$ is a discrete subset of $E$. Since $\pi$ is proper, $\pi^{-1}(\mathbf{q})$ is also compact, so it is finite. Write $\pi^{-1}(\mathbf{q}) = \Set{p_i}_{i=1}^k$. For each $i$, there exists a neighbourhood $V_i$ of $\mathbf{p}_i$ on which $\pi$ is a diffeomorphism onto an open subset $U_i\subseteq M$. Shrinking each $V_i$ if necessary, we may assume also that $V_i \cap V_j = \emptyset$ for $i\neq j$.

Set $U = \bigcap_{i=1}^k U_i$, which is a neighbourhood of $\mathbf{q}$. Then $U$ satisfies $U \subseteq U_i$ for each $i$. Because $K = E\setminus \bigcup_{i=1}^k V_k$ is closed in $E$ adn $\pi$ is a closed map, $\pi(K)$ is closed in $M$. Replacing $U$ by $U\setminus \pi(K)$, we can assume that $U$ also satisfies $pi^{-1}(U) \subseteq \bigcup_{i=1}^k V_i$.

Finally, after replacing $U$ by the connected component of $U$ containing $\mathbf{q}$, we can assume that $U$ is connected and still satisfies the two partial order conditions. It remains to show that $U$ is evenly covered.

Let $\tilde{V}_i = \pi^{-1}(U) \cap V_i$. By the second condition, $\pi^{-1}(U) = \bigcup_{i=1}^k \tilde{V}_i$. Because $\pi:V_i \to U_i$ is a diffeomorphism, the first condition implies that $\pi:\tilde{V}_i \to U$ is still a diffeomorphism, and in particular $\tilde{V}_i$ is connected. Because $\tilde{V}_i$ are disjoint connected open subsets of $\pi^{-1}(U)$, they are exactly the components of $\pi^{-1}(U)$.
</details>
</MathBox>

# Smooth submanifolds

## Embedded submanifold

<MathBox title='Embedded submanifold' boxType='definition'>
Suppose that $M$ is a smooth manifold with or without boundary. An *embedded submanifold* of $M$ is a subset $S\subseteq M$ that is a manifold (without boundary) in the subspace topology, endowed with a smooth structure with respect to which the inclusion map $S\hookrightarrow M$ is a smooth embedding. Embedded submanifolds are also known as *regular submanifolds*. An embedded submanifold $S$ is called *properly embedded* if the inclusion $S\hookrightarrow M$ is a proper map.

If $S$ is an embedded submanifold of $M$, the difference $\dim(M) - \dim(S)$ is called the *codimension* of $S$ in $M$, and the containing manifold $M$ is called the *ambient manifold* for $S$. An *embedded hypersurface* is an embedded submanifold of codimension $1$.
</MathBox>

<MathBox title='Open submanifolds have codimension zero' boxType='proposition'>
Suppose that $M$ is a smooth manifold. The embedded submanifolds of codimension $0$ in $M$ are exactly the open submanifolds.

<details>
<summary>Proof</summary>

Suppose that $S\subseteq M$ is an open submanifold, and let $\iota:S\hookrightarrow M$ be the inclusion map. Becuase $S$ is an open submanifold, it follows that it is a smooth manifold with same dimension as $M$ and there has codimension $0$. 

Any point $\mathbf{p}\in S$ is contained in the domain of some chart $(V,\varphi)$ for $M$. If $\mathbf{p}\in U\subseteq S$, then $(W, \varphi|_W)$ with $W = U \cap V$ is a smooth chart for $S$. In terms of these charts, $\iota$ is represented in coordinates by an identity map, making it a smooth immersion. Since $S$ has the subspace topology, $\iota$ is a smooth embedding. Thus $S$ is an embedded submanifold.

Conversely, suppose that $S$ is any codimension-$0$ embedded submanifold of $M$. Then the inclusion $\iota:S\hookrightarrow M$ is a smooth embedding by definition, and therefore it is a local diffeomorphism, which in turn makes it an open map. Thus $S$ is an open subset of $M$.
</details>
</MathBox>

<MathBox title='Images of embeddings as submanifolds' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary, $N$ is a smooth manifold, and $F:N\to M$ is a smooth embedding. Let $S = F(N)$. With the subspace topology, $S$ is a topological manifold, and it has a unique smooth structure making it into an embedded submanifold of $M$ with the property that $F$ is a diffeomorphism onto its image.

<details>
<summary>Proof</summary>

If we give $S$ the subspace topology that it inherits from $M$, then the assumption that $F$ is an embedding means that $F$ can be considered as a homeomorphism from $N$ onto $S$, and thus $S$ is a topological manifold. We give $S$ a smooth structure by taking the smooth charts to be those of the form $(F(U), \varphi\circ F^{-1})$, where $(U,\varphi)$ is any smooth chart for $N$; smooth compatibility of these charts follows immediately from the smooth compatibility of the corresponding charts for $N$. With this smooth structure on $S$, the map $F$ is a diffeomorphism onto its image (essentially
by definition), and this is obviously the only smooth structure with this property. The inclusion map $S\hookrightarrow M$ is equal to the composition of a diffeomorphism followed by a smooth embedding

$$
  S \xrightarrow{F^{-1}} N \xrightarrow{F} M
$$

and therefore it is a smooth embedding.
</details>
</MathBox>

<MathBox title='Slices of product manifolds' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds. For each $p\in N$, the subset $M\times\Set{p}$, called a *slice* of the product manifold, is an embedded submanifold of $M\times N$ diffeomorphic to $M$. 

<details>
<summary>Proof</summary>

The set $M\times\Set{p}$ is the image of the smooth embedding $x\mapsto (x,p)$.
</details>
</MathBox>

<MathBox title='Graphs as submanifolds' boxType='proposition'>
Suppose that $M$ is a smooth $m$-manifold (without boundary), $N$ is a smooth $n$-manifold with or without boundary, $U\subseteq M$ is open, and $f: U\to N$ is a smooth map. Let $\Gamma(f) \subseteq M\times N$ denote the graph of $f$

$$
  \Gamma(f) = \Set{(\mathbf{x},\mathbf{y})\in M\times N | \mathbf{x}\in U, \mathbf{y}\in f(\mathbf{x})}
$$

Then $\Gamma(f)$ is an embedded $m$-dimensional submanifold of $M\times N$.

<details>
<summary>Proof</summary>

Define a map $\gamma_f:U\to M\times N$ by $\gamma_f(\mathbf{x}) = (\mathbf{x},f(\mathbf{x}))$. It is a smooth map whose image is $\Gamma(f)$. Because the projection $\pi_M: M\times N\to M$ satisfies $\pi_M \circ \gamma_f (\mathbf{x}) = \mathbf{x}$, the composition $\mathrm{d}(\pi_M)_{(\mathbf{x},f(\mathbf{x}))} \circ \mathrm{d}(\gamma_f)_\mathbf{x}$ is the identity on $T_\mathbf{x} M$ for each $\mathbf{x}\in U$. Thus $\mathrm{d}(\gamma_f)_\mathbf{x}$ is injective, so $\gamma_f$ is a smooth immersion. It is a homeomorphism onto its image because $\pi_M|_{\Gamma(f)}$ is a continuous inverse for it. Hence, $\Gamma(f)$ is an embedded submanifold diffeomorphic to $U$.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary and $S\subseteq M$ is an embedded submanifold. Then $S$ is properly embedded if and only if it is a closed subset of $M$.

<details>
<summary>Proof</summary>

If $S$ is properly embedded, then it is closed by properties of proper maps. Conversely, if $S$ is closed in $M$, then the conditions for properness show that the inclusion map $S\hookrightarrow M$ is proper.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Every compact embedded submanifold is properly embedded.

<details>
<summary>Proof</summary>

Compact subsets of Hausdorff spaces are closed.
</details>
</MathBox>

<MathBox title='Global graphs are properly embedded' boxType='proposition'>
Suppose that $M$ is a smooth manifold, $N$ is a smooth manifold with or without boundary, and $f:M\to N$ is a smooth map. Let $\Gamma(f) \subseteq M\times N$ denote the graph of $f$

$$
  \Gamma(f) = \Set{(\mathbf{x},\mathbf{y})\in M\times N | \mathbf{x}\in U, \mathbf{y}\in f(\mathbf{x})}
$$

With the smooth immersion $\gamma_f:U\subseteq M\to M\times N$ given by $\gamma_f(\mathbf{x}) = (\mathbf{x},f\mathbf{x})$, the graph $\Gamma(f) \subseteq M\times N$ is properly embedded in $M\times N$.

<details>
<summary>Proof</summary>

In this case, the projection $\pi_M :M\times N$ is a smooth left inverse for the embedding $\gamma_f :M\to M\times N$. Thus, $\gamma_f$ satisfies the conditions for properness. 
</details>
</MathBox>

### Slice charts for embedded submanifolds

<MathBox title='Slice' boxType='definition'>
If $U\subseteq\R^n$ is open and $k\in\Set{0,\dots,n}$, a $k$-dimensional *slice* of $U$, or simply a $k$-slice, is any subset of the form

$$
  S = \Set{(x^1,\dots,x^k,x^{k+1},\dots,x^n)\in U | x^{k+1} = c^{k+1}\dots,x^n = c^n}
$$

for some constants $c^{k+1},\dots,c^n$.

Let $M$ be a smooth $n$-manifold, and let $(V,\varphi)$ be a smooth chart on $M$. If $S$ is a subset of $V$ such that $\varphi(S)$ is a $k$-slice of $\varphi(V)$, then $S$ is a $k$-slice of $V$.

A subset $S\subseteq M$ is said to satisfy the local $k$-slice conditions if each point of $S$ is contained in the domain of a smooth chart $(V,\varphi)$ for $M$ such that $S\cap V$ is a single $k$-slice in $U$. Any such chart is called a *slice chart* for $S$ in $M$, and the corresponding coordinates are called *slice coordinates*.
</MathBox>

<MathBox title='Local slice criterion for embedded submanifolds' boxType='theorem'>
Let $M$ be a smooth $n$-manifold. If $S\subseteq M$ is an embedded $k$-dimensional submanifold, then $S$ satisfies the local $k$-slice condtion. Conversely, if $S\substeq M$ is a subset that satisfies the local $k$-slice condition, then with the subspace topology, $S$ is topological $k$-manifold, and it has a smooth structure making it into a $k$-dimensional embedded submanifold of $M$.

<details>
<summary>Proof</summary>

First, suppose that $S\subseteq M$ is an embedded $k$-dimensional submanifold. Since the inclusion map $S\hookrightarrow M$ is an immersion, the rank theorem shows that for any $\mathbf{p}\in S$ there are smooth charts $(U,\varphi)$ for $S$ and $(V,\psi)$ for $M$, both centered at $\mathbf{p}$, in which the inclusion map $\iota|_U :U\to V$ has the coordinate representation

$$
  (x^1,\dots,x^k)\mapsto (x^1,\dots,x^k,0,\dots,0)
$$

Choose $\varepsilon > 0$ small enough that both $U$ and $V$ contain coordinate balls of redius $\varqepsilon$ centered at $\mathbf{p}$, and denote these coordinate balls by $U_0 \subseteq U$ and $V_0 \subseteq V$. It follows that $U_0 = \iota|_U(U_0)$ is exactly a single slice in $V_0$. Because $S$ has the subspace topology, the fact that $U_0$ is open in $S$ means that there is an open subset $W\subseteq M$ such that $U_0 = W \cap S$. Setting $V_1 = V_0 \cap W$, we obtain a smooth chart $(V_1, \psi|_{V_1})$ for $M$ containing $\mathbf{p}$ such that $V_1 \cap S = U_0$, which is a single slice of $V_1$.

Conversely, suppose that $S$ satisfies the local $k$-slice condition. With the subspace topology, $S$ is Hausdorff and second-countable, because both properties are inherited by subspaces. To see that $S$ is locally Euclidean, we construct an atlas. The basic idea of the construction is that if $(x^1,\dots,x^n)$ are slice coordinates for $S$ in $M$, we can use $(x^1,\dots,x^k)$ as local coordinates for $S$.

Let $\pi:\R^n \to\R^k$ denote the projection onto the first $k$ coordinates. Let $(U,\varphi)$ be any slice chart for $S$ in $M$ and define

$$
\begin{align*}
  V =& U \cap S \\
  \hat{V} =& \pi\circ\varphi(V) \\
  \psi =& \pi\circ\varphi|_V: V\to\hat{V}
\end{align*}
$$

By definition of slice charts, $\varphi(V)$ is the intersection of $\varphi(U)$ with a certain $k$-slice $A\subseteq\R^n$ defined by setting $x^{k+1} = c^{k+1},\dots,x^n = c^n$, and therefore $\varphi(V)$ is open in $A$. Since $\pi|_A$ is a diffeomorphism from $A$ to $\R^n$, it follows that $\hat{V}$ is open in $\R^k$. Moreover, $\psi$ is a homeomorphism because it has a continuous inverse given by $\varphi^{-1}\circ j|_{\hat{V}}$ where $j:\R^k \to\R^n$ is the map

$$
  j(x^1,\dots,x^k) = (x^k,\dots,x^k,c^{k+1},\dots,c^n)
$$

Thus, $S$ is a topological $k$-manifold, and the inclusion map $\iota:S\hookrightarrow M$ is a topological embedding.

To put a smooth structure on $S$, we need to verify that the charts constructed above are smoothly compatible. Suppose that $(U,\varphi)$ and $(U',\varphi')$ are two slice charts for $S$ in $M$, and let $(V,\psi)$ and $(V',\psi')$ be the corresponding charts for $S$. The transition map is given by $\psi'\circ\psi = \pi\circ\varphi'\circ\varphi^{-1} \circ j$, which is a composition of four smooth maps. Thus, the atlas we have constructed is in fact a smooth atlas, and it defines a smooth structure on $S$. In terms of a slice chart $(U,\varphi)$ for $M$ and the corresponding chart $(V,\varphi)$ for $S$, the inclusion map $S\hookrightarrow M$ has a coordinate representation of the form

$$
  (x^1,\dots,x^k)\mapsto(x^1,\dots,x^k,c^{k+1},\dots,c^n)
$$

which is a smooth immersion. Since the inclusion is a smooth immersion and a topological embedding, $S$ is an embedded submanifold.
</details>
</MathBox>

<MathBox title='Local slice criterion for embedded submanifolds' boxType='theorem'>
If $M$ is a smooth $n$-manifold with boundary, then with the subspace topology, $\partial M$ is a topological $(n-1)$-dimensional manifold (without boundary), and has a smooth structure such that is a properly embedded submanifold of $M$.
</MathBox>

### Level sets

<MathBox title='Local slice criterion for embedded submanifolds' boxType='theorem'>
If $\Phi: M\to N$ is any map and $\mathbf{c}$ is any point of $N$, the preimage $\Phi^{-1}(\mathbf{c})$ is a *level set* of $\phi$. 
</MathBox>

<MathBox title='Constant-rank level set theorem' boxType='theorem'>
Let $M$ and $N$ be smooth manifolds, and let $\Phi: M\to N$ be a smooth map with constant rank $r$. Each level set of $\Phi$ is a properly embedded submanifold of codimension $r$ in $M$.

<details>
<summary>Proof</summary>

Let $m = \dim(M)$, $n = \dim(N)$ and $k = m - r$. Let $\mathbf{c}\in N$ be arbitrary, and let $S$ denote the level set $\varphi^{-1}(\mathbf{c})\subseteq M$. From the rank theorem, for each $\mathbf{p}\in S$ there are smooth charts $(U,\varphi)$ centered at $\mathbf{p}$ and $(V,\psi)$ centered at $\mathbf{c} = \Phi(\mathbf{p})$ in which $\Phi$ has a coordinate representation of

$$
  \Phi(x^1,\dots,x^r,x^{r+1},\dots,x^m) = (x^1,\dots,x^r,0,\dots,0)
$$
 
and therefore $S\cap U$ is the slice

$$
  \Set{(x^1,\dots,x^r,x^{r+1},\dots,x^m)\in U | x^1 =\cdots = x^r = 0}
$$

Thus, $S$ satisfies the local $k$-slice condition, so it is an embedded submanifold of dimension $k$. It is closed in $M$ by continuity, so it is properly embedded.
</details>
</MathBox>

<MathBox title='Submersion level set theorem' boxType='corollary'>
If $M$ and $N$ are smooth manifolds and $\Phi: M\to N$ is a smooth submersion, then each level set of $\Phi$ is a properly embedded submanifold whose codimension is equal to the dimension of $N$.

<details>
<summary>Proof</summary>

Every smooth submersion has constant rank equal to the dimension of its codomain.
</details>
</MathBox>

<MathBox title='Regular and critical values' boxType='definition'>
If $M$ and $N$ are smooth manifolds and $\Phi: M\to N$ is a smooth map, a point $\mathbf{p}\in M$ is said to be a *regular point* of $\Phi$ if $\mathrm{d}\Phi_\mathbf{p}: T_\mathbf{p} M \to T_{\Phi(\mathbf{p})}N$ is surjective; it is a *critical point* of $\Phi$ otherwise. In particular, every point of $M$ is critical if $\dim(M) < \dim(N)$, and every point is regular if and only if $F$ is a submersion.

A point $\mathbf{c}\in N$ is a *regular value* of $\Phi$ is every point of the level set $\Phi^{-1}(\mathbf{c})$ is a regular point, and a *critical value* otherwise. In particular, if $\Phi^{-1}(\mathbf{c}) = \emptyset$ then $\mathbf{c}$ is a regular value.

A level set $\Phi^{-1}(\mathbf{c})$ is called a *regular value set* if $\mathbf{c}$ is a regular value of $\Phi$. In other words, a regular level set is a level set consisting entirely of regular points of $\Phi$.
</MathBox>

<MathBox title='Critical point and regular value' boxType='definition'>
Suppose that $f:M\to N$ is a smooth map. A point $p\in M$ is called a critical point of $f$ if the differential of $f$ at $p$, denoted $\mathrm{d}f_p$, is not surjective. Equivalently, the Jacobian of the map $\psi\circ f\phi^{-1}: \R^n \to\R^M$ has not maximal rank, i.e.

$$
  \mathrm{rank}f_p := \mathrm{rank}\left( J_{\psi\circ f\phi^{-1}} [h(p)] \right) < n
$$

A point $q\in N$ is called a regular value $f$ if $f^{-1}[\Set{q}]\in M$ does not contain critical points.
</MathBox>

<MathBox title='Regular value theorem' boxType='theorem'>
Let $M, N$ be smooth manifolds of dimension $m$ and $n$ with $m\geq n$. Suppose that $f:M\to N$ is a smooth map, and $q\in N$ be a regular value of $f$. Then $f^{-1}[\Set{q}]$ is a $(m-n)$-dimensional submanifold of $M$.
</MathBox>

<MathBox title='Regular level set theorem' boxType='corollary'>
Every regular level set of a smooth map between smooth manifolds is a properly embedded submanifold whose codimension is equal to the dimension of the codomain.

<details>
<summary>Proof</summary>

Let $\Phi:M\to N$ be a smooth map and let $\mathbf{c}\in N$ be a regular value. The set $U$ of points $\mathbf{p}\in M$ where $\mathrm{rank}(\mathrm{d}\Phi_\mathbf{p}) = \dim(N)$ is open in $M$ and contains $\Phi^{-1}(\mathbf{c})$ because of the assumption that $\mathbf{c}$ is a regular value. It follows that $\Phi|_U:U\to N$ is a smooth submersion, and the submersion level set theorem shows that $\Phi^{-1}(\mathbf{c})$ is an embedded submanifold of $U$. Since the composition of smooth embeddings $\Phi^{-1}(\mathbf{c}) \hookrightarrow U \hookrightarrow M$ is again a smooth embedding, it follows that $\Phi^{-1}(\mathbf{c})$ is en embedded submanifold of $M$, and it is closed by continuity. 
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $S$ be a subset of a smooth $m$-manifold $M$. Then $S$ is an embedded $k$-submanifold if and only if every point of $S$ has a neighbourhood $U\subseteq M$ such that $U\cap S$ is a level set of a smooth submersion $\Phi:U\to\R^{m-k}$.

<details>
<summary>Proof</summary>

First, suppose that $S$ is an embedded $k$-submanifold. If $(x^1,\dots,x^m)$ are slice coordinates for $S$ on an open subset $U\subseteq M$, the map $\Phi:U\to\R^{m-k}$ given in coordinates by $\Phi(\mathbf{x}) = (x^{k+1},\dots,x^m)$ is easily seen to be a smooth submersion, one of whose level sets is $S\cap U$.

Conversely, suppose that around every point $\mathbf{p}\in S$ there is a neighbourhood $U$ and a smooth submersion $\Phi:U\to\R^{m-k}$ such that $S\cap U$ is a level set of $\Phi$. By the submersion level set theorem, $S\cap U$ is an embedded submanifold of $U$, so it satisfies the local slice condition. It follows that $S$ is itself an embedded submanifold of $M$. 
</details>
</MathBox>

<MathBox title='Defining map' boxType='definition'>
If $S\subseteq M$ is an embedded submanifold, a smooth map $\Phi: M\to N$ such that $S$ is a regular level set of $\Phi$, is called a *defining map* for $S$. More generally, if $U$ is an open subset of $M$ and $\Phi:U\to N$ is a smooth map such that $S\cap U$ is a regular level set of $\Phi$, then $\Phi$ is called a *local defining map* for $S$.
</MathBox>

## Immersed submanifolds

<MathBox title='Immersed submanifold' boxType='definition'>
Let $M$ be a smooth manifold with or without boundary. An *immersed submanifold* of $M$ is a subset $S\subseteq M$ endowed with a topology with respect to which it is a topological manifold (without boundary), and a smooth structure with respect to which the inclusion map $S\hookrightarrow M$ is a smooth immersion. If $S$ is an immersed submanifold then $\dim(M) - \dim(S)$ is the *codimension* of $S$ in $M$. Every embedded submanifold is also an immersed submanifold.
</MathBox>

<MathBox title='Images of immersions as submanifolds' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary, $N$ is a smooth manifold, and $F:N\to M$ is an injective smooth immersion. Let $S = F(N)$. Then $S$ has a unique topology and smooth structure such that it is a smooth submanifold of $M$ and such that $F:N\to S$ is a diffeomorphism onto its image.

<details>
<summary>Proof</summary>

We give $S$ a topology by declaring a set $U\subseteq S$ to be open if and only if $F^{-1}(U) \subseteq N$ is open, and then give it a smooth structure by taking the smooth charts to be those of the form $(F(U),\varphi\circ F^{-1})$ where $(U,\varphi)$ is any smooth chart for $N$. The smooth compatibility condition follows from that for $N$. With this topology and smooth structure on $S$, the map $F$ is a diffeomorphism onto its image, and these are the only topology and smooth structure on $S$ with this property. The inclusion  $S\hookrightarrow M$ can be written as the composition

$$
  S \xrightarrow{F^{-1}} N \xrightarrow{F} M
$$

In this case, the first map is a diffeomorphism and the second is a smooth immerision, so the composition is a smooth immersion.
</details>
</MathBox>

<MathBox title='Criteria for embedded submanifolds' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary, and $S\subseteq M$ is an immersed submanifold. If any of the following holds, then $S$ is embedded.
1. $S$ has codomain $0$ in $M$
2. The inclusion map $S\subseteq M$ is proper
3. $S$ is compact
</MathBox>

<MathBox title='Immersed submanifolds are locally embedded' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary, and $S\subseteq M$ is an immersed submanifold. Then for each $\mathbf{p}\in S$ there exists a neighbourhood $U$ of $\mathbf{p}$ in $S$ that is an embedded submanifold of $M$.

<details>
<summary>Proof</summary>

The local embedding theorem shows that each $\mathbf{p}\in S$ has a neighbourhood $U$ in $S$ such that the inclusion $\iota_U:U\hookrightarrow M$ is an embedding.
</details>
</MathBox>

<MathBox title='Parametrization' boxType='definition'>
Suppose that $S\subseteq M$ is an immersed $k$-dimensional submanifold. A *local parametrization* of $S$ is a continuous map $X:U\to M$ whose domain is an open subset $U\subseteq \R^k$, whose image is an open subset of $S$, and which, considered as a map into $S$, is a homeomorphism onto its image. It is alled a *smooth local parametrization* if it is a diffeomorphism onto its image. If the image of $X$ is all of $S$, it is called a *global parametrization*.
</MathBox>

<MathBox title='Parametrization' boxType='definition'>
Suppose that $M$ is a smooth manifold with or without boundary, $S\subseteq M$ is an immersed $k$-submanifold, $\iota:S\hookrightarrow M$ is the inclusion map, and $U$ is an open subset of $\R^k$. A map $X:U\to M$ is a smooth local parametrization of $S$ if and only if there is a smooth coordinate chart $(V,\varphi)$ for $S$ such that $X = \iota\circ\varphi^{-1}$. Therefore, every point of $S$ is in the image of some local parametrization.
</MathBox>

## Restricting maps to submanifolds

<MathBox title='Restricting the domain of a smooth map' boxType='theorem'>
If $M$ and $N$ are smooth manifolds with or without boundary, $F:M\to N$ is a smooth map, and $S\subseteq M$ is an immersed or embedded submanifold, then $F|_S :S\to N$ is smooth.

<details>
<summary>Proof</summary>

The inclusion map $\iota:S\hookrightarrow M$ is smooth by definition of an immersed submanifold. Since $F|_S = F\circ\iota$, the result follows.
</details>
</MathBox>

<MathBox title='Restricting the codomain of a smooth map' boxType='theorem'>
Suppose that $M$ is a smooth manifold (without boundary), $S\subseteq M$ is an immersed submanifold, and $F:N\to M$ is a smooth map whose image is contained in $S$. If $F$ is continuous as a map from $N$ to $S$, then $F:N\to S$ is smooth.

<details>
<summary>Proof</summary>

Let $\mathbf{p}\in N$ be arbitrary and let $\mathbf{q} = F(\mathbf{p})\in S$. Since immersed submanifolds are locally embedded, there is a neighbourhood $V$ of $\mathbf{q}$ in $S$ such that $\iota|_V: V\hookrightarrow M$ is a smooth embedding. Thus, there exists a smooth chart $(W,\psi)$ for $M$ that is a slice chart for $V$ in $M$ centered at $\mathbf{q}$. The fact that $(W,\psi)$ is a slice chart means that $(V_0, \tilde{\psi})$ is a smooth chart for $V$, where $V_0 = W \cap V$ and $\tilde{\psi} = \pi \circ\psi$ with $\pi:\R^n \to\R^k$ being the projection onto the first $k = \dim(S)$ coordinates. Since $V_0 = (\iota|_V)^{-1}(W)$ is open in $V$, it is open in $S$ in its given topology, and so $(V_0, \tilde{\psi})$ is also a smooth chart for $S$.

Let $U = F^{-1}(V_0)$, which is an open subset of $N$ containing $\mathbf{p}$. Choose a smooth chart $(U_0,\varphi)$ for $N$ such that $\mathbf{p}\in U_0 \subseteq U$. Then the coordinate representation of $F:N\to S$ with respect to the charts $(U_0, \varphi)$ and $(V_0,\tilde{\psi})$ is

$$
  \tilde{\psi}\circ F\circ\varphi^{-1} = \pi \circ(\psi\circ F\circ\varphi^{-1})
$$

which is smooth because $F:N\to M$ is smooth.
</details>
</MathBox>

<MathBox title='Embedded case' boxType='corollary'>
Suppose that $M$ is a smooth manifold, and that $S\subseteq M$ is an embedded submanifold. Then every smooth map $F:N\to M$ whose image is contained in $S$ is also smooth as a map from $N$ to $S$.

<details>
<summary>Proof</summary>

Since $S\subseteq M$ has the subspace topology, a continuous map $F:N\to M$ whose image is contained in $S$ is automatically continuous into $S$, by the characteristic property of the subspace topology.
</details>
</MathBox>

<MathBox title='Weakly embedded submanifold' boxType='definition'>
If $M$ is a smooth manifold, an immersed submanifold $S\subseteq M$ is *weakly embedded in* $M$ if every smooth map $F:N\to M$ whose image lies in $S$ is smooth as a map from $N$ to $S$.
</MathBox>

### Uniqueness of smooth structures on submanifolds

<MathBox title='' boxType='theorem'>
Suppose that $M$ is a smooth manifold. If $S\subseteq M$ is an embedded submanifold, it has a unique subspace topology and smooth structure (as described in the local slice condition theorem). 

<details>
<summary>Proof</summary>

Suppose that $S\subseteq M$ is an embedded $k$-submanifold. It then satisfies the local $k$-slice condition, so it is an embedded submanifold with the subspace topology. Suppose that were some other topology and smooth structure on $S$, making it into an immersed submanifold of some dimension. Let $\tilde{S}$ denote the same set $S$, considered as a smooth manifold with non-standard topology and smooth structure, and let $\tilde{\iota}:\tilde{S}\hookrightarrow M$ denote the inclusion map, which by assumption is an injective immesion (but not necessarily an embedding). Because $\tilde{\iota}(\tilde{S}) = S$, the embedded codomain restriction of smooth maps implies that $\tilde{\iota}$ is also smooth when considered as a map from $\tilde{S}$ to $S$. For each $\mathbf{p}\in\tilde{S}$, the differential $\mathrm{d}\tilde{\iota}_\mathbf{p}: T_\mathbf{p}\tilde{S} \to T_\mathbf{p}M$ is equal to the composition

$$
  T_\mathbf{p}\tilde{S} \xrightarrow{\mathrm{d}\tilde{\iota}_\mathbf{p}} T_\mathbf{p}S \xrightarrow{\mathrm{d}\iota_\mathbf{p}} T_\mathbf{p}M
$$

where $\iota: S\hookrightarrow M$ is also an inclusion. Because this composition is injective, $\mathrm{d}\tilde{\iota}_\mathbf{p}$ must be injective. In particular, this means that $\tilde{\iota}:\tilde{S}\to S$ is an immersion. Because it is bijective, it follows from the global rank theorem that it is a diffeomorphism. In other words, the topology and smooth manifold structure of $\tilde{S}$ are the same as those of $S$.
</details>
</MathBox>

<MathBox title='' boxType='theorem'>
Suppose that $M$ is a smooth manifold, and that $S\subseteq M$ is an embedded submanifold. For the given topology on $S$, there is only one smooth structure making $S$ into an immersed submanifold.
</MathBox>

<MathBox title='' boxType='theorem'>
If $M$ is a smooth manifold and $S\subseteq M$ is a weakly embedded submanifold, then $S$ has only one topology and smooth structure with respect to which it is an immersed submanifold.
</MathBox>

### Extending functions from submanifolds

<MathBox title='Extension lemma for functions of submanifolds' boxType='lemma'>
Suppose that $M$ is a smooth manifold, $S\subseteq M$ is a smooth manifold, and that $f\in C^\infty (S)$.
1. If $S$ is embedded, then there exists a neighbourhood $U$ of $S$ in $M$ and a smooth function $\tilde{f}\in C^\infty(U)$ such that $\tilde{f}|_S = f$.
2. If $S$ is properly embedded, then the neighbourhood $U$ in part **(1)** can be taken to be all of $M$.
</MathBox>

### The tangent space to a submanifold

Let $M$ be a smooth manifold with or without boundary, and let $S\subseteq M$ be an immersion or embedded submanifold. Since the inclusion map $\iota:S\hookrightarrow M$ is a smooth immersion, at each point $\mathbf{p}\in S$ we have an injective linear map $\mathrm{d}\iota_\mathbf{p}:T_\mathbf{p}S \to T_\mathbf{p}M$. In terms of derivations, this injection works in the following way: for any vector $\mathbf{v}\in T_\mathbf{p} S$, the image vector $\tilde{\mathbf{v}} = \mathrm{d}\iota_\mathbf{p}(\mathbf{v}) \in T_\mathbf{p}M$ acts on smooth functions on $M$ by

$$
\begin{align*}
  \tilde{\mathbf{v}} f = \mathrm{d}\iota_\mathbf{p}(\mathbf{v})f = \mathbf{v}(f\circ\iota) = \mathbf{v}(f|_S)
\end{align*}
$$

Identifying $T_\mathbf{p}M$ with its image under this map, the tangent space $T_\mathbf{p}M$ can be thought of as a certain linear subspace of $T_\mathbf{p}M$. This identification makes sense regardless of whether $S$ is embedded or immersed.

<MathBox title='' boxType='propositon'>
Suppose that $M$ is a smooth manifold with or without boundary, $S\subseteq M$ is an immersed or embedded submanifold, and $\mathbf{p}\in S$. A vector $\mathbf{v}\in T_\mathbf{p}M$ is in $T_\mathbf{p}S$ if and only if there is a smooth curve $\gamma:I\subseteq\R \to M$ whose image is contained in $S$, and which is also smooth as a map into $S$, such that $0 \in I$, $\gamma(0) = \mathbf{p}$, and $\gamma'(0) = \mathbf{v}$.
</MathBox>

<MathBox title='' boxType='propositon'>
Suppose that $M$ is a smooth manifold, $S\subseteq M$ is an embedded submanifold, and $\mathbf{p}\in S$. As a subspace of $T_\mathbf{p}M$, the tangent space $T_\mathbf{p}S$ is characterized by

$$
  T_\mathbf{p}S = \Set{\mathbf{v}\in T_\mathbf{p}M | \mathbf{v}f = 0, f\in C^\infty (M) \land f|_S = 0}
$$

<details>
<summary>Proof</summary>

First, suppose that $\mathbf{v}\in T_\mathbf{p}M \subseteq T_\mathbf{p} M$. This means, that $\mathbf{v} = \mathrm{d}\iota_\mathbf{p}(\mathbf{w})$ for some $\mathbf{w}\in T_\mathbf{p} S$, where $\iota:S\to M$ is an inclusion. If $f$ is an y smooth real-valued function on $M$ that vanishes on $S$, then $f\circ\iota \equiv 0$ so

$$
  \mathbf{v}f = \mathrm{d}\iota_\mathbf{p}(\mathbf{w})f = \mathbf{w}(f\circ\iota) = 0
$$

Conversely, if $\mathbf{v}\in T_\mathbf{p}M$ satisfies $\mathbf{v}f = 0$ whenever $f$ vanishes on $S$, we need to show that there is a vector $\mathbf{w}\in T_\mathbf{p}S$ such taht $\mathbf{v} = \mathrm{d}\iota_\mathbf{p}(\mathbf{w})$. Let $(x^1,\dots,x^n)$ be slice coordinates for $S$ in some neighbourhood $U$ of $\mathbf{p}$, so that $U\cap S$ is the subset of $U$ where $x^{k+1} = \cdots = x^n = 0$ and $(x^1,\dots,x^k)$ are coordinates for $U\cap S$. Because the inclusion map $\iota:S\cap U\hookrightarrow M$ has the coordinate representation

$$
  \iota(x^1,\dots,x^k) = (x^1,\dots,x^k,0,\dots,0)
$$

in these coordinates, it follows that $T_\mathbf{p}S$, i.e. $\mathrm{d}\iota_\mathbf{p}(T_\mathbf{p} S)$, is exactly the subspace of $T_\mathbf{p}M$ spanned by $\boldsymbol{\partial}_i|_\mathbf{p}$. If we write the coordinate representation of $\mathbf{v}$ as

$$
  \mathbf{v} = \sum_{i=1}^n v^i \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}
$$

we see that $\mathbf{v}\in T_\mathbf{p} S$ if and only if $v^i = 0$ for $i > k$.

Let $\varphi$ be a smooth bump function supported in $U$ that is equal to $1$ in a neighbourhood of $\mathbf{p}$. Choose an index $j > k$, and consider the function $f(x) = \varphi(\mathbf{x})x^j$, extended to be zero on $M\setminus\mathrm{supp}(\varphi)$. Then $f$ vanishes identically on $S$, so

$$
  0 = \mathbf{v}f = \sum_{i=1}^n v^i \frac{\partial (\varphi(\mathbf{x}x^j))}{\partial x^i}(\mathbf{p}) = v^i \delta_i^j = v^j
$$

Thus, $\mathbf{v}\in T_\mathbf{p} S$ as desired.
</details>
</MathBox>

<MathBox title='' boxType='propositon'>
Suppose that $M$ is a smooth manifold and that $S\subseteq M$ is an embedded submanifold. If $\Phi:U\to N$ is any local defining map for $S$, then $T_\mathbf{p}S = \mathrm{ker}(\mathrm{d}\Phi_\mathbf{p}): T_\mathbf{p}M \to T_{\Phi(\mathbf{p})}N$ for each $\mathbf{p}\in S\cap U$.

<details>
<summary>Proof</summary>

Recall that we identify $T_\mathbf{p}S$ with the subspace $\mathrm{d}\iota_\mathbf{p}(T_\mathbf{p}S) \subseteq T_\mathbf{p}M$, where $\iota:S\hookrightarrow M$ is the inclusion map. Because $\Phi\circ\iota$ is constant on $S\cap U$, it follows that $\mathrm{d}\Phi_\mathbf{p}\circ\mathrm{d}\iota_\mathbf{p}$ is the zero map from $T_\mathbf{p}S$ to $T_{\Phi(\mathbf{p})}N$, and therefore $\mathrm{ran}(\mathbf{d}\iota_\mathbf{p}) \subseteq \mathrm{ker}(\mathrm{d}\Phi_\mathbf{p})$. On the other hand, $\mathrm{d}\Phi_\mathbf{p}$ is surjective by the definition of a defining map, so the rank-nullity theorem implies that

$$
\begin{align*}
  \dim(\mathrm{ker}(\mathrm{d}\Phi_\mathbf{p})) =& \dim(T_\mathbf{p}M) - \dim(T_{\Phi(\mathbf{p})}N) \\
  =& \dim(T_\mathbf{p}S) = \dim(\mathrm{ran}(\mathrm{d}\iota_\mathbf{p}))
\end{align*}
$$

which implies that $\mathrm{ran}(\mathrm{d}\iota_\mathbf{p}) = \mathrm{ker}(\mathrm{d}\Phi_\mathbf{p})$.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
Suppose that $S\subseteq M$ is a level set of a smooth submersion $\Phi = (\Phi^1,\dots,\Phi^k):M \to\R^k$. A vector $\mathbf{v}\in T_\mathbf{p}M$ is tangent to $S$ if and only if $\mathbf{v}\Phi^1 =\cdots=\mathbf{v}\Phi^k = 0$.
</MathBox>

<MathBox title='Inward- and outward-pointing vector' boxType='definition'>
If $M$ a smooth manifold with boundary and $\mathbf{p}\in\partial M$, a vector $\mathbf{v}\in T_\mathbf{p}M\setminus T_\mathbf{p}\partial M$ is *inward-pointing* if for some $\varepsilon > 0$ there exists a smooth curve $\gamma:[0,\varepsilon) \to M$ such that $\gamma(0) = \mathbf{p}$ and $\gamma'(0) = \mathbf{v}$. The vector is *outward-pointing* if there exists such a curve whose domain is $(-\varepsilon, 0]$.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ is a smooth $n$-manifold with boundary, $\mathbf{p}\in \partial M$, and $(x^i)_{i=1}^n$ are smooth boundary coordinates defined on a neighbourhood of $\mathbf{p}$. The inward-pointing vectors in $T_\mathbf{p}M$ are precisely those with positive $x^n$-component, the outward-pointing ones are those with negative $x^n$-component, and the ones tangent to $\partial M$ are those with zero $x^n$-component. Thus, $T_\mathbf{p} M$ is the disjoint union of $T_\mathbf{p}\partial M$, set of inward-pointing vectors, and the set of outward-pointing vectors. A vector $\mathbf{v}\in T_\mathbf{p}$ is inward-pointing if and only if $-\mathbf{v}$ is outward-pointing.
</MathBox>

<MathBox title='Boundary defining function' boxType='definition'>
If $M$ is a smooth manifold with boundary, a *boundary defining function* for $M$ is a smooth function $f:M\to[0,\infty)$ such that $f^{-1}(0) = \partial M$ and $\mathrm{d}f_\mathbf{p} \neq 0$ for all $\mathbf{p}\in\partial M$.
</MathBox>

<MathBox title='' boxType='proposition'>
Every smooth manifold with boundary admits a boundary defining function.

<details>
<summary>Proof</summary>

Let $\Set{(U_\alpha, \varphi_\alpha)}$ be a collection of smooth charts whose domains cover an $n$-manifold $M$. For each $\alpha$, defined a smooth function $f_\alpha: U_\alpha \to[0,\infty)$ as follows: if $U_\alpha$ is an interior chart, let $f_\alpha \equiv 1$, while if $U_\alpha$ is a boundary chart, let $f_\alpha(x^1,\dots,x^n) = x^n$. Thus, $f_\alpha(\mathbf{p})$ is positive if $\mathbf{p}\in\mathrm{int}(M)$ and zero if $\mathbf{p}\in\partial M$. 

Let $\Set{\psi_\alpha}$ be a partition of unity subordinate to this cover, and let $f = \sum_\alpha \psi_\alpha f_\alpha$. Then $f$ is smooth, identically zero on $\partial M$, and strictly positive in $\mathrm{int}(M)$. To see that $\mathrm{d}f$ does not vanish on $\partial M$, suppose that $\mathbf{p}\in\partial M$ and that $\mathrm{v}$ is an inward-pointing vector at $\mathbf{p}$. For each $\alpha$ such that $\mathbf{p}\in U_\alpha$, we have $f_\alpha(\mathbf{p})$ = 0 and $\mathrm{d}f_\alpha|_\mathbf{p} = \mathrm{d}x^n|_\mathbf{p}(\mathbf{v}) > 0$ by properties of inward-pointing vectors. Thus

$$
  \mathrm{d}f_\mathbf{p}(\mathbf{v}) = \sum_\alpha (f_\alpha (\mathbf{p})\mathrm{d}\psi_\alpha|_\mathbf{p}(\mathbf{v}) + \psi_\alpha(\mathbf{p})\mathrm{d}f_\alpha|_\mathbf{p}(\mathbf{v}))
$$

For each $\alpha$, the first term in parenthesis is zero and the second is nonnegative, and there is at least one $\alpha$ for which the second term is positive. Thus $\mathrm{d}f_\mathbf{p}(\mathbf{v}) > 0$, which implies that $\mathrm{d}f_\mathbf{p}\neq 0$.
</details>
</MathBox>

## Submanifolds with boundary

<MathBox title='Smooth submanifold with boundary' boxType='definition'>
If $M$ is a smooth manifold with or without boundary, a *smooth submanifold with boundary* in $M$ is a subset $S\subseteq M$ endowed with a topology and smooth structure making it into a smooth manifold with boundary such that the inclusion map is a smooth immersion. If the inclusion map is an embedding, then it is called an *embedded submanifold with boundary*. In the general case, it is an *immersed submanifold with boundary*. A *regular domain* in $M$ is a properly embedded codimension-$0$ submanifold with boundary.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ is a smooth manifold without boundary and $D\subseteq M$ is a regular domain. The topological interior and boundary of $D$ are equal to its manifold interior and boundary, respectively.

<details>
<summary>Proof</summary>

Suppose that $\mathbf{p}\in D$ is arbitrary. If $\mathbf{p}$ is in the manifold boundary of $D$, then the local immersion theorem shows that there exists a smooth boundary chart $(U,\varphi)$ for $D$ centered at $\mathbf{p}$ and a smooth chart $(V,\psi)$ for $M$ centered at $\mathbf{p}$ in which any smooth immersion $F:M\to D$ has the coordinate representation $F(x^1,\dots,x^n) = (x^1,\dots,x^n)$, where $n = \dim(M) = \dim(D)$. Since $D$ has the subspace topology, $U = D\cap W$ for some open subset $W\subseteq M$, so $V_0  = V \cap W$ is a neighbourhood of $\mathbf{p}$ in $M$ such that $V_0 \cap D$ consists of all the points in $V_0$ whose $x^m$ coordinate is nonnegative. Thus every neighbourhood of $\mathbf{p}$ intersects both $D$ and $M\setminus D$, so $\mathbf{p}$ is in the topological boundary of $D$.

On the other hand, suppose that $\mathbf{p}$ is in the manifold interior of $D$. The manifold interior is a smooth embedded codimension-$0$ submanifold without boundary in $M$, so it is an open subset. Thus, $\mathbf{p}$ is in the topological interior of $D$.

Conversely, if $\mathbf{p}$ is in the topological interior of $D$, then it is not in the topological boundary, so the preceding argument shows that it is not in the manifold boundary and hence must be in the manifold interior. Similarly, if $\mathbf{p}$ is in the topological boundary, it is also in the manifold boundary.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $M$ is a smooth manifold and that $f\in C^\infty (M)$.
1. For each regular value $b$ of $f$, the sublevel set $f^{-1}((-\infty,b])$ is a regular domain in $M$.
2. If $a$ and $b$ are two regular values of $f$ with $a < b$, then $f^{-1}([a,b])$ is a regular domain in $M$.
</MathBox>

<MathBox title='' boxType='proposition'>
If $M$ is a smooth manifold and $D\subseteq M$ is a regular domain, then there exists a defining funtion for $D$. If $D$ is compact, then $f$ can be taken to be a smooth exhaustion function for $M$.
</MathBox>

<MathBox title='Properties of embedded submanifolds with boundary' boxType='proposition'>
Suppose that $M$ is a smooth manifold with or without boundary.
1. Every open subset of $M$ is an embedded codimension-$0$ submanifold with (possibly empty) boundary.
2. If $N$ is a smooth manifold with boundary and $F:N\to M$ is a smooth embedding, then with the subspace topology $F(N)$ is a topogical manifold with boundary, and it has a smooth structure making it into an embedded submanifold with boundary in $M$.
3. An embedded submanifold with boundary in $M$ is properly embedded if and only if it is closed.
4. If $S\subseteq M$ is an immersed submanifold with boundary, then for each $\mathbf{p}\in S$ there exists a neighbourhood $U$ of $\mathbf{p}$ in $S$ that is embedded in $M$.
</MathBox>

<MathBox title='Half-slice' boxType='definition'>
Suppose that $M$ is a smooth manifold (without boundary). If $(U, (x^i))$ is a chart for $M$, a $k$-dimensional *half-slice* of $U$ is a subset of the following form for some constants $c^{k+1},\dots,c^n$:

$$
  \Set{(x^1,\dots,x^n)\in U | x^{k+1} = c^{k+1},\dots, x^n = c^n, x^k \geq 0}
$$

A subset $S\subseteq M$ satisfies the local $k$-slice condition for submanifolds with boundary if each point of $S$ is contained in the domain of a smooth chart $(U, (x^i))$ such that $S\cap U$ is either an ordinary $k$-dimensional slice or a $k$-dimensional half-slice. In the former case, the chart is called an *interior slice chart* for $S$ in $M$, and in the latter, it is a *boundary slice chart* for $S$ in $M$.
</MathBox>

<MathBox title='' boxType='theorem'>
Let $M$ be a smooth $n$-manifold without boundary. If $S\subseteq M$ is an embedded $k$-dimensional submanifold with boundary, then $S$ satisfies the local $k$-slice condition for submanifolds with boundary. Conversely, if $S\subseteq M$ is a subset that satisfies the local $k$-slice condition for submanifolds with boundary, then with the subspace topology, $S$ is a topological $k$-manifold with boundary, and it has a smooth structure making it into an embedded submanifold without boundary in $M$.
</MathBox>

<MathBox title='Restricting maps to submanifolds with boundary' boxType='theorem'>
Suppose that $M$ and $N$ are smooth manifold with boundary and let $S\subseteq M$ be an embedded submanifold.
1. **(restricting the domain):** If $F:M\to N$ is a smooth map, then $F|_S: S\to N$ is smooth.
2. **(restricting the codomain):** If $\partial M = \emptyset$ and $F:N\to M$ is a smooth map whose image is contained in $S$, then $F$ is a smooth map from $N$ to $S$.
</MathBox>

# Lie groups

<MathBox title='Lie group' boxType='definition'>
A *Lie group* is a smooth manifold $G$ (without boundary) that is also a group in the algebraic sense, with the property that the multiplication map $G\times G\to G$ given by $m(g,h) = gh$, and inversion map $i:G\to G$ given by $i(g) = g^{-1}$, are both smooth. A Lie group is, in particular, a *topological group*, a topological space with a group structure such that the multiplication and inversion maps are continuous.
</MathBox>

If $G$ is a Lie group, any element $g\in G$ defines maps $L_g,R_g: G\to G$, called *left translation* and *right translation*, respectively, given by

$$
\begin{align*}
  L_g(h) =& gh \\
  R_g(h) =& hg
\end{align*}
$$

Because $L_g$ can be expressed as the composition of smooth maps $G\xrightarrow{\iota_g} G\times G \xrightarrow{m} G$, where $\iota_g(h) = (g,h)$ and $m$ is multiplication, it follows that $L_g$ is smooth. It is actually a diffeomorphism of $G$, because $L_{g^{-1}}$ is a smooth inverse for it. Similarly $R_g$ is a diffeomorphism.

<MathBox title='' boxType='proposition'>
If $G$ is a smooth manifold with a group structure such that the map $G\times G\to G$ given by $(g,h) \mapsto gh^{-1}$ is smooth, then $G$ is a Lie group.
</MathBox>

## Lie group homomorphism

<MathBox title='Lie group homomorphism' boxType='proposition'>
If $G$ and $H$ are Lie groups, a *Lie group homomorphism* from $G$ to $H$ is a smooth map $F:G\to H$ that is also a group homomorphism. It is called a *Lie group isomorphism* if it is also a diffeomorphism, which implies that is has an inverse that is also a Lie group homomorphism. In this case, $G$ and $H$ are *isomorphic Lie groups*.
</MathBox>

<MathBox title='' boxType='theorem'>
Every Lie group homomorphism has constant rank.

<details>
<summary>Proof</summary>

Let $F:G\to H$ be a Lie group homomorphism, and let $e$ and $\tilde{e}$ denote the idenity elements of $G$ and $H$, respectively. Suppose that $g_0$ is an arbitrary element of $G$. We will show that $\mathrm{d}F_{g_0}$ has the same rank as $\mathrm{d}F_e$. The fact that $F$ is a homomorphism means that for all $g\in G$

$$
\begin{align*}
  F(L_{g_0}(g)) =& F(g_0 g) = F(g_0)F(g) \\
  L_{F(g_0)}(F(g))
\end{align*}
$$

or in other words, $F\circ L_{g_0} = L_{F(g_0)} \circ F$. Taking differentials of both sides at the identiy using the composition property of differentials gives

$$
  \mathrm{d}F_{g_0} \circ \mathrm{d}\left(L_{g_0}\right)_e = \mathrm{d}\left( L_{F(g_0)} \right)_{\tilde{e}} \circ \mathrm{d}F_e
$$

Left multiplication by any element of a Lie group is a diffeomorphism, so both $\mathrm{d}\left(L_{g_0}\right)_e$ and $\mathrm{d}\left(L_{F(g_0)} \right)_{\tilde{e}}$ are isomorphisms. Because composing with an isomorphism does not change the rank of a linear map, it follows that $\mathrm{d}F_{g_0}$ and $\mathrm{d}F_e$ have the same rank.
</details>
</MathBox>

<MathBox title='' boxType='corollary'>
A Lie group homomorphism is a Lie group isomorphism if and only if it is bijective.

<details>
<summary>Proof</summary>

The global rank theorem shows that a bijective Lie group homomorphism is a diffeomorphism.
</details>
</MathBox>

### Universal covering group

<MathBox title='Existence of a universal covering group' boxType='theorem'>
Let $G$ be a connected Lie group. There exists a simply connected Lie group $\tilde{G}$, called the *universal covering group* of $G$ that admits a smooth covering map $\pi:\tilde{G}\to G$ that is also a Lie group homomorphism.

<details>
<summary>Proof</summary>

Let $\tilde{G}$ be the universal covering manifold of $G$ and $\pi:\tilde{G}\to G$ be the corresponding smooth covering map. Then $\pi\times\pi: \tilde{G}\times\tilde{G}\to G\times G$ is also a smooth covering map.

Let $m:G\times G\to G$ and $i:G\to G$ denote the multiplication and inversion maps, respectively, and let $\tilde{e}$ be an arbitrary element of the fibre $\pi^{-1}(e) \subseteq \tilde{G}$. Since $\tilde{G}$ is simply connected, the lifting criterion for covering maps guarantees that the map $m\circ (\pi\times\pi): \tilde{G}\times\tilde{G} \to G$ has a unique continuous lift $\tilde{m}:\tilde{G}\times\tilde{G}\to\tilde{G}$ satisfying $\tilde{m}(\tilde{e},\tilde{e}) = \tilde{e}$ and $\pi\circ\tilde{m}= m\circ(\pi\times\pi)$

$$
\begin{CD}
  \tilde{G}\times\tilde{G} @>{\tilde{m}}>> \tilde{G} \\
  @V{\pi\times\pi}VV @VV{\pi}V \\
  G\times G @>>{m}> G
\end{CD}
$$

Because $\pi$ is a local diffeomorphism and $\pi\circ\tilde{m} = m\circ(\pi\times\pi)$ is smooth, it follows that $\tilde{m}$ is smooth. By the same reasoning, $i\circ\pi:\tilde{G}\to G$ has a smooth lift $\tilde{i}:\tilde{G}\to\tilde{G}$ satisfying $\tilde{i}(\tilde{e}) = \tilde{e}$ and $\pi\circ\tilde{i} = i\circ\pi$

$$
\begin{CD}
  \tilde{G} @>{\tilde{i}}>> \tilde{G} \\
  @V{\pi}VV @VV{\pi}V \\
  G @>>{i}> G
\end{CD}
$$

We define multiplication and inversion in $\tilde{G}$ by $xy = \tilde{m}(x,y)$ and $x^{-1} = \tilde{i}(x)$ for all $x,y\in\tilde{G}$. Then the commutative diagrams can be rewritten as $\pi(xy) = \pi(x)\pi(y)$ and $\pi(x^{-1}) = \pi(x)^{-1}$.

It remains only to show that $\tilde{G}$ is a group with these operations for then it is a Lie group because $\tilde{m}$ and $\tilde{i}$ are smooth, and the first commutative diagram shows that $\pi$ is a homeomorphism.

First, we show that $\tilde{e}$ is an identity for multiplication in $\tilde{G}$. Consider the map $f:\tilde{G}\to\tilde{G}$ defined by $f(x) = \tilde{e}x$. Then the first commutative diagram implies that $\pi\circ f(x) = \pi(\tilde{e})\pi(x) = e\pi(x) = \pi(x)$, so $f$ is a lift of $\pi:\tilde{G}\to G$. The identity map $\mathrm{id}_{\tilde{G}}$ is another lift of $\pi$, and it agrees with $f$ at a point because $f(\tilde{e}) = \tilde{m}(\tilde{e},\tilde{e}) = \tilde{e}$, so the unique lifting property of covering maps implies that $f = \mathrm{id}_{\tilde{G}}$, or equivalentlym $\tilde{e}x = x$ for all $x\in\tilde{G}$. The same argument shows that $x\tilde{e} = x$.

Next, to show that multiplication in $\tilde{G}$ is associative, consider the two maps $\alpha_L,\aplha_R: \tilde{G}\times\tilde{G}\to\tilde{G}\times\tilde{G}$ defined by

$$
\begin{align*}
  \alpha_L (x,y,z) =& (xy)z \\
  \alpha_R (x,y,z) =& x(yz)
\end{align*}
$$

The the first commutative diagram applied repeatedly implies that

$$
\begin{align*}
  \pi\circ\alpha_L(x,y,z) =& (\pi(x)\pi(y))\pi(z) \\
  =& \pi(x)(\pi(y)\pi(z)) \\
  =& \pi\circ\alpha_R (x,y,z)
\end{align*}
$$

so $\alpha_L$ and $\alpha_R$ are both lifts of the same map $\alpha(x,y,z) = \pi(x)\pi(y)\pi(z)$. Because $\alpha_L$ and $\alpha_R$ agree at $(\tilde{e},\tilde{e},\tilde{e})$, they are equal. A similar argument showst that $x^{-1} x = xx^{-1} = \tilde{e}$, so $\tilde{G}$ is a group.
</details>
</MathBox>

<MathBox title='Uniqueness of the universal covering group' boxType='theorem'>
For any connected Lie group $G$, the universal convering group is unique in the following sense: if $\tilde{G}$ and $\tilde{G}'$ are simply connected Lie groups that admit smooth covering maps $\pi:\tilde{G}\to G$ and $\pi': \tilde{G}\to G$ that are also Lie group homomorphism, then there exists a Lie group homomorphism $\phi:\tilde{G}\to\tilde{G}'$ such that $\pi'\circ\Phi = \pi$.
</MathBox>

## Lie subgroups

<MathBox title='Lie subgroup' boxType='definition'>
Suppose that $G$ is a Lie group. A *Lie subgroup* of $G$ is a subgroup of $G$ endowed with a topology and smooth structure making it into a Lie group and an immersed submanifold of $G$.
</MathBox>

<MathBox title='Embedded submanifolds are Lie subgroups' boxType='proposition'>
Let $G$ be a Lie group, and suppose that $H\subseteq G$ is a subgroup that is also an embedded manifold. Then $H$ is a Lie subgroup.

<details>
<summary>Proof</summary>

We only need to check that multiplication $H\times H\to H$ and inversion $H\to H$ are smooth maps. Because multiplication is a smooth map from $G\times G$ into $G$, its restriction is clearly smooth from $H\times H$ into $G$ (this is true even if $H$ is merely immersed). Because $H$ is a subgroup, multiplication takes $H\times H$ into $H$, and since $H$ is embedded, this is a smooth map into $H$. A similar argument applies to inversion. This proves that $H$ is a Lie subgroup.
</details>
</MathBox>

<MathBox title='' boxType='lemma'>
Suppose that $G$ is a Lie group and $H\subseteq G$ is an open subgroup. Then $H$ is an embedded Lie subgroup. In addition, $H$ is cloes, so it is a union of connected components of $G$.

<details>
<summary>Proof</summary>

If $H$ is open in $G$, it is embedded. In addition, every left coset $gH = \Set{gh | h\in H}$ is open in $G$ because it is the image of the open subset $H$ under the diffeomorphism $L_g$. Because $G\setminus H$ is the union of the cosets of $H$ other than $H$ itself, it is open, and therefore $H$ is closed in $G$. Because $H$ is both open and closed, it is a union of components.
</details>
</MathBox>

If $G$ is a group and $S\subseteq G$, the subgroup generated by $S$ is the smallest subgroup containing $S$, i.e. the intersection of all subgroups containing $S$.

<MathBox title='' boxType='proposition'>
Suppose that $G$ is a Lie group, and that $W\subseteq G$ is any neighbourhood of the identity.
1. $W$ generates an open subgroup of $G$
2. If $W$ is connected, it generates a connected open subgroup of $G$
3. If $G$ is connected, then $W$ generates $G$

<details>
<summary>Proof</summary>

**(1):** Let $W\subseteq G$ by any neighbourhood of the identity, and let $H$ be the subgroup generated by $W$. As a matter of notation, if $A$ and $B$ are subsets of $G$, let us write

$$
\begin{align*}
  AB =& \Set{ab | a\in A, b\in B} \\
  A^{-1} =& \Set{a^{-1} | a\in A}
\end{align*}
$$

For each $k\in\N_+$, let $W_k$ denote the set of all elements of $G$ that can be expressed as products of $k$ or fewer elements of $W\cup W^{-1}$. It follows that $H = \bigcup_{k\in\N_+} W_k$. Furthermore, $W^{-1}$ is open because it is the image of $W$ under the inversion map, which is a diffeomorphism. Thus $W_1 = W \cup W^{-1}$ is open, and for each $k > 1$ we have

$$
  W_k = W_1 W_{k-1} = \bigcup_{g\in W_1} L_g (W_{k-1})
$$

Because each $L_g$ is a diffeomorphism, it follows by induction that each $W_k$ is open, and thus $H$ is open.

**(2):** Suppose that $W$ is connected. Then $W^{-1}$ is also connected because it is a diffeomorphic image of $W$, and $W_1 = W \cup W^{-1}$ is connected because it is a union of connected sets with the identity in common. Therefore, $W_2 = m(W_1 \times W_1)$ is connected because it is the image of a connected space under the continuous multiplication map $m$, and it follows by induction that $W_k = m(W_1\times W_{k-1})$ is connected for each $k$. Thus, $H = \bigcup_{k\in\N_+} W_k$ is connected because it is a union of connected subsets with the identity in common.

**(3):**Assume that $G$ is connected. Since $H$ is an open subgroup, it is closed by the previous lemma, and it is not empty because it contains the identity. Thus, $H = G$.
</details>
</MathBox>

<MathBox title='Identity component' boxType='definition'>
If $G$ is a Lie group, the connected component of $G$ containing the identity is called the *identity component* of $G$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $G$ be a Lie group and let $G_0$ be its identity component. Then $G_0$ is a normal subgroup of $G$, and is the only connected open subgroup. Every connnected component of $G$ is diffeomorphic to $G_0$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $F:G\to H$ be a Lie group homomorphism. The kernel of $F$ is a properly embedded Lie subgroup of $G$, whose codimension is equal to the rank of $F$.

<details>
<summary>Proof</summary>

Because $F$ has constant rank, its kernel $F^{-1}(e)$ is a properly embedded submanifold of comdimension equal to $\mathrm{rank}(F)$. It is thus a Lie subgroup.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
If $F:G\to H$ is an injective Lie group homomorphism, the image of $F$ has a unique smooth manifold structure such that $F(G)$ is a Lie subgroup of $H$ and $F:G\to F(G)$ is a Lie group isomorphism.

<details>
<summary>Proof</summary>

Since a Lie group has constant rank, it follows from the global rank theorem that $F$ is a smooth immersion. Then $F(G)$ has a unique smooth manifold structure such that it is an immersed submanifold of $H$, and $F$ is a diffeomorphism onto its image. It is a Lie group because $G$ is, and it is a subgroup for algebraic reasons, so it is a Lie subgroup. Because $F:G\to F(G)$ is a group isomorphism and a diffeomorphism, it is a Lie group isomorphism.
</details>
</MathBox>

<MathBox title='Embedded Lie subgroups are properly embedded submanifolds' boxType='theorem'>
Suppose that $G$ is a Lie group and that $H\subseteq G$ is a Lie subgroup. Then $H$ is closed in $G$ if and only if it is embedded.

<details>
<summary>Proof</summary>

Assume first that $H$ is embedded in $G$. To prove that $H$ is closed, let $g$ be an arbitrary point of $\overline{H}$. Then there is a sequence $(h_i)_{i\in\N}$ of points in $H$ converging to $g$. Let $U$ be the domain of a slice chart for $H$ containing the identity, and let $W$ be a smaller neighbourhood of $e$ such that $\overline{W}\subseteq U$. Then there is a neighbourhood $V$ of $e$ with the property that $g_1 g_2^{-1} \in W$, whenever $g_1, g_2\in V$.

Because $h_i g^{-1} \to e$, by discarding finitely many terms of the sequence we may assume that $h_i g^{-1} \in V$ for all $i$. This implies that

$$
  h_i h_j^{-1} = (h_i g^{-1})(h_j g^{-1})^{-1}\in W,\; \forall i,j \in\N
$$

Fixing $j$ and letting $i\to \infty$, we find that $h_i h_j^{-1} \to gh_j^{-1} \in\overline{W}\subseteq U$. Since $H \cap U$ is a slice, it is closed in $U$, and therefore $gh_j^{-1}\in H$, which implies $g\in H$. Thus $H$ is closed.

Conversely, assume that $H$ is a closed Lie subgroup, and let $m = \dim(H)$ and $n = \dim(G)$. We need to show that $H$ is an embedded submanifold of $G$. If $m = n$, then by the conditions for embeddedness $H$ is embedded, so we may assume that $m < n$.

If suffices to show that for some $h_1\in H$, there is a neighbourhood $U_1$ of $h_1$ in $G$ such that $H \cap U_1$ is an embedded submanifold of $U_1$. If $h$ is any other point of $H$, the right translation $R_{hh_1^{-1}}: G\to G$ is a diffeomorphism of $G$ that takes $H$ to $H$, and takes $U_1$ to a neighbourhood $U'_1$ of $h$ such that $U'_1 \cap H$ is embedded in $U'_1$, so it follows from the local slice criterion that $H$ is an embedded submanifold of $G$.

Because every immersed submanifold is locally embedded, there exists a neighbourhood $V$ of $e$ in $H$ and a slice chart $(U,\varphi)$ for $V$ in $G$ centered at $e$ By shrinking $U$ if necessary, we may assume that it is a coordinate cube, and $U\cap V$ is the set of points whose coordinates are of the form $(x^1,\dots,x^m,0,\dots,0)$. Let $S\subseteq U$ be the set of points with coordinates of the form $(0,\dots,0,x^{m+1},\dots,x^n)$. It is the slice perpendiculaar to $U \cap V$ in these coordinates. Then $S$ is an embedded submanifold of $U$ and hence of $G$. Note that in these coordinates, $T_e V$ is spanned by the first $m$ coordinate vectors and $T_e S$ by the last $n-m$, so $T_e G = T_e V \oplus T_e S$.

Consider the map $\psi:V\times S\to G$ obtained by restricting group multiplication: $\psi(v,s) = vs$. Since $\psi(v,e) = v$ for $v\in V$ and $\psi(e,s) = s$ for $s\in S$, it follows easily that the differential of $\psi$ at $(e,e)$ satisfies $\mathrm{d}\psi(X,0) = X$ and $\mathrm{d}\psi(0,Y) = Y$ for $X\in T_e V$ and $Y\in T_e S$, and therefore $\mathrm{d}\psi_{(e,e)}$ is bijective. By the inverse function theorem, there are connected neighbourhoods $W_0$ of $(e,e)$ in $V\times S$ and $U_0$ of $e$ in $G$ such that $\psi:W_0 \to U_0$ is a diffeomorphism. Shrinking the neighbourhoods if necessary, we may assume that $W_0 = V_0 \times S_0$, where $V_0$ and $S_0$ are neighbourhoods of $e$ in $V$ and $S$, respectively.

Let $K = S_0 \cap H$. There are two things we need to show about $K$:
1. $\psi(V_0 \times K) = H\cap U_0$
2. $K$ is a discrete set in the topology of $H$

To prove **(1)**, let $(v,s)\in V_0 \times S_0$ be arbitrary. Since $H$ is a subgroup and $V_0 \subseteq H$, it follows that $vs\in H$ if and only if $s\in H$, which is to say that $\psi(v,s)\in H\cap U_0$ if and only if $(v,s) \in V_0 \times K$. To prove **(2)**, suppose that $h\in K$. Righ translation $R_h: H\to H$ is a diffeomorphism of $H$ taking $e$ to $h$ and takin $V_0$ to a neighbourhood $V_h$ of $h$. Note that $V_h = R_h(V_0) = \psi(V_0 \times \Set{h})$, while $K = \psi(\Set{e}\times K)$. Since $\psi$ is injective on $V_0 \times S_0$, it follows that

$$
  V_h \cap K = \psi(\Set{e}\times\Set{h}) = \Set{h}
$$

Thus each point $h\in K$ is isolated in $H$, which implies that $K$ is discrete. Since $K$ is a discrete subset of the manifold $H$, it is countable, and since $H$ is closed in $G$, it follows that $K = S_0 \cap H$ is closed in $S_0$. Thus, there is a point $h_1 \in K$ that is isolated in $S_0$ (this step fails if $H$ is not closed - for example, if $H$ is a dense subgroup of the torus, then $K$ is dense in $S_0$). This means that there is a neighbourhood $S_1$ of $h_1$ in $S_0$ such that $S_1 \cap H = \Set{h_1}$. Then $U_1 = \psi(V_0 \times S_1)$ is a neighbourhood of $h_1$ in $G$ with the property that $U_1 \cap H$ is the slice $\psi(V_0 \times\Set{h_1})$ in $U_1$. The existence of such a neighbourhood for one point of $H$ implies that $H$ is embedded.
</details>
</MathBox>

## Group actions

<MathBox title='Group action' boxType='definition'>
If $G$ is a group and $M$ is a set, a *left action* of $G$ on $M$ is a map $G\times M\to M$, often written as $(g,\mathbf{p})\mapsto g\cdot \mathbf{p}$ that satisfies
1.  $g_1\cdot (g_2\cdot \mathbf{p}) = (g_1 g_2)\cdot \mathbf{p}$ for all $g_1, g_2 \in G$ and $\mathbf{p} \in M$
2. $e\cdot \mathbf{p} = \mathbf{p}$ for all $\mathbf{p}\in M$

A *righ action* is defined analogously as a map $M\times G\to M$, written $(\mathbf{p},g)\mapsto \mathbf{p}\cdot g$, with the appropriate composition law
1.  $(\mathbf{p}\cdot g_1) \cdot g_2 = \mathbf{p}\cdot (g_1 g_2)\cdot \mathbf{p}$ for all $g_1, g_2 \in G$ and $\mathbf{p} \in M$
2. $\mathbf{p}\cdot e = \mathbf{p}$ for all $\mathbf{p}\in M$

If $M$ is a topological space and $G$ is a topological group, an action of $G$ on $M$ called a continuous action if the defining map $G\times M\to M$ or $M\times G\to M$ is continuous. In this case, $M$ is a (left or right) $G$-space. If in addition $M$ is a smooht manifold with or without boundary, $G$ is a Lie group, and the defining map is smooth, then the action is called a $smooth action$.
</MathBox>

Sometimes actions are labeled like $\theta: G\times M\to M$ and $\theta_g (\mathbf{p})$. With this notation, the conditions for a left action read
1. $\theta_{g_1} \circ\theta_{g_2} = \theta_{g_1 g_2}$
2. $\theta_e = \mathrm{id}_M$

while for a right action the first equation is replaced by 
1. $\theta_{g_2}\circ\theta_{g_2} = \theta_{g_1 g_2}$.

A right action can always be converted to a left action by the trick of defining $\mathbf{p}\cdot g$ to be $\mathbf{p} \cdot g^{-1}$. Similarly, a left action can be converted to a right action.

<MathBox title='Group action terminology' boxType='definition'>
Suppose that $\theta:G\times M\to M$ is a left action of group $G$ on a set $M$.
- For each $p\in M$ the *orbit* of $p$, denoted by $G\cdot p$, is the set of all images of $p$ under the action by elements of $G$:
$$
  G\cdot p = \Set{g\cdot p | g\in G}
$$
- For each $p\in M$, the *isotropy group* or *stabilizer* of $p$, denoted by $G_p$, is the set of elements of $G$ that fix $p$:
$$
  G_p = \Set{g\in G | g\cdot p = p}
$$
The definition of a group guarantees that $G_p$ is a subgroup of $G$.
- The action is *transitive* if for every pair of points $p,q\in M$, there exists $g\in G$ such that $g\cdot p = q$, or equivalently, if the only orbit is all of $M$.
- The action is *free* if the only element of $G$ that fixes any element of $M$ is the identity: $g\cdot p = p$ for some $p\in M$ implies $g\cdot e$, or equivalently, if every isotopy group is trivial.
</MathBox>

<MathBox title='Automorphism group' boxType='definition'>
Suppose that $E$ and $M$ are topological spaces, and that $\pi:E\to M$ is a topological covering map. An *automorphism* of $\pi$, also called a *deck/covering transformation*, is a homeomorphism $\varphi:E\to E$ such that $\pi\circ\varphi = \pi$:

$$
\begin{CD}
  E @>{\varphi}>> E \\
  @V{\pi}VV @VV{\pi}V \\
  M @= M
\end{CD}
$$

The set $\mathrm{Aut}_\pi (E)$ of all automorphisms of $\pi$, called the *automorphism group* of $\pi$, is a group under composition, acting on $E$ from the left.
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $E$ and $M$ are smooth manifolds with or without boundary, and $\pi: E\to M$ is a smooth covering map. With the discrete topology, the automorphism group $\mathrm{Aut}_\pi (E)$ is a zero-dimensional Lie group acting smoothly and freely on $E$.

<details>
<summary>Proof</summary>

Suppose that $\varphi\in\mathrm{Aut}_\pi (E)$ is an automorphism that fixes a point $\mathbf{p}\in E$. We can consider $\varphi$ as a lift of $\pi$:

$$
\begin{CD}
  E @>{\varphi}>> E \\
  @| @VV{\pi}V \\
  E @>>{\pi}> M
\end{CD}
$$

Since the identity map of $E$ is another such lift that agrees with $\varphi$ at $\mathbf{p}$, the unique lifting property of covering maps guarantees that $\varphi = \mathrm{id}_E$. Thus, the action of $\mathrm{Aut}_\pi (E)$ is free.

To show that $\mathrm{Aut}_\pi (E)$ is a Lie group, we need only verify that is is countable. Let $q\in E$ be arbitrary, $\mathbf{p} = \pi(\mathbf{q})\in M$, and let $U\subseteq M$ be an evenly covered neighbourhood of $\mathbf{p}$. Because $E$ is second-countable, $\pi^{-1}(U)$ has countable many components, and because each component contains exactly one point of $\pi^{-1}(\mathbf{p})$, it follows that $\pi^{-1}(\mathbf{p})$ is countable. Let $\theta^{(\mathbf{q})}: \mathrm{Aut}_\pi (E)\to E$ be the map $\theta^{(\mathbf{q})}(\varphi) = \varphi(\mathbf{q})$. Then $\theta^{(\mathbf{q})}$ maps $\mathrm{Aut}_\pi (E)$ into $\pi^{-1}(\mathbf{p})$, and the fact that the action is free implies that it is injective, thus $\mathrm{Aut}_\pi (E)$ is countable.
</details>
</MathBox>

### Equivariant maps

<MathBox title='Equivariant map' boxType='definition'>
Suppose that $G$ is a Lie group, and that $M$ and $N$ are booth smooth manifolds endowed with smooth left or right $G$-actions. A map $F:M\to N$ is *equivariant* with respect to the given $G$-actions if for each $g\in G$

1. $F(g\cdot\mathbf{p}) = g\cdot F(\mathbf{p})$ (for left actions)
2. $F(\mathbf{p}\cdot g) = F(\mathbf{p})\cdot g$ (for right actions)

Equivalently, if $\theta$ and $\varphi$ are the given actions on $M$ and $N$, respectively, $F$ is equivariant if the following diagram commutes for eaach $g\in G$:

$$
\begin{CD}
  M @>{F}>> N \\
  @V{\theta_g}VV @VV{\varphi_g}V \\
  M @>>{F}> N
\end{CD}
$$

The condition is also expressed by saying the $F$ *intertwines* $\theta$ and $\varphi$.
</MathBox>

<MathBox title='Equivariant rank theorem' boxType='theorem'>
Let $M$ and $N$ be smooth manifolds and let $G$ be a Lie group. Suppose that $F:M\to N$ is smooth map that is equivariant with respect to a transitive smooth $G$-action on $M$ and any smooth $G$-action on $N$. Then $F$ has constant rank. Thus, if $F$ is surjective, it is a smooth submersion; if it is injective, it is smooth immersion; and if it is bijective, it is a diffeomorphism.

<details>
<summary>Proof</summary>

Let $\theta$ and $\varphi$ denote the $G$-actions on $M$ and $N$, respectively, and let $\mathbf{p}$ and $\mathbf{q}$ be arbitrary points in $M$. Choose $g\in G$ such that $\theta_g (\mathbf{p}) = \mathbf{q}$. Because $\varphi_g \circ F = F\circ\varphi_g$, the following diagram commutes:

$$
\begin{CD}
  T_\mathbf{p}M @>{\mathrm{d}F_\mathbf{p}}>> T_{F(\mathbf{p})}N \\
  @V{\mathrm{d}(\theta_g)_\mathbf{p}}VV @VV{\mathrm{d}(\varphi_g)_{F(\mathbf{p})}}V \\
  T_\mathbf{q} M @>>{\mathrm{d}F_\mathbf{q}}> T_{F(\mathbf{q})} N
\end{CD}
$$

Because the vertical linear maps in this diagram are isomorphisms, the horizontal ones have the same rank. In other word, the rank of $F$ is the same at any two arbitrary points $\mathbf{p},\mathbf{q}\in M$, so $F$ has constant rank. The final statement follows from the global rank theorem.
</details>
</MathBox>

<MathBox title='Orbit map' boxType='definition'>
Suppose that $G$ is a Lie group, $M$ is a smooth manifold, and that $\theta:G\times M\to M$ is a smooth left action (the definition for right actions is analogous). For each $\mathbf{p}\in M$, define a map $\theta^{(\mathbf{p})}:G\to M$ by $\theta^{(\mathbf{p})}(g) = g\cdot\mathbf{p}$. This is called the *orbit map*, because its image is the orbit $G\cdot\mathbf{p}$. In addition, the preimage $\left(\theta^{(\mathbf{p})}\right)^{-1}(\mathbf{p})$ is the isotropy group $G_\mathbf{p}$.
</MathBox>

<MathBox title='Properties of the orbit map' boxType='proposition'>
Suppose that $\theta$ is a smooth left action of a Lie group $G$ on a smooth manifold $M$. For each $p\in M$, the orbit map $\theta^{(\mathbf{p})}: G\to M$ is smooth and has constant rank, so the isotropy group $G_\mathbf{p} = \left(\theta^{(\mathbf{p})}\right)^{-1}(\mathbf{p})$ is a properly embedded Lie subgroup of $G$. If $G_\mathbf{p} = \Set{e}$, then $\theta^{(\mathbf{p})}$ is an injective smooth immersion, so the orbit $G\cdot\mathbf{p}$ is an immersed submanifold of $M$.

<details>
<summary>Proof</summary>

The orbit map is smooth because it is equal to the composition

$$
  G\cong G\times\Set{\mathbf{p}} \hookrightarrow G\times M \xrightarrow{\theta} M
$$

It follows from the definition of a group action that $\theta^{(\mathbf{p})}$ is equivariant with respect to the action of $G$ on itself by left translation and the given action on $M$

$$
\begin{align*}
  \theta^{(\mathbf{p})}(g'g) =& (g'g)\cdot \mathbf{p} = g'\cdot(g\cdot\mathbf{p}) \\
  =& g'\cdot \theta^{\mathbf{p}}(g)
\end{align*}
$$

Since $G$ acts transitively on itself, the equivariant rank theorem shows that $\theta^{(\mathbf{p})}$ has constant rank. Thus $G_\mathbf{p}$ is a properly embedded submanifold and a Lie subgroup.

Suppose that $G_p = \Set{e}$. If $\theta^{(\mathbf{p})}(g') = \theta^{(\mathbf{p})}(g)$, then

$$
\begin{gather*}
  g' \cdot\mathbf{p} = g\cdot \mathbf{p} \\
  \iff (g^{-1}g')\cdot\mathbf{p} = \mathbf{p} \\
  \iff g^{-1}g' = e \iff g = g'
\end{gather*}
$$

showing that $\theta^{(\mathbf{p})}$ is injective. By the equivariant rank theorem, it is a smooth immersion, and thus the orbit (endowed with a suitable topology and smooth structure) is an immersed submanifold.
</details>
</MathBox>

### Semidirect products

<MathBox title='Semidirect product' boxType='definition'>
Suppose that $H$ and $N$ are Lie groups, and that $\theta: H\times N\to N$ is a smooth left action of $H$ on $N$. It is called an *action by automorphisms* if for each $h\in H$, the map $\theta_h:N\to N$ is a group automorphism of $N$. Given such an action, we define a new Lie group $N \rtimes_\theta H$, called a *semidirect product* of $H$ and $N$ as follows. As a smooth manifold, $N \rtimes_\theta H$ is just the Cartesian product $N\times H$, but the group multiplication is defined by

$$
  (n,h)(n', h') = (n\theta_h(n'), hh')
$$
</MathBox>

<MathBox title='Properties of semidirect products' boxType='proposition'>
Suppose that $H$ and $N$ are Lie groups, and that $\theta: H\times N\to N$ is a smooth action of $H$ on $N$ by automorphism. Let $G = N \rtimes_\theta H$.
1. The subsets $\tilde{N} = N\times\Set{e}$ and $\tilde{H} = \Set{e}\times H$ are closed Lie subgroups of $G$ isomorphic to $N$ and $H$, respectively.
2. $\tilde{N}$ is a normal subgroup of $\tilde{G}$
3. $\tilde{N} \cap\tilde{H} = \Set{(e,e)}$ and $\tilde{N}\tilde{H}= G$ 
</MathBox>

<MathBox title='Characterization of semidirect products' boxType='theorem'>
Suppose that $G$ is a Lie group, and that $N,H\subseteq G$ are closed Lie subgroups such that $N$ is normal, $N\cap H = \Set{e}$ and $NH = G$. Then the map $(n,h)\mapsto nh$ is a Lie group isomorphism between $N \rtimes_\theta H$ and $G$, where $\theta: H\times N\to N$ is the action by conjugation: $\theta_h (n) = hnh^{-1}$.
</MathBox>

### Representations

<MathBox title='Linear action' boxType='definition'>
Let $G$ be a Lie group and $V$ be a finite-dimensional vector space. An action of $G$ on $V$ is called a *linear action* if for each $g\in G$, the map from $V$ to itself given by $x\mapsto g\cdot x$ is linear.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $G$ be a Lie group and $V$ be a finite-dimensional vector space. A smooth left action of $G$ on $V$ is linear if and only if it is of the form $g\cdot x = \rho(g)x$ for some representation $\rho$ of $G$.

<details>
<summary>Proof</summary>

Every action induced by a representation is evidently linear. To prove the converse, assumme that we are given a linear action of $G$ on $V$. The hypothesis implies that for each $g\in G$ there is a linear map $\rho(g) \in \mathrm{GL}(V)$ such that $g\cdot x = \rho(g)x$ for all $x\in V$. The fact that the action satisfies the left action properties translates to $\rho(g_1 g_2) = \rho(g_1)\rho(g_2)$, so $\rho: G\to \mathrm{GL}(V)$ is a group homomorphism. Thus, to show that it is a Lie group representation, we need only show that it is smooth.

Choose a basis $\Set{\mathbf{e}_i}$ for $V$, and for each $i$ let $\pi^i: V\to\R$ be the projection onto the $i$th coordinate with respect to this basis: $\pi^i (x^j \mathbf{e}_j) = x^i$. If we let $\rho_j^i(g)$ denote the matrix entries of $\rho(g)$ with respect to this basis, it follows that $\rho_j^i(g) = \pi^i (g\cdot\mathbf{e}_i)$, so each function $\rho_j^i$ is a composition of smooth function. Because the matrix entries form global smooth coordinates for $\mathrm{GL}(V)$ ,this implies that $\rho$ is smooth.
</details>
</MathBox>

# Vector fields

<MathBox title='Vector field' boxType='definition'>
If $M$ is a smooth manifold with or without boundary, a *vector field* on $M$ is a section of the map $\pi:TM\to M$. More specifically, a vector field is a continuous map $X:M\to TM$, usually written $\mathbf{p}\mapsto X_\mathbf{p}$, with the property that

$$
  \pi\circ X = \mathrm{id}_M
$$

or equivalently, $X_\mathbf{p}\in T_\mathbf{p}M$ for each $\mathbf{p}\in M$. If $X$ is smooth it is a *smooth vector field*, otherwise it is called a *rough vector field*. The set of all smooth vector fields on $M$, denoted $\mathfrak{X}(M)$, is a vector space under pointwise addition and scalar multiplication:

$$
  (\alpha X + \beta Y)_\mathbf{p} = \alpha X_\mathbf{p} + \beta Y_\mathbf{p},\; \alpha,\beta\in\R
$$

The zero element of this vector space is the zero vector field, whose value at each $\mathbf{p}\in M$ is $\mathbf{0}\in T_\mathbf{p}M$. In addition, smooth vector fields can be multiplied by smooth real-valued functions: if $f\in C^\infty(M)$ and $X\in\mathfrak{X}(M)$, we define $fX:M\to TM$ by

$$
  (fX)_\mathbf{p} = f(\mathbf{p})X_\mathbf{p}
$$

The support of $X$ is defined as

$$
  \mathrm{supp}(X) = \overline{\Set{\mathbf{p}\in M | X_\mathbf{p} \neq \mathbf{0}}}
$$

A vector field is *compactly supported* if its support is a compact set. 

If $U\subseteq M$ is an arbitrary subset, a *vector field along* $U$ is a continuous map $X:A\to TM$ satisfying

$$
  \pi\circ X = \mathrm{id}_U
$$

or equivalently, $X_\mathbf{p}\in T_\mathbf{p}M$ for each $\mathbf{p}\in U$. The vector field along $U$ is smooth if for each $\mathbf{p}\in U$ there is a neighbourhood of $\mathbf{p}$ in $M$ and a smooth vector field $\tilde{X}$ on $V$ that agrees with $X$ on $V \cap U$.
</MathBox>

Suppose that $M$ is a smooth $n$-manifold with or without boundary. If $X:M\to TM$ is a rough vector field and $(U, (x^i))$ is any smooth coordinate chart for $M$, we can write $X$ at any point $\mathbf{p}\in U$ in terms of the coordinate basis vectors:

$$
  X_\mathbf{p} = X^i(\mathbf{p}) \left.\frac{\partial}{\partial x^i}\right|_\mathbf{p}
$$

This defines $n$ functions $X^i:U\to\R$, called the *component functions* of $X$ in the given chart.

<MathBox title='Smoothness criterion for vector fields' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary, and let $X:M\to TM$ be a rough vector field. If $(U, (x^i))$ is any smooth coordinate chart on $M$, then the restriction of $X$ to $U$ is smooth if and only if its component functions with respect tor this chart are smooth.

<details>
<summary>Proof</summary>

Let $(x^i, v^i)$ be the natural coordinates on $\pi^{-1}(U)\subseteq TM$ associated with the chart $(U,(x^i))$. By definition of natural coordinates, the coordinate representation of $X:M\to TM$ on $U$ is

$$
  \hat{X}(\mathbf{p}) = (x^i,\dots,x^n,X^1(\mathbf{x}),\dots,X^n(\mathbf{x}))
$$

where $X^i$ is the $i$th component function of $X$ in $x^i$-coordinates. It follows immediately that smoothness of $X$ in $U$ is equivalent to smoothness of its component functions.
</details>
</MathBox>

<MathBox title='Extension lemma for vector fields' boxType='lemma'>
Let $M$ be a smooth manifold with or without boundary, and let $A\subseteq M$ be a closed subset. Suppose that $X$ is a smooth vector field along $A$. Given any subset $U$ containing $A$, there exists a smooth global vector field $\tilde{X}$ on $M$ such that $\tilde{X}|_A$ and $\mathrm{supp}(\tilde{X})\subseteq U$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary. Given $\mathbf{p}\in M$ and $\mathbf{v}\in T_\mathbf{p} M$, there is a smooth global vector field $X$ on $M$ such that $X_\mathbf{p} = \mathbf{v}$.

<details>
<summary>Proof</summary>

The assignment $\mathbf{p}\mapsto\mathbf{v}$ is an example of a vector field along the set $\Set{\mathbf{p}}$. It is smooth because it can be extended to a constant-coefficient vector field in a coordinate neighbourhood of $\mathbf{p}$. Thus, the proposition follows from the extension lemma with $A = \Set{\mathbf{p}}$ and $U = M$.
</details>
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary. 
1. If $X$ and $Y$ are smooth vector field on $M$ and $f,g\in C^\infty (M)$, then $fX + gY$ is a smooth vector field.
2. $\mathfrak{X}(M)$ is a module over the ring $C^\infty (M)$
</MathBox>

## Local and global frames

<MathBox title='Linear independence' boxType='proposition'>
Suppose that $M$ is a smooth $n$-manifold with or without boundary. An ordered $k$-tuple $(X_1,\dots,X_k)$ of vector fields defined on some subset $A\subseteq M$ is *linearly independent* if $(X_1|_\mathbf{p},\dots, X_k|_\mathbf{p})$ is a linearly independent $k$-tuple in $T_\mathbf{p} M$ for each $\mathbf{p}\in A$. The $k$-tuple $(X_1,\dots,X_k)$ of vector fields *spans* the tangent bundle $TM$ if the $k$-tuple $(X_1|_\mathbf{p},\dots,X_k|\mathbf{p})$ spans $T_\mathbf{p}M$ for each $\mathbf{p}$.
</MathBox>

<MathBox title='Frame' boxType='definition'>
Suppose that $M$ is a smooth $n$-manifold with or without boundary. A *local frame* for $M$ is an ordered $n$-tuple of vector fields $(E_i)_{i=1}^n$ defined on an open subset $U\subseteq M$ that is linearly independent and spans the tangent bundle. Thus, the vectors $(E_i|_\mathbf{p})_{i=1}^n$ form a basis for $T_p M$ at each $\mathbf{p}$. It is called a *global frame* if $U = M$, and a *smooth frame* if each of the vector fields $E_i$ is smooth. If $M$ admits a smooth global frame, it is called *parallelizable*.

In particular, if $M = \R^n$, then a $k$-tuple of vector fields $(E_i)_{i=1}^k$ defined on some subset $A\subseteq\R^n$ is *orthonormal* if for each $\mathbf{p}\in A$, the vectors $(E_i|_\mathbf{p})_{i=1}^k$ are orthonormal with respect to the Euclidean inner product. A (local/global) frame consisiting of orthonormal vector fields is called an *orthonormal field*.
</MathBox>

<MathBox title='Completion of local frames' boxType='proposition'>
Suppose that $M$ is a smooth $n$-manifold with or without boundary.
1. If $(X_i)_{i=1}^k$ is a linearly independent $k$-tuple of smooth vector fields on an open subset $U\subseteq M$ with $1\geq k < n$, then for each $\mathbf{p}\in U$ there exis smooth vector fields $X_{k+1},\dots,X_n$ in a neighbourhood $V$ of $\mathbf{p}$ such that $(X_i)_{i=1}^n$ is a smooth local frame for $M$ on $U\cap V$.
2. If $(\mathbf{v}_i)_{i=1}^k$ is a linearly independent $k$-tuple of vectors in $T_\mathbf{p}M$ for some $\mathbf{p}\in M$ with $1\leq k < n$, then there exists a smooth local frame $(X_i)_{i=1}^k$ on a neighbourhood of $\mathbf{p}$ such that $X_i|\mathbf{p} = \mathbf{v}_i$. 
3. If $(X_i)_{i=1}^n$ is a linearly independent $n$-tuple of smooth vector fields along a closed subset $A\subseteq M$, then there exists a smooth local fram $(\tilde{X}_1)_{i=1}^n$ on some neighbourhood of $A$ such that $\tilde{X}_i|_A = X_i$.
</MathBox>

<MathBox title='Gram-Schmidt algorithm for frames' boxType='lemma'>
Suppose that $(X_i)_{i=1}^n$ is a smooth local frame for $T\R^n$ over an open subset $U\subseteq \R^n$. Then there is a smooth orthonormal frame $(E_i)_{i=1}^n$ over $U$ such that for each $\mathbf{p}\in U$

$$
  \mathrm{span}(E_i|_\mathbf{p})_{i=1}^n = \mathrm{span}(X_i|_\mathbf{p})_{i=1}^n
$$

<details>
<summary>Proof</summary>

Applying the Gram-Schmidt algorithm to the vectors $(X_j|_\mathbf{p})$ at each $\mathbf{p}\in U$, we obtain an $n$-tuple of rough vector fields $(E_i)_{i=1}^n$ given inductively by

$$
  E_j = \frac{X_j - \sum_{i=1}^{j-1} (X_j \cdot E_i)E_i}{|X_j - \sum_{i=1}^{j-1} (X_j \cdot E_i)E_i|},\; j=1,\dots,n
$$

For eahc $j=1,\dots,n$ and each $\mathbf{p}\in U$, then $X_j|_\mathbf{p}\notin \mathrm{span}(E_1|_\mathbf{p},\dots,E_{j-1}|_\mathbf{p})$, so the denominator above is a nowhere-vanishing smooth function on $U$. Thus, this formula defines $(E_i)_{i=1}^n$ as a smooth orthonormal frame on $U$.
</details>
</MathBox>

## Vector fields as derivations of $C^\infty (M)$

Vector fields define operators on the space of smooth real-valued functions. Let $M$ be a smooth manifold with or without boundary. If $X\in\mathfrak{X}(M)$ and $f\in C^\infty (U)$ is a smooth real-valued function defined on an open subset $U\subseteq M$, we obtain a new function $Xf:U\to\R$ defined By

$$
  (Xf)(\mathbf{p}) = X_\mathbf{p}f
$$

In particular, for any open subset $V \subseteq U$

$$
  (Xf)|_V = X(f|_V)
$$

<MathBox title='Smoothness criterion for vector fields' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary, and let $X:M\to TM$ be a rough vector field. The following are equivalent:
1. $X$ is smooth
2. for every $f\in C^\infty (M)$, the function $Xf$ is smooth on $M$
3. for every open subset $U\subseteq M$ and every $f\in C^\infty (M)$, the function $Xf$ is smooth on $U$

<details>
<summary>Proof</summary>

**(1)** $\implies$ **(2)**<br/>
Assume that $X$ is smooth, and let $f\in C^\infty(M)$. For any $\mathbf{p}\in M$, we can choose smooth coordinates $(x^i)$ on a neighbourhood $U$ of $\mathbf{p}$. Then for $\mathbf{x}\in U$, we can write

$$
  Xf(\mathbf{x}) = \left( X^i(\mathbf{x})\left.\frac{\partial}{\partial x^i}\right|_\mathbf{x} \right)f = X^i(\mathbf{x})\frac{\partial f}{\partial x^i}(\mathbf{x})
$$

Since the component functions $X^i$ are smooth on $U$, if follows that $Xf$ is smooth in $U$. Since the same is true in a neighbourhood of each point, $Xf$ is smooth on $M$.

**(2)** $\implies$ **(3)**<br/>
Suppose that $U\subseteq M$ is open and $f\in C^\infty (U)$. For any $\mathbf{p}\in U$, let $\psi$ be a smooth bump function that is equal to $1$ in a neighbourhood of $\mathbf{p}$ and supported in $U$, and define $\tilde{f} = \psi f$, extended to be zero on $M\setminus\mathrm{supp}(\psi)$. Then $X\tilde{f}$ is smooth by assumption, and is equal to $Xf$ in a neighbourhood of $\mathbf{p}$. This shows that $Xf$ is smooth in a neighbourhood of each point of $U$.

**(3)** $\implies$ **(1)**<br/>
Suppose that $Xf$ is smooth whenever $f$ is smooth on an open subset of $M$. If $(x^i)$ are any smooth local coordinates on $U\subseteq M$, we can think of each coordinate $x^i$ as a smooth function on $U$. Applying $X$ to one of these functions, we obtain

$$
  Xx^i = X^j \frac{\partial}{\partial x^j}(x^i) = X^i
$$

Because $Xx^i$ is smooth by assumption, it follows that the component functions of $X$ are smooth, so $X$ is smooth.
</details>
</MathBox>

<MathBox title='Vector fields are derivations' boxType='proposition'>
Let $M$ be a smooth manifold with or without boundary. A map $D:C^\infty(M) \to C^\infty(M)$ is a derivation if and only if it is of the form $Df = Xf$ for some smooth vector field $X\in\mathfrak{X}(M)$.

<details>
<summary>Proof</summary>

A smooth vector field $X\in\mathfrak{X}(M)$ defines a map from $C^\infty(M)$ to itself by $f\mapsto Xf$. This map is clearly linear over $\R$ and satisfies the product rule

$$
\begin{align*}
  (Xfg)(\mathbf{p}) =& X_\mathbf{p}(fg) = \left(X^i (\mathbf{p})\left.\frac{\partial }{\partial x^i}\right|_\mathbf{p}\right)fg \\
  =& X^i (\mathbf{p}) \frac{\partial fg}{\partial x^i} (\mathbf{p}) \\
  =& X^i (\mathbf{p}) \left(f(\mathbf{p})\frac{\partial g}{\partial x^i}(\mathbf{p}) +  g(\mathbf{p}) \frac{\partial f}{\partial x^i}(\mathbf{p}) \right) \\
  =& f(\mathbf{p}) X^i (\mathbf{p})\frac{\partial g}{\partial x^i}(\mathbf{p}) + g(\mathbf{p}) X^i (\mathbf{p})\frac{\partial f}{\partial x^i}(\mathbf{p}) \\
  =& f(\mathbf{p}) X_\mathbf{p}g + g(\mathbf{p})X_\mathbf{p} f
\end{align*}
$$

showing that that $X$ induces a derivation.

Conversely, suppose that $D:C^\infty (M)$. We need to construct a vector field $X$ such that $Df = Xf$ for all $f$. If there is such a vector field, its value at $\mathbf{p}$ must be the derivation at $\mathbf{p}$ whose action on any smooth real-valued function $f\in C^\infty(M)$ is given by

$$
  X_\mathbf{p}f = (Df)(\mathbf{p})
$$

The linearity of $D$ guarantees that this expression depends linearly on $f$, and the fact that $D$ is a derivation yields the product rule for tangent vectors. Thus, the map $X_\mathbf{p}:C^\infty(M) \to\R$ so defined is indeed a tangent vector, i.e. a derivation of $C^\infty(M)$ at $\mathbf{p}$. This defines $X$ as a rough vector field. Because $Xf = DF$ is smooth whenever $f\in C^\infty (M)$, this vector field is smooth.
</details>
</MathBox>

## Vector fields and smooth maps

<MathBox title='Related vector fields' boxType='definition'>
Let $M$ and $N$ be smooth manifolds with or without boundary. Suppose that $F:M\to N$ is smooth and that $X$ is a vector field on $M$. If there is a vector field $Y$ on $N$ such that $\mathrm{d}F_\mathbf{p}(X_\mathbf{p}) = Y_{F(\mathbf{p})}$ for each $\mathbf{p}\in M$, we say that $X$ and $Y$ are $F$-related. 
</MathBox>

<MathBox title='' boxType='proposition'>
Suppose that $F$ is a smooth map between manifolds with or without boundary, $X\in\mathfrak{X}(M)$, and $Y \in\mathfrak{X}(N)$. Then $X$ and $Y$ are $F$-related if and only if for every smooth real-valued function $f$ defined on an open subset of $N$

$$
  X(f\circ F) = (Yf) \circ F
$$

<details>
<summary>Proof</summary>

For any $\mathbf{p}\in M$ and any smooth real-value $f$ defined in a neighbourhood of $F(\mathbf{p})$

$$
  X(f\circ F)(\mathbf{p}) = X_p(f\circ F) = \mathrm{d}F_\mathbf{p}(X_\mathbf{p})f
$$

while

$$
  (Yf)\circ F(\mathbf{p}) = (Yf)(F(\mathbf{p})) = Y_{F(\mathbf{p})}f
$$

Thus, the first expression is true for all $f$ if and only if $\mathrm{d}F_\mathbf{p}(X_\mathbf{p}) = Y_{F(\mathbf{p})}$ for all $\mathbf{p}\in M$, i.e. if and only if $X$ and $Y$ are $F$-related.
</details>
</MathBox>

<MathBox title='Existence of unique related vector fields' boxType='proposition'>
Suppose that $M$ and $N$ are smooth manifolds with or without boudary, and $F:M\to N$ is a diffeomorphism. For every $X\in\mathfrak{X}(M)$, there is a unique smooth vector field on $N$ that is $F$-related to $X$.

<details>
<summary>Proof</summary>

For $Y\in\mathfrak{X}(N)$ to be $F$-related to $X$ means that $\mathrm{d}F_\mathbf{p}(X_\mathbf{p}) = Y_{F(\mathbf{p})}$ for every $\mathbf{p}\in M$. If $F$ is a diffeomorphism, therefore, we define $Y$ by

$$
  Y_\mathbf{q} = \mathrm{d}F_{F^{-1}(\mathbf{q})}(X_{F^{-1}(\mathbf{q})})
$$

It is clear that $Y$, so defined, is the unique (rough) vector field that is $F$-related to $X$. Note that $Y:N\to TN$ is the composition of the following smooth maps:

$$
  N \xrightarrow{F^{-1}} M \xrightarrow{X} TM \xrightarrow{\mathrm{d}F} TN 
$$

It follows that $Y$ is smooth.
</details>
</MathBox>

Let $F:M\to N$ be a diffeomorphism between smooth manifolds and consider a vector field $X\in\mathfrak{X}(M)$. The unique vector field that is $F$-related to $X$ is usually denoted $F_* X$ and is called the *pushforward* of $X$ by $F$. The $F$-related vector $F_* X$ is explicitly defined By

$$
  (F_* X)_\mathbf{q} = \mathrm{d}F_{F^{-1}(\mathbf{q})} (X_{F^{-1}(\mathbf{q})})
$$

<MathBox title='' boxType='corollary'>
Suppose that $F:M\to N$ is a diffeomorphism and $X\in\mathfrak{X}(M)$. For any $f\in C^\infty(N)$

$$
  ((F_* X)f) \circ F = X(f\circ F)
$$
</MathBox>

## Vector fields and submanifolds

<MathBox title='Tangent vector field' boxType='definition'>
Let $S\subseteq M$ be an immersed or embedded submanifold (with or without boundary). Given a point $\mathbf{p}\in S$, a vector field $X\in\mathfrak{X}(M)$ is *tangent* to $S$ at $\mathbf{p}$ if $X_\mathbf{p}\in T_\mathbf{p}S \subseteq T_\mathbf{p}M$. It is tangent to $S$ if it is tangent to $S$ at every point of $S$.
</MathBox>

<MathBox title='' boxType='proposition'>
Let $M$ be a smooth manifold, $S\subseteq M$ be an embedded submanifold with or without boundary, and let $X$ be a smooth vector field on $M$. Then $X$ is tangent to $S$ if and only if $(Xf)|_S = 0$ for every $f\in C^\infty (M)$ such that $f|_S \equiv 0$.

<details>
<summary>Proof</summary>

This follows directly from the characterizing property of tangent spaces to embedded submanifolds.
</details>
</MathBox>

<MathBox title='Restricting vector fields to submanifolds' boxType='proposition'>
Let $M$ be a smooth manifold, $S\subseteq M$ be an immersed submanifold with or without boundary, and let $\iota:S\hookrightarrow M$ denote the inclusion map. If $Y\in\mathfrak{X}(M)$ is tangent to $S$, then there is a unique smooth vector field on $S$, denoted by $Y|_S$, that is $\iota$-related to $Y$.

<details>
<summary>Proof</summary>

The fact that $Y$ is tangent to $S$ means by definition that $Y_\mathbf{p}$ is in the image of $\mathrm{d}\iota_\mathbf{p}$ for each $\mathbf{p}\in S$. Thus, for each $\mathbf{p}$ there is a vector $X_\mathbf{p} \in T_\mathbf{p}S$ such that $Y_\mathbf{p} = \mathrm{d}\iota_\mathbf{p}(X_\mathbf{p})$. Since $\mathrm{d}\iota_\mathbf{p}$ is injective, $X_\mathbf{p}$ is unique, so this defines $X$ as a rough vector field on $S$. If we can show that $X$ is smooth, it is the unique vector field that is $\iota$-related to $Y$. It suffices to show that it is smooth in a neighbourhood of each point.

Let $\mathbf{p}$ be any point in $S$. Since an immersed submanifold (with or without boundary) is locally embedded, there is a neighbourhood $V$ of $\mathbf{p}$ in $S$ that is embedded in $M$. Let $(U, (x^i))$ be a slice chart (or boundary slice chart) for $V$ in $M$ centered at $\mathbf{p}$, so that $V\cap U$ is the subset where $x^{k+1} = \cdots = x^n = 0$ (and $x^k \geq 0$ if $\partial S$), and $(x^1,\dots,x^k)$ for local coordinates for $S$ in $V \cap U$. If $Y = \sum_{i=1}^n Y^i \frac{\partial}{\partial x^i}$ in these coordinates it follows from our construction that $X$ has the coordinate representation $Y = \sum_{i=1}^k Y^i \frac{\partial}{\partial x^i}$, which is clearly smooth on $V \cap U$.
</details>
</MathBox>

## Lie brackets

<MathBox title='Lie bracket' boxType='definition'>
Let $X,Y\in\mathfrak{X}(M)$ be smooth vector fields on a smooth manifold $M$. The *Lie bracket* of $X$ and $Y$ is an operator $[X,Y]:C^\infty (M) \to C^\infty(M)$ defined by

$$
  [X,Y]f = XYf - YXf
$$
</MathBox>

<MathBox title='Lie bracket is a smooth vector field' boxType='lemma'>
The Lie bracket of any pair of smooth vector fields is a smooth vector field.

<details>
<summary>Proof</summary>

It suffices to show that $[X,Y]$ is a derivation of $C^\infty(M)$. For arbitrary $f,g\in C^\infty (M)$ we gets

$$
\begin{align*}
  [X,Y](fg) =& X(Y(fg)) - Y(X(fg)) \\
  =& X(fYg + gYf) - Y(fXg + gXf) \\
  =& \cancel{XfYg} + fXYg + \cancel{XgYf} + gXYf \\
  &- \bcancel{YfXg} - fYXg - YgXf - \bcance{gYXf} \\
  =& fXYg + gXYf - fYXg - gYXf \\
  =& f[X,Y]g + g[X,Y]f
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Coordinate formula for the Lie bracket' boxType='proposition'>
Let $X,Y\in\mathfrak{X}(M)$ be smooth vector fields on a smooth manifold $M$ with or without boundary. The value of the vector field $[X, Y]$ at a point $\mathbf{p}\in M$ is the derivation at $\mathbf{p}$ given by

$$
  [X,Y]_\mathbf{p} f = X_\mathbf{p} (Yf) - Y_\mathbf{p}(Xf)
$$

Let $X = X^i \frac{\partial}{\partial x^i}$ and $Y = Y^j \frac{\partial}{\partial x^j}$ be the coordinate expression for $X$ and $Y$ in terms of some smooth local coordinates $(x^i)$ for $M$. Then $[X,Y]$ has the following coordinate expression

$$
  [X,Y] = \left( X^i \frac{\partial Y^j}{\partial x^i} - Y^i \frac{\partial X^j}{\partial x^i} \right)\frac{\partial}{\partial x^j}
$$

or more concisely,

$$
  [X,Y] = (XY^j - YX^j)\frac{\partial}{\partial x^j}
$$

<details>
<summary>Proof</summary>

Since $[X,Y]$ is a smooth vector field, its action on a function is determined locally: $([X,Y]f)|_U = [X,Y](f|_U)$. Thus it suffices to compute in a single smooth chart, where we have

$$
\begin{align*}
  [X,Y]f =& X^i \frac{\partial}{\partial x^i}\left( Y^j \frac{\partial f}{\partial x^j} \right) - Y^j \frac{\partial }{\partial x^j} \left(  X^i \frac{\partial f}{\partial x^i} \right) \\
  =& X^i \frac{\partial Y^j}{\partial x^i} \frac{\partial f}{\partial x^j} + \cancel{X^i Y^j \frac{\partial^2 f}{\partial x^i \partial x^j}} - Y^j \frac{\partial X^i}{\partial x^j}\frac{\partial f}{\partial x^i} - \bcancel{Y^j X^i \frac{\partial^2 f}{\partial x^j \partial x^i}} \\
  =& X^i \frac{\partial Y^j}{\partial x^i}\frac{\partial f}{\partial x^j} - Y^j \frac{\partial X^i}{\partial x^j} \frac{\partial f}{\partial x^i} \\
  =& X^i \frac{\partial Y^j}{\partial x^i}\frac{\partial f}{\partial x^j} - Y^i \frac{\partial X^j}{\partial x^i} \frac{\partial f}{\partial x^j} \\
  =& \left( X^i \frac{\partial Y^j}{\partial x^i} - Y^i \frac{\partial X^j}{\partial x^i} \right)\frac{\partial f}{\partial x^j}
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Properties of the Lie bracket' boxType='proposition'>
The Lie bracket satisfies the following identities for all $X,Y,Z\in\mathfrak{X}(M)$:
1. **Bilinearity:** For $a,b\in\R$:
    - $[aX + bY, Z] = a[X,Z] + b[Y,Z]$
    - $[Z, aX + bY] = a[Z,X] + b[Z,Y]$
2. **Antisymmetry:** $[X,Y] = - [Y,X]$
3. **Jacobi identity:** 
$$
  [X,[Y,Z]] + [Y,[Z,X]] + [Z,[X,Y]] = 0
$$
4. For $f,g\in C^\infty(M)$:
$$
  [fX, gY] = fg[X,Y] + (fXg)Y - (gYf)X
$$

<details>
<summary>Proof</summary>

Bilinearity and antisymmetry are obvious consequences of the definition. The proof of the Jacobi identity is just a computation

$$
\begin{align*}
  &[X,[Y,Z]]f + [Y,[Z,X]]f + [Z,[X,Y]]f \\
  =& X[Y,Z]f - [Y,Z]Xf + Y[Z,X]f \\
  &- [Z,X]Yf + Z[X,Y]f - [X,Y]Zf \\
  =& \color{red}{XYZf} \color{green}{-XZYf} \color{blue}{-YZXf} \color{cyan}{+ZYXf} \color{blue}{+YZXf} \color{orange}{-YXZf} \\
  & \color{magenta}{-ZXYf} \color{green}{+XZYf} \color{magenta}{+ZXYf} \color{cyan}{-ZYXf} \color{red}{-XYZf} \color{orange}{+YXZf} \\
  =& 0
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Naturality of the Lie brackets' boxType='proposition'>
Let $F:M\to N$ be a smooth map between manifolds with or without boundary, and let $X_1, X_2\in \mathfrak{X}(X)$ and $Y_1, Y_2\in\mathfrak{X}(N)$ be vector fields such that $X_i$ is $F$-related to $Y_i$ for $i=1,2$. Then $[X_1, X_2]$ is $F$-related to $[Y_1, Y_2]$.

<details>
<summary>Proof</summary>

Since $X_i$ and $Y_i$ are $F$-related

$$
\begin{align*}
  X_1 X_2 (f\circ F) =& X_1((X_2f) \circ F) \\
  =& (Y_1 Y_2 f) \circ F
\end{align*}
$$

Similarly,

$$
  X_2 X_1 (f\circ F) = (Y_2 Y_1 f) \circ F
$$

Thus,

$$
\begin{align*}
  [X_1, X_2](f\circ F) =& X_1 X_2 (f\circ F) - X_2 X_1 (f\circ F) \\
  =& (Y_1 Y_2 f) \circ F - (Y_2 Y_1 f)\circ F \\
  =& ([Y_1, Y_2]f)\circ F
\end{align*}
$$
</details>
</MathBox>

<MathBox title='Pushforwards of Lie brackets' boxType='corollary'>
Suppose that $F:M\to N$ is a diffeomorphism and $X_1, X_2 \in\mathfrak{X}(M)$. Then $F_*[X_1, X_2]= [F_* X_1, F_* X_2]$.

<details>
<summary>Proof</summary>

This is just a special case of the naturality of the Lie bracket in which $F$ is a diffeomorphism and $Y_i = F_* X_i$ for $i=1,2$.
</details>
</MathBox>

<MathBox title='Bracket of vector fields tangent to submanifolds' boxType='corollary'>
Let $M$ be a smooth manifold and let $S\subseteq M$ be an immersed submanifold with or without boundary in $M$. If $Y_1$ and $Y_2$ are smooth vector fields on that are tangent to $S$, then $[Y_1, Y_2]$ is also tangent to $S$.

<details>
<summary>Proof</summary>

There exist smooth vector fields $X_1$ and $X_2$ on $S$ such that $X_i$ is $\iota$-related to $Y_i$ for $i=1,2$, where $\iota:S\hookrightarrow M$ is the inclusion. By the naturality of the Lie bracket, $[X_1,X_2]$ is $\iota$-related to $[Y_1, Y_2]$, which is therefore tangent to $S$.
</details>
</MathBox>

## The Lie algebra of a Lie group

# Riemannian manifolds

A Riemannian metric $g$ on $M$ is a smooth symmetric covariant $2$-tensor field (bilinear form) on $M$ that is positive definitive at each point. A Riemannian manifold $(M, g)$ is a smooth manifold $M$ endowed with a Riemannian metric $g$.

## Riemannian metric

If $g$ is a Riemannian metric on $M$, then for each $p \in M$, the $2$-tensor $g_p$ is an inner product on $T_p M$. In any smooth local coordinates $\left( x^i \right)$, a Riemannian metric can be written

$$
\begin{align*}
  g &= g_{ij} \mathrm{d}x^i \otimes \mathrm{d}x^j \\
  &= \frac{1}{2} \left( g_{ij} \mathrm{d}x^i \otimes \mathrm{d}x^j + g_{ji} \mathrm{d}x^i \otimes \mathrm{d}x^j  \right) \\
  &= \frac{1}{2} \left( g_{ij} \mathrm{d}x^i \otimes \mathrm{d}x^j + g_{ij} \mathrm{d}x^j \otimes \mathrm{d}x^i  \right) \\
  &= g_{ij} \mathrm{d}x^i \mathrm{d}x^j 
\end{align*}
$$

where $(g_{ij})$ is a symmetric positive definitive matrix of smooth functions.